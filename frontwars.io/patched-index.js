
/*
 * FrontWars Macro Hack by KebabLord
 * Automatically generated at 16/12/2025
 */
function showToast(message) {
  const DURATION = 2000; // ms
  const containerId = '__toast_container_bl';

  // Ensure container exists (bottom-left)
  let c = document.getElementById(containerId);
  if (!c) {
    c = document.createElement('div');
    c.id = containerId;
    Object.assign(c.style, {
      position: 'fixed',
      left: '32px',
      bottom: '32px',
      display: 'flex',
      flexDirection: 'column-reverse', // newest closest to bottom
      gap: '16px',
      maxWidth: '40vw',
      zIndex: '2147483647',
      pointerEvents: 'none'
    });
    (document.body || document.documentElement).appendChild(c);
  }

  // Create toast (4x bigger, opaque background)
  const t = document.createElement('div');
  t.textContent = String(message);
  Object.assign(t.style, {
    background: '#111111',                   // opaque (no transparency)
    color: '#ffffff',
    fontFamily: 'system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif',
    fontSize: '28px',                        // 14px * 4
    lineHeight: '1.2',
    padding: '20px 24px',                    // 4x padding
    borderRadius: '16px',                    // 4x radius
    boxShadow: '0 12px 36px rgba(0,0,0,.35)',
    pointerEvents: 'none',
    opacity: '0',
    transform: 'translateY(16px)',
    transition: 'opacity 180ms ease-out, transform 180ms ease-out',
    whiteSpace: 'pre-wrap',
    wordBreak: 'break-word',
    overflowWrap: 'anywhere'
  });

  c.appendChild(t);

  // Animate in
  requestAnimationFrame(() => {
    t.style.opacity = '1';
    t.style.transform = 'translateY(0)';
  });

  // Animate out shortly before removal
  setTimeout(() => {
    t.style.opacity = '0';
    t.style.transform = 'translateY(16px)';
  }, DURATION - 180);

  // Remove from DOM
  setTimeout(() => {
    if (t.parentNode) t.parentNode.removeChild(t);
    if (c.children.length === 0) c.remove();
  }, DURATION);
}


(function initSpamLoopWithUI() {
    // ---------- floating info box ----------
    const box = document.createElement("div");
    box.textContent = "SPAMMING ACTIVE";
    box.style.position = "fixed";
    box.style.top = "12px";
    box.style.left = "50%";
    box.style.transform = "translateX(-50%)";
    box.style.padding = "8px 16px";
    box.style.fontFamily = "Arial, sans-serif";
    box.style.fontSize = "14px";
    box.style.fontWeight = "bold";
    box.style.color = "#111";
    box.style.background = "orange";
    box.style.border = "3px solid #cc8400"; // darker orange
    box.style.borderRadius = "0";
    box.style.zIndex = "999999";
    box.style.display = "none";
    box.style.pointerEvents = "none";

    document.body.appendChild(box);

    // ---------- spam loop ----------
    let last = 0;
    const interval = 100; // ms

    let lastKeepghost;
    let lastSpam;
    showToast("Macro hack is loaded.")

    const loop = (t) => {
        // --- spam execution ---
        if (t - last >= interval) {
            last = t;

            if (window.keepghost && window.spam) {
                try {
                    window.executePlacement(window.obj_placement?._cursorLoc);
                } catch (err) {
                    console.log("7331 ERR:", err);
                }
            }
        }

        // --- UI update (only on state change) ---
        if (window.keepghost !== lastKeepghost || window.spam !== lastSpam) {
            lastKeepghost = window.keepghost;
            lastSpam = window.spam;

            if (window.keepghost === true) {
                box.style.display = "block";

                if (window.spam === true) {
                    box.style.background = "red";
                    box.style.borderColor = "#b30000"; // darker red
                } else {
                    box.style.background = "orange";
                    box.style.borderColor = "#cc8400"; // darker orange
                }
            } else {
                box.style.display = "none";
            }
        }

        requestAnimationFrame(loop);
    };

    requestAnimationFrame(loop);
})();
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["https://frontwars.io/assets/browserAll-CdxFVCIO.js","https://frontwars.io/assets/webworkerAll-DDGql2Zg.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var vie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zo(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function sj(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var Ny={exports:{}},Ou={};var IA;function aj(){if(IA)return Ou;IA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var c in i)c!=="key"&&(s[c]=i[c])}else s=i;return i=s.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:s}}return Ou.Fragment=e,Ou.jsx=t,Ou.jsxs=t,Ou}var RA;function oj(){return RA||(RA=1,Ny.exports=aj()),Ny.exports}var g=oj(),Iy={exports:{}},Lu={},Ry={exports:{}},Py={};var PA;function lj(){return PA||(PA=1,(function(n){function e(N,V){var J=N.length;N.push(V);e:for(;0<J;){var se=J-1>>>1,O=N[se];if(0<i(O,V))N[se]=V,N[J]=O,J=se;else break e}}function t(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var V=N[0],J=N.pop();if(J!==V){N[0]=J;e:for(var se=0,O=N.length,F=O>>>1;se<F;){var X=2*(se+1)-1,D=N[X],ee=X+1,pe=N[ee];if(0>i(D,J))ee<O&&0>i(pe,D)?(N[se]=pe,N[ee]=J,se=ee):(N[se]=D,N[X]=J,se=X);else if(ee<O&&0>i(pe,J))N[se]=pe,N[ee]=J,se=ee;else break e}}return V}function i(N,V){var J=N.sortIndex-V.sortIndex;return J!==0?J:N.id-V.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var u=[],d=[],f=1,p=null,y=3,b=!1,_=!1,w=!1,S=!1,A=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function E(N){for(var V=t(d);V!==null;){if(V.callback===null)r(d);else if(V.startTime<=N)r(d),V.sortIndex=V.expirationTime,e(u,V);else break;V=t(d)}}function U(N){if(w=!1,E(N),!_)if(t(u)!==null)_=!0,I||(I=!0,Y());else{var V=t(d);V!==null&&W(U,V.startTime-N)}}var I=!1,B=-1,G=5,R=-1;function P(){return S?!0:!(n.unstable_now()-R<G)}function H(){if(S=!1,I){var N=n.unstable_now();R=N;var V=!0;try{e:{_=!1,w&&(w=!1,M(B),B=-1),b=!0;var J=y;try{t:{for(E(N),p=t(u);p!==null&&!(p.expirationTime>N&&P());){var se=p.callback;if(typeof se=="function"){p.callback=null,y=p.priorityLevel;var O=se(p.expirationTime<=N);if(N=n.unstable_now(),typeof O=="function"){p.callback=O,E(N),V=!0;break t}p===t(u)&&r(u),E(N)}else r(u);p=t(u)}if(p!==null)V=!0;else{var F=t(d);F!==null&&W(U,F.startTime-N),V=!1}}break e}finally{p=null,y=J,b=!1}V=void 0}}finally{V?Y():I=!1}}}var Y;if(typeof k=="function")Y=function(){k(H)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,q=L.port2;L.port1.onmessage=H,Y=function(){q.postMessage(null)}}else Y=function(){A(H,0)};function W(N,V){B=A(function(){N(n.unstable_now())},V)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(N){N.callback=null},n.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<N?Math.floor(1e3/N):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function(N){switch(y){case 1:case 2:case 3:var V=3;break;default:V=y}var J=y;y=V;try{return N()}finally{y=J}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(N,V){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var J=y;y=N;try{return V()}finally{y=J}},n.unstable_scheduleCallback=function(N,V,J){var se=n.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?se+J:se):J=se,N){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=J+O,N={id:f++,callback:V,priorityLevel:N,startTime:J,expirationTime:O,sortIndex:-1},J>se?(N.sortIndex=J,e(d,N),t(u)===null&&N===t(d)&&(w?(M(B),B=-1):w=!0,W(U,J-se))):(N.sortIndex=O,e(u,N),_||b||(_=!0,I||(I=!0,Y()))),N},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(N){var V=y;return function(){var J=y;y=V;try{return N.apply(this,arguments)}finally{y=J}}}})(Py)),Py}var DA;function cj(){return DA||(DA=1,Ry.exports=lj()),Ry.exports}var Dy={exports:{}},Ze={};var jA;function uj(){if(jA)return Ze;jA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),y=Symbol.iterator;function b(F){return F===null||typeof F!="object"?null:(F=y&&F[y]||F["@@iterator"],typeof F=="function"?F:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function A(F,X,D){this.props=F,this.context=X,this.refs=S,this.updater=D||_}A.prototype.isReactComponent={},A.prototype.setState=function(F,X){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,X,"setState")},A.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function M(){}M.prototype=A.prototype;function k(F,X,D){this.props=F,this.context=X,this.refs=S,this.updater=D||_}var E=k.prototype=new M;E.constructor=k,w(E,A.prototype),E.isPureReactComponent=!0;var U=Array.isArray;function I(){}var B={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function R(F,X,D){var ee=D.ref;return{$$typeof:n,type:F,key:X,ref:ee!==void 0?ee:null,props:D}}function P(F,X){return R(F.type,X,F.props)}function H(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function Y(F){var X={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(D){return X[D]})}var L=/\/+/g;function q(F,X){return typeof F=="object"&&F!==null&&F.key!=null?Y(""+F.key):X.toString(36)}function W(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(I,I):(F.status="pending",F.then(function(X){F.status==="pending"&&(F.status="fulfilled",F.value=X)},function(X){F.status==="pending"&&(F.status="rejected",F.reason=X)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function N(F,X,D,ee,pe){var Se=typeof F;(Se==="undefined"||Se==="boolean")&&(F=null);var ie=!1;if(F===null)ie=!0;else switch(Se){case"bigint":case"string":case"number":ie=!0;break;case"object":switch(F.$$typeof){case n:case e:ie=!0;break;case f:return ie=F._init,N(ie(F._payload),X,D,ee,pe)}}if(ie)return pe=pe(F),ie=ee===""?"."+q(F,0):ee,U(pe)?(D="",ie!=null&&(D=ie.replace(L,"$&/")+"/"),N(pe,X,D,"",function(Le){return Le})):pe!=null&&(H(pe)&&(pe=P(pe,D+(pe.key==null||F&&F.key===pe.key?"":(""+pe.key).replace(L,"$&/")+"/")+ie)),X.push(pe)),1;ie=0;var ve=ee===""?".":ee+":";if(U(F))for(var Ce=0;Ce<F.length;Ce++)ee=F[Ce],Se=ve+q(ee,Ce),ie+=N(ee,X,D,Se,pe);else if(Ce=b(F),typeof Ce=="function")for(F=Ce.call(F),Ce=0;!(ee=F.next()).done;)ee=ee.value,Se=ve+q(ee,Ce++),ie+=N(ee,X,D,Se,pe);else if(Se==="object"){if(typeof F.then=="function")return N(W(F),X,D,ee,pe);throw X=String(F),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return ie}function V(F,X,D){if(F==null)return F;var ee=[],pe=0;return N(F,ee,"","",function(Se){return X.call(D,Se,pe++)}),ee}function J(F){if(F._status===-1){var X=F._result;X=X(),X.then(function(D){(F._status===0||F._status===-1)&&(F._status=1,F._result=D)},function(D){(F._status===0||F._status===-1)&&(F._status=2,F._result=D)}),F._status===-1&&(F._status=0,F._result=X)}if(F._status===1)return F._result.default;throw F._result}var se=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},O={map:V,forEach:function(F,X,D){V(F,function(){X.apply(this,arguments)},D)},count:function(F){var X=0;return V(F,function(){X++}),X},toArray:function(F){return V(F,function(X){return X})||[]},only:function(F){if(!H(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return Ze.Activity=p,Ze.Children=O,Ze.Component=A,Ze.Fragment=t,Ze.Profiler=i,Ze.PureComponent=k,Ze.StrictMode=r,Ze.Suspense=u,Ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Ze.__COMPILER_RUNTIME={__proto__:null,c:function(F){return B.H.useMemoCache(F)}},Ze.cache=function(F){return function(){return F.apply(null,arguments)}},Ze.cacheSignal=function(){return null},Ze.cloneElement=function(F,X,D){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var ee=w({},F.props),pe=F.key;if(X!=null)for(Se in X.key!==void 0&&(pe=""+X.key),X)!G.call(X,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&X.ref===void 0||(ee[Se]=X[Se]);var Se=arguments.length-2;if(Se===1)ee.children=D;else if(1<Se){for(var ie=Array(Se),ve=0;ve<Se;ve++)ie[ve]=arguments[ve+2];ee.children=ie}return R(F.type,pe,ee)},Ze.createContext=function(F){return F={$$typeof:o,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:s,_context:F},F},Ze.createElement=function(F,X,D){var ee,pe={},Se=null;if(X!=null)for(ee in X.key!==void 0&&(Se=""+X.key),X)G.call(X,ee)&&ee!=="key"&&ee!=="__self"&&ee!=="__source"&&(pe[ee]=X[ee]);var ie=arguments.length-2;if(ie===1)pe.children=D;else if(1<ie){for(var ve=Array(ie),Ce=0;Ce<ie;Ce++)ve[Ce]=arguments[Ce+2];pe.children=ve}if(F&&F.defaultProps)for(ee in ie=F.defaultProps,ie)pe[ee]===void 0&&(pe[ee]=ie[ee]);return R(F,Se,pe)},Ze.createRef=function(){return{current:null}},Ze.forwardRef=function(F){return{$$typeof:c,render:F}},Ze.isValidElement=H,Ze.lazy=function(F){return{$$typeof:f,_payload:{_status:-1,_result:F},_init:J}},Ze.memo=function(F,X){return{$$typeof:d,type:F,compare:X===void 0?null:X}},Ze.startTransition=function(F){var X=B.T,D={};B.T=D;try{var ee=F(),pe=B.S;pe!==null&&pe(D,ee),typeof ee=="object"&&ee!==null&&typeof ee.then=="function"&&ee.then(I,se)}catch(Se){se(Se)}finally{X!==null&&D.types!==null&&(X.types=D.types),B.T=X}},Ze.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Ze.use=function(F){return B.H.use(F)},Ze.useActionState=function(F,X,D){return B.H.useActionState(F,X,D)},Ze.useCallback=function(F,X){return B.H.useCallback(F,X)},Ze.useContext=function(F){return B.H.useContext(F)},Ze.useDebugValue=function(){},Ze.useDeferredValue=function(F,X){return B.H.useDeferredValue(F,X)},Ze.useEffect=function(F,X){return B.H.useEffect(F,X)},Ze.useEffectEvent=function(F){return B.H.useEffectEvent(F)},Ze.useId=function(){return B.H.useId()},Ze.useImperativeHandle=function(F,X,D){return B.H.useImperativeHandle(F,X,D)},Ze.useInsertionEffect=function(F,X){return B.H.useInsertionEffect(F,X)},Ze.useLayoutEffect=function(F,X){return B.H.useLayoutEffect(F,X)},Ze.useMemo=function(F,X){return B.H.useMemo(F,X)},Ze.useOptimistic=function(F,X){return B.H.useOptimistic(F,X)},Ze.useReducer=function(F,X,D){return B.H.useReducer(F,X,D)},Ze.useRef=function(F){return B.H.useRef(F)},Ze.useState=function(F){return B.H.useState(F)},Ze.useSyncExternalStore=function(F,X,D){return B.H.useSyncExternalStore(F,X,D)},Ze.useTransition=function(){return B.H.useTransition()},Ze.version="19.2.0",Ze}var BA;function Kp(){return BA||(BA=1,Dy.exports=uj()),Dy.exports}var jy={exports:{}},_r={};var OA;function hj(){if(OA)return _r;OA=1;var n=Kp();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)d+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(u,d,f){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:f}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return _r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,_r.createPortal=function(u,d){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(u,d,null,f)},_r.flushSync=function(u){var d=o.T,f=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=f,r.d.f()}},_r.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},_r.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},_r.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var f=d.as,p=c(f,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;f==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:y,fetchPriority:b}):f==="script"&&r.d.X(u,{crossOrigin:p,integrity:y,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},_r.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var f=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},_r.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var f=d.as,p=c(f,d.crossOrigin);r.d.L(u,f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},_r.preloadModule=function(u,d){if(typeof u=="string")if(d){var f=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},_r.requestFormReset=function(u){r.d.r(u)},_r.unstable_batchedUpdates=function(u,d){return u(d)},_r.useFormState=function(u,d,f){return o.H.useFormState(u,d,f)},_r.useFormStatus=function(){return o.H.useHostTransitionStatus()},_r.version="19.2.0",_r}var LA;function NM(){if(LA)return jy.exports;LA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),jy.exports=hj(),jy.exports}var zA;function dj(){if(zA)return Lu;zA=1;var n=cj(),e=Kp(),t=NM();function r(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var l=a,h=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(h=l.return),a=l.return;while(a)}return l.tag===3?h:null}function o(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function c(a){if(a.tag===31){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function u(a){if(s(a)!==a)throw Error(r(188))}function d(a){var l=a.alternate;if(!l){if(l=s(a),l===null)throw Error(r(188));return l!==a?null:a}for(var h=a,m=l;;){var x=h.return;if(x===null)break;var v=x.alternate;if(v===null){if(m=x.return,m!==null){h=m;continue}break}if(x.child===v.child){for(v=x.child;v;){if(v===h)return u(x),a;if(v===m)return u(x),l;v=v.sibling}throw Error(r(188))}if(h.return!==m.return)h=x,m=v;else{for(var C=!1,z=x.child;z;){if(z===h){C=!0,h=x,m=v;break}if(z===m){C=!0,m=x,h=v;break}z=z.sibling}if(!C){for(z=v.child;z;){if(z===h){C=!0,h=v,m=x;break}if(z===m){C=!0,m=v,h=x;break}z=z.sibling}if(!C)throw Error(r(189))}}if(h.alternate!==m)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?a:l}function f(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=f(a),l!==null)return l;a=a.sibling}return null}var p=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),k=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function Y(a){return a===null||typeof a!="object"?null:(a=H&&a[H]||a["@@iterator"],typeof a=="function"?a:null)}var L=Symbol.for("react.client.reference");function q(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===L?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case A:return"Profiler";case S:return"StrictMode";case U:return"Suspense";case I:return"SuspenseList";case R:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case _:return"Portal";case k:return a.displayName||"Context";case M:return(a._context.displayName||"Context")+".Consumer";case E:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case B:return l=a.displayName||null,l!==null?l:q(a.type)||"Memo";case G:l=a._payload,a=a._init;try{return q(a(l))}catch{}}return null}var W=Array.isArray,N=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},se=[],O=-1;function F(a){return{current:a}}function X(a){0>O||(a.current=se[O],se[O]=null,O--)}function D(a,l){O++,se[O]=a.current,a.current=l}var ee=F(null),pe=F(null),Se=F(null),ie=F(null);function ve(a,l){switch(D(Se,l),D(pe,a),D(ee,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?eA(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=eA(l),a=tA(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}X(ee),D(ee,a)}function Ce(){X(ee),X(pe),X(Se)}function Le(a){a.memoizedState!==null&&D(ie,a);var l=ee.current,h=tA(l,a.type);l!==h&&(D(pe,a),D(ee,h))}function st(a){pe.current===a&&(X(ee),X(pe)),ie.current===a&&(X(ie),Pu._currentValue=J)}var ft,Ge;function It(a){if(ft===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);ft=l&&l[1]||"",Ge=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ft+a+Ge}var zt=!1;function tt(a,l){if(!a||zt)return"";zt=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(l){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(he){var ce=he}Reflect.construct(a,[],xe)}else{try{xe.call()}catch(he){ce=he}a.call(xe.prototype)}}else{try{throw Error()}catch(he){ce=he}(xe=a())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(he){if(he&&ce&&typeof he.stack=="string")return[he.stack,ce.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=m.DetermineComponentFrameRoot(),C=v[0],z=v[1];if(C&&z){var Z=C.split(`
`),le=z.split(`
`);for(x=m=0;m<Z.length&&!Z[m].includes("DetermineComponentFrameRoot");)m++;for(;x<le.length&&!le[x].includes("DetermineComponentFrameRoot");)x++;if(m===Z.length||x===le.length)for(m=Z.length-1,x=le.length-1;1<=m&&0<=x&&Z[m]!==le[x];)x--;for(;1<=m&&0<=x;m--,x--)if(Z[m]!==le[x]){if(m!==1||x!==1)do if(m--,x--,0>x||Z[m]!==le[x]){var fe=`
`+Z[m].replace(" at new "," at ");return a.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",a.displayName)),fe}while(1<=m&&0<=x);break}}}finally{zt=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?It(h):""}function mt(a,l){switch(a.tag){case 26:case 27:case 5:return It(a.type);case 16:return It("Lazy");case 13:return a.child!==l&&l!==null?It("Suspense Fallback"):It("Suspense");case 19:return It("SuspenseList");case 0:case 15:return tt(a.type,!1);case 11:return tt(a.type.render,!1);case 1:return tt(a.type,!0);case 31:return It("Activity");default:return""}}function _t(a){try{var l="",h=null;do l+=mt(a,h),h=a,a=a.return;while(a);return l}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var Xn=Object.prototype.hasOwnProperty,Kn=n.unstable_scheduleCallback,ke=n.unstable_cancelCallback,nt=n.unstable_shouldYield,wt=n.unstable_requestPaint,$e=n.unstable_now,kn=n.unstable_getCurrentPriorityLevel,de=n.unstable_ImmediatePriority,we=n.unstable_UserBlockingPriority,Oe=n.unstable_NormalPriority,qe=n.unstable_LowPriority,pt=n.unstable_IdlePriority,Qn=n.log,Dr=n.unstable_setDisableYieldValue,Un=null,hn=null;function dn(a){if(typeof Qn=="function"&&Dr(a),hn&&typeof hn.setStrictMode=="function")try{hn.setStrictMode(Un,a)}catch{}}var vt=Math.clz32?Math.clz32:wg,yi=Math.log,kr=Math.LN2;function wg(a){return a>>>=0,a===0?32:31-(yi(a)/kr|0)|0}var bs=256,xs=262144,il=4194304;function Jr(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function sl(a,l,h){var m=a.pendingLanes;if(m===0)return 0;var x=0,v=a.suspendedLanes,C=a.pingedLanes;a=a.warmLanes;var z=m&134217727;return z!==0?(m=z&~v,m!==0?x=Jr(m):(C&=z,C!==0?x=Jr(C):h||(h=z&~a,h!==0&&(x=Jr(h))))):(z=m&~v,z!==0?x=Jr(z):C!==0?x=Jr(C):h||(h=m&~a,h!==0&&(x=Jr(h)))),x===0?0:l!==0&&l!==x&&(l&v)===0&&(v=x&-x,h=l&-l,v>=h||v===32&&(h&4194048)!==0)?l:x}function Xa(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function Fn(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vs(){var a=il;return il<<=1,(il&62914560)===0&&(il=4194304),a}function Gc(a){for(var l=[],h=0;31>h;h++)l.push(a);return l}function Qs(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Hc(a,l,h,m,x,v){var C=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var z=a.entanglements,Z=a.expirationTimes,le=a.hiddenUpdates;for(h=C&~h;0<h;){var fe=31-vt(h),xe=1<<fe;z[fe]=0,Z[fe]=-1;var ce=le[fe];if(ce!==null)for(le[fe]=null,fe=0;fe<ce.length;fe++){var he=ce[fe];he!==null&&(he.lane&=-536870913)}h&=~xe}m!==0&&Vc(a,m,0),v!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=v&~(C&~l))}function Vc(a,l,h){a.pendingLanes|=l,a.suspendedLanes&=~l;var m=31-vt(l);a.entangledLanes|=l,a.entanglements[m]=a.entanglements[m]|1073741824|h&261930}function Wc(a,l){var h=a.entangledLanes|=l;for(a=a.entanglements;h;){var m=31-vt(h),x=1<<m;x&l|a[m]&l&&(a[m]|=l),h&=~x}}function Dd(a,l){var h=l&-l;return h=(h&42)!==0?1:jr(h),(h&(a.suspendedLanes|l))!==0?0:h}function jr(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Ui(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Yc(){var a=V.p;return a!==0?a:(a=window.event,a===void 0?32:AA(a.type))}function $c(a,l){var h=V.p;try{return V.p=a,l()}finally{V.p=h}}var bi=Math.random().toString(36).slice(2),Gn="__reactFiber$"+bi,fn="__reactProps$"+bi,_s="__reactContainer$"+bi,al="__reactEvents$"+bi,jd="__reactListeners$"+bi,Bd="__reactHandles$"+bi,Od="__reactResources$"+bi,Pe="__reactMarker$"+bi;function K(a){delete a[Gn],delete a[fn],delete a[al],delete a[jd],delete a[Bd]}function _e(a){var l=a[Gn];if(l)return l;for(var h=a.parentNode;h;){if(l=h[_s]||h[Gn]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(a=lA(a);a!==null;){if(h=a[Gn])return h;a=lA(a)}return l}a=h,h=a.parentNode}return null}function Me(a){if(a=a[Gn]||a[_s]){var l=a.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return a}return null}function Rt(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(r(33))}function vn(a){var l=a[Od];return l||(l=a[Od]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function rt(a){a[Pe]=!0}var hr=new Set,xi={};function Br(a,l){Xi(a,l),Xi(a+"Capture",l)}function Xi(a,l){for(xi[a]=l,a=0;a<l.length;a++)hr.add(l[a])}var Jn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qc={},Zc={};function KP(a){return Xn.call(Zc,a)?!0:Xn.call(qc,a)?!1:Jn.test(a)?Zc[a]=!0:(qc[a]=!0,!1)}function Ld(a,l,h){if(KP(l))if(h===null)a.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var m=l.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+h)}}function zd(a,l,h){if(h===null)a.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+h)}}function ws(a,l,h,m){if(m===null)a.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(l,h,""+m)}}function vi(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Yv(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function QP(a,l,h){var m=Object.getOwnPropertyDescriptor(a.constructor.prototype,l);if(!a.hasOwnProperty(l)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var x=m.get,v=m.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return x.call(this)},set:function(C){h=""+C,v.call(this,C)}}),Object.defineProperty(a,l,{enumerable:m.enumerable}),{getValue:function(){return h},setValue:function(C){h=""+C},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Sg(a){if(!a._valueTracker){var l=Yv(a)?"checked":"value";a._valueTracker=QP(a,l,""+a[l])}}function $v(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var h=l.getValue(),m="";return a&&(m=Yv(a)?a.checked?"true":"false":a.value),a=m,a!==h?(l.setValue(a),!0):!1}function Ud(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var JP=/[\n"\\]/g;function _i(a){return a.replace(JP,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Ag(a,l,h,m,x,v,C,z){a.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?a.type=C:a.removeAttribute("type"),l!=null?C==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+vi(l)):a.value!==""+vi(l)&&(a.value=""+vi(l)):C!=="submit"&&C!=="reset"||a.removeAttribute("value"),l!=null?Cg(a,C,vi(l)):h!=null?Cg(a,C,vi(h)):m!=null&&a.removeAttribute("value"),x==null&&v!=null&&(a.defaultChecked=!!v),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?a.name=""+vi(z):a.removeAttribute("name")}function qv(a,l,h,m,x,v,C,z){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(a.type=v),l!=null||h!=null){if(!(v!=="submit"&&v!=="reset"||l!=null)){Sg(a);return}h=h!=null?""+vi(h):"",l=l!=null?""+vi(l):h,z||l===a.value||(a.value=l),a.defaultValue=l}m=m??x,m=typeof m!="function"&&typeof m!="symbol"&&!!m,a.checked=z?a.checked:!!m,a.defaultChecked=!!m,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(a.name=C),Sg(a)}function Cg(a,l,h){l==="number"&&Ud(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function ol(a,l,h,m){if(a=a.options,l){l={};for(var x=0;x<h.length;x++)l["$"+h[x]]=!0;for(h=0;h<a.length;h++)x=l.hasOwnProperty("$"+a[h].value),a[h].selected!==x&&(a[h].selected=x),x&&m&&(a[h].defaultSelected=!0)}else{for(h=""+vi(h),l=null,x=0;x<a.length;x++){if(a[x].value===h){a[x].selected=!0,m&&(a[x].defaultSelected=!0);return}l!==null||a[x].disabled||(l=a[x])}l!==null&&(l.selected=!0)}}function Zv(a,l,h){if(l!=null&&(l=""+vi(l),l!==a.value&&(a.value=l),h==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=h!=null?""+vi(h):""}function Xv(a,l,h,m){if(l==null){if(m!=null){if(h!=null)throw Error(r(92));if(W(m)){if(1<m.length)throw Error(r(93));m=m[0]}h=m}h==null&&(h=""),l=h}h=vi(l),a.defaultValue=h,m=a.textContent,m===h&&m!==""&&m!==null&&(a.value=m),Sg(a)}function ll(a,l){if(l){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=l;return}}a.textContent=l}var e6=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Kv(a,l,h){var m=l.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?m?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":m?a.setProperty(l,h):typeof h!="number"||h===0||e6.has(l)?l==="float"?a.cssFloat=h:a[l]=(""+h).trim():a[l]=h+"px"}function Qv(a,l,h){if(l!=null&&typeof l!="object")throw Error(r(62));if(a=a.style,h!=null){for(var m in h)!h.hasOwnProperty(m)||l!=null&&l.hasOwnProperty(m)||(m.indexOf("--")===0?a.setProperty(m,""):m==="float"?a.cssFloat="":a[m]="");for(var x in l)m=l[x],l.hasOwnProperty(x)&&h[x]!==m&&Kv(a,x,m)}else for(var v in l)l.hasOwnProperty(v)&&Kv(a,v,l[v])}function kg(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var t6=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),n6=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fd(a){return n6.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Ss(){}var Tg=null;function Eg(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var cl=null,ul=null;function Jv(a){var l=Me(a);if(l&&(a=l.stateNode)){var h=a[fn]||null;e:switch(a=l.stateNode,l.type){case"input":if(Ag(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),l=h.name,h.type==="radio"&&l!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+_i(""+l)+'"][type="radio"]'),l=0;l<h.length;l++){var m=h[l];if(m!==a&&m.form===a.form){var x=m[fn]||null;if(!x)throw Error(r(90));Ag(m,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<h.length;l++)m=h[l],m.form===a.form&&$v(m)}break e;case"textarea":Zv(a,h.value,h.defaultValue);break e;case"select":l=h.value,l!=null&&ol(a,!!h.multiple,l,!1)}}}var Mg=!1;function e_(a,l,h){if(Mg)return a(l,h);Mg=!0;try{var m=a(l);return m}finally{if(Mg=!1,(cl!==null||ul!==null)&&(Mf(),cl&&(l=cl,a=ul,ul=cl=null,Jv(l),a)))for(l=0;l<a.length;l++)Jv(a[l])}}function Xc(a,l){var h=a.stateNode;if(h===null)return null;var m=h[fn]||null;if(m===null)return null;h=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(r(231,l,typeof h));return h}var As=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ng=!1;if(As)try{var Kc={};Object.defineProperty(Kc,"passive",{get:function(){Ng=!0}}),window.addEventListener("test",Kc,Kc),window.removeEventListener("test",Kc,Kc)}catch{Ng=!1}var Js=null,Ig=null,Gd=null;function t_(){if(Gd)return Gd;var a,l=Ig,h=l.length,m,x="value"in Js?Js.value:Js.textContent,v=x.length;for(a=0;a<h&&l[a]===x[a];a++);var C=h-a;for(m=1;m<=C&&l[h-m]===x[v-m];m++);return Gd=x.slice(a,1<m?1-m:void 0)}function Hd(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Vd(){return!0}function n_(){return!1}function Or(a){function l(h,m,x,v,C){this._reactName=h,this._targetInst=x,this.type=m,this.nativeEvent=v,this.target=C,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(h=a[z],this[z]=h?h(v):v[z]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Vd:n_,this.isPropagationStopped=n_,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Vd)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Vd)},persist:function(){},isPersistent:Vd}),l}var Ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wd=Or(Ka),Qc=p({},Ka,{view:0,detail:0}),r6=Or(Qc),Rg,Pg,Jc,Yd=p({},Qc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jg,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Jc&&(Jc&&a.type==="mousemove"?(Rg=a.screenX-Jc.screenX,Pg=a.screenY-Jc.screenY):Pg=Rg=0,Jc=a),Rg)},movementY:function(a){return"movementY"in a?a.movementY:Pg}}),r_=Or(Yd),i6=p({},Yd,{dataTransfer:0}),s6=Or(i6),a6=p({},Qc,{relatedTarget:0}),Dg=Or(a6),o6=p({},Ka,{animationName:0,elapsedTime:0,pseudoElement:0}),l6=Or(o6),c6=p({},Ka,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),u6=Or(c6),h6=p({},Ka,{data:0}),i_=Or(h6),d6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},f6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function p6(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=m6[a])?!!l[a]:!1}function jg(){return p6}var g6=p({},Qc,{key:function(a){if(a.key){var l=d6[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Hd(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?f6[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jg,charCode:function(a){return a.type==="keypress"?Hd(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Hd(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),y6=Or(g6),b6=p({},Yd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s_=Or(b6),x6=p({},Qc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jg}),v6=Or(x6),_6=p({},Ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),w6=Or(_6),S6=p({},Yd,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),A6=Or(S6),C6=p({},Ka,{newState:0,oldState:0}),k6=Or(C6),T6=[9,13,27,32],Bg=As&&"CompositionEvent"in window,eu=null;As&&"documentMode"in document&&(eu=document.documentMode);var E6=As&&"TextEvent"in window&&!eu,a_=As&&(!Bg||eu&&8<eu&&11>=eu),o_=" ",l_=!1;function c_(a,l){switch(a){case"keyup":return T6.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u_(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var hl=!1;function M6(a,l){switch(a){case"compositionend":return u_(l);case"keypress":return l.which!==32?null:(l_=!0,o_);case"textInput":return a=l.data,a===o_&&l_?null:a;default:return null}}function N6(a,l){if(hl)return a==="compositionend"||!Bg&&c_(a,l)?(a=t_(),Gd=Ig=Js=null,hl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return a_&&l.locale!=="ko"?null:l.data;default:return null}}var I6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function h_(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!I6[a.type]:l==="textarea"}function d_(a,l,h,m){cl?ul?ul.push(m):ul=[m]:cl=m,l=Bf(l,"onChange"),0<l.length&&(h=new Wd("onChange","change",null,h,m),a.push({event:h,listeners:l}))}var tu=null,nu=null;function R6(a){qS(a,0)}function $d(a){var l=Rt(a);if($v(l))return a}function f_(a,l){if(a==="change")return l}var m_=!1;if(As){var Og;if(As){var Lg="oninput"in document;if(!Lg){var p_=document.createElement("div");p_.setAttribute("oninput","return;"),Lg=typeof p_.oninput=="function"}Og=Lg}else Og=!1;m_=Og&&(!document.documentMode||9<document.documentMode)}function g_(){tu&&(tu.detachEvent("onpropertychange",y_),nu=tu=null)}function y_(a){if(a.propertyName==="value"&&$d(nu)){var l=[];d_(l,nu,a,Eg(a)),e_(R6,l)}}function P6(a,l,h){a==="focusin"?(g_(),tu=l,nu=h,tu.attachEvent("onpropertychange",y_)):a==="focusout"&&g_()}function D6(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return $d(nu)}function j6(a,l){if(a==="click")return $d(l)}function B6(a,l){if(a==="input"||a==="change")return $d(l)}function O6(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var ei=typeof Object.is=="function"?Object.is:O6;function ru(a,l){if(ei(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var h=Object.keys(a),m=Object.keys(l);if(h.length!==m.length)return!1;for(m=0;m<h.length;m++){var x=h[m];if(!Xn.call(l,x)||!ei(a[x],l[x]))return!1}return!0}function b_(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function x_(a,l){var h=b_(a);a=0;for(var m;h;){if(h.nodeType===3){if(m=a+h.textContent.length,a<=l&&m>=l)return{node:h,offset:l-a};a=m}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=b_(h)}}function v_(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?v_(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function __(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=Ud(a.document);l instanceof a.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)a=l.contentWindow;else break;l=Ud(a.document)}return l}function zg(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var L6=As&&"documentMode"in document&&11>=document.documentMode,dl=null,Ug=null,iu=null,Fg=!1;function w_(a,l,h){var m=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Fg||dl==null||dl!==Ud(m)||(m=dl,"selectionStart"in m&&zg(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),iu&&ru(iu,m)||(iu=m,m=Bf(Ug,"onSelect"),0<m.length&&(l=new Wd("onSelect","select",null,l,h),a.push({event:l,listeners:m}),l.target=dl)))}function Qa(a,l){var h={};return h[a.toLowerCase()]=l.toLowerCase(),h["Webkit"+a]="webkit"+l,h["Moz"+a]="moz"+l,h}var fl={animationend:Qa("Animation","AnimationEnd"),animationiteration:Qa("Animation","AnimationIteration"),animationstart:Qa("Animation","AnimationStart"),transitionrun:Qa("Transition","TransitionRun"),transitionstart:Qa("Transition","TransitionStart"),transitioncancel:Qa("Transition","TransitionCancel"),transitionend:Qa("Transition","TransitionEnd")},Gg={},S_={};As&&(S_=document.createElement("div").style,"AnimationEvent"in window||(delete fl.animationend.animation,delete fl.animationiteration.animation,delete fl.animationstart.animation),"TransitionEvent"in window||delete fl.transitionend.transition);function Ja(a){if(Gg[a])return Gg[a];if(!fl[a])return a;var l=fl[a],h;for(h in l)if(l.hasOwnProperty(h)&&h in S_)return Gg[a]=l[h];return a}var A_=Ja("animationend"),C_=Ja("animationiteration"),k_=Ja("animationstart"),z6=Ja("transitionrun"),U6=Ja("transitionstart"),F6=Ja("transitioncancel"),T_=Ja("transitionend"),E_=new Map,Hg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Hg.push("scrollEnd");function Fi(a,l){E_.set(a,l),Br(l,[a])}var qd=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},wi=[],ml=0,Vg=0;function Zd(){for(var a=ml,l=Vg=ml=0;l<a;){var h=wi[l];wi[l++]=null;var m=wi[l];wi[l++]=null;var x=wi[l];wi[l++]=null;var v=wi[l];if(wi[l++]=null,m!==null&&x!==null){var C=m.pending;C===null?x.next=x:(x.next=C.next,C.next=x),m.pending=x}v!==0&&M_(h,x,v)}}function Xd(a,l,h,m){wi[ml++]=a,wi[ml++]=l,wi[ml++]=h,wi[ml++]=m,Vg|=m,a.lanes|=m,a=a.alternate,a!==null&&(a.lanes|=m)}function Wg(a,l,h,m){return Xd(a,l,h,m),Kd(a)}function eo(a,l){return Xd(a,null,null,l),Kd(a)}function M_(a,l,h){a.lanes|=h;var m=a.alternate;m!==null&&(m.lanes|=h);for(var x=!1,v=a.return;v!==null;)v.childLanes|=h,m=v.alternate,m!==null&&(m.childLanes|=h),v.tag===22&&(a=v.stateNode,a===null||a._visibility&1||(x=!0)),a=v,v=v.return;return a.tag===3?(v=a.stateNode,x&&l!==null&&(x=31-vt(h),a=v.hiddenUpdates,m=a[x],m===null?a[x]=[l]:m.push(l),l.lane=h|536870912),v):null}function Kd(a){if(50<ku)throw ku=0,ey=null,Error(r(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var pl={};function G6(a,l,h,m){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(a,l,h,m){return new G6(a,l,h,m)}function Yg(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Cs(a,l){var h=a.alternate;return h===null?(h=ti(a.tag,l,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=l,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,l=a.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function N_(a,l){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,l=h.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function Qd(a,l,h,m,x,v){var C=0;if(m=a,typeof a=="function")Yg(a)&&(C=1);else if(typeof a=="string")C=$D(a,h,ee.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case R:return a=ti(31,h,l,x),a.elementType=R,a.lanes=v,a;case w:return to(h.children,x,v,l);case S:C=8,x|=24;break;case A:return a=ti(12,h,l,x|2),a.elementType=A,a.lanes=v,a;case U:return a=ti(13,h,l,x),a.elementType=U,a.lanes=v,a;case I:return a=ti(19,h,l,x),a.elementType=I,a.lanes=v,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case k:C=10;break e;case M:C=9;break e;case E:C=11;break e;case B:C=14;break e;case G:C=16,m=null;break e}C=29,h=Error(r(130,a===null?"null":typeof a,"")),m=null}return l=ti(C,h,l,x),l.elementType=a,l.type=m,l.lanes=v,l}function to(a,l,h,m){return a=ti(7,a,m,l),a.lanes=h,a}function $g(a,l,h){return a=ti(6,a,null,l),a.lanes=h,a}function I_(a){var l=ti(18,null,null,0);return l.stateNode=a,l}function qg(a,l,h){return l=ti(4,a.children!==null?a.children:[],a.key,l),l.lanes=h,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var R_=new WeakMap;function Si(a,l){if(typeof a=="object"&&a!==null){var h=R_.get(a);return h!==void 0?h:(l={value:a,source:l,stack:_t(l)},R_.set(a,l),l)}return{value:a,source:l,stack:_t(l)}}var gl=[],yl=0,Jd=null,su=0,Ai=[],Ci=0,ea=null,Ki=1,Qi="";function ks(a,l){gl[yl++]=su,gl[yl++]=Jd,Jd=a,su=l}function P_(a,l,h){Ai[Ci++]=Ki,Ai[Ci++]=Qi,Ai[Ci++]=ea,ea=a;var m=Ki;a=Qi;var x=32-vt(m)-1;m&=~(1<<x),h+=1;var v=32-vt(l)+x;if(30<v){var C=x-x%5;v=(m&(1<<C)-1).toString(32),m>>=C,x-=C,Ki=1<<32-vt(l)+x|h<<x|m,Qi=v+a}else Ki=1<<v|h<<x|m,Qi=a}function Zg(a){a.return!==null&&(ks(a,1),P_(a,1,0))}function Xg(a){for(;a===Jd;)Jd=gl[--yl],gl[yl]=null,su=gl[--yl],gl[yl]=null;for(;a===ea;)ea=Ai[--Ci],Ai[Ci]=null,Qi=Ai[--Ci],Ai[Ci]=null,Ki=Ai[--Ci],Ai[Ci]=null}function D_(a,l){Ai[Ci++]=Ki,Ai[Ci++]=Qi,Ai[Ci++]=ea,Ki=l.id,Qi=l.overflow,ea=a}var dr=null,ln=null,gt=!1,ta=null,ki=!1,Kg=Error(r(519));function na(a){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw au(Si(l,a)),Kg}function j_(a){var l=a.stateNode,h=a.type,m=a.memoizedProps;switch(l[Gn]=a,l[fn]=m,h){case"dialog":ot("cancel",l),ot("close",l);break;case"iframe":case"object":case"embed":ot("load",l);break;case"video":case"audio":for(h=0;h<Eu.length;h++)ot(Eu[h],l);break;case"source":ot("error",l);break;case"img":case"image":case"link":ot("error",l),ot("load",l);break;case"details":ot("toggle",l);break;case"input":ot("invalid",l),qv(l,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":ot("invalid",l);break;case"textarea":ot("invalid",l),Xv(l,m.value,m.defaultValue,m.children)}h=m.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||l.textContent===""+h||m.suppressHydrationWarning===!0||QS(l.textContent,h)?(m.popover!=null&&(ot("beforetoggle",l),ot("toggle",l)),m.onScroll!=null&&ot("scroll",l),m.onScrollEnd!=null&&ot("scrollend",l),m.onClick!=null&&(l.onclick=Ss),l=!0):l=!1,l||na(a,!0)}function B_(a){for(dr=a.return;dr;)switch(dr.tag){case 5:case 31:case 13:ki=!1;return;case 27:case 3:ki=!0;return;default:dr=dr.return}}function bl(a){if(a!==dr)return!1;if(!gt)return B_(a),gt=!0,!1;var l=a.tag,h;if((h=l!==3&&l!==27)&&((h=l===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||py(a.type,a.memoizedProps)),h=!h),h&&ln&&na(a),B_(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));ln=oA(a)}else if(l===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));ln=oA(a)}else l===27?(l=ln,ga(a.type)?(a=vy,vy=null,ln=a):ln=l):ln=dr?Ei(a.stateNode.nextSibling):null;return!0}function no(){ln=dr=null,gt=!1}function Qg(){var a=ta;return a!==null&&(Fr===null?Fr=a:Fr.push.apply(Fr,a),ta=null),a}function au(a){ta===null?ta=[a]:ta.push(a)}var Jg=F(null),ro=null,Ts=null;function ra(a,l,h){D(Jg,l._currentValue),l._currentValue=h}function Es(a){a._currentValue=Jg.current,X(Jg)}function e0(a,l,h){for(;a!==null;){var m=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),a===h)break;a=a.return}}function t0(a,l,h,m){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var v=x.dependencies;if(v!==null){var C=x.child;v=v.firstContext;e:for(;v!==null;){var z=v;v=x;for(var Z=0;Z<l.length;Z++)if(z.context===l[Z]){v.lanes|=h,z=v.alternate,z!==null&&(z.lanes|=h),e0(v.return,h,a),m||(C=null);break e}v=z.next}}else if(x.tag===18){if(C=x.return,C===null)throw Error(r(341));C.lanes|=h,v=C.alternate,v!==null&&(v.lanes|=h),e0(C,h,a),C=null}else C=x.child;if(C!==null)C.return=x;else for(C=x;C!==null;){if(C===a){C=null;break}if(x=C.sibling,x!==null){x.return=C.return,C=x;break}C=C.return}x=C}}function xl(a,l,h,m){a=null;for(var x=l,v=!1;x!==null;){if(!v){if((x.flags&524288)!==0)v=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var C=x.alternate;if(C===null)throw Error(r(387));if(C=C.memoizedProps,C!==null){var z=x.type;ei(x.pendingProps.value,C.value)||(a!==null?a.push(z):a=[z])}}else if(x===ie.current){if(C=x.alternate,C===null)throw Error(r(387));C.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(Pu):a=[Pu])}x=x.return}a!==null&&t0(l,a,h,m),l.flags|=262144}function ef(a){for(a=a.firstContext;a!==null;){if(!ei(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function io(a){ro=a,Ts=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function fr(a){return O_(ro,a)}function tf(a,l){return ro===null&&io(a),O_(a,l)}function O_(a,l){var h=l._currentValue;if(l={context:l,memoizedValue:h,next:null},Ts===null){if(a===null)throw Error(r(308));Ts=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else Ts=Ts.next=l;return h}var H6=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(h,m){a.push(m)}};this.abort=function(){l.aborted=!0,a.forEach(function(h){return h()})}},V6=n.unstable_scheduleCallback,W6=n.unstable_NormalPriority,Hn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function n0(){return{controller:new H6,data:new Map,refCount:0}}function ou(a){a.refCount--,a.refCount===0&&V6(W6,function(){a.controller.abort()})}var lu=null,r0=0,vl=0,_l=null;function Y6(a,l){if(lu===null){var h=lu=[];r0=0,vl=ay(),_l={status:"pending",value:void 0,then:function(m){h.push(m)}}}return r0++,l.then(L_,L_),l}function L_(){if(--r0===0&&lu!==null){_l!==null&&(_l.status="fulfilled");var a=lu;lu=null,vl=0,_l=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function $6(a,l){var h=[],m={status:"pending",value:null,reason:null,then:function(x){h.push(x)}};return a.then(function(){m.status="fulfilled",m.value=l;for(var x=0;x<h.length;x++)(0,h[x])(l)},function(x){for(m.status="rejected",m.reason=x,x=0;x<h.length;x++)(0,h[x])(void 0)}),m}var z_=N.S;N.S=function(a,l){wS=$e(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&Y6(a,l),z_!==null&&z_(a,l)};var so=F(null);function i0(){var a=so.current;return a!==null?a:qt.pooledCache}function nf(a,l){l===null?D(so,so.current):D(so,l.pool)}function U_(){var a=i0();return a===null?null:{parent:Hn._currentValue,pool:a}}var wl=Error(r(460)),s0=Error(r(474)),rf=Error(r(542)),sf={then:function(){}};function F_(a){return a=a.status,a==="fulfilled"||a==="rejected"}function G_(a,l,h){switch(h=a[h],h===void 0?a.push(l):h!==l&&(l.then(Ss,Ss),l=h),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,V_(a),a;default:if(typeof l.status=="string")l.then(Ss,Ss);else{if(a=qt,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=l,a.status="pending",a.then(function(m){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=m}},function(m){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=m}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,V_(a),a}throw oo=l,wl}}function ao(a){try{var l=a._init;return l(a._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(oo=h,wl):h}}var oo=null;function H_(){if(oo===null)throw Error(r(459));var a=oo;return oo=null,a}function V_(a){if(a===wl||a===rf)throw Error(r(483))}var Sl=null,cu=0;function af(a){var l=cu;return cu+=1,Sl===null&&(Sl=[]),G_(Sl,a,l)}function uu(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function of(a,l){throw l.$$typeof===y?Error(r(525)):(a=Object.prototype.toString.call(l),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function W_(a){function l(ne,Q){if(a){var oe=ne.deletions;oe===null?(ne.deletions=[Q],ne.flags|=16):oe.push(Q)}}function h(ne,Q){if(!a)return null;for(;Q!==null;)l(ne,Q),Q=Q.sibling;return null}function m(ne){for(var Q=new Map;ne!==null;)ne.key!==null?Q.set(ne.key,ne):Q.set(ne.index,ne),ne=ne.sibling;return Q}function x(ne,Q){return ne=Cs(ne,Q),ne.index=0,ne.sibling=null,ne}function v(ne,Q,oe){return ne.index=oe,a?(oe=ne.alternate,oe!==null?(oe=oe.index,oe<Q?(ne.flags|=67108866,Q):oe):(ne.flags|=67108866,Q)):(ne.flags|=1048576,Q)}function C(ne){return a&&ne.alternate===null&&(ne.flags|=67108866),ne}function z(ne,Q,oe,be){return Q===null||Q.tag!==6?(Q=$g(oe,ne.mode,be),Q.return=ne,Q):(Q=x(Q,oe),Q.return=ne,Q)}function Z(ne,Q,oe,be){var ze=oe.type;return ze===w?fe(ne,Q,oe.props.children,be,oe.key):Q!==null&&(Q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===G&&ao(ze)===Q.type)?(Q=x(Q,oe.props),uu(Q,oe),Q.return=ne,Q):(Q=Qd(oe.type,oe.key,oe.props,null,ne.mode,be),uu(Q,oe),Q.return=ne,Q)}function le(ne,Q,oe,be){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==oe.containerInfo||Q.stateNode.implementation!==oe.implementation?(Q=qg(oe,ne.mode,be),Q.return=ne,Q):(Q=x(Q,oe.children||[]),Q.return=ne,Q)}function fe(ne,Q,oe,be,ze){return Q===null||Q.tag!==7?(Q=to(oe,ne.mode,be,ze),Q.return=ne,Q):(Q=x(Q,oe),Q.return=ne,Q)}function xe(ne,Q,oe){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=$g(""+Q,ne.mode,oe),Q.return=ne,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case b:return oe=Qd(Q.type,Q.key,Q.props,null,ne.mode,oe),uu(oe,Q),oe.return=ne,oe;case _:return Q=qg(Q,ne.mode,oe),Q.return=ne,Q;case G:return Q=ao(Q),xe(ne,Q,oe)}if(W(Q)||Y(Q))return Q=to(Q,ne.mode,oe,null),Q.return=ne,Q;if(typeof Q.then=="function")return xe(ne,af(Q),oe);if(Q.$$typeof===k)return xe(ne,tf(ne,Q),oe);of(ne,Q)}return null}function ce(ne,Q,oe,be){var ze=Q!==null?Q.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return ze!==null?null:z(ne,Q,""+oe,be);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case b:return oe.key===ze?Z(ne,Q,oe,be):null;case _:return oe.key===ze?le(ne,Q,oe,be):null;case G:return oe=ao(oe),ce(ne,Q,oe,be)}if(W(oe)||Y(oe))return ze!==null?null:fe(ne,Q,oe,be,null);if(typeof oe.then=="function")return ce(ne,Q,af(oe),be);if(oe.$$typeof===k)return ce(ne,Q,tf(ne,oe),be);of(ne,oe)}return null}function he(ne,Q,oe,be,ze){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return ne=ne.get(oe)||null,z(Q,ne,""+be,ze);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case b:return ne=ne.get(be.key===null?oe:be.key)||null,Z(Q,ne,be,ze);case _:return ne=ne.get(be.key===null?oe:be.key)||null,le(Q,ne,be,ze);case G:return be=ao(be),he(ne,Q,oe,be,ze)}if(W(be)||Y(be))return ne=ne.get(oe)||null,fe(Q,ne,be,ze,null);if(typeof be.then=="function")return he(ne,Q,oe,af(be),ze);if(be.$$typeof===k)return he(ne,Q,oe,tf(Q,be),ze);of(Q,be)}return null}function Ie(ne,Q,oe,be){for(var ze=null,At=null,De=Q,Ke=Q=0,ht=null;De!==null&&Ke<oe.length;Ke++){De.index>Ke?(ht=De,De=null):ht=De.sibling;var Ct=ce(ne,De,oe[Ke],be);if(Ct===null){De===null&&(De=ht);break}a&&De&&Ct.alternate===null&&l(ne,De),Q=v(Ct,Q,Ke),At===null?ze=Ct:At.sibling=Ct,At=Ct,De=ht}if(Ke===oe.length)return h(ne,De),gt&&ks(ne,Ke),ze;if(De===null){for(;Ke<oe.length;Ke++)De=xe(ne,oe[Ke],be),De!==null&&(Q=v(De,Q,Ke),At===null?ze=De:At.sibling=De,At=De);return gt&&ks(ne,Ke),ze}for(De=m(De);Ke<oe.length;Ke++)ht=he(De,ne,Ke,oe[Ke],be),ht!==null&&(a&&ht.alternate!==null&&De.delete(ht.key===null?Ke:ht.key),Q=v(ht,Q,Ke),At===null?ze=ht:At.sibling=ht,At=ht);return a&&De.forEach(function(_a){return l(ne,_a)}),gt&&ks(ne,Ke),ze}function Fe(ne,Q,oe,be){if(oe==null)throw Error(r(151));for(var ze=null,At=null,De=Q,Ke=Q=0,ht=null,Ct=oe.next();De!==null&&!Ct.done;Ke++,Ct=oe.next()){De.index>Ke?(ht=De,De=null):ht=De.sibling;var _a=ce(ne,De,Ct.value,be);if(_a===null){De===null&&(De=ht);break}a&&De&&_a.alternate===null&&l(ne,De),Q=v(_a,Q,Ke),At===null?ze=_a:At.sibling=_a,At=_a,De=ht}if(Ct.done)return h(ne,De),gt&&ks(ne,Ke),ze;if(De===null){for(;!Ct.done;Ke++,Ct=oe.next())Ct=xe(ne,Ct.value,be),Ct!==null&&(Q=v(Ct,Q,Ke),At===null?ze=Ct:At.sibling=Ct,At=Ct);return gt&&ks(ne,Ke),ze}for(De=m(De);!Ct.done;Ke++,Ct=oe.next())Ct=he(De,ne,Ke,Ct.value,be),Ct!==null&&(a&&Ct.alternate!==null&&De.delete(Ct.key===null?Ke:Ct.key),Q=v(Ct,Q,Ke),At===null?ze=Ct:At.sibling=Ct,At=Ct);return a&&De.forEach(function(ij){return l(ne,ij)}),gt&&ks(ne,Ke),ze}function Gt(ne,Q,oe,be){if(typeof oe=="object"&&oe!==null&&oe.type===w&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case b:e:{for(var ze=oe.key;Q!==null;){if(Q.key===ze){if(ze=oe.type,ze===w){if(Q.tag===7){h(ne,Q.sibling),be=x(Q,oe.props.children),be.return=ne,ne=be;break e}}else if(Q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===G&&ao(ze)===Q.type){h(ne,Q.sibling),be=x(Q,oe.props),uu(be,oe),be.return=ne,ne=be;break e}h(ne,Q);break}else l(ne,Q);Q=Q.sibling}oe.type===w?(be=to(oe.props.children,ne.mode,be,oe.key),be.return=ne,ne=be):(be=Qd(oe.type,oe.key,oe.props,null,ne.mode,be),uu(be,oe),be.return=ne,ne=be)}return C(ne);case _:e:{for(ze=oe.key;Q!==null;){if(Q.key===ze)if(Q.tag===4&&Q.stateNode.containerInfo===oe.containerInfo&&Q.stateNode.implementation===oe.implementation){h(ne,Q.sibling),be=x(Q,oe.children||[]),be.return=ne,ne=be;break e}else{h(ne,Q);break}else l(ne,Q);Q=Q.sibling}be=qg(oe,ne.mode,be),be.return=ne,ne=be}return C(ne);case G:return oe=ao(oe),Gt(ne,Q,oe,be)}if(W(oe))return Ie(ne,Q,oe,be);if(Y(oe)){if(ze=Y(oe),typeof ze!="function")throw Error(r(150));return oe=ze.call(oe),Fe(ne,Q,oe,be)}if(typeof oe.then=="function")return Gt(ne,Q,af(oe),be);if(oe.$$typeof===k)return Gt(ne,Q,tf(ne,oe),be);of(ne,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,Q!==null&&Q.tag===6?(h(ne,Q.sibling),be=x(Q,oe),be.return=ne,ne=be):(h(ne,Q),be=$g(oe,ne.mode,be),be.return=ne,ne=be),C(ne)):h(ne,Q)}return function(ne,Q,oe,be){try{cu=0;var ze=Gt(ne,Q,oe,be);return Sl=null,ze}catch(De){if(De===wl||De===rf)throw De;var At=ti(29,De,null,ne.mode);return At.lanes=be,At.return=ne,At}finally{}}}var lo=W_(!0),Y_=W_(!1),ia=!1;function a0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function o0(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function sa(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function aa(a,l,h){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Tt&2)!==0){var x=m.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),m.pending=l,l=Kd(a),M_(a,null,h),l}return Xd(a,m,l,h),Kd(a)}function hu(a,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194048)!==0)){var m=l.lanes;m&=a.pendingLanes,h|=m,l.lanes=h,Wc(a,h)}}function l0(a,l){var h=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,h===m)){var x=null,v=null;if(h=h.firstBaseUpdate,h!==null){do{var C={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};v===null?x=v=C:v=v.next=C,h=h.next}while(h!==null);v===null?x=v=l:v=v.next=l}else x=v=l;h={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:v,shared:m.shared,callbacks:m.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=l:a.next=l,h.lastBaseUpdate=l}var c0=!1;function du(){if(c0){var a=_l;if(a!==null)throw a}}function fu(a,l,h,m){c0=!1;var x=a.updateQueue;ia=!1;var v=x.firstBaseUpdate,C=x.lastBaseUpdate,z=x.shared.pending;if(z!==null){x.shared.pending=null;var Z=z,le=Z.next;Z.next=null,C===null?v=le:C.next=le,C=Z;var fe=a.alternate;fe!==null&&(fe=fe.updateQueue,z=fe.lastBaseUpdate,z!==C&&(z===null?fe.firstBaseUpdate=le:z.next=le,fe.lastBaseUpdate=Z))}if(v!==null){var xe=x.baseState;C=0,fe=le=Z=null,z=v;do{var ce=z.lane&-536870913,he=ce!==z.lane;if(he?(ut&ce)===ce:(m&ce)===ce){ce!==0&&ce===vl&&(c0=!0),fe!==null&&(fe=fe.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var Ie=a,Fe=z;ce=l;var Gt=h;switch(Fe.tag){case 1:if(Ie=Fe.payload,typeof Ie=="function"){xe=Ie.call(Gt,xe,ce);break e}xe=Ie;break e;case 3:Ie.flags=Ie.flags&-65537|128;case 0:if(Ie=Fe.payload,ce=typeof Ie=="function"?Ie.call(Gt,xe,ce):Ie,ce==null)break e;xe=p({},xe,ce);break e;case 2:ia=!0}}ce=z.callback,ce!==null&&(a.flags|=64,he&&(a.flags|=8192),he=x.callbacks,he===null?x.callbacks=[ce]:he.push(ce))}else he={lane:ce,tag:z.tag,payload:z.payload,callback:z.callback,next:null},fe===null?(le=fe=he,Z=xe):fe=fe.next=he,C|=ce;if(z=z.next,z===null){if(z=x.shared.pending,z===null)break;he=z,z=he.next,he.next=null,x.lastBaseUpdate=he,x.shared.pending=null}}while(!0);fe===null&&(Z=xe),x.baseState=Z,x.firstBaseUpdate=le,x.lastBaseUpdate=fe,v===null&&(x.shared.lanes=0),ha|=C,a.lanes=C,a.memoizedState=xe}}function $_(a,l){if(typeof a!="function")throw Error(r(191,a));a.call(l)}function q_(a,l){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)$_(h[a],l)}var Al=F(null),lf=F(0);function Z_(a,l){a=Os,D(lf,a),D(Al,l),Os=a|l.baseLanes}function u0(){D(lf,Os),D(Al,Al.current)}function h0(){Os=lf.current,X(Al),X(lf)}var ni=F(null),Ti=null;function oa(a){var l=a.alternate;D(Dn,Dn.current&1),D(ni,a),Ti===null&&(l===null||Al.current!==null||l.memoizedState!==null)&&(Ti=a)}function d0(a){D(Dn,Dn.current),D(ni,a),Ti===null&&(Ti=a)}function X_(a){a.tag===22?(D(Dn,Dn.current),D(ni,a),Ti===null&&(Ti=a)):la()}function la(){D(Dn,Dn.current),D(ni,ni.current)}function ri(a){X(ni),Ti===a&&(Ti=null),X(Dn)}var Dn=F(0);function cf(a){for(var l=a;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||by(h)||xy(h)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Ms=0,Xe=null,Ut=null,Vn=null,uf=!1,Cl=!1,co=!1,hf=0,mu=0,kl=null,q6=0;function Tn(){throw Error(r(321))}function f0(a,l){if(l===null)return!1;for(var h=0;h<l.length&&h<a.length;h++)if(!ei(a[h],l[h]))return!1;return!0}function m0(a,l,h,m,x,v){return Ms=v,Xe=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,N.H=a===null||a.memoizedState===null?Pw:M0,co=!1,v=h(m,x),co=!1,Cl&&(v=Q_(l,h,m,x)),K_(a),v}function K_(a){N.H=yu;var l=Ut!==null&&Ut.next!==null;if(Ms=0,Vn=Ut=Xe=null,uf=!1,mu=0,kl=null,l)throw Error(r(300));a===null||Wn||(a=a.dependencies,a!==null&&ef(a)&&(Wn=!0))}function Q_(a,l,h,m){Xe=a;var x=0;do{if(Cl&&(kl=null),mu=0,Cl=!1,25<=x)throw Error(r(301));if(x+=1,Vn=Ut=null,a.updateQueue!=null){var v=a.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}N.H=Dw,v=l(h,m)}while(Cl);return v}function Z6(){var a=N.H,l=a.useState()[0];return l=typeof l.then=="function"?pu(l):l,a=a.useState()[0],(Ut!==null?Ut.memoizedState:null)!==a&&(Xe.flags|=1024),l}function p0(){var a=hf!==0;return hf=0,a}function g0(a,l,h){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~h}function y0(a){if(uf){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}uf=!1}Ms=0,Vn=Ut=Xe=null,Cl=!1,mu=hf=0,kl=null}function Tr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?Xe.memoizedState=Vn=a:Vn=Vn.next=a,Vn}function jn(){if(Ut===null){var a=Xe.alternate;a=a!==null?a.memoizedState:null}else a=Ut.next;var l=Vn===null?Xe.memoizedState:Vn.next;if(l!==null)Vn=l,Ut=a;else{if(a===null)throw Xe.alternate===null?Error(r(467)):Error(r(310));Ut=a,a={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},Vn===null?Xe.memoizedState=Vn=a:Vn=Vn.next=a}return Vn}function df(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pu(a){var l=mu;return mu+=1,kl===null&&(kl=[]),a=G_(kl,a,l),l=Xe,(Vn===null?l.memoizedState:Vn.next)===null&&(l=l.alternate,N.H=l===null||l.memoizedState===null?Pw:M0),a}function ff(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return pu(a);if(a.$$typeof===k)return fr(a)}throw Error(r(438,String(a)))}function b0(a){var l=null,h=Xe.updateQueue;if(h!==null&&(l=h.memoCache),l==null){var m=Xe.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(l={data:m.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),h===null&&(h=df(),Xe.updateQueue=h),h.memoCache=l,h=l.data[l.index],h===void 0)for(h=l.data[l.index]=Array(a),m=0;m<a;m++)h[m]=P;return l.index++,h}function Ns(a,l){return typeof l=="function"?l(a):l}function mf(a){var l=jn();return x0(l,Ut,a)}function x0(a,l,h){var m=a.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=h;var x=a.baseQueue,v=m.pending;if(v!==null){if(x!==null){var C=x.next;x.next=v.next,v.next=C}l.baseQueue=x=v,m.pending=null}if(v=a.baseState,x===null)a.memoizedState=v;else{l=x.next;var z=C=null,Z=null,le=l,fe=!1;do{var xe=le.lane&-536870913;if(xe!==le.lane?(ut&xe)===xe:(Ms&xe)===xe){var ce=le.revertLane;if(ce===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),xe===vl&&(fe=!0);else if((Ms&ce)===ce){le=le.next,ce===vl&&(fe=!0);continue}else xe={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},Z===null?(z=Z=xe,C=v):Z=Z.next=xe,Xe.lanes|=ce,ha|=ce;xe=le.action,co&&h(v,xe),v=le.hasEagerState?le.eagerState:h(v,xe)}else ce={lane:xe,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},Z===null?(z=Z=ce,C=v):Z=Z.next=ce,Xe.lanes|=xe,ha|=xe;le=le.next}while(le!==null&&le!==l);if(Z===null?C=v:Z.next=z,!ei(v,a.memoizedState)&&(Wn=!0,fe&&(h=_l,h!==null)))throw h;a.memoizedState=v,a.baseState=C,a.baseQueue=Z,m.lastRenderedState=v}return x===null&&(m.lanes=0),[a.memoizedState,m.dispatch]}function v0(a){var l=jn(),h=l.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=a;var m=h.dispatch,x=h.pending,v=l.memoizedState;if(x!==null){h.pending=null;var C=x=x.next;do v=a(v,C.action),C=C.next;while(C!==x);ei(v,l.memoizedState)||(Wn=!0),l.memoizedState=v,l.baseQueue===null&&(l.baseState=v),h.lastRenderedState=v}return[v,m]}function J_(a,l,h){var m=Xe,x=jn(),v=gt;if(v){if(h===void 0)throw Error(r(407));h=h()}else h=l();var C=!ei((Ut||x).memoizedState,h);if(C&&(x.memoizedState=h,Wn=!0),x=x.queue,S0(nw.bind(null,m,x,a),[a]),x.getSnapshot!==l||C||Vn!==null&&Vn.memoizedState.tag&1){if(m.flags|=2048,Tl(9,{destroy:void 0},tw.bind(null,m,x,h,l),null),qt===null)throw Error(r(349));v||(Ms&127)!==0||ew(m,l,h)}return h}function ew(a,l,h){a.flags|=16384,a={getSnapshot:l,value:h},l=Xe.updateQueue,l===null?(l=df(),Xe.updateQueue=l,l.stores=[a]):(h=l.stores,h===null?l.stores=[a]:h.push(a))}function tw(a,l,h,m){l.value=h,l.getSnapshot=m,rw(l)&&iw(a)}function nw(a,l,h){return h(function(){rw(l)&&iw(a)})}function rw(a){var l=a.getSnapshot;a=a.value;try{var h=l();return!ei(a,h)}catch{return!0}}function iw(a){var l=eo(a,2);l!==null&&Gr(l,a,2)}function _0(a){var l=Tr();if(typeof a=="function"){var h=a;if(a=h(),co){dn(!0);try{h()}finally{dn(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ns,lastRenderedState:a},l}function sw(a,l,h,m){return a.baseState=h,x0(a,Ut,typeof m=="function"?m:Ns)}function X6(a,l,h,m,x){if(yf(a))throw Error(r(485));if(a=l.action,a!==null){var v={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){v.listeners.push(C)}};N.T!==null?h(!0):v.isTransition=!1,m(v),h=l.pending,h===null?(v.next=l.pending=v,aw(l,v)):(v.next=h.next,l.pending=h.next=v)}}function aw(a,l){var h=l.action,m=l.payload,x=a.state;if(l.isTransition){var v=N.T,C={};N.T=C;try{var z=h(x,m),Z=N.S;Z!==null&&Z(C,z),ow(a,l,z)}catch(le){w0(a,l,le)}finally{v!==null&&C.types!==null&&(v.types=C.types),N.T=v}}else try{v=h(x,m),ow(a,l,v)}catch(le){w0(a,l,le)}}function ow(a,l,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(m){lw(a,l,m)},function(m){return w0(a,l,m)}):lw(a,l,h)}function lw(a,l,h){l.status="fulfilled",l.value=h,cw(l),a.state=h,l=a.pending,l!==null&&(h=l.next,h===l?a.pending=null:(h=h.next,l.next=h,aw(a,h)))}function w0(a,l,h){var m=a.pending;if(a.pending=null,m!==null){m=m.next;do l.status="rejected",l.reason=h,cw(l),l=l.next;while(l!==m)}a.action=null}function cw(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function uw(a,l){return l}function hw(a,l){if(gt){var h=qt.formState;if(h!==null){e:{var m=Xe;if(gt){if(ln){t:{for(var x=ln,v=ki;x.nodeType!==8;){if(!v){x=null;break t}if(x=Ei(x.nextSibling),x===null){x=null;break t}}v=x.data,x=v==="F!"||v==="F"?x:null}if(x){ln=Ei(x.nextSibling),m=x.data==="F!";break e}}na(m)}m=!1}m&&(l=h[0])}}return h=Tr(),h.memoizedState=h.baseState=l,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uw,lastRenderedState:l},h.queue=m,h=Nw.bind(null,Xe,m),m.dispatch=h,m=_0(!1),v=E0.bind(null,Xe,!1,m.queue),m=Tr(),x={state:l,dispatch:null,action:a,pending:null},m.queue=x,h=X6.bind(null,Xe,x,v,h),x.dispatch=h,m.memoizedState=a,[l,h,!1]}function dw(a){var l=jn();return fw(l,Ut,a)}function fw(a,l,h){if(l=x0(a,l,uw)[0],a=mf(Ns)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var m=pu(l)}catch(C){throw C===wl?rf:C}else m=l;l=jn();var x=l.queue,v=x.dispatch;return h!==l.memoizedState&&(Xe.flags|=2048,Tl(9,{destroy:void 0},K6.bind(null,x,h),null)),[m,v,a]}function K6(a,l){a.action=l}function mw(a){var l=jn(),h=Ut;if(h!==null)return fw(l,h,a);jn(),l=l.memoizedState,h=jn();var m=h.queue.dispatch;return h.memoizedState=a,[l,m,!1]}function Tl(a,l,h,m){return a={tag:a,create:h,deps:m,inst:l,next:null},l=Xe.updateQueue,l===null&&(l=df(),Xe.updateQueue=l),h=l.lastEffect,h===null?l.lastEffect=a.next=a:(m=h.next,h.next=a,a.next=m,l.lastEffect=a),a}function pw(){return jn().memoizedState}function pf(a,l,h,m){var x=Tr();Xe.flags|=a,x.memoizedState=Tl(1|l,{destroy:void 0},h,m===void 0?null:m)}function gf(a,l,h,m){var x=jn();m=m===void 0?null:m;var v=x.memoizedState.inst;Ut!==null&&m!==null&&f0(m,Ut.memoizedState.deps)?x.memoizedState=Tl(l,v,h,m):(Xe.flags|=a,x.memoizedState=Tl(1|l,v,h,m))}function gw(a,l){pf(8390656,8,a,l)}function S0(a,l){gf(2048,8,a,l)}function Q6(a){Xe.flags|=4;var l=Xe.updateQueue;if(l===null)l=df(),Xe.updateQueue=l,l.events=[a];else{var h=l.events;h===null?l.events=[a]:h.push(a)}}function yw(a){var l=jn().memoizedState;return Q6({ref:l,nextImpl:a}),function(){if((Tt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function bw(a,l){return gf(4,2,a,l)}function xw(a,l){return gf(4,4,a,l)}function vw(a,l){if(typeof l=="function"){a=a();var h=l(a);return function(){typeof h=="function"?h():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function _w(a,l,h){h=h!=null?h.concat([a]):null,gf(4,4,vw.bind(null,l,a),h)}function A0(){}function ww(a,l){var h=jn();l=l===void 0?null:l;var m=h.memoizedState;return l!==null&&f0(l,m[1])?m[0]:(h.memoizedState=[a,l],a)}function Sw(a,l){var h=jn();l=l===void 0?null:l;var m=h.memoizedState;if(l!==null&&f0(l,m[1]))return m[0];if(m=a(),co){dn(!0);try{a()}finally{dn(!1)}}return h.memoizedState=[m,l],m}function C0(a,l,h){return h===void 0||(Ms&1073741824)!==0&&(ut&261930)===0?a.memoizedState=l:(a.memoizedState=h,a=AS(),Xe.lanes|=a,ha|=a,h)}function Aw(a,l,h,m){return ei(h,l)?h:Al.current!==null?(a=C0(a,h,m),ei(a,l)||(Wn=!0),a):(Ms&42)===0||(Ms&1073741824)!==0&&(ut&261930)===0?(Wn=!0,a.memoizedState=h):(a=AS(),Xe.lanes|=a,ha|=a,l)}function Cw(a,l,h,m,x){var v=V.p;V.p=v!==0&&8>v?v:8;var C=N.T,z={};N.T=z,E0(a,!1,l,h);try{var Z=x(),le=N.S;if(le!==null&&le(z,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var fe=$6(Z,m);gu(a,l,fe,ai(a))}else gu(a,l,m,ai(a))}catch(xe){gu(a,l,{then:function(){},status:"rejected",reason:xe},ai())}finally{V.p=v,C!==null&&z.types!==null&&(C.types=z.types),N.T=C}}function J6(){}function k0(a,l,h,m){if(a.tag!==5)throw Error(r(476));var x=kw(a).queue;Cw(a,x,l,J,h===null?J6:function(){return Tw(a),h(m)})}function kw(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ns,lastRenderedState:J},next:null};var h={};return l.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ns,lastRenderedState:h},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function Tw(a){var l=kw(a);l.next===null&&(l=a.alternate.memoizedState),gu(a,l.next.queue,{},ai())}function T0(){return fr(Pu)}function Ew(){return jn().memoizedState}function Mw(){return jn().memoizedState}function eD(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var h=ai();a=sa(h);var m=aa(l,a,h);m!==null&&(Gr(m,l,h),hu(m,l,h)),l={cache:n0()},a.payload=l;return}l=l.return}}function tD(a,l,h){var m=ai();h={lane:m,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},yf(a)?Iw(l,h):(h=Wg(a,l,h,m),h!==null&&(Gr(h,a,m),Rw(h,l,m)))}function Nw(a,l,h){var m=ai();gu(a,l,h,m)}function gu(a,l,h,m){var x={lane:m,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(yf(a))Iw(l,x);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=l.lastRenderedReducer,v!==null))try{var C=l.lastRenderedState,z=v(C,h);if(x.hasEagerState=!0,x.eagerState=z,ei(z,C))return Xd(a,l,x,0),qt===null&&Zd(),!1}catch{}finally{}if(h=Wg(a,l,x,m),h!==null)return Gr(h,a,m),Rw(h,l,m),!0}return!1}function E0(a,l,h,m){if(m={lane:2,revertLane:ay(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},yf(a)){if(l)throw Error(r(479))}else l=Wg(a,h,m,2),l!==null&&Gr(l,a,2)}function yf(a){var l=a.alternate;return a===Xe||l!==null&&l===Xe}function Iw(a,l){Cl=uf=!0;var h=a.pending;h===null?l.next=l:(l.next=h.next,h.next=l),a.pending=l}function Rw(a,l,h){if((h&4194048)!==0){var m=l.lanes;m&=a.pendingLanes,h|=m,l.lanes=h,Wc(a,h)}}var yu={readContext:fr,use:ff,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useLayoutEffect:Tn,useInsertionEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useSyncExternalStore:Tn,useId:Tn,useHostTransitionStatus:Tn,useFormState:Tn,useActionState:Tn,useOptimistic:Tn,useMemoCache:Tn,useCacheRefresh:Tn};yu.useEffectEvent=Tn;var Pw={readContext:fr,use:ff,useCallback:function(a,l){return Tr().memoizedState=[a,l===void 0?null:l],a},useContext:fr,useEffect:gw,useImperativeHandle:function(a,l,h){h=h!=null?h.concat([a]):null,pf(4194308,4,vw.bind(null,l,a),h)},useLayoutEffect:function(a,l){return pf(4194308,4,a,l)},useInsertionEffect:function(a,l){pf(4,2,a,l)},useMemo:function(a,l){var h=Tr();l=l===void 0?null:l;var m=a();if(co){dn(!0);try{a()}finally{dn(!1)}}return h.memoizedState=[m,l],m},useReducer:function(a,l,h){var m=Tr();if(h!==void 0){var x=h(l);if(co){dn(!0);try{h(l)}finally{dn(!1)}}}else x=l;return m.memoizedState=m.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},m.queue=a,a=a.dispatch=tD.bind(null,Xe,a),[m.memoizedState,a]},useRef:function(a){var l=Tr();return a={current:a},l.memoizedState=a},useState:function(a){a=_0(a);var l=a.queue,h=Nw.bind(null,Xe,l);return l.dispatch=h,[a.memoizedState,h]},useDebugValue:A0,useDeferredValue:function(a,l){var h=Tr();return C0(h,a,l)},useTransition:function(){var a=_0(!1);return a=Cw.bind(null,Xe,a.queue,!0,!1),Tr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,h){var m=Xe,x=Tr();if(gt){if(h===void 0)throw Error(r(407));h=h()}else{if(h=l(),qt===null)throw Error(r(349));(ut&127)!==0||ew(m,l,h)}x.memoizedState=h;var v={value:h,getSnapshot:l};return x.queue=v,gw(nw.bind(null,m,v,a),[a]),m.flags|=2048,Tl(9,{destroy:void 0},tw.bind(null,m,v,h,l),null),h},useId:function(){var a=Tr(),l=qt.identifierPrefix;if(gt){var h=Qi,m=Ki;h=(m&~(1<<32-vt(m)-1)).toString(32)+h,l="_"+l+"R_"+h,h=hf++,0<h&&(l+="H"+h.toString(32)),l+="_"}else h=q6++,l="_"+l+"r_"+h.toString(32)+"_";return a.memoizedState=l},useHostTransitionStatus:T0,useFormState:hw,useActionState:hw,useOptimistic:function(a){var l=Tr();l.memoizedState=l.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=h,l=E0.bind(null,Xe,!0,h),h.dispatch=l,[a,l]},useMemoCache:b0,useCacheRefresh:function(){return Tr().memoizedState=eD.bind(null,Xe)},useEffectEvent:function(a){var l=Tr(),h={impl:a};return l.memoizedState=h,function(){if((Tt&2)!==0)throw Error(r(440));return h.impl.apply(void 0,arguments)}}},M0={readContext:fr,use:ff,useCallback:ww,useContext:fr,useEffect:S0,useImperativeHandle:_w,useInsertionEffect:bw,useLayoutEffect:xw,useMemo:Sw,useReducer:mf,useRef:pw,useState:function(){return mf(Ns)},useDebugValue:A0,useDeferredValue:function(a,l){var h=jn();return Aw(h,Ut.memoizedState,a,l)},useTransition:function(){var a=mf(Ns)[0],l=jn().memoizedState;return[typeof a=="boolean"?a:pu(a),l]},useSyncExternalStore:J_,useId:Ew,useHostTransitionStatus:T0,useFormState:dw,useActionState:dw,useOptimistic:function(a,l){var h=jn();return sw(h,Ut,a,l)},useMemoCache:b0,useCacheRefresh:Mw};M0.useEffectEvent=yw;var Dw={readContext:fr,use:ff,useCallback:ww,useContext:fr,useEffect:S0,useImperativeHandle:_w,useInsertionEffect:bw,useLayoutEffect:xw,useMemo:Sw,useReducer:v0,useRef:pw,useState:function(){return v0(Ns)},useDebugValue:A0,useDeferredValue:function(a,l){var h=jn();return Ut===null?C0(h,a,l):Aw(h,Ut.memoizedState,a,l)},useTransition:function(){var a=v0(Ns)[0],l=jn().memoizedState;return[typeof a=="boolean"?a:pu(a),l]},useSyncExternalStore:J_,useId:Ew,useHostTransitionStatus:T0,useFormState:mw,useActionState:mw,useOptimistic:function(a,l){var h=jn();return Ut!==null?sw(h,Ut,a,l):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:b0,useCacheRefresh:Mw};Dw.useEffectEvent=yw;function N0(a,l,h,m){l=a.memoizedState,h=h(m,l),h=h==null?l:p({},l,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var I0={enqueueSetState:function(a,l,h){a=a._reactInternals;var m=ai(),x=sa(m);x.payload=l,h!=null&&(x.callback=h),l=aa(a,x,m),l!==null&&(Gr(l,a,m),hu(l,a,m))},enqueueReplaceState:function(a,l,h){a=a._reactInternals;var m=ai(),x=sa(m);x.tag=1,x.payload=l,h!=null&&(x.callback=h),l=aa(a,x,m),l!==null&&(Gr(l,a,m),hu(l,a,m))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var h=ai(),m=sa(h);m.tag=2,l!=null&&(m.callback=l),l=aa(a,m,h),l!==null&&(Gr(l,a,h),hu(l,a,h))}};function jw(a,l,h,m,x,v,C){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,v,C):l.prototype&&l.prototype.isPureReactComponent?!ru(h,m)||!ru(x,v):!0}function Bw(a,l,h,m){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,m),l.state!==a&&I0.enqueueReplaceState(l,l.state,null)}function uo(a,l){var h=l;if("ref"in l){h={};for(var m in l)m!=="ref"&&(h[m]=l[m])}if(a=a.defaultProps){h===l&&(h=p({},h));for(var x in a)h[x]===void 0&&(h[x]=a[x])}return h}function Ow(a){qd(a)}function Lw(a){console.error(a)}function zw(a){qd(a)}function bf(a,l){try{var h=a.onUncaughtError;h(l.value,{componentStack:l.stack})}catch(m){setTimeout(function(){throw m})}}function Uw(a,l,h){try{var m=a.onCaughtError;m(h.value,{componentStack:h.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function R0(a,l,h){return h=sa(h),h.tag=3,h.payload={element:null},h.callback=function(){bf(a,l)},h}function Fw(a){return a=sa(a),a.tag=3,a}function Gw(a,l,h,m){var x=h.type.getDerivedStateFromError;if(typeof x=="function"){var v=m.value;a.payload=function(){return x(v)},a.callback=function(){Uw(l,h,m)}}var C=h.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(a.callback=function(){Uw(l,h,m),typeof x!="function"&&(da===null?da=new Set([this]):da.add(this));var z=m.stack;this.componentDidCatch(m.value,{componentStack:z!==null?z:""})})}function nD(a,l,h,m,x){if(h.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(l=h.alternate,l!==null&&xl(l,h,x,!0),h=ni.current,h!==null){switch(h.tag){case 31:case 13:return Ti===null?Nf():h.alternate===null&&En===0&&(En=3),h.flags&=-257,h.flags|=65536,h.lanes=x,m===sf?h.flags|=16384:(l=h.updateQueue,l===null?h.updateQueue=new Set([m]):l.add(m),ry(a,m,x)),!1;case 22:return h.flags|=65536,m===sf?h.flags|=16384:(l=h.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([m])},h.updateQueue=l):(h=l.retryQueue,h===null?l.retryQueue=new Set([m]):h.add(m)),ry(a,m,x)),!1}throw Error(r(435,h.tag))}return ry(a,m,x),Nf(),!1}if(gt)return l=ni.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,m!==Kg&&(a=Error(r(422),{cause:m}),au(Si(a,h)))):(m!==Kg&&(l=Error(r(423),{cause:m}),au(Si(l,h))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,m=Si(m,h),x=R0(a.stateNode,m,x),l0(a,x),En!==4&&(En=2)),!1;var v=Error(r(520),{cause:m});if(v=Si(v,h),Cu===null?Cu=[v]:Cu.push(v),En!==4&&(En=2),l===null)return!0;m=Si(m,h),h=l;do{switch(h.tag){case 3:return h.flags|=65536,a=x&-x,h.lanes|=a,a=R0(h.stateNode,m,a),l0(h,a),!1;case 1:if(l=h.type,v=h.stateNode,(h.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(da===null||!da.has(v))))return h.flags|=65536,x&=-x,h.lanes|=x,x=Fw(x),Gw(x,a,h,m),l0(h,x),!1}h=h.return}while(h!==null);return!1}var P0=Error(r(461)),Wn=!1;function mr(a,l,h,m){l.child=a===null?Y_(l,null,h,m):lo(l,a.child,h,m)}function Hw(a,l,h,m,x){h=h.render;var v=l.ref;if("ref"in m){var C={};for(var z in m)z!=="ref"&&(C[z]=m[z])}else C=m;return io(l),m=m0(a,l,h,C,v,x),z=p0(),a!==null&&!Wn?(g0(a,l,x),Is(a,l,x)):(gt&&z&&Zg(l),l.flags|=1,mr(a,l,m,x),l.child)}function Vw(a,l,h,m,x){if(a===null){var v=h.type;return typeof v=="function"&&!Yg(v)&&v.defaultProps===void 0&&h.compare===null?(l.tag=15,l.type=v,Ww(a,l,v,m,x)):(a=Qd(h.type,null,m,l,l.mode,x),a.ref=l.ref,a.return=l,l.child=a)}if(v=a.child,!F0(a,x)){var C=v.memoizedProps;if(h=h.compare,h=h!==null?h:ru,h(C,m)&&a.ref===l.ref)return Is(a,l,x)}return l.flags|=1,a=Cs(v,m),a.ref=l.ref,a.return=l,l.child=a}function Ww(a,l,h,m,x){if(a!==null){var v=a.memoizedProps;if(ru(v,m)&&a.ref===l.ref)if(Wn=!1,l.pendingProps=m=v,F0(a,x))(a.flags&131072)!==0&&(Wn=!0);else return l.lanes=a.lanes,Is(a,l,x)}return D0(a,l,h,m,x)}function Yw(a,l,h,m){var x=m.children,v=a!==null?a.memoizedState:null;if(a===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((l.flags&128)!==0){if(v=v!==null?v.baseLanes|h:h,a!==null){for(m=l.child=a.child,x=0;m!==null;)x=x|m.lanes|m.childLanes,m=m.sibling;m=x&~v}else m=0,l.child=null;return $w(a,l,v,h,m)}if((h&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&nf(l,v!==null?v.cachePool:null),v!==null?Z_(l,v):u0(),X_(l);else return m=l.lanes=536870912,$w(a,l,v!==null?v.baseLanes|h:h,h,m)}else v!==null?(nf(l,v.cachePool),Z_(l,v),la(),l.memoizedState=null):(a!==null&&nf(l,null),u0(),la());return mr(a,l,x,h),l.child}function bu(a,l){return a!==null&&a.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function $w(a,l,h,m,x){var v=i0();return v=v===null?null:{parent:Hn._currentValue,pool:v},l.memoizedState={baseLanes:h,cachePool:v},a!==null&&nf(l,null),u0(),X_(l),a!==null&&xl(a,l,m,!0),l.childLanes=x,null}function xf(a,l){return l=_f({mode:l.mode,children:l.children},a.mode),l.ref=a.ref,a.child=l,l.return=a,l}function qw(a,l,h){return lo(l,a.child,null,h),a=xf(l,l.pendingProps),a.flags|=2,ri(l),l.memoizedState=null,a}function rD(a,l,h){var m=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,a===null){if(gt){if(m.mode==="hidden")return a=xf(l,m),l.lanes=536870912,bu(null,a);if(d0(l),(a=ln)?(a=aA(a,ki),a=a!==null&&a.data==="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:ea!==null?{id:Ki,overflow:Qi}:null,retryLane:536870912,hydrationErrors:null},h=I_(a),h.return=l,l.child=h,dr=l,ln=null)):a=null,a===null)throw na(l);return l.lanes=536870912,null}return xf(l,m)}var v=a.memoizedState;if(v!==null){var C=v.dehydrated;if(d0(l),x)if(l.flags&256)l.flags&=-257,l=qw(a,l,h);else if(l.memoizedState!==null)l.child=a.child,l.flags|=128,l=null;else throw Error(r(558));else if(Wn||xl(a,l,h,!1),x=(h&a.childLanes)!==0,Wn||x){if(m=qt,m!==null&&(C=Dd(m,h),C!==0&&C!==v.retryLane))throw v.retryLane=C,eo(a,C),Gr(m,a,C),P0;Nf(),l=qw(a,l,h)}else a=v.treeContext,ln=Ei(C.nextSibling),dr=l,gt=!0,ta=null,ki=!1,a!==null&&D_(l,a),l=xf(l,m),l.flags|=4096;return l}return a=Cs(a.child,{mode:m.mode,children:m.children}),a.ref=l.ref,l.child=a,a.return=l,a}function vf(a,l){var h=l.ref;if(h===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(a===null||a.ref!==h)&&(l.flags|=4194816)}}function D0(a,l,h,m,x){return io(l),h=m0(a,l,h,m,void 0,x),m=p0(),a!==null&&!Wn?(g0(a,l,x),Is(a,l,x)):(gt&&m&&Zg(l),l.flags|=1,mr(a,l,h,x),l.child)}function Zw(a,l,h,m,x,v){return io(l),l.updateQueue=null,h=Q_(l,m,h,x),K_(a),m=p0(),a!==null&&!Wn?(g0(a,l,v),Is(a,l,v)):(gt&&m&&Zg(l),l.flags|=1,mr(a,l,h,v),l.child)}function Xw(a,l,h,m,x){if(io(l),l.stateNode===null){var v=pl,C=h.contextType;typeof C=="object"&&C!==null&&(v=fr(C)),v=new h(m,v),l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=I0,l.stateNode=v,v._reactInternals=l,v=l.stateNode,v.props=m,v.state=l.memoizedState,v.refs={},a0(l),C=h.contextType,v.context=typeof C=="object"&&C!==null?fr(C):pl,v.state=l.memoizedState,C=h.getDerivedStateFromProps,typeof C=="function"&&(N0(l,h,C,m),v.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(C=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),C!==v.state&&I0.enqueueReplaceState(v,v.state,null),fu(l,m,v,x),du(),v.state=l.memoizedState),typeof v.componentDidMount=="function"&&(l.flags|=4194308),m=!0}else if(a===null){v=l.stateNode;var z=l.memoizedProps,Z=uo(h,z);v.props=Z;var le=v.context,fe=h.contextType;C=pl,typeof fe=="object"&&fe!==null&&(C=fr(fe));var xe=h.getDerivedStateFromProps;fe=typeof xe=="function"||typeof v.getSnapshotBeforeUpdate=="function",z=l.pendingProps!==z,fe||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(z||le!==C)&&Bw(l,v,m,C),ia=!1;var ce=l.memoizedState;v.state=ce,fu(l,m,v,x),du(),le=l.memoizedState,z||ce!==le||ia?(typeof xe=="function"&&(N0(l,h,xe,m),le=l.memoizedState),(Z=ia||jw(l,h,Z,m,ce,le,C))?(fe||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(l.flags|=4194308)):(typeof v.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=le),v.props=m,v.state=le,v.context=C,m=Z):(typeof v.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{v=l.stateNode,o0(a,l),C=l.memoizedProps,fe=uo(h,C),v.props=fe,xe=l.pendingProps,ce=v.context,le=h.contextType,Z=pl,typeof le=="object"&&le!==null&&(Z=fr(le)),z=h.getDerivedStateFromProps,(le=typeof z=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(C!==xe||ce!==Z)&&Bw(l,v,m,Z),ia=!1,ce=l.memoizedState,v.state=ce,fu(l,m,v,x),du();var he=l.memoizedState;C!==xe||ce!==he||ia||a!==null&&a.dependencies!==null&&ef(a.dependencies)?(typeof z=="function"&&(N0(l,h,z,m),he=l.memoizedState),(fe=ia||jw(l,h,fe,m,ce,he,Z)||a!==null&&a.dependencies!==null&&ef(a.dependencies))?(le||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(m,he,Z),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(m,he,Z)),typeof v.componentDidUpdate=="function"&&(l.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof v.componentDidUpdate!="function"||C===a.memoizedProps&&ce===a.memoizedState||(l.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||C===a.memoizedProps&&ce===a.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=he),v.props=m,v.state=he,v.context=Z,m=fe):(typeof v.componentDidUpdate!="function"||C===a.memoizedProps&&ce===a.memoizedState||(l.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||C===a.memoizedProps&&ce===a.memoizedState||(l.flags|=1024),m=!1)}return v=m,vf(a,l),m=(l.flags&128)!==0,v||m?(v=l.stateNode,h=m&&typeof h.getDerivedStateFromError!="function"?null:v.render(),l.flags|=1,a!==null&&m?(l.child=lo(l,a.child,null,x),l.child=lo(l,null,h,x)):mr(a,l,h,x),l.memoizedState=v.state,a=l.child):a=Is(a,l,x),a}function Kw(a,l,h,m){return no(),l.flags|=256,mr(a,l,h,m),l.child}var j0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function B0(a){return{baseLanes:a,cachePool:U_()}}function O0(a,l,h){return a=a!==null?a.childLanes&~h:0,l&&(a|=si),a}function Qw(a,l,h){var m=l.pendingProps,x=!1,v=(l.flags&128)!==0,C;if((C=v)||(C=a!==null&&a.memoizedState===null?!1:(Dn.current&2)!==0),C&&(x=!0,l.flags&=-129),C=(l.flags&32)!==0,l.flags&=-33,a===null){if(gt){if(x?oa(l):la(),(a=ln)?(a=aA(a,ki),a=a!==null&&a.data!=="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:ea!==null?{id:Ki,overflow:Qi}:null,retryLane:536870912,hydrationErrors:null},h=I_(a),h.return=l,l.child=h,dr=l,ln=null)):a=null,a===null)throw na(l);return xy(a)?l.lanes=32:l.lanes=536870912,null}var z=m.children;return m=m.fallback,x?(la(),x=l.mode,z=_f({mode:"hidden",children:z},x),m=to(m,x,h,null),z.return=l,m.return=l,z.sibling=m,l.child=z,m=l.child,m.memoizedState=B0(h),m.childLanes=O0(a,C,h),l.memoizedState=j0,bu(null,m)):(oa(l),L0(l,z))}var Z=a.memoizedState;if(Z!==null&&(z=Z.dehydrated,z!==null)){if(v)l.flags&256?(oa(l),l.flags&=-257,l=z0(a,l,h)):l.memoizedState!==null?(la(),l.child=a.child,l.flags|=128,l=null):(la(),z=m.fallback,x=l.mode,m=_f({mode:"visible",children:m.children},x),z=to(z,x,h,null),z.flags|=2,m.return=l,z.return=l,m.sibling=z,l.child=m,lo(l,a.child,null,h),m=l.child,m.memoizedState=B0(h),m.childLanes=O0(a,C,h),l.memoizedState=j0,l=bu(null,m));else if(oa(l),xy(z)){if(C=z.nextSibling&&z.nextSibling.dataset,C)var le=C.dgst;C=le,m=Error(r(419)),m.stack="",m.digest=C,au({value:m,source:null,stack:null}),l=z0(a,l,h)}else if(Wn||xl(a,l,h,!1),C=(h&a.childLanes)!==0,Wn||C){if(C=qt,C!==null&&(m=Dd(C,h),m!==0&&m!==Z.retryLane))throw Z.retryLane=m,eo(a,m),Gr(C,a,m),P0;by(z)||Nf(),l=z0(a,l,h)}else by(z)?(l.flags|=192,l.child=a.child,l=null):(a=Z.treeContext,ln=Ei(z.nextSibling),dr=l,gt=!0,ta=null,ki=!1,a!==null&&D_(l,a),l=L0(l,m.children),l.flags|=4096);return l}return x?(la(),z=m.fallback,x=l.mode,Z=a.child,le=Z.sibling,m=Cs(Z,{mode:"hidden",children:m.children}),m.subtreeFlags=Z.subtreeFlags&65011712,le!==null?z=Cs(le,z):(z=to(z,x,h,null),z.flags|=2),z.return=l,m.return=l,m.sibling=z,l.child=m,bu(null,m),m=l.child,z=a.child.memoizedState,z===null?z=B0(h):(x=z.cachePool,x!==null?(Z=Hn._currentValue,x=x.parent!==Z?{parent:Z,pool:Z}:x):x=U_(),z={baseLanes:z.baseLanes|h,cachePool:x}),m.memoizedState=z,m.childLanes=O0(a,C,h),l.memoizedState=j0,bu(a.child,m)):(oa(l),h=a.child,a=h.sibling,h=Cs(h,{mode:"visible",children:m.children}),h.return=l,h.sibling=null,a!==null&&(C=l.deletions,C===null?(l.deletions=[a],l.flags|=16):C.push(a)),l.child=h,l.memoizedState=null,h)}function L0(a,l){return l=_f({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function _f(a,l){return a=ti(22,a,null,l),a.lanes=0,a}function z0(a,l,h){return lo(l,a.child,null,h),a=L0(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function Jw(a,l,h){a.lanes|=l;var m=a.alternate;m!==null&&(m.lanes|=l),e0(a.return,l,h)}function U0(a,l,h,m,x,v){var C=a.memoizedState;C===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:h,tailMode:x,treeForkCount:v}:(C.isBackwards=l,C.rendering=null,C.renderingStartTime=0,C.last=m,C.tail=h,C.tailMode=x,C.treeForkCount=v)}function eS(a,l,h){var m=l.pendingProps,x=m.revealOrder,v=m.tail;m=m.children;var C=Dn.current,z=(C&2)!==0;if(z?(C=C&1|2,l.flags|=128):C&=1,D(Dn,C),mr(a,l,m,h),m=gt?su:0,!z&&a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Jw(a,h,l);else if(a.tag===19)Jw(a,h,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(x){case"forwards":for(h=l.child,x=null;h!==null;)a=h.alternate,a!==null&&cf(a)===null&&(x=h),h=h.sibling;h=x,h===null?(x=l.child,l.child=null):(x=h.sibling,h.sibling=null),U0(l,!1,x,h,v,m);break;case"backwards":case"unstable_legacy-backwards":for(h=null,x=l.child,l.child=null;x!==null;){if(a=x.alternate,a!==null&&cf(a)===null){l.child=x;break}a=x.sibling,x.sibling=h,h=x,x=a}U0(l,!0,h,null,v,m);break;case"together":U0(l,!1,null,null,void 0,m);break;default:l.memoizedState=null}return l.child}function Is(a,l,h){if(a!==null&&(l.dependencies=a.dependencies),ha|=l.lanes,(h&l.childLanes)===0)if(a!==null){if(xl(a,l,h,!1),(h&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(r(153));if(l.child!==null){for(a=l.child,h=Cs(a,a.pendingProps),l.child=h,h.return=l;a.sibling!==null;)a=a.sibling,h=h.sibling=Cs(a,a.pendingProps),h.return=l;h.sibling=null}return l.child}function F0(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&ef(a)))}function iD(a,l,h){switch(l.tag){case 3:ve(l,l.stateNode.containerInfo),ra(l,Hn,a.memoizedState.cache),no();break;case 27:case 5:Le(l);break;case 4:ve(l,l.stateNode.containerInfo);break;case 10:ra(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,d0(l),null;break;case 13:var m=l.memoizedState;if(m!==null)return m.dehydrated!==null?(oa(l),l.flags|=128,null):(h&l.child.childLanes)!==0?Qw(a,l,h):(oa(l),a=Is(a,l,h),a!==null?a.sibling:null);oa(l);break;case 19:var x=(a.flags&128)!==0;if(m=(h&l.childLanes)!==0,m||(xl(a,l,h,!1),m=(h&l.childLanes)!==0),x){if(m)return eS(a,l,h);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),D(Dn,Dn.current),m)break;return null;case 22:return l.lanes=0,Yw(a,l,h,l.pendingProps);case 24:ra(l,Hn,a.memoizedState.cache)}return Is(a,l,h)}function tS(a,l,h){if(a!==null)if(a.memoizedProps!==l.pendingProps)Wn=!0;else{if(!F0(a,h)&&(l.flags&128)===0)return Wn=!1,iD(a,l,h);Wn=(a.flags&131072)!==0}else Wn=!1,gt&&(l.flags&1048576)!==0&&P_(l,su,l.index);switch(l.lanes=0,l.tag){case 16:e:{var m=l.pendingProps;if(a=ao(l.elementType),l.type=a,typeof a=="function")Yg(a)?(m=uo(a,m),l.tag=1,l=Xw(null,l,a,m,h)):(l.tag=0,l=D0(null,l,a,m,h));else{if(a!=null){var x=a.$$typeof;if(x===E){l.tag=11,l=Hw(null,l,a,m,h);break e}else if(x===B){l.tag=14,l=Vw(null,l,a,m,h);break e}}throw l=q(a)||a,Error(r(306,l,""))}}return l;case 0:return D0(a,l,l.type,l.pendingProps,h);case 1:return m=l.type,x=uo(m,l.pendingProps),Xw(a,l,m,x,h);case 3:e:{if(ve(l,l.stateNode.containerInfo),a===null)throw Error(r(387));m=l.pendingProps;var v=l.memoizedState;x=v.element,o0(a,l),fu(l,m,null,h);var C=l.memoizedState;if(m=C.cache,ra(l,Hn,m),m!==v.cache&&t0(l,[Hn],h,!0),du(),m=C.element,v.isDehydrated)if(v={element:m,isDehydrated:!1,cache:C.cache},l.updateQueue.baseState=v,l.memoizedState=v,l.flags&256){l=Kw(a,l,m,h);break e}else if(m!==x){x=Si(Error(r(424)),l),au(x),l=Kw(a,l,m,h);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(ln=Ei(a.firstChild),dr=l,gt=!0,ta=null,ki=!0,h=Y_(l,null,m,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(no(),m===x){l=Is(a,l,h);break e}mr(a,l,m,h)}l=l.child}return l;case 26:return vf(a,l),a===null?(h=dA(l.type,null,l.pendingProps,null))?l.memoizedState=h:gt||(h=l.type,a=l.pendingProps,m=Of(Se.current).createElement(h),m[Gn]=l,m[fn]=a,pr(m,h,a),rt(m),l.stateNode=m):l.memoizedState=dA(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return Le(l),a===null&&gt&&(m=l.stateNode=cA(l.type,l.pendingProps,Se.current),dr=l,ki=!0,x=ln,ga(l.type)?(vy=x,ln=Ei(m.firstChild)):ln=x),mr(a,l,l.pendingProps.children,h),vf(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&gt&&((x=m=ln)&&(m=DD(m,l.type,l.pendingProps,ki),m!==null?(l.stateNode=m,dr=l,ln=Ei(m.firstChild),ki=!1,x=!0):x=!1),x||na(l)),Le(l),x=l.type,v=l.pendingProps,C=a!==null?a.memoizedProps:null,m=v.children,py(x,v)?m=null:C!==null&&py(x,C)&&(l.flags|=32),l.memoizedState!==null&&(x=m0(a,l,Z6,null,null,h),Pu._currentValue=x),vf(a,l),mr(a,l,m,h),l.child;case 6:return a===null&&gt&&((a=h=ln)&&(h=jD(h,l.pendingProps,ki),h!==null?(l.stateNode=h,dr=l,ln=null,a=!0):a=!1),a||na(l)),null;case 13:return Qw(a,l,h);case 4:return ve(l,l.stateNode.containerInfo),m=l.pendingProps,a===null?l.child=lo(l,null,m,h):mr(a,l,m,h),l.child;case 11:return Hw(a,l,l.type,l.pendingProps,h);case 7:return mr(a,l,l.pendingProps,h),l.child;case 8:return mr(a,l,l.pendingProps.children,h),l.child;case 12:return mr(a,l,l.pendingProps.children,h),l.child;case 10:return m=l.pendingProps,ra(l,l.type,m.value),mr(a,l,m.children,h),l.child;case 9:return x=l.type._context,m=l.pendingProps.children,io(l),x=fr(x),m=m(x),l.flags|=1,mr(a,l,m,h),l.child;case 14:return Vw(a,l,l.type,l.pendingProps,h);case 15:return Ww(a,l,l.type,l.pendingProps,h);case 19:return eS(a,l,h);case 31:return rD(a,l,h);case 22:return Yw(a,l,h,l.pendingProps);case 24:return io(l),m=fr(Hn),a===null?(x=i0(),x===null&&(x=qt,v=n0(),x.pooledCache=v,v.refCount++,v!==null&&(x.pooledCacheLanes|=h),x=v),l.memoizedState={parent:m,cache:x},a0(l),ra(l,Hn,x)):((a.lanes&h)!==0&&(o0(a,l),fu(l,null,null,h),du()),x=a.memoizedState,v=l.memoizedState,x.parent!==m?(x={parent:m,cache:m},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),ra(l,Hn,m)):(m=v.cache,ra(l,Hn,m),m!==x.cache&&t0(l,[Hn],h,!0))),mr(a,l,l.pendingProps.children,h),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function Rs(a){a.flags|=4}function G0(a,l,h,m,x){if((l=(a.mode&32)!==0)&&(l=!1),l){if(a.flags|=16777216,(x&335544128)===x)if(a.stateNode.complete)a.flags|=8192;else if(ES())a.flags|=8192;else throw oo=sf,s0}else a.flags&=-16777217}function nS(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!yA(l))if(ES())a.flags|=8192;else throw oo=sf,s0}function wf(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?vs():536870912,a.lanes|=l,Il|=l)}function xu(a,l){if(!gt)switch(a.tailMode){case"hidden":l=a.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function cn(a){var l=a.alternate!==null&&a.alternate.child===a.child,h=0,m=0;if(l)for(var x=a.child;x!==null;)h|=x.lanes|x.childLanes,m|=x.subtreeFlags&65011712,m|=x.flags&65011712,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)h|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=m,a.childLanes=h,l}function sD(a,l,h){var m=l.pendingProps;switch(Xg(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(l),null;case 1:return cn(l),null;case 3:return h=l.stateNode,m=null,a!==null&&(m=a.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),Es(Hn),Ce(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(bl(l)?Rs(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Qg())),cn(l),null;case 26:var x=l.type,v=l.memoizedState;return a===null?(Rs(l),v!==null?(cn(l),nS(l,v)):(cn(l),G0(l,x,null,m,h))):v?v!==a.memoizedState?(Rs(l),cn(l),nS(l,v)):(cn(l),l.flags&=-16777217):(a=a.memoizedProps,a!==m&&Rs(l),cn(l),G0(l,x,a,m,h)),null;case 27:if(st(l),h=Se.current,x=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==m&&Rs(l);else{if(!m){if(l.stateNode===null)throw Error(r(166));return cn(l),null}a=ee.current,bl(l)?j_(l):(a=cA(x,m,h),l.stateNode=a,Rs(l))}return cn(l),null;case 5:if(st(l),x=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==m&&Rs(l);else{if(!m){if(l.stateNode===null)throw Error(r(166));return cn(l),null}if(v=ee.current,bl(l))j_(l);else{var C=Of(Se.current);switch(v){case 1:v=C.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:v=C.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":v=C.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":v=C.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":v=C.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof m.is=="string"?C.createElement("select",{is:m.is}):C.createElement("select"),m.multiple?v.multiple=!0:m.size&&(v.size=m.size);break;default:v=typeof m.is=="string"?C.createElement(x,{is:m.is}):C.createElement(x)}}v[Gn]=l,v[fn]=m;e:for(C=l.child;C!==null;){if(C.tag===5||C.tag===6)v.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===l)break e;for(;C.sibling===null;){if(C.return===null||C.return===l)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}l.stateNode=v;e:switch(pr(v,x,m),x){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Rs(l)}}return cn(l),G0(l,l.type,a===null?null:a.memoizedProps,l.pendingProps,h),null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==m&&Rs(l);else{if(typeof m!="string"&&l.stateNode===null)throw Error(r(166));if(a=Se.current,bl(l)){if(a=l.stateNode,h=l.memoizedProps,m=null,x=dr,x!==null)switch(x.tag){case 27:case 5:m=x.memoizedProps}a[Gn]=l,a=!!(a.nodeValue===h||m!==null&&m.suppressHydrationWarning===!0||QS(a.nodeValue,h)),a||na(l,!0)}else a=Of(a).createTextNode(m),a[Gn]=l,l.stateNode=a}return cn(l),null;case 31:if(h=l.memoizedState,a===null||a.memoizedState!==null){if(m=bl(l),h!==null){if(a===null){if(!m)throw Error(r(318));if(a=l.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[Gn]=l}else no(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;cn(l),a=!1}else h=Qg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=h),a=!0;if(!a)return l.flags&256?(ri(l),l):(ri(l),null);if((l.flags&128)!==0)throw Error(r(558))}return cn(l),null;case 13:if(m=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=bl(l),m!==null&&m.dehydrated!==null){if(a===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Gn]=l}else no(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;cn(l),x=!1}else x=Qg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(ri(l),l):(ri(l),null)}return ri(l),(l.flags&128)!==0?(l.lanes=h,l):(h=m!==null,a=a!==null&&a.memoizedState!==null,h&&(m=l.child,x=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(x=m.alternate.memoizedState.cachePool.pool),v=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(v=m.memoizedState.cachePool.pool),v!==x&&(m.flags|=2048)),h!==a&&h&&(l.child.flags|=8192),wf(l,l.updateQueue),cn(l),null);case 4:return Ce(),a===null&&uy(l.stateNode.containerInfo),cn(l),null;case 10:return Es(l.type),cn(l),null;case 19:if(X(Dn),m=l.memoizedState,m===null)return cn(l),null;if(x=(l.flags&128)!==0,v=m.rendering,v===null)if(x)xu(m,!1);else{if(En!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(v=cf(a),v!==null){for(l.flags|=128,xu(m,!1),a=v.updateQueue,l.updateQueue=a,wf(l,a),l.subtreeFlags=0,a=h,h=l.child;h!==null;)N_(h,a),h=h.sibling;return D(Dn,Dn.current&1|2),gt&&ks(l,m.treeForkCount),l.child}a=a.sibling}m.tail!==null&&$e()>Tf&&(l.flags|=128,x=!0,xu(m,!1),l.lanes=4194304)}else{if(!x)if(a=cf(v),a!==null){if(l.flags|=128,x=!0,a=a.updateQueue,l.updateQueue=a,wf(l,a),xu(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!gt)return cn(l),null}else 2*$e()-m.renderingStartTime>Tf&&h!==536870912&&(l.flags|=128,x=!0,xu(m,!1),l.lanes=4194304);m.isBackwards?(v.sibling=l.child,l.child=v):(a=m.last,a!==null?a.sibling=v:l.child=v,m.last=v)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=$e(),a.sibling=null,h=Dn.current,D(Dn,x?h&1|2:h&1),gt&&ks(l,m.treeForkCount),a):(cn(l),null);case 22:case 23:return ri(l),h0(),m=l.memoizedState!==null,a!==null?a.memoizedState!==null!==m&&(l.flags|=8192):m&&(l.flags|=8192),m?(h&536870912)!==0&&(l.flags&128)===0&&(cn(l),l.subtreeFlags&6&&(l.flags|=8192)):cn(l),h=l.updateQueue,h!==null&&wf(l,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),m=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==h&&(l.flags|=2048),a!==null&&X(so),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),Es(Hn),cn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function aD(a,l){switch(Xg(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Es(Hn),Ce(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return st(l),null;case 31:if(l.memoizedState!==null){if(ri(l),l.alternate===null)throw Error(r(340));no()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 13:if(ri(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(r(340));no()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return X(Dn),null;case 4:return Ce(),null;case 10:return Es(l.type),null;case 22:case 23:return ri(l),h0(),a!==null&&X(so),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return Es(Hn),null;case 25:return null;default:return null}}function rS(a,l){switch(Xg(l),l.tag){case 3:Es(Hn),Ce();break;case 26:case 27:case 5:st(l);break;case 4:Ce();break;case 31:l.memoizedState!==null&&ri(l);break;case 13:ri(l);break;case 19:X(Dn);break;case 10:Es(l.type);break;case 22:case 23:ri(l),h0(),a!==null&&X(so);break;case 24:Es(Hn)}}function vu(a,l){try{var h=l.updateQueue,m=h!==null?h.lastEffect:null;if(m!==null){var x=m.next;h=x;do{if((h.tag&a)===a){m=void 0;var v=h.create,C=h.inst;m=v(),C.destroy=m}h=h.next}while(h!==x)}}catch(z){Bt(l,l.return,z)}}function ca(a,l,h){try{var m=l.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var v=x.next;m=v;do{if((m.tag&a)===a){var C=m.inst,z=C.destroy;if(z!==void 0){C.destroy=void 0,x=l;var Z=h,le=z;try{le()}catch(fe){Bt(x,Z,fe)}}}m=m.next}while(m!==v)}}catch(fe){Bt(l,l.return,fe)}}function iS(a){var l=a.updateQueue;if(l!==null){var h=a.stateNode;try{q_(l,h)}catch(m){Bt(a,a.return,m)}}}function sS(a,l,h){h.props=uo(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(m){Bt(a,l,m)}}function _u(a,l){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var m=a.stateNode;break;case 30:m=a.stateNode;break;default:m=a.stateNode}typeof h=="function"?a.refCleanup=h(m):h.current=m}}catch(x){Bt(a,l,x)}}function Ji(a,l){var h=a.ref,m=a.refCleanup;if(h!==null)if(typeof m=="function")try{m()}catch(x){Bt(a,l,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(x){Bt(a,l,x)}else h.current=null}function aS(a){var l=a.type,h=a.memoizedProps,m=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":h.autoFocus&&m.focus();break e;case"img":h.src?m.src=h.src:h.srcSet&&(m.srcset=h.srcSet)}}catch(x){Bt(a,a.return,x)}}function H0(a,l,h){try{var m=a.stateNode;ED(m,a.type,h,l),m[fn]=l}catch(x){Bt(a,a.return,x)}}function oS(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&ga(a.type)||a.tag===4}function V0(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||oS(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&ga(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function W0(a,l,h){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,l):(l=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,l.appendChild(a),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=Ss));else if(m!==4&&(m===27&&ga(a.type)&&(h=a.stateNode,l=null),a=a.child,a!==null))for(W0(a,l,h),a=a.sibling;a!==null;)W0(a,l,h),a=a.sibling}function Sf(a,l,h){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?h.insertBefore(a,l):h.appendChild(a);else if(m!==4&&(m===27&&ga(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(Sf(a,l,h),a=a.sibling;a!==null;)Sf(a,l,h),a=a.sibling}function lS(a){var l=a.stateNode,h=a.memoizedProps;try{for(var m=a.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);pr(l,m,h),l[Gn]=a,l[fn]=h}catch(v){Bt(a,a.return,v)}}var Ps=!1,Yn=!1,Y0=!1,cS=typeof WeakSet=="function"?WeakSet:Set,rr=null;function oD(a,l){if(a=a.containerInfo,fy=Vf,a=__(a),zg(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&m.rangeCount!==0){h=m.anchorNode;var x=m.anchorOffset,v=m.focusNode;m=m.focusOffset;try{h.nodeType,v.nodeType}catch{h=null;break e}var C=0,z=-1,Z=-1,le=0,fe=0,xe=a,ce=null;t:for(;;){for(var he;xe!==h||x!==0&&xe.nodeType!==3||(z=C+x),xe!==v||m!==0&&xe.nodeType!==3||(Z=C+m),xe.nodeType===3&&(C+=xe.nodeValue.length),(he=xe.firstChild)!==null;)ce=xe,xe=he;for(;;){if(xe===a)break t;if(ce===h&&++le===x&&(z=C),ce===v&&++fe===m&&(Z=C),(he=xe.nextSibling)!==null)break;xe=ce,ce=xe.parentNode}xe=he}h=z===-1||Z===-1?null:{start:z,end:Z}}else h=null}h=h||{start:0,end:0}}else h=null;for(my={focusedElem:a,selectionRange:h},Vf=!1,rr=l;rr!==null;)if(l=rr,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,rr=a;else for(;rr!==null;){switch(l=rr,v=l.alternate,a=l.flags,l.tag){case 0:if((a&4)!==0&&(a=l.updateQueue,a=a!==null?a.events:null,a!==null))for(h=0;h<a.length;h++)x=a[h],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&v!==null){a=void 0,h=l,x=v.memoizedProps,v=v.memoizedState,m=h.stateNode;try{var Ie=uo(h.type,x);a=m.getSnapshotBeforeUpdate(Ie,v),m.__reactInternalSnapshotBeforeUpdate=a}catch(Fe){Bt(h,h.return,Fe)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,h=a.nodeType,h===9)yy(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":yy(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=l.sibling,a!==null){a.return=l.return,rr=a;break}rr=l.return}}function uS(a,l,h){var m=h.flags;switch(h.tag){case 0:case 11:case 15:js(a,h),m&4&&vu(5,h);break;case 1:if(js(a,h),m&4)if(a=h.stateNode,l===null)try{a.componentDidMount()}catch(C){Bt(h,h.return,C)}else{var x=uo(h.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(x,l,a.__reactInternalSnapshotBeforeUpdate)}catch(C){Bt(h,h.return,C)}}m&64&&iS(h),m&512&&_u(h,h.return);break;case 3:if(js(a,h),m&64&&(a=h.updateQueue,a!==null)){if(l=null,h.child!==null)switch(h.child.tag){case 27:case 5:l=h.child.stateNode;break;case 1:l=h.child.stateNode}try{q_(a,l)}catch(C){Bt(h,h.return,C)}}break;case 27:l===null&&m&4&&lS(h);case 26:case 5:js(a,h),l===null&&m&4&&aS(h),m&512&&_u(h,h.return);break;case 12:js(a,h);break;case 31:js(a,h),m&4&&fS(a,h);break;case 13:js(a,h),m&4&&mS(a,h),m&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=gD.bind(null,h),BD(a,h))));break;case 22:if(m=h.memoizedState!==null||Ps,!m){l=l!==null&&l.memoizedState!==null||Yn,x=Ps;var v=Yn;Ps=m,(Yn=l)&&!v?Bs(a,h,(h.subtreeFlags&8772)!==0):js(a,h),Ps=x,Yn=v}break;case 30:break;default:js(a,h)}}function hS(a){var l=a.alternate;l!==null&&(a.alternate=null,hS(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&K(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var mn=null,Lr=!1;function Ds(a,l,h){for(h=h.child;h!==null;)dS(a,l,h),h=h.sibling}function dS(a,l,h){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(Un,h)}catch{}switch(h.tag){case 26:Yn||Ji(h,l),Ds(a,l,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Yn||Ji(h,l);var m=mn,x=Lr;ga(h.type)&&(mn=h.stateNode,Lr=!1),Ds(a,l,h),Nu(h.stateNode),mn=m,Lr=x;break;case 5:Yn||Ji(h,l);case 6:if(m=mn,x=Lr,mn=null,Ds(a,l,h),mn=m,Lr=x,mn!==null)if(Lr)try{(mn.nodeType===9?mn.body:mn.nodeName==="HTML"?mn.ownerDocument.body:mn).removeChild(h.stateNode)}catch(v){Bt(h,l,v)}else try{mn.removeChild(h.stateNode)}catch(v){Bt(h,l,v)}break;case 18:mn!==null&&(Lr?(a=mn,iA(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),zl(a)):iA(mn,h.stateNode));break;case 4:m=mn,x=Lr,mn=h.stateNode.containerInfo,Lr=!0,Ds(a,l,h),mn=m,Lr=x;break;case 0:case 11:case 14:case 15:ca(2,h,l),Yn||ca(4,h,l),Ds(a,l,h);break;case 1:Yn||(Ji(h,l),m=h.stateNode,typeof m.componentWillUnmount=="function"&&sS(h,l,m)),Ds(a,l,h);break;case 21:Ds(a,l,h);break;case 22:Yn=(m=Yn)||h.memoizedState!==null,Ds(a,l,h),Yn=m;break;default:Ds(a,l,h)}}function fS(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{zl(a)}catch(h){Bt(l,l.return,h)}}}function mS(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{zl(a)}catch(h){Bt(l,l.return,h)}}function lD(a){switch(a.tag){case 31:case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new cS),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new cS),l;default:throw Error(r(435,a.tag))}}function Af(a,l){var h=lD(a);l.forEach(function(m){if(!h.has(m)){h.add(m);var x=yD.bind(null,a,m);m.then(x,x)}})}function zr(a,l){var h=l.deletions;if(h!==null)for(var m=0;m<h.length;m++){var x=h[m],v=a,C=l,z=C;e:for(;z!==null;){switch(z.tag){case 27:if(ga(z.type)){mn=z.stateNode,Lr=!1;break e}break;case 5:mn=z.stateNode,Lr=!1;break e;case 3:case 4:mn=z.stateNode.containerInfo,Lr=!0;break e}z=z.return}if(mn===null)throw Error(r(160));dS(v,C,x),mn=null,Lr=!1,v=x.alternate,v!==null&&(v.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)pS(l,a),l=l.sibling}var Gi=null;function pS(a,l){var h=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:zr(l,a),Ur(a),m&4&&(ca(3,a,a.return),vu(3,a),ca(5,a,a.return));break;case 1:zr(l,a),Ur(a),m&512&&(Yn||h===null||Ji(h,h.return)),m&64&&Ps&&(a=a.updateQueue,a!==null&&(m=a.callbacks,m!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?m:h.concat(m))));break;case 26:var x=Gi;if(zr(l,a),Ur(a),m&512&&(Yn||h===null||Ji(h,h.return)),m&4){var v=h!==null?h.memoizedState:null;if(m=a.memoizedState,h===null)if(m===null)if(a.stateNode===null){e:{m=a.type,h=a.memoizedProps,x=x.ownerDocument||x;t:switch(m){case"title":v=x.getElementsByTagName("title")[0],(!v||v[Pe]||v[Gn]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=x.createElement(m),x.head.insertBefore(v,x.querySelector("head > title"))),pr(v,m,h),v[Gn]=a,rt(v),m=v;break e;case"link":var C=pA("link","href",x).get(m+(h.href||""));if(C){for(var z=0;z<C.length;z++)if(v=C[z],v.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&v.getAttribute("rel")===(h.rel==null?null:h.rel)&&v.getAttribute("title")===(h.title==null?null:h.title)&&v.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){C.splice(z,1);break t}}v=x.createElement(m),pr(v,m,h),x.head.appendChild(v);break;case"meta":if(C=pA("meta","content",x).get(m+(h.content||""))){for(z=0;z<C.length;z++)if(v=C[z],v.getAttribute("content")===(h.content==null?null:""+h.content)&&v.getAttribute("name")===(h.name==null?null:h.name)&&v.getAttribute("property")===(h.property==null?null:h.property)&&v.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&v.getAttribute("charset")===(h.charSet==null?null:h.charSet)){C.splice(z,1);break t}}v=x.createElement(m),pr(v,m,h),x.head.appendChild(v);break;default:throw Error(r(468,m))}v[Gn]=a,rt(v),m=v}a.stateNode=m}else gA(x,a.type,a.stateNode);else a.stateNode=mA(x,m,a.memoizedProps);else v!==m?(v===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):v.count--,m===null?gA(x,a.type,a.stateNode):mA(x,m,a.memoizedProps)):m===null&&a.stateNode!==null&&H0(a,a.memoizedProps,h.memoizedProps)}break;case 27:zr(l,a),Ur(a),m&512&&(Yn||h===null||Ji(h,h.return)),h!==null&&m&4&&H0(a,a.memoizedProps,h.memoizedProps);break;case 5:if(zr(l,a),Ur(a),m&512&&(Yn||h===null||Ji(h,h.return)),a.flags&32){x=a.stateNode;try{ll(x,"")}catch(Ie){Bt(a,a.return,Ie)}}m&4&&a.stateNode!=null&&(x=a.memoizedProps,H0(a,x,h!==null?h.memoizedProps:x)),m&1024&&(Y0=!0);break;case 6:if(zr(l,a),Ur(a),m&4){if(a.stateNode===null)throw Error(r(162));m=a.memoizedProps,h=a.stateNode;try{h.nodeValue=m}catch(Ie){Bt(a,a.return,Ie)}}break;case 3:if(Uf=null,x=Gi,Gi=Lf(l.containerInfo),zr(l,a),Gi=x,Ur(a),m&4&&h!==null&&h.memoizedState.isDehydrated)try{zl(l.containerInfo)}catch(Ie){Bt(a,a.return,Ie)}Y0&&(Y0=!1,gS(a));break;case 4:m=Gi,Gi=Lf(a.stateNode.containerInfo),zr(l,a),Ur(a),Gi=m;break;case 12:zr(l,a),Ur(a);break;case 31:zr(l,a),Ur(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Af(a,m)));break;case 13:zr(l,a),Ur(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(kf=$e()),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Af(a,m)));break;case 22:x=a.memoizedState!==null;var Z=h!==null&&h.memoizedState!==null,le=Ps,fe=Yn;if(Ps=le||x,Yn=fe||Z,zr(l,a),Yn=fe,Ps=le,Ur(a),m&8192)e:for(l=a.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(h===null||Z||Ps||Yn||ho(a)),h=null,l=a;;){if(l.tag===5||l.tag===26){if(h===null){Z=h=l;try{if(v=Z.stateNode,x)C=v.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{z=Z.stateNode;var xe=Z.memoizedProps.style,ce=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;z.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Ie){Bt(Z,Z.return,Ie)}}}else if(l.tag===6){if(h===null){Z=l;try{Z.stateNode.nodeValue=x?"":Z.memoizedProps}catch(Ie){Bt(Z,Z.return,Ie)}}}else if(l.tag===18){if(h===null){Z=l;try{var he=Z.stateNode;x?sA(he,!0):sA(Z.stateNode,!1)}catch(Ie){Bt(Z,Z.return,Ie)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;h===l&&(h=null),l=l.return}h===l&&(h=null),l.sibling.return=l.return,l=l.sibling}m&4&&(m=a.updateQueue,m!==null&&(h=m.retryQueue,h!==null&&(m.retryQueue=null,Af(a,h))));break;case 19:zr(l,a),Ur(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Af(a,m)));break;case 30:break;case 21:break;default:zr(l,a),Ur(a)}}function Ur(a){var l=a.flags;if(l&2){try{for(var h,m=a.return;m!==null;){if(oS(m)){h=m;break}m=m.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var x=h.stateNode,v=V0(a);Sf(a,v,x);break;case 5:var C=h.stateNode;h.flags&32&&(ll(C,""),h.flags&=-33);var z=V0(a);Sf(a,z,C);break;case 3:case 4:var Z=h.stateNode.containerInfo,le=V0(a);W0(a,le,Z);break;default:throw Error(r(161))}}catch(fe){Bt(a,a.return,fe)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function gS(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;gS(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function js(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)uS(a,l.alternate,l),l=l.sibling}function ho(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:ca(4,l,l.return),ho(l);break;case 1:Ji(l,l.return);var h=l.stateNode;typeof h.componentWillUnmount=="function"&&sS(l,l.return,h),ho(l);break;case 27:Nu(l.stateNode);case 26:case 5:Ji(l,l.return),ho(l);break;case 22:l.memoizedState===null&&ho(l);break;case 30:ho(l);break;default:ho(l)}a=a.sibling}}function Bs(a,l,h){for(h=h&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var m=l.alternate,x=a,v=l,C=v.flags;switch(v.tag){case 0:case 11:case 15:Bs(x,v,h),vu(4,v);break;case 1:if(Bs(x,v,h),m=v,x=m.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(le){Bt(m,m.return,le)}if(m=v,x=m.updateQueue,x!==null){var z=m.stateNode;try{var Z=x.shared.hiddenCallbacks;if(Z!==null)for(x.shared.hiddenCallbacks=null,x=0;x<Z.length;x++)$_(Z[x],z)}catch(le){Bt(m,m.return,le)}}h&&C&64&&iS(v),_u(v,v.return);break;case 27:lS(v);case 26:case 5:Bs(x,v,h),h&&m===null&&C&4&&aS(v),_u(v,v.return);break;case 12:Bs(x,v,h);break;case 31:Bs(x,v,h),h&&C&4&&fS(x,v);break;case 13:Bs(x,v,h),h&&C&4&&mS(x,v);break;case 22:v.memoizedState===null&&Bs(x,v,h),_u(v,v.return);break;case 30:break;default:Bs(x,v,h)}l=l.sibling}}function $0(a,l){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&ou(h))}function q0(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&ou(a))}function Hi(a,l,h,m){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)yS(a,l,h,m),l=l.sibling}function yS(a,l,h,m){var x=l.flags;switch(l.tag){case 0:case 11:case 15:Hi(a,l,h,m),x&2048&&vu(9,l);break;case 1:Hi(a,l,h,m);break;case 3:Hi(a,l,h,m),x&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&ou(a)));break;case 12:if(x&2048){Hi(a,l,h,m),a=l.stateNode;try{var v=l.memoizedProps,C=v.id,z=v.onPostCommit;typeof z=="function"&&z(C,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(Z){Bt(l,l.return,Z)}}else Hi(a,l,h,m);break;case 31:Hi(a,l,h,m);break;case 13:Hi(a,l,h,m);break;case 23:break;case 22:v=l.stateNode,C=l.alternate,l.memoizedState!==null?v._visibility&2?Hi(a,l,h,m):wu(a,l):v._visibility&2?Hi(a,l,h,m):(v._visibility|=2,El(a,l,h,m,(l.subtreeFlags&10256)!==0||!1)),x&2048&&$0(C,l);break;case 24:Hi(a,l,h,m),x&2048&&q0(l.alternate,l);break;default:Hi(a,l,h,m)}}function El(a,l,h,m,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var v=a,C=l,z=h,Z=m,le=C.flags;switch(C.tag){case 0:case 11:case 15:El(v,C,z,Z,x),vu(8,C);break;case 23:break;case 22:var fe=C.stateNode;C.memoizedState!==null?fe._visibility&2?El(v,C,z,Z,x):wu(v,C):(fe._visibility|=2,El(v,C,z,Z,x)),x&&le&2048&&$0(C.alternate,C);break;case 24:El(v,C,z,Z,x),x&&le&2048&&q0(C.alternate,C);break;default:El(v,C,z,Z,x)}l=l.sibling}}function wu(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var h=a,m=l,x=m.flags;switch(m.tag){case 22:wu(h,m),x&2048&&$0(m.alternate,m);break;case 24:wu(h,m),x&2048&&q0(m.alternate,m);break;default:wu(h,m)}l=l.sibling}}var Su=8192;function Ml(a,l,h){if(a.subtreeFlags&Su)for(a=a.child;a!==null;)bS(a,l,h),a=a.sibling}function bS(a,l,h){switch(a.tag){case 26:Ml(a,l,h),a.flags&Su&&a.memoizedState!==null&&qD(h,Gi,a.memoizedState,a.memoizedProps);break;case 5:Ml(a,l,h);break;case 3:case 4:var m=Gi;Gi=Lf(a.stateNode.containerInfo),Ml(a,l,h),Gi=m;break;case 22:a.memoizedState===null&&(m=a.alternate,m!==null&&m.memoizedState!==null?(m=Su,Su=16777216,Ml(a,l,h),Su=m):Ml(a,l,h));break;default:Ml(a,l,h)}}function xS(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function Au(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var m=l[h];rr=m,_S(m,a)}xS(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)vS(a),a=a.sibling}function vS(a){switch(a.tag){case 0:case 11:case 15:Au(a),a.flags&2048&&ca(9,a,a.return);break;case 3:Au(a);break;case 12:Au(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,Cf(a)):Au(a);break;default:Au(a)}}function Cf(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var m=l[h];rr=m,_S(m,a)}xS(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:ca(8,l,l.return),Cf(l);break;case 22:h=l.stateNode,h._visibility&2&&(h._visibility&=-3,Cf(l));break;default:Cf(l)}a=a.sibling}}function _S(a,l){for(;rr!==null;){var h=rr;switch(h.tag){case 0:case 11:case 15:ca(8,h,l);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var m=h.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:ou(h.memoizedState.cache)}if(m=h.child,m!==null)m.return=h,rr=m;else e:for(h=a;rr!==null;){m=rr;var x=m.sibling,v=m.return;if(hS(m),m===h){rr=null;break e}if(x!==null){x.return=v,rr=x;break e}rr=v}}}var cD={getCacheForType:function(a){var l=fr(Hn),h=l.data.get(a);return h===void 0&&(h=a(),l.data.set(a,h)),h},cacheSignal:function(){return fr(Hn).controller.signal}},uD=typeof WeakMap=="function"?WeakMap:Map,Tt=0,qt=null,at=null,ut=0,jt=0,ii=null,ua=!1,Nl=!1,Z0=!1,Os=0,En=0,ha=0,fo=0,X0=0,si=0,Il=0,Cu=null,Fr=null,K0=!1,kf=0,wS=0,Tf=1/0,Ef=null,da=null,er=0,fa=null,Rl=null,Ls=0,Q0=0,J0=null,SS=null,ku=0,ey=null;function ai(){return(Tt&2)!==0&&ut!==0?ut&-ut:N.T!==null?ay():Yc()}function AS(){if(si===0)if((ut&536870912)===0||gt){var a=xs;xs<<=1,(xs&3932160)===0&&(xs=262144),si=a}else si=536870912;return a=ni.current,a!==null&&(a.flags|=32),si}function Gr(a,l,h){(a===qt&&(jt===2||jt===9)||a.cancelPendingCommit!==null)&&(Pl(a,0),ma(a,ut,si,!1)),Qs(a,h),((Tt&2)===0||a!==qt)&&(a===qt&&((Tt&2)===0&&(fo|=h),En===4&&ma(a,ut,si,!1)),es(a))}function CS(a,l,h){if((Tt&6)!==0)throw Error(r(327));var m=!h&&(l&127)===0&&(l&a.expiredLanes)===0||Xa(a,l),x=m?fD(a,l):ny(a,l,!0),v=m;do{if(x===0){Nl&&!m&&ma(a,l,0,!1);break}else{if(h=a.current.alternate,v&&!hD(h)){x=ny(a,l,!1),v=!1;continue}if(x===2){if(v=l,a.errorRecoveryDisabledLanes&v)var C=0;else C=a.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){l=C;e:{var z=a;x=Cu;var Z=z.current.memoizedState.isDehydrated;if(Z&&(Pl(z,C).flags|=256),C=ny(z,C,!1),C!==2){if(Z0&&!Z){z.errorRecoveryDisabledLanes|=v,fo|=v,x=4;break e}v=Fr,Fr=x,v!==null&&(Fr===null?Fr=v:Fr.push.apply(Fr,v))}x=C}if(v=!1,x!==2)continue}}if(x===1){Pl(a,0),ma(a,l,0,!0);break}e:{switch(m=a,v=x,v){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:ma(m,l,si,!ua);break e;case 2:Fr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=kf+300-$e(),10<x)){if(ma(m,l,si,!ua),sl(m,0,!0)!==0)break e;Ls=l,m.timeoutHandle=nA(kS.bind(null,m,h,Fr,Ef,K0,l,si,fo,Il,ua,v,"Throttled",-0,0),x);break e}kS(m,h,Fr,Ef,K0,l,si,fo,Il,ua,v,null,-0,0)}}break}while(!0);es(a)}function kS(a,l,h,m,x,v,C,z,Z,le,fe,xe,ce,he){if(a.timeoutHandle=-1,xe=l.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ss},bS(l,v,xe);var Ie=(v&62914560)===v?kf-$e():(v&4194048)===v?wS-$e():0;if(Ie=ZD(xe,Ie),Ie!==null){Ls=v,a.cancelPendingCommit=Ie(DS.bind(null,a,l,v,h,m,x,C,z,Z,fe,xe,null,ce,he)),ma(a,v,C,!le);return}}DS(a,l,v,h,m,x,C,z,Z)}function hD(a){for(var l=a;;){var h=l.tag;if((h===0||h===11||h===15)&&l.flags&16384&&(h=l.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var m=0;m<h.length;m++){var x=h[m],v=x.getSnapshot;x=x.value;try{if(!ei(v(),x))return!1}catch{return!1}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ma(a,l,h,m){l&=~X0,l&=~fo,a.suspendedLanes|=l,a.pingedLanes&=~l,m&&(a.warmLanes|=l),m=a.expirationTimes;for(var x=l;0<x;){var v=31-vt(x),C=1<<v;m[v]=-1,x&=~C}h!==0&&Vc(a,h,l)}function Mf(){return(Tt&6)===0?(Tu(0),!1):!0}function ty(){if(at!==null){if(jt===0)var a=at.return;else a=at,Ts=ro=null,y0(a),Sl=null,cu=0,a=at;for(;a!==null;)rS(a.alternate,a),a=a.return;at=null}}function Pl(a,l){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,ID(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),Ls=0,ty(),qt=a,at=h=Cs(a.current,null),ut=l,jt=0,ii=null,ua=!1,Nl=Xa(a,l),Z0=!1,Il=si=X0=fo=ha=En=0,Fr=Cu=null,K0=!1,(l&8)!==0&&(l|=l&32);var m=a.entangledLanes;if(m!==0)for(a=a.entanglements,m&=l;0<m;){var x=31-vt(m),v=1<<x;l|=a[x],m&=~v}return Os=l,Zd(),h}function TS(a,l){Xe=null,N.H=yu,l===wl||l===rf?(l=H_(),jt=3):l===s0?(l=H_(),jt=4):jt=l===P0?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,ii=l,at===null&&(En=1,bf(a,Si(l,a.current)))}function ES(){var a=ni.current;return a===null?!0:(ut&4194048)===ut?Ti===null:(ut&62914560)===ut||(ut&536870912)!==0?a===Ti:!1}function MS(){var a=N.H;return N.H=yu,a===null?yu:a}function NS(){var a=N.A;return N.A=cD,a}function Nf(){En=4,ua||(ut&4194048)!==ut&&ni.current!==null||(Nl=!0),(ha&134217727)===0&&(fo&134217727)===0||qt===null||ma(qt,ut,si,!1)}function ny(a,l,h){var m=Tt;Tt|=2;var x=MS(),v=NS();(qt!==a||ut!==l)&&(Ef=null,Pl(a,l)),l=!1;var C=En;e:do try{if(jt!==0&&at!==null){var z=at,Z=ii;switch(jt){case 8:ty(),C=6;break e;case 3:case 2:case 9:case 6:ni.current===null&&(l=!0);var le=jt;if(jt=0,ii=null,Dl(a,z,Z,le),h&&Nl){C=0;break e}break;default:le=jt,jt=0,ii=null,Dl(a,z,Z,le)}}dD(),C=En;break}catch(fe){TS(a,fe)}while(!0);return l&&a.shellSuspendCounter++,Ts=ro=null,Tt=m,N.H=x,N.A=v,at===null&&(qt=null,ut=0,Zd()),C}function dD(){for(;at!==null;)IS(at)}function fD(a,l){var h=Tt;Tt|=2;var m=MS(),x=NS();qt!==a||ut!==l?(Ef=null,Tf=$e()+500,Pl(a,l)):Nl=Xa(a,l);e:do try{if(jt!==0&&at!==null){l=at;var v=ii;t:switch(jt){case 1:jt=0,ii=null,Dl(a,l,v,1);break;case 2:case 9:if(F_(v)){jt=0,ii=null,RS(l);break}l=function(){jt!==2&&jt!==9||qt!==a||(jt=7),es(a)},v.then(l,l);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:F_(v)?(jt=0,ii=null,RS(l)):(jt=0,ii=null,Dl(a,l,v,7));break;case 5:var C=null;switch(at.tag){case 26:C=at.memoizedState;case 5:case 27:var z=at;if(C?yA(C):z.stateNode.complete){jt=0,ii=null;var Z=z.sibling;if(Z!==null)at=Z;else{var le=z.return;le!==null?(at=le,If(le)):at=null}break t}}jt=0,ii=null,Dl(a,l,v,5);break;case 6:jt=0,ii=null,Dl(a,l,v,6);break;case 8:ty(),En=6;break e;default:throw Error(r(462))}}mD();break}catch(fe){TS(a,fe)}while(!0);return Ts=ro=null,N.H=m,N.A=x,Tt=h,at!==null?0:(qt=null,ut=0,Zd(),En)}function mD(){for(;at!==null&&!nt();)IS(at)}function IS(a){var l=tS(a.alternate,a,Os);a.memoizedProps=a.pendingProps,l===null?If(a):at=l}function RS(a){var l=a,h=l.alternate;switch(l.tag){case 15:case 0:l=Zw(h,l,l.pendingProps,l.type,void 0,ut);break;case 11:l=Zw(h,l,l.pendingProps,l.type.render,l.ref,ut);break;case 5:y0(l);default:rS(h,l),l=at=N_(l,Os),l=tS(h,l,Os)}a.memoizedProps=a.pendingProps,l===null?If(a):at=l}function Dl(a,l,h,m){Ts=ro=null,y0(l),Sl=null,cu=0;var x=l.return;try{if(nD(a,x,l,h,ut)){En=1,bf(a,Si(h,a.current)),at=null;return}}catch(v){if(x!==null)throw at=x,v;En=1,bf(a,Si(h,a.current)),at=null;return}l.flags&32768?(gt||m===1?a=!0:Nl||(ut&536870912)!==0?a=!1:(ua=a=!0,(m===2||m===9||m===3||m===6)&&(m=ni.current,m!==null&&m.tag===13&&(m.flags|=16384))),PS(l,a)):If(l)}function If(a){var l=a;do{if((l.flags&32768)!==0){PS(l,ua);return}a=l.return;var h=sD(l.alternate,l,Os);if(h!==null){at=h;return}if(l=l.sibling,l!==null){at=l;return}at=l=a}while(l!==null);En===0&&(En=5)}function PS(a,l){do{var h=aD(a.alternate,a);if(h!==null){h.flags&=32767,at=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!l&&(a=a.sibling,a!==null)){at=a;return}at=a=h}while(a!==null);En=6,at=null}function DS(a,l,h,m,x,v,C,z,Z){a.cancelPendingCommit=null;do Rf();while(er!==0);if((Tt&6)!==0)throw Error(r(327));if(l!==null){if(l===a.current)throw Error(r(177));if(v=l.lanes|l.childLanes,v|=Vg,Hc(a,h,v,C,z,Z),a===qt&&(at=qt=null,ut=0),Rl=l,fa=a,Ls=h,Q0=v,J0=x,SS=m,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,bD(Oe,function(){return zS(),null})):(a.callbackNode=null,a.callbackPriority=0),m=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||m){m=N.T,N.T=null,x=V.p,V.p=2,C=Tt,Tt|=4;try{oD(a,l,h)}finally{Tt=C,V.p=x,N.T=m}}er=1,jS(),BS(),OS()}}function jS(){if(er===1){er=0;var a=fa,l=Rl,h=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||h){h=N.T,N.T=null;var m=V.p;V.p=2;var x=Tt;Tt|=4;try{pS(l,a);var v=my,C=__(a.containerInfo),z=v.focusedElem,Z=v.selectionRange;if(C!==z&&z&&z.ownerDocument&&v_(z.ownerDocument.documentElement,z)){if(Z!==null&&zg(z)){var le=Z.start,fe=Z.end;if(fe===void 0&&(fe=le),"selectionStart"in z)z.selectionStart=le,z.selectionEnd=Math.min(fe,z.value.length);else{var xe=z.ownerDocument||document,ce=xe&&xe.defaultView||window;if(ce.getSelection){var he=ce.getSelection(),Ie=z.textContent.length,Fe=Math.min(Z.start,Ie),Gt=Z.end===void 0?Fe:Math.min(Z.end,Ie);!he.extend&&Fe>Gt&&(C=Gt,Gt=Fe,Fe=C);var ne=x_(z,Fe),Q=x_(z,Gt);if(ne&&Q&&(he.rangeCount!==1||he.anchorNode!==ne.node||he.anchorOffset!==ne.offset||he.focusNode!==Q.node||he.focusOffset!==Q.offset)){var oe=xe.createRange();oe.setStart(ne.node,ne.offset),he.removeAllRanges(),Fe>Gt?(he.addRange(oe),he.extend(Q.node,Q.offset)):(oe.setEnd(Q.node,Q.offset),he.addRange(oe))}}}}for(xe=[],he=z;he=he.parentNode;)he.nodeType===1&&xe.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<xe.length;z++){var be=xe[z];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}Vf=!!fy,my=fy=null}finally{Tt=x,V.p=m,N.T=h}}a.current=l,er=2}}function BS(){if(er===2){er=0;var a=fa,l=Rl,h=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||h){h=N.T,N.T=null;var m=V.p;V.p=2;var x=Tt;Tt|=4;try{uS(a,l.alternate,l)}finally{Tt=x,V.p=m,N.T=h}}er=3}}function OS(){if(er===4||er===3){er=0,wt();var a=fa,l=Rl,h=Ls,m=SS;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?er=5:(er=0,Rl=fa=null,LS(a,a.pendingLanes));var x=a.pendingLanes;if(x===0&&(da=null),Ui(h),l=l.stateNode,hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(Un,l,void 0,(l.current.flags&128)===128)}catch{}if(m!==null){l=N.T,x=V.p,V.p=2,N.T=null;try{for(var v=a.onRecoverableError,C=0;C<m.length;C++){var z=m[C];v(z.value,{componentStack:z.stack})}}finally{N.T=l,V.p=x}}(Ls&3)!==0&&Rf(),es(a),x=a.pendingLanes,(h&261930)!==0&&(x&42)!==0?a===ey?ku++:(ku=0,ey=a):ku=0,Tu(0)}}function LS(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,ou(l)))}function Rf(){return jS(),BS(),OS(),zS()}function zS(){if(er!==5)return!1;var a=fa,l=Q0;Q0=0;var h=Ui(Ls),m=N.T,x=V.p;try{V.p=32>h?32:h,N.T=null,h=J0,J0=null;var v=fa,C=Ls;if(er=0,Rl=fa=null,Ls=0,(Tt&6)!==0)throw Error(r(331));var z=Tt;if(Tt|=4,vS(v.current),yS(v,v.current,C,h),Tt=z,Tu(0,!1),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(Un,v)}catch{}return!0}finally{V.p=x,N.T=m,LS(a,l)}}function US(a,l,h){l=Si(h,l),l=R0(a.stateNode,l,2),a=aa(a,l,2),a!==null&&(Qs(a,2),es(a))}function Bt(a,l,h){if(a.tag===3)US(a,a,h);else for(;l!==null;){if(l.tag===3){US(l,a,h);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(da===null||!da.has(m))){a=Si(h,a),h=Fw(2),m=aa(l,h,2),m!==null&&(Gw(h,m,l,a),Qs(m,2),es(m));break}}l=l.return}}function ry(a,l,h){var m=a.pingCache;if(m===null){m=a.pingCache=new uD;var x=new Set;m.set(l,x)}else x=m.get(l),x===void 0&&(x=new Set,m.set(l,x));x.has(h)||(Z0=!0,x.add(h),a=pD.bind(null,a,l,h),l.then(a,a))}function pD(a,l,h){var m=a.pingCache;m!==null&&m.delete(l),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,qt===a&&(ut&h)===h&&(En===4||En===3&&(ut&62914560)===ut&&300>$e()-kf?(Tt&2)===0&&Pl(a,0):X0|=h,Il===ut&&(Il=0)),es(a)}function FS(a,l){l===0&&(l=vs()),a=eo(a,l),a!==null&&(Qs(a,l),es(a))}function gD(a){var l=a.memoizedState,h=0;l!==null&&(h=l.retryLane),FS(a,h)}function yD(a,l){var h=0;switch(a.tag){case 31:case 13:var m=a.stateNode,x=a.memoizedState;x!==null&&(h=x.retryLane);break;case 19:m=a.stateNode;break;case 22:m=a.stateNode._retryCache;break;default:throw Error(r(314))}m!==null&&m.delete(l),FS(a,h)}function bD(a,l){return Kn(a,l)}var Pf=null,jl=null,iy=!1,Df=!1,sy=!1,pa=0;function es(a){a!==jl&&a.next===null&&(jl===null?Pf=jl=a:jl=jl.next=a),Df=!0,iy||(iy=!0,vD())}function Tu(a,l){if(!sy&&Df){sy=!0;do for(var h=!1,m=Pf;m!==null;){if(a!==0){var x=m.pendingLanes;if(x===0)var v=0;else{var C=m.suspendedLanes,z=m.pingedLanes;v=(1<<31-vt(42|a)+1)-1,v&=x&~(C&~z),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(h=!0,WS(m,v))}else v=ut,v=sl(m,m===qt?v:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(v&3)===0||Xa(m,v)||(h=!0,WS(m,v));m=m.next}while(h);sy=!1}}function xD(){GS()}function GS(){Df=iy=!1;var a=0;pa!==0&&ND()&&(a=pa);for(var l=$e(),h=null,m=Pf;m!==null;){var x=m.next,v=HS(m,l);v===0?(m.next=null,h===null?Pf=x:h.next=x,x===null&&(jl=h)):(h=m,(a!==0||(v&3)!==0)&&(Df=!0)),m=x}er!==0&&er!==5||Tu(a),pa!==0&&(pa=0)}function HS(a,l){for(var h=a.suspendedLanes,m=a.pingedLanes,x=a.expirationTimes,v=a.pendingLanes&-62914561;0<v;){var C=31-vt(v),z=1<<C,Z=x[C];Z===-1?((z&h)===0||(z&m)!==0)&&(x[C]=Fn(z,l)):Z<=l&&(a.expiredLanes|=z),v&=~z}if(l=qt,h=ut,h=sl(a,a===l?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m=a.callbackNode,h===0||a===l&&(jt===2||jt===9)||a.cancelPendingCommit!==null)return m!==null&&m!==null&&ke(m),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||Xa(a,h)){if(l=h&-h,l===a.callbackPriority)return l;switch(m!==null&&ke(m),Ui(h)){case 2:case 8:h=we;break;case 32:h=Oe;break;case 268435456:h=pt;break;default:h=Oe}return m=VS.bind(null,a),h=Kn(h,m),a.callbackPriority=l,a.callbackNode=h,l}return m!==null&&m!==null&&ke(m),a.callbackPriority=2,a.callbackNode=null,2}function VS(a,l){if(er!==0&&er!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(Rf()&&a.callbackNode!==h)return null;var m=ut;return m=sl(a,a===qt?m:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m===0?null:(CS(a,m,l),HS(a,$e()),a.callbackNode!=null&&a.callbackNode===h?VS.bind(null,a):null)}function WS(a,l){if(Rf())return null;CS(a,l,!0)}function vD(){RD(function(){(Tt&6)!==0?Kn(de,xD):GS()})}function ay(){if(pa===0){var a=vl;a===0&&(a=bs,bs<<=1,(bs&261888)===0&&(bs=256)),pa=a}return pa}function YS(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Fd(""+a)}function $S(a,l){var h=l.ownerDocument.createElement("input");return h.name=l.name,h.value=l.value,a.id&&h.setAttribute("form",a.id),l.parentNode.insertBefore(h,l),a=new FormData(a),h.parentNode.removeChild(h),a}function _D(a,l,h,m,x){if(l==="submit"&&h&&h.stateNode===x){var v=YS((x[fn]||null).action),C=m.submitter;C&&(l=(l=C[fn]||null)?YS(l.formAction):C.getAttribute("formAction"),l!==null&&(v=l,C=null));var z=new Wd("action","action",null,m,x);a.push({event:z,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(pa!==0){var Z=C?$S(x,C):new FormData(x);k0(h,{pending:!0,data:Z,method:x.method,action:v},null,Z)}}else typeof v=="function"&&(z.preventDefault(),Z=C?$S(x,C):new FormData(x),k0(h,{pending:!0,data:Z,method:x.method,action:v},v,Z))},currentTarget:x}]})}}for(var oy=0;oy<Hg.length;oy++){var ly=Hg[oy],wD=ly.toLowerCase(),SD=ly[0].toUpperCase()+ly.slice(1);Fi(wD,"on"+SD)}Fi(A_,"onAnimationEnd"),Fi(C_,"onAnimationIteration"),Fi(k_,"onAnimationStart"),Fi("dblclick","onDoubleClick"),Fi("focusin","onFocus"),Fi("focusout","onBlur"),Fi(z6,"onTransitionRun"),Fi(U6,"onTransitionStart"),Fi(F6,"onTransitionCancel"),Fi(T_,"onTransitionEnd"),Xi("onMouseEnter",["mouseout","mouseover"]),Xi("onMouseLeave",["mouseout","mouseover"]),Xi("onPointerEnter",["pointerout","pointerover"]),Xi("onPointerLeave",["pointerout","pointerover"]),Br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Br("onBeforeInput",["compositionend","keypress","textInput","paste"]),Br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Eu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Eu));function qS(a,l){l=(l&4)!==0;for(var h=0;h<a.length;h++){var m=a[h],x=m.event;m=m.listeners;e:{var v=void 0;if(l)for(var C=m.length-1;0<=C;C--){var z=m[C],Z=z.instance,le=z.currentTarget;if(z=z.listener,Z!==v&&x.isPropagationStopped())break e;v=z,x.currentTarget=le;try{v(x)}catch(fe){qd(fe)}x.currentTarget=null,v=Z}else for(C=0;C<m.length;C++){if(z=m[C],Z=z.instance,le=z.currentTarget,z=z.listener,Z!==v&&x.isPropagationStopped())break e;v=z,x.currentTarget=le;try{v(x)}catch(fe){qd(fe)}x.currentTarget=null,v=Z}}}}function ot(a,l){var h=l[al];h===void 0&&(h=l[al]=new Set);var m=a+"__bubble";h.has(m)||(ZS(l,a,2,!1),h.add(m))}function cy(a,l,h){var m=0;l&&(m|=4),ZS(h,a,m,l)}var jf="_reactListening"+Math.random().toString(36).slice(2);function uy(a){if(!a[jf]){a[jf]=!0,hr.forEach(function(h){h!=="selectionchange"&&(AD.has(h)||cy(h,!1,a),cy(h,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[jf]||(l[jf]=!0,cy("selectionchange",!1,l))}}function ZS(a,l,h,m){switch(AA(l)){case 2:var x=QD;break;case 8:x=JD;break;default:x=Cy}h=x.bind(null,l,h,a),x=void 0,!Ng||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),m?x!==void 0?a.addEventListener(l,h,{capture:!0,passive:x}):a.addEventListener(l,h,!0):x!==void 0?a.addEventListener(l,h,{passive:x}):a.addEventListener(l,h,!1)}function hy(a,l,h,m,x){var v=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var C=m.tag;if(C===3||C===4){var z=m.stateNode.containerInfo;if(z===x)break;if(C===4)for(C=m.return;C!==null;){var Z=C.tag;if((Z===3||Z===4)&&C.stateNode.containerInfo===x)return;C=C.return}for(;z!==null;){if(C=_e(z),C===null)return;if(Z=C.tag,Z===5||Z===6||Z===26||Z===27){m=v=C;continue e}z=z.parentNode}}m=m.return}e_(function(){var le=v,fe=Eg(h),xe=[];e:{var ce=E_.get(a);if(ce!==void 0){var he=Wd,Ie=a;switch(a){case"keypress":if(Hd(h)===0)break e;case"keydown":case"keyup":he=y6;break;case"focusin":Ie="focus",he=Dg;break;case"focusout":Ie="blur",he=Dg;break;case"beforeblur":case"afterblur":he=Dg;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=r_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=s6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=v6;break;case A_:case C_:case k_:he=l6;break;case T_:he=w6;break;case"scroll":case"scrollend":he=r6;break;case"wheel":he=A6;break;case"copy":case"cut":case"paste":he=u6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=s_;break;case"toggle":case"beforetoggle":he=k6}var Fe=(l&4)!==0,Gt=!Fe&&(a==="scroll"||a==="scrollend"),ne=Fe?ce!==null?ce+"Capture":null:ce;Fe=[];for(var Q=le,oe;Q!==null;){var be=Q;if(oe=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||oe===null||ne===null||(be=Xc(Q,ne),be!=null&&Fe.push(Mu(Q,be,oe))),Gt)break;Q=Q.return}0<Fe.length&&(ce=new he(ce,Ie,null,h,fe),xe.push({event:ce,listeners:Fe}))}}if((l&7)===0){e:{if(ce=a==="mouseover"||a==="pointerover",he=a==="mouseout"||a==="pointerout",ce&&h!==Tg&&(Ie=h.relatedTarget||h.fromElement)&&(_e(Ie)||Ie[_s]))break e;if((he||ce)&&(ce=fe.window===fe?fe:(ce=fe.ownerDocument)?ce.defaultView||ce.parentWindow:window,he?(Ie=h.relatedTarget||h.toElement,he=le,Ie=Ie?_e(Ie):null,Ie!==null&&(Gt=s(Ie),Fe=Ie.tag,Ie!==Gt||Fe!==5&&Fe!==27&&Fe!==6)&&(Ie=null)):(he=null,Ie=le),he!==Ie)){if(Fe=r_,be="onMouseLeave",ne="onMouseEnter",Q="mouse",(a==="pointerout"||a==="pointerover")&&(Fe=s_,be="onPointerLeave",ne="onPointerEnter",Q="pointer"),Gt=he==null?ce:Rt(he),oe=Ie==null?ce:Rt(Ie),ce=new Fe(be,Q+"leave",he,h,fe),ce.target=Gt,ce.relatedTarget=oe,be=null,_e(fe)===le&&(Fe=new Fe(ne,Q+"enter",Ie,h,fe),Fe.target=oe,Fe.relatedTarget=Gt,be=Fe),Gt=be,he&&Ie)t:{for(Fe=CD,ne=he,Q=Ie,oe=0,be=ne;be;be=Fe(be))oe++;be=0;for(var ze=Q;ze;ze=Fe(ze))be++;for(;0<oe-be;)ne=Fe(ne),oe--;for(;0<be-oe;)Q=Fe(Q),be--;for(;oe--;){if(ne===Q||Q!==null&&ne===Q.alternate){Fe=ne;break t}ne=Fe(ne),Q=Fe(Q)}Fe=null}else Fe=null;he!==null&&XS(xe,ce,he,Fe,!1),Ie!==null&&Gt!==null&&XS(xe,Gt,Ie,Fe,!0)}}e:{if(ce=le?Rt(le):window,he=ce.nodeName&&ce.nodeName.toLowerCase(),he==="select"||he==="input"&&ce.type==="file")var At=f_;else if(h_(ce))if(m_)At=B6;else{At=D6;var De=P6}else he=ce.nodeName,!he||he.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?le&&kg(le.elementType)&&(At=f_):At=j6;if(At&&(At=At(a,le))){d_(xe,At,h,fe);break e}De&&De(a,ce,le),a==="focusout"&&le&&ce.type==="number"&&le.memoizedProps.value!=null&&Cg(ce,"number",ce.value)}switch(De=le?Rt(le):window,a){case"focusin":(h_(De)||De.contentEditable==="true")&&(dl=De,Ug=le,iu=null);break;case"focusout":iu=Ug=dl=null;break;case"mousedown":Fg=!0;break;case"contextmenu":case"mouseup":case"dragend":Fg=!1,w_(xe,h,fe);break;case"selectionchange":if(L6)break;case"keydown":case"keyup":w_(xe,h,fe)}var Ke;if(Bg)e:{switch(a){case"compositionstart":var ht="onCompositionStart";break e;case"compositionend":ht="onCompositionEnd";break e;case"compositionupdate":ht="onCompositionUpdate";break e}ht=void 0}else hl?c_(a,h)&&(ht="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(ht="onCompositionStart");ht&&(a_&&h.locale!=="ko"&&(hl||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&hl&&(Ke=t_()):(Js=fe,Ig="value"in Js?Js.value:Js.textContent,hl=!0)),De=Bf(le,ht),0<De.length&&(ht=new i_(ht,a,null,h,fe),xe.push({event:ht,listeners:De}),Ke?ht.data=Ke:(Ke=u_(h),Ke!==null&&(ht.data=Ke)))),(Ke=E6?M6(a,h):N6(a,h))&&(ht=Bf(le,"onBeforeInput"),0<ht.length&&(De=new i_("onBeforeInput","beforeinput",null,h,fe),xe.push({event:De,listeners:ht}),De.data=Ke)),_D(xe,a,le,h,fe)}qS(xe,l)})}function Mu(a,l,h){return{instance:a,listener:l,currentTarget:h}}function Bf(a,l){for(var h=l+"Capture",m=[];a!==null;){var x=a,v=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||v===null||(x=Xc(a,h),x!=null&&m.unshift(Mu(a,x,v)),x=Xc(a,l),x!=null&&m.push(Mu(a,x,v))),a.tag===3)return m;a=a.return}return[]}function CD(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function XS(a,l,h,m,x){for(var v=l._reactName,C=[];h!==null&&h!==m;){var z=h,Z=z.alternate,le=z.stateNode;if(z=z.tag,Z!==null&&Z===m)break;z!==5&&z!==26&&z!==27||le===null||(Z=le,x?(le=Xc(h,v),le!=null&&C.unshift(Mu(h,le,Z))):x||(le=Xc(h,v),le!=null&&C.push(Mu(h,le,Z)))),h=h.return}C.length!==0&&a.push({event:l,listeners:C})}var kD=/\r\n?/g,TD=/\u0000|\uFFFD/g;function KS(a){return(typeof a=="string"?a:""+a).replace(kD,`
`).replace(TD,"")}function QS(a,l){return l=KS(l),KS(a)===l}function Ft(a,l,h,m,x,v){switch(h){case"children":typeof m=="string"?l==="body"||l==="textarea"&&m===""||ll(a,m):(typeof m=="number"||typeof m=="bigint")&&l!=="body"&&ll(a,""+m);break;case"className":zd(a,"class",m);break;case"tabIndex":zd(a,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":zd(a,h,m);break;case"style":Qv(a,m,v);break;case"data":if(l!=="object"){zd(a,"data",m);break}case"src":case"href":if(m===""&&(l!=="a"||h!=="href")){a.removeAttribute(h);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(h);break}m=Fd(""+m),a.setAttribute(h,m);break;case"action":case"formAction":if(typeof m=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(h==="formAction"?(l!=="input"&&Ft(a,l,"name",x.name,x,null),Ft(a,l,"formEncType",x.formEncType,x,null),Ft(a,l,"formMethod",x.formMethod,x,null),Ft(a,l,"formTarget",x.formTarget,x,null)):(Ft(a,l,"encType",x.encType,x,null),Ft(a,l,"method",x.method,x,null),Ft(a,l,"target",x.target,x,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(h);break}m=Fd(""+m),a.setAttribute(h,m);break;case"onClick":m!=null&&(a.onclick=Ss);break;case"onScroll":m!=null&&ot("scroll",a);break;case"onScrollEnd":m!=null&&ot("scrollend",a);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(h=m.__html,h!=null){if(x.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"multiple":a.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":a.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){a.removeAttribute("xlink:href");break}h=Fd(""+m),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(h,""+m):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":m===!0?a.setAttribute(h,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(h,m):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?a.setAttribute(h,m):a.removeAttribute(h);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?a.removeAttribute(h):a.setAttribute(h,m);break;case"popover":ot("beforetoggle",a),ot("toggle",a),Ld(a,"popover",m);break;case"xlinkActuate":ws(a,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":ws(a,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":ws(a,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":ws(a,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":ws(a,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":ws(a,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":ws(a,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":ws(a,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":ws(a,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Ld(a,"is",m);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=t6.get(h)||h,Ld(a,h,m))}}function dy(a,l,h,m,x,v){switch(h){case"style":Qv(a,m,v);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(h=m.__html,h!=null){if(x.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"children":typeof m=="string"?ll(a,m):(typeof m=="number"||typeof m=="bigint")&&ll(a,""+m);break;case"onScroll":m!=null&&ot("scroll",a);break;case"onScrollEnd":m!=null&&ot("scrollend",a);break;case"onClick":m!=null&&(a.onclick=Ss);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xi.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(x=h.endsWith("Capture"),l=h.slice(2,x?h.length-7:void 0),v=a[fn]||null,v=v!=null?v[h]:null,typeof v=="function"&&a.removeEventListener(l,v,x),typeof m=="function")){typeof v!="function"&&v!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(l,m,x);break e}h in a?a[h]=m:m===!0?a.setAttribute(h,""):Ld(a,h,m)}}}function pr(a,l,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ot("error",a),ot("load",a);var m=!1,x=!1,v;for(v in h)if(h.hasOwnProperty(v)){var C=h[v];if(C!=null)switch(v){case"src":m=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Ft(a,l,v,C,h,null)}}x&&Ft(a,l,"srcSet",h.srcSet,h,null),m&&Ft(a,l,"src",h.src,h,null);return;case"input":ot("invalid",a);var z=v=C=x=null,Z=null,le=null;for(m in h)if(h.hasOwnProperty(m)){var fe=h[m];if(fe!=null)switch(m){case"name":x=fe;break;case"type":C=fe;break;case"checked":Z=fe;break;case"defaultChecked":le=fe;break;case"value":v=fe;break;case"defaultValue":z=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,l));break;default:Ft(a,l,m,fe,h,null)}}qv(a,v,z,Z,le,C,x,!1);return;case"select":ot("invalid",a),m=C=v=null;for(x in h)if(h.hasOwnProperty(x)&&(z=h[x],z!=null))switch(x){case"value":v=z;break;case"defaultValue":C=z;break;case"multiple":m=z;default:Ft(a,l,x,z,h,null)}l=v,h=C,a.multiple=!!m,l!=null?ol(a,!!m,l,!1):h!=null&&ol(a,!!m,h,!0);return;case"textarea":ot("invalid",a),v=x=m=null;for(C in h)if(h.hasOwnProperty(C)&&(z=h[C],z!=null))switch(C){case"value":m=z;break;case"defaultValue":x=z;break;case"children":v=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(r(91));break;default:Ft(a,l,C,z,h,null)}Xv(a,m,x,v);return;case"option":for(Z in h)if(h.hasOwnProperty(Z)&&(m=h[Z],m!=null))switch(Z){case"selected":a.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Ft(a,l,Z,m,h,null)}return;case"dialog":ot("beforetoggle",a),ot("toggle",a),ot("cancel",a),ot("close",a);break;case"iframe":case"object":ot("load",a);break;case"video":case"audio":for(m=0;m<Eu.length;m++)ot(Eu[m],a);break;case"image":ot("error",a),ot("load",a);break;case"details":ot("toggle",a);break;case"embed":case"source":case"link":ot("error",a),ot("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in h)if(h.hasOwnProperty(le)&&(m=h[le],m!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Ft(a,l,le,m,h,null)}return;default:if(kg(l)){for(fe in h)h.hasOwnProperty(fe)&&(m=h[fe],m!==void 0&&dy(a,l,fe,m,h,void 0));return}}for(z in h)h.hasOwnProperty(z)&&(m=h[z],m!=null&&Ft(a,l,z,m,h,null))}function ED(a,l,h,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,v=null,C=null,z=null,Z=null,le=null,fe=null;for(he in h){var xe=h[he];if(h.hasOwnProperty(he)&&xe!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":Z=xe;default:m.hasOwnProperty(he)||Ft(a,l,he,null,m,xe)}}for(var ce in m){var he=m[ce];if(xe=h[ce],m.hasOwnProperty(ce)&&(he!=null||xe!=null))switch(ce){case"type":v=he;break;case"name":x=he;break;case"checked":le=he;break;case"defaultChecked":fe=he;break;case"value":C=he;break;case"defaultValue":z=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,l));break;default:he!==xe&&Ft(a,l,ce,he,m,xe)}}Ag(a,C,z,Z,le,fe,v,x);return;case"select":he=C=z=ce=null;for(v in h)if(Z=h[v],h.hasOwnProperty(v)&&Z!=null)switch(v){case"value":break;case"multiple":he=Z;default:m.hasOwnProperty(v)||Ft(a,l,v,null,m,Z)}for(x in m)if(v=m[x],Z=h[x],m.hasOwnProperty(x)&&(v!=null||Z!=null))switch(x){case"value":ce=v;break;case"defaultValue":z=v;break;case"multiple":C=v;default:v!==Z&&Ft(a,l,x,v,m,Z)}l=z,h=C,m=he,ce!=null?ol(a,!!h,ce,!1):!!m!=!!h&&(l!=null?ol(a,!!h,l,!0):ol(a,!!h,h?[]:"",!1));return;case"textarea":he=ce=null;for(z in h)if(x=h[z],h.hasOwnProperty(z)&&x!=null&&!m.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Ft(a,l,z,null,m,x)}for(C in m)if(x=m[C],v=h[C],m.hasOwnProperty(C)&&(x!=null||v!=null))switch(C){case"value":ce=x;break;case"defaultValue":he=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==v&&Ft(a,l,C,x,m,v)}Zv(a,ce,he);return;case"option":for(var Ie in h)if(ce=h[Ie],h.hasOwnProperty(Ie)&&ce!=null&&!m.hasOwnProperty(Ie))switch(Ie){case"selected":a.selected=!1;break;default:Ft(a,l,Ie,null,m,ce)}for(Z in m)if(ce=m[Z],he=h[Z],m.hasOwnProperty(Z)&&ce!==he&&(ce!=null||he!=null))switch(Z){case"selected":a.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:Ft(a,l,Z,ce,m,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in h)ce=h[Fe],h.hasOwnProperty(Fe)&&ce!=null&&!m.hasOwnProperty(Fe)&&Ft(a,l,Fe,null,m,ce);for(le in m)if(ce=m[le],he=h[le],m.hasOwnProperty(le)&&ce!==he&&(ce!=null||he!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(r(137,l));break;default:Ft(a,l,le,ce,m,he)}return;default:if(kg(l)){for(var Gt in h)ce=h[Gt],h.hasOwnProperty(Gt)&&ce!==void 0&&!m.hasOwnProperty(Gt)&&dy(a,l,Gt,void 0,m,ce);for(fe in m)ce=m[fe],he=h[fe],!m.hasOwnProperty(fe)||ce===he||ce===void 0&&he===void 0||dy(a,l,fe,ce,m,he);return}}for(var ne in h)ce=h[ne],h.hasOwnProperty(ne)&&ce!=null&&!m.hasOwnProperty(ne)&&Ft(a,l,ne,null,m,ce);for(xe in m)ce=m[xe],he=h[xe],!m.hasOwnProperty(xe)||ce===he||ce==null&&he==null||Ft(a,l,xe,ce,m,he)}function JS(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function MD(){if(typeof performance.getEntriesByType=="function"){for(var a=0,l=0,h=performance.getEntriesByType("resource"),m=0;m<h.length;m++){var x=h[m],v=x.transferSize,C=x.initiatorType,z=x.duration;if(v&&z&&JS(C)){for(C=0,z=x.responseEnd,m+=1;m<h.length;m++){var Z=h[m],le=Z.startTime;if(le>z)break;var fe=Z.transferSize,xe=Z.initiatorType;fe&&JS(xe)&&(Z=Z.responseEnd,C+=fe*(Z<z?1:(z-le)/(Z-le)))}if(--m,l+=8*(v+C)/(x.duration/1e3),a++,10<a)break}}if(0<a)return l/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var fy=null,my=null;function Of(a){return a.nodeType===9?a:a.ownerDocument}function eA(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tA(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function py(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var gy=null;function ND(){var a=window.event;return a&&a.type==="popstate"?a===gy?!1:(gy=a,!0):(gy=null,!1)}var nA=typeof setTimeout=="function"?setTimeout:void 0,ID=typeof clearTimeout=="function"?clearTimeout:void 0,rA=typeof Promise=="function"?Promise:void 0,RD=typeof queueMicrotask=="function"?queueMicrotask:typeof rA<"u"?function(a){return rA.resolve(null).then(a).catch(PD)}:nA;function PD(a){setTimeout(function(){throw a})}function ga(a){return a==="head"}function iA(a,l){var h=l,m=0;do{var x=h.nextSibling;if(a.removeChild(h),x&&x.nodeType===8)if(h=x.data,h==="/$"||h==="/&"){if(m===0){a.removeChild(x),zl(l);return}m--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")m++;else if(h==="html")Nu(a.ownerDocument.documentElement);else if(h==="head"){h=a.ownerDocument.head,Nu(h);for(var v=h.firstChild;v;){var C=v.nextSibling,z=v.nodeName;v[Pe]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&v.rel.toLowerCase()==="stylesheet"||h.removeChild(v),v=C}}else h==="body"&&Nu(a.ownerDocument.body);h=x}while(h);zl(l)}function sA(a,l){var h=a;a=0;do{var m=h.nextSibling;if(h.nodeType===1?l?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(l?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),m&&m.nodeType===8)if(h=m.data,h==="/$"){if(a===0)break;a--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||a++;h=m}while(h)}function yy(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var h=l;switch(l=l.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":yy(h),K(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function DD(a,l,h,m){for(;a.nodeType===1;){var x=h;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!m&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(m){if(!a[Pe])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(v=a.getAttribute("rel"),v==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(v!==x.rel||a.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(v=a.getAttribute("src"),(v!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&v&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var v=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===v)return a}else return a;if(a=Ei(a.nextSibling),a===null)break}return null}function jD(a,l,h){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=Ei(a.nextSibling),a===null))return null;return a}function aA(a,l){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=Ei(a.nextSibling),a===null))return null;return a}function by(a){return a.data==="$?"||a.data==="$~"}function xy(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function BD(a,l){var h=a.ownerDocument;if(a.data==="$~")a._reactRetry=l;else if(a.data!=="$?"||h.readyState!=="loading")l();else{var m=function(){l(),h.removeEventListener("DOMContentLoaded",m)};h.addEventListener("DOMContentLoaded",m),a._reactRetry=m}}function Ei(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return a}var vy=null;function oA(a){a=a.nextSibling;for(var l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"||h==="/&"){if(l===0)return Ei(a.nextSibling);l--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||l++}a=a.nextSibling}return null}function lA(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(l===0)return a;l--}else h!=="/$"&&h!=="/&"||l++}a=a.previousSibling}return null}function cA(a,l,h){switch(l=Of(h),a){case"html":if(a=l.documentElement,!a)throw Error(r(452));return a;case"head":if(a=l.head,!a)throw Error(r(453));return a;case"body":if(a=l.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function Nu(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);K(a)}var Mi=new Map,uA=new Set;function Lf(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var zs=V.d;V.d={f:OD,r:LD,D:zD,C:UD,L:FD,m:GD,X:VD,S:HD,M:WD};function OD(){var a=zs.f(),l=Mf();return a||l}function LD(a){var l=Me(a);l!==null&&l.tag===5&&l.type==="form"?Tw(l):zs.r(a)}var Bl=typeof document>"u"?null:document;function hA(a,l,h){var m=Bl;if(m&&typeof l=="string"&&l){var x=_i(l);x='link[rel="'+a+'"][href="'+x+'"]',typeof h=="string"&&(x+='[crossorigin="'+h+'"]'),uA.has(x)||(uA.add(x),a={rel:a,crossOrigin:h,href:l},m.querySelector(x)===null&&(l=m.createElement("link"),pr(l,"link",a),rt(l),m.head.appendChild(l)))}}function zD(a){zs.D(a),hA("dns-prefetch",a,null)}function UD(a,l){zs.C(a,l),hA("preconnect",a,l)}function FD(a,l,h){zs.L(a,l,h);var m=Bl;if(m&&a&&l){var x='link[rel="preload"][as="'+_i(l)+'"]';l==="image"&&h&&h.imageSrcSet?(x+='[imagesrcset="'+_i(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(x+='[imagesizes="'+_i(h.imageSizes)+'"]')):x+='[href="'+_i(a)+'"]';var v=x;switch(l){case"style":v=Ol(a);break;case"script":v=Ll(a)}Mi.has(v)||(a=p({rel:"preload",href:l==="image"&&h&&h.imageSrcSet?void 0:a,as:l},h),Mi.set(v,a),m.querySelector(x)!==null||l==="style"&&m.querySelector(Iu(v))||l==="script"&&m.querySelector(Ru(v))||(l=m.createElement("link"),pr(l,"link",a),rt(l),m.head.appendChild(l)))}}function GD(a,l){zs.m(a,l);var h=Bl;if(h&&a){var m=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+_i(m)+'"][href="'+_i(a)+'"]',v=x;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Ll(a)}if(!Mi.has(v)&&(a=p({rel:"modulepreload",href:a},l),Mi.set(v,a),h.querySelector(x)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Ru(v)))return}m=h.createElement("link"),pr(m,"link",a),rt(m),h.head.appendChild(m)}}}function HD(a,l,h){zs.S(a,l,h);var m=Bl;if(m&&a){var x=vn(m).hoistableStyles,v=Ol(a);l=l||"default";var C=x.get(v);if(!C){var z={loading:0,preload:null};if(C=m.querySelector(Iu(v)))z.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":l},h),(h=Mi.get(v))&&_y(a,h);var Z=C=m.createElement("link");rt(Z),pr(Z,"link",a),Z._p=new Promise(function(le,fe){Z.onload=le,Z.onerror=fe}),Z.addEventListener("load",function(){z.loading|=1}),Z.addEventListener("error",function(){z.loading|=2}),z.loading|=4,zf(C,l,m)}C={type:"stylesheet",instance:C,count:1,state:z},x.set(v,C)}}}function VD(a,l){zs.X(a,l);var h=Bl;if(h&&a){var m=vn(h).hoistableScripts,x=Ll(a),v=m.get(x);v||(v=h.querySelector(Ru(x)),v||(a=p({src:a,async:!0},l),(l=Mi.get(x))&&wy(a,l),v=h.createElement("script"),rt(v),pr(v,"link",a),h.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},m.set(x,v))}}function WD(a,l){zs.M(a,l);var h=Bl;if(h&&a){var m=vn(h).hoistableScripts,x=Ll(a),v=m.get(x);v||(v=h.querySelector(Ru(x)),v||(a=p({src:a,async:!0,type:"module"},l),(l=Mi.get(x))&&wy(a,l),v=h.createElement("script"),rt(v),pr(v,"link",a),h.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},m.set(x,v))}}function dA(a,l,h,m){var x=(x=Se.current)?Lf(x):null;if(!x)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(l=Ol(h.href),h=vn(x).hoistableStyles,m=h.get(l),m||(m={type:"style",instance:null,count:0,state:null},h.set(l,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=Ol(h.href);var v=vn(x).hoistableStyles,C=v.get(a);if(C||(x=x.ownerDocument||x,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(a,C),(v=x.querySelector(Iu(a)))&&!v._p&&(C.instance=v,C.state.loading=5),Mi.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Mi.set(a,h),v||YD(x,a,h,C.state))),l&&m===null)throw Error(r(528,""));return C}if(l&&m!==null)throw Error(r(529,""));return null;case"script":return l=h.async,h=h.src,typeof h=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Ll(h),h=vn(x).hoistableScripts,m=h.get(l),m||(m={type:"script",instance:null,count:0,state:null},h.set(l,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function Ol(a){return'href="'+_i(a)+'"'}function Iu(a){return'link[rel="stylesheet"]['+a+"]"}function fA(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function YD(a,l,h,m){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?m.loading=1:(l=a.createElement("link"),m.preload=l,l.addEventListener("load",function(){return m.loading|=1}),l.addEventListener("error",function(){return m.loading|=2}),pr(l,"link",h),rt(l),a.head.appendChild(l))}function Ll(a){return'[src="'+_i(a)+'"]'}function Ru(a){return"script[async]"+a}function mA(a,l,h){if(l.count++,l.instance===null)switch(l.type){case"style":var m=a.querySelector('style[data-href~="'+_i(h.href)+'"]');if(m)return l.instance=m,rt(m),m;var x=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return m=(a.ownerDocument||a).createElement("style"),rt(m),pr(m,"style",x),zf(m,h.precedence,a),l.instance=m;case"stylesheet":x=Ol(h.href);var v=a.querySelector(Iu(x));if(v)return l.state.loading|=4,l.instance=v,rt(v),v;m=fA(h),(x=Mi.get(x))&&_y(m,x),v=(a.ownerDocument||a).createElement("link"),rt(v);var C=v;return C._p=new Promise(function(z,Z){C.onload=z,C.onerror=Z}),pr(v,"link",m),l.state.loading|=4,zf(v,h.precedence,a),l.instance=v;case"script":return v=Ll(h.src),(x=a.querySelector(Ru(v)))?(l.instance=x,rt(x),x):(m=h,(x=Mi.get(v))&&(m=p({},h),wy(m,x)),a=a.ownerDocument||a,x=a.createElement("script"),rt(x),pr(x,"link",m),a.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(m=l.instance,l.state.loading|=4,zf(m,h.precedence,a));return l.instance}function zf(a,l,h){for(var m=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=m.length?m[m.length-1]:null,v=x,C=0;C<m.length;C++){var z=m[C];if(z.dataset.precedence===l)v=z;else if(v!==x)break}v?v.parentNode.insertBefore(a,v.nextSibling):(l=h.nodeType===9?h.head:h,l.insertBefore(a,l.firstChild))}function _y(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function wy(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var Uf=null;function pA(a,l,h){if(Uf===null){var m=new Map,x=Uf=new Map;x.set(h,m)}else x=Uf,m=x.get(h),m||(m=new Map,x.set(h,m));if(m.has(a))return m;for(m.set(a,null),h=h.getElementsByTagName(a),x=0;x<h.length;x++){var v=h[x];if(!(v[Pe]||v[Gn]||a==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var C=v.getAttribute(l)||"";C=a+C;var z=m.get(C);z?z.push(v):m.set(C,[v])}}return m}function gA(a,l,h){a=a.ownerDocument||a,a.head.insertBefore(h,l==="title"?a.querySelector("head > title"):null)}function $D(a,l,h){if(h===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function yA(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function qD(a,l,h,m){if(h.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var x=Ol(m.href),v=l.querySelector(Iu(x));if(v){l=v._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(a.count++,a=Ff.bind(a),l.then(a,a)),h.state.loading|=4,h.instance=v,rt(v);return}v=l.ownerDocument||l,m=fA(m),(x=Mi.get(x))&&_y(m,x),v=v.createElement("link"),rt(v);var C=v;C._p=new Promise(function(z,Z){C.onload=z,C.onerror=Z}),pr(v,"link",m),h.instance=v}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(h,l),(l=h.state.preload)&&(h.state.loading&3)===0&&(a.count++,h=Ff.bind(a),l.addEventListener("load",h),l.addEventListener("error",h))}}var Sy=0;function ZD(a,l){return a.stylesheets&&a.count===0&&Hf(a,a.stylesheets),0<a.count||0<a.imgCount?function(h){var m=setTimeout(function(){if(a.stylesheets&&Hf(a,a.stylesheets),a.unsuspend){var v=a.unsuspend;a.unsuspend=null,v()}},6e4+l);0<a.imgBytes&&Sy===0&&(Sy=62500*MD());var x=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&Hf(a,a.stylesheets),a.unsuspend)){var v=a.unsuspend;a.unsuspend=null,v()}},(a.imgBytes>Sy?50:800)+l);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(m),clearTimeout(x)}}:null}function Ff(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Hf(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Gf=null;function Hf(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Gf=new Map,l.forEach(XD,a),Gf=null,Ff.call(a))}function XD(a,l){if(!(l.state.loading&4)){var h=Gf.get(a);if(h)var m=h.get(null);else{h=new Map,Gf.set(a,h);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<x.length;v++){var C=x[v];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(h.set(C.dataset.precedence,C),m=C)}m&&h.set(null,m)}x=l.instance,C=x.getAttribute("data-precedence"),v=h.get(C)||m,v===m&&h.set(null,x),h.set(C,x),this.count++,m=Ff.bind(this),x.addEventListener("load",m),x.addEventListener("error",m),v?v.parentNode.insertBefore(x,v.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),l.state.loading|=4}}var Pu={$$typeof:k,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function KD(a,l,h,m,x,v,C,z,Z){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gc(0),this.hiddenUpdates=Gc(null),this.identifierPrefix=m,this.onUncaughtError=x,this.onCaughtError=v,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function bA(a,l,h,m,x,v,C,z,Z,le,fe,xe){return a=new KD(a,l,h,C,Z,le,fe,xe,z),l=1,v===!0&&(l|=24),v=ti(3,null,null,l),a.current=v,v.stateNode=a,l=n0(),l.refCount++,a.pooledCache=l,l.refCount++,v.memoizedState={element:m,isDehydrated:h,cache:l},a0(v),a}function xA(a){return a?(a=pl,a):pl}function vA(a,l,h,m,x,v){x=xA(x),m.context===null?m.context=x:m.pendingContext=x,m=sa(l),m.payload={element:h},v=v===void 0?null:v,v!==null&&(m.callback=v),h=aa(a,m,l),h!==null&&(Gr(h,a,l),hu(h,a,l))}function _A(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<l?h:l}}function Ay(a,l){_A(a,l),(a=a.alternate)&&_A(a,l)}function wA(a){if(a.tag===13||a.tag===31){var l=eo(a,67108864);l!==null&&Gr(l,a,67108864),Ay(a,67108864)}}function SA(a){if(a.tag===13||a.tag===31){var l=ai();l=jr(l);var h=eo(a,l);h!==null&&Gr(h,a,l),Ay(a,l)}}var Vf=!0;function QD(a,l,h,m){var x=N.T;N.T=null;var v=V.p;try{V.p=2,Cy(a,l,h,m)}finally{V.p=v,N.T=x}}function JD(a,l,h,m){var x=N.T;N.T=null;var v=V.p;try{V.p=8,Cy(a,l,h,m)}finally{V.p=v,N.T=x}}function Cy(a,l,h,m){if(Vf){var x=ky(m);if(x===null)hy(a,l,m,Wf,h),CA(a,m);else if(tj(x,a,l,h,m))m.stopPropagation();else if(CA(a,m),l&4&&-1<ej.indexOf(a)){for(;x!==null;){var v=Me(x);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var C=Jr(v.pendingLanes);if(C!==0){var z=v;for(z.pendingLanes|=2,z.entangledLanes|=2;C;){var Z=1<<31-vt(C);z.entanglements[1]|=Z,C&=~Z}es(v),(Tt&6)===0&&(Tf=$e()+500,Tu(0))}}break;case 31:case 13:z=eo(v,2),z!==null&&Gr(z,v,2),Mf(),Ay(v,2)}if(v=ky(m),v===null&&hy(a,l,m,Wf,h),v===x)break;x=v}x!==null&&m.stopPropagation()}else hy(a,l,m,null,h)}}function ky(a){return a=Eg(a),Ty(a)}var Wf=null;function Ty(a){if(Wf=null,a=_e(a),a!==null){var l=s(a);if(l===null)a=null;else{var h=l.tag;if(h===13){if(a=o(l),a!==null)return a;a=null}else if(h===31){if(a=c(l),a!==null)return a;a=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return Wf=a,null}function AA(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kn()){case de:return 2;case we:return 8;case Oe:case qe:return 32;case pt:return 268435456;default:return 32}default:return 32}}var Ey=!1,ya=null,ba=null,xa=null,Du=new Map,ju=new Map,va=[],ej="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function CA(a,l){switch(a){case"focusin":case"focusout":ya=null;break;case"dragenter":case"dragleave":ba=null;break;case"mouseover":case"mouseout":xa=null;break;case"pointerover":case"pointerout":Du.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":ju.delete(l.pointerId)}}function Bu(a,l,h,m,x,v){return a===null||a.nativeEvent!==v?(a={blockedOn:l,domEventName:h,eventSystemFlags:m,nativeEvent:v,targetContainers:[x]},l!==null&&(l=Me(l),l!==null&&wA(l)),a):(a.eventSystemFlags|=m,l=a.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),a)}function tj(a,l,h,m,x){switch(l){case"focusin":return ya=Bu(ya,a,l,h,m,x),!0;case"dragenter":return ba=Bu(ba,a,l,h,m,x),!0;case"mouseover":return xa=Bu(xa,a,l,h,m,x),!0;case"pointerover":var v=x.pointerId;return Du.set(v,Bu(Du.get(v)||null,a,l,h,m,x)),!0;case"gotpointercapture":return v=x.pointerId,ju.set(v,Bu(ju.get(v)||null,a,l,h,m,x)),!0}return!1}function kA(a){var l=_e(a.target);if(l!==null){var h=s(l);if(h!==null){if(l=h.tag,l===13){if(l=o(h),l!==null){a.blockedOn=l,$c(a.priority,function(){SA(h)});return}}else if(l===31){if(l=c(h),l!==null){a.blockedOn=l,$c(a.priority,function(){SA(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Yf(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var h=ky(a.nativeEvent);if(h===null){h=a.nativeEvent;var m=new h.constructor(h.type,h);Tg=m,h.target.dispatchEvent(m),Tg=null}else return l=Me(h),l!==null&&wA(l),a.blockedOn=h,!1;l.shift()}return!0}function TA(a,l,h){Yf(a)&&h.delete(l)}function nj(){Ey=!1,ya!==null&&Yf(ya)&&(ya=null),ba!==null&&Yf(ba)&&(ba=null),xa!==null&&Yf(xa)&&(xa=null),Du.forEach(TA),ju.forEach(TA)}function $f(a,l){a.blockedOn===l&&(a.blockedOn=null,Ey||(Ey=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,nj)))}var qf=null;function EA(a){qf!==a&&(qf=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){qf===a&&(qf=null);for(var l=0;l<a.length;l+=3){var h=a[l],m=a[l+1],x=a[l+2];if(typeof m!="function"){if(Ty(m||h)===null)continue;break}var v=Me(h);v!==null&&(a.splice(l,3),l-=3,k0(v,{pending:!0,data:x,method:h.method,action:m},m,x))}}))}function zl(a){function l(Z){return $f(Z,a)}ya!==null&&$f(ya,a),ba!==null&&$f(ba,a),xa!==null&&$f(xa,a),Du.forEach(l),ju.forEach(l);for(var h=0;h<va.length;h++){var m=va[h];m.blockedOn===a&&(m.blockedOn=null)}for(;0<va.length&&(h=va[0],h.blockedOn===null);)kA(h),h.blockedOn===null&&va.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(m=0;m<h.length;m+=3){var x=h[m],v=h[m+1],C=x[fn]||null;if(typeof v=="function")C||EA(h);else if(C){var z=null;if(v&&v.hasAttribute("formAction")){if(x=v,C=v[fn]||null)z=C.formAction;else if(Ty(x)!==null)continue}else z=C.action;typeof z=="function"?h[m+1]=z:(h.splice(m,3),m-=3),EA(h)}}}function MA(){function a(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(C){return x=C})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),m||setTimeout(h,20)}function h(){if(!m&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,x=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(h,100),function(){m=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function My(a){this._internalRoot=a}Zf.prototype.render=My.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(r(409));var h=l.current,m=ai();vA(h,m,a,l,null,null)},Zf.prototype.unmount=My.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;vA(a.current,2,null,a,null,null),Mf(),l[_s]=null}};function Zf(a){this._internalRoot=a}Zf.prototype.unstable_scheduleHydration=function(a){if(a){var l=Yc();a={blockedOn:null,target:a,priority:l};for(var h=0;h<va.length&&l!==0&&l<va[h].priority;h++);va.splice(h,0,a),h===0&&kA(a)}};var NA=e.version;if(NA!=="19.2.0")throw Error(r(527,NA,"19.2.0"));V.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=d(l),a=a!==null?f(a):null,a=a===null?null:a.stateNode,a};var rj={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xf.isDisabled&&Xf.supportsFiber)try{Un=Xf.inject(rj),hn=Xf}catch{}}return Lu.createRoot=function(a,l){if(!i(a))throw Error(r(299));var h=!1,m="",x=Ow,v=Lw,C=zw;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError)),l=bA(a,1,!1,null,null,h,m,null,x,v,C,MA),a[_s]=l.current,uy(a),new My(l)},Lu.hydrateRoot=function(a,l,h){if(!i(a))throw Error(r(299));var m=!1,x="",v=Ow,C=Lw,z=zw,Z=null;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onUncaughtError!==void 0&&(v=h.onUncaughtError),h.onCaughtError!==void 0&&(C=h.onCaughtError),h.onRecoverableError!==void 0&&(z=h.onRecoverableError),h.formState!==void 0&&(Z=h.formState)),l=bA(a,1,!0,l,h??null,m,x,Z,v,C,z,MA),l.context=xA(null),h=l.current,m=ai(),m=jr(m),x=sa(m),x.callback=null,aa(h,x,m),h=m,l.current.lanes=h,Qs(l,h),es(l),a[_s]=l.current,uy(a),new Zf(l)},Lu.version="19.2.0",Lu}var UA;function fj(){if(UA)return Iy.exports;UA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Iy.exports=dj(),Iy.exports}var FA=fj(),T=Kp();const mj=Zo(T),Ve=n=>typeof n=="string",zu=()=>{let n,e;const t=new Promise((r,i)=>{n=r,e=i});return t.resolve=n,t.reject=e,t},GA=n=>n==null?"":""+n,pj=(n,e,t)=>{n.forEach(r=>{e[r]&&(t[r]=e[r])})},gj=/###/g,HA=n=>n&&n.indexOf("###")>-1?n.replace(gj,"."):n,VA=n=>!n||Ve(n),Ih=(n,e,t)=>{const r=Ve(e)?e.split("."):e;let i=0;for(;i<r.length-1;){if(VA(n))return{};const s=HA(r[i]);!n[s]&&t&&(n[s]=new t),Object.prototype.hasOwnProperty.call(n,s)?n=n[s]:n={},++i}return VA(n)?{}:{obj:n,k:HA(r[i])}},WA=(n,e,t)=>{const{obj:r,k:i}=Ih(n,e,Object);if(r!==void 0||e.length===1){r[i]=t;return}let s=e[e.length-1],o=e.slice(0,e.length-1),c=Ih(n,o,Object);for(;c.obj===void 0&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),c=Ih(n,o,Object),c?.obj&&typeof c.obj[`${c.k}.${s}`]<"u"&&(c.obj=void 0);c.obj[`${c.k}.${s}`]=t},yj=(n,e,t,r)=>{const{obj:i,k:s}=Ih(n,e,Object);i[s]=i[s]||[],i[s].push(t)},xp=(n,e)=>{const{obj:t,k:r}=Ih(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,r))return t[r]},bj=(n,e,t)=>{const r=xp(n,t);return r!==void 0?r:xp(e,t)},IM=(n,e,t)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in n?Ve(n[r])||n[r]instanceof String||Ve(e[r])||e[r]instanceof String?t&&(n[r]=e[r]):IM(n[r],e[r],t):n[r]=e[r]);return n},Ul=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var xj={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const vj=n=>Ve(n)?n.replace(/[&<>"'\/]/g,e=>xj[e]):n;class _j{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const wj=[" ",",","?","!",";"],Sj=new _j(20),Aj=(n,e,t)=>{e=e||"",t=t||"";const r=wj.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(r.length===0)return!0;const i=Sj.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let s=!i.test(n);if(!s){const o=n.indexOf(t);o>0&&!i.test(n.substring(0,o))&&(s=!0)}return s},Px=(n,e,t=".")=>{if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const r=e.split(t);let i=n;for(let s=0;s<r.length;){if(!i||typeof i!="object")return;let o,c="";for(let u=s;u<r.length;++u)if(u!==s&&(c+=t),c+=r[u],o=i[c],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&u<r.length-1)continue;s+=u-s+1;break}i=o}return i},Kh=n=>n?.replace("_","-"),Cj={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){console?.[n]?.apply?.(console,e)}};class vp{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||Cj,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,i){return i&&!this.debug?null:(Ve(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new vp(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new vp(this.logger,e)}}var hs=new vp;let Qp=class{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const i=this.observers[r].get(t)||0;this.observers[r].set(t,i+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([i,s])=>{for(let o=0;o<s;o++)i(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([i,s])=>{for(let o=0;o<s;o++)i.apply(i,[e,...t])})}};class YA extends Qp{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r,i={}){const s=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,o=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let c;e.indexOf(".")>-1?c=e.split("."):(c=[e,t],r&&(Array.isArray(r)?c.push(...r):Ve(r)&&s?c.push(...r.split(s)):c.push(r)));const u=xp(this.data,c);return!u&&!t&&!r&&e.indexOf(".")>-1&&(e=c[0],t=c[1],r=c.slice(2).join(".")),u||!o||!Ve(r)?u:Px(this.data?.[e]?.[t],r,s)}addResource(e,t,r,i,s={silent:!1}){const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let c=[e,t];r&&(c=c.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(c=e.split("."),i=t,t=c[1]),this.addNamespaces(t),WA(this.data,c,i),s.silent||this.emit("added",e,t,r,i)}addResources(e,t,r,i={silent:!1}){for(const s in r)(Ve(r[s])||Array.isArray(r[s]))&&this.addResource(e,t,s,r[s],{silent:!0});i.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,i,s,o={silent:!1,skipCopy:!1}){let c=[e,t];e.indexOf(".")>-1&&(c=e.split("."),i=r,r=t,t=c[1]),this.addNamespaces(t);let u=xp(this.data,c)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),i?IM(u,r,s):u={...u,...r},WA(this.data,c,u),o.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(i=>t[i]&&Object.keys(t[i]).length>0)}toJSON(){return this.data}}var RM={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,r,i){return n.forEach(s=>{e=this.processors[s]?.process(e,t,r,i)??e}),e}};const PM=Symbol("i18next/PATH_KEY");function kj(){const n=[],e=Object.create(null);let t;return e.get=(r,i)=>(t?.revoke?.(),i===PM?n:(n.push(i),t=Proxy.revocable(r,e),t.proxy)),Proxy.revocable(Object.create(null),e).proxy}function Dx(n,e){const{[PM]:t}=n(kj());return t.join(e?.keySeparator??".")}const $A={},By=n=>!Ve(n)&&typeof n!="boolean"&&typeof n!="number";class _p extends Qp{constructor(e,t={}){super(),pj(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=hs.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const r={...t};if(e==null)return!1;const i=this.resolve(e,r);if(i?.res===void 0)return!1;const s=By(i.res);return!(r.returnObjects===!1&&s)}extractFromKey(e,t){let r=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const i=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,c=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!Aj(e,r,i);if(o&&!c){const u=e.match(this.interpolator.nestingRegexp);if(u&&u.length>0)return{key:e,namespaces:Ve(s)?[s]:s};const d=e.split(r);(r!==i||r===i&&this.options.ns.indexOf(d[0])>-1)&&(s=d.shift()),e=d.join(i)}return{key:e,namespaces:Ve(s)?[s]:s}}translate(e,t,r){let i=typeof t=="object"?{...t}:t;if(typeof i!="object"&&this.options.overloadTranslationOptionHandler&&(i=this.options.overloadTranslationOptionHandler(arguments)),typeof i=="object"&&(i={...i}),i||(i={}),e==null)return"";typeof e=="function"&&(e=Dx(e,{...this.options,...i})),Array.isArray(e)||(e=[String(e)]);const s=i.returnDetails!==void 0?i.returnDetails:this.options.returnDetails,o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,{key:c,namespaces:u}=this.extractFromKey(e[e.length-1],i),d=u[u.length-1];let f=i.nsSeparator!==void 0?i.nsSeparator:this.options.nsSeparator;f===void 0&&(f=":");const p=i.lng||this.language,y=i.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(p?.toLowerCase()==="cimode")return y?s?{res:`${d}${f}${c}`,usedKey:c,exactUsedKey:c,usedLng:p,usedNS:d,usedParams:this.getUsedParamsDetails(i)}:`${d}${f}${c}`:s?{res:c,usedKey:c,exactUsedKey:c,usedLng:p,usedNS:d,usedParams:this.getUsedParamsDetails(i)}:c;const b=this.resolve(e,i);let _=b?.res;const w=b?.usedKey||c,S=b?.exactUsedKey||c,A=["[object Number]","[object Function]","[object RegExp]"],M=i.joinArrays!==void 0?i.joinArrays:this.options.joinArrays,k=!this.i18nFormat||this.i18nFormat.handleAsObject,E=i.count!==void 0&&!Ve(i.count),U=_p.hasDefaultValue(i),I=E?this.pluralResolver.getSuffix(p,i.count,i):"",B=i.ordinal&&E?this.pluralResolver.getSuffix(p,i.count,{ordinal:!1}):"",G=E&&!i.ordinal&&i.count===0,R=G&&i[`defaultValue${this.options.pluralSeparator}zero`]||i[`defaultValue${I}`]||i[`defaultValue${B}`]||i.defaultValue;let P=_;k&&!_&&U&&(P=R);const H=By(P),Y=Object.prototype.toString.apply(P);if(k&&P&&H&&A.indexOf(Y)<0&&!(Ve(M)&&Array.isArray(P))){if(!i.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const L=this.options.returnedObjectHandler?this.options.returnedObjectHandler(w,P,{...i,ns:u}):`key '${c} (${this.language})' returned an object instead of string.`;return s?(b.res=L,b.usedParams=this.getUsedParamsDetails(i),b):L}if(o){const L=Array.isArray(P),q=L?[]:{},W=L?S:w;for(const N in P)if(Object.prototype.hasOwnProperty.call(P,N)){const V=`${W}${o}${N}`;U&&!_?q[N]=this.translate(V,{...i,defaultValue:By(R)?R[N]:void 0,joinArrays:!1,ns:u}):q[N]=this.translate(V,{...i,joinArrays:!1,ns:u}),q[N]===V&&(q[N]=P[N])}_=q}}else if(k&&Ve(M)&&Array.isArray(_))_=_.join(M),_&&(_=this.extendTranslation(_,e,i,r));else{let L=!1,q=!1;!this.isValidLookup(_)&&U&&(L=!0,_=R),this.isValidLookup(_)||(q=!0,_=c);const N=(i.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&q?void 0:_,V=U&&R!==_&&this.options.updateMissing;if(q||L||V){if(this.logger.log(V?"updateKey":"missingKey",p,d,c,V?R:_),o){const F=this.resolve(c,{...i,keySeparator:!1});F&&F.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let J=[];const se=this.languageUtils.getFallbackCodes(this.options.fallbackLng,i.lng||this.language);if(this.options.saveMissingTo==="fallback"&&se&&se[0])for(let F=0;F<se.length;F++)J.push(se[F]);else this.options.saveMissingTo==="all"?J=this.languageUtils.toResolveHierarchy(i.lng||this.language):J.push(i.lng||this.language);const O=(F,X,D)=>{const ee=U&&D!==_?D:N;this.options.missingKeyHandler?this.options.missingKeyHandler(F,d,X,ee,V,i):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(F,d,X,ee,V,i),this.emit("missingKey",F,d,X,_)};this.options.saveMissing&&(this.options.saveMissingPlurals&&E?J.forEach(F=>{const X=this.pluralResolver.getSuffixes(F,i);G&&i[`defaultValue${this.options.pluralSeparator}zero`]&&X.indexOf(`${this.options.pluralSeparator}zero`)<0&&X.push(`${this.options.pluralSeparator}zero`),X.forEach(D=>{O([F],c+D,i[`defaultValue${D}`]||R)})}):O(J,c,R))}_=this.extendTranslation(_,e,i,b,r),q&&_===c&&this.options.appendNamespaceToMissingKey&&(_=`${d}${f}${c}`),(q||L)&&this.options.parseMissingKeyHandler&&(_=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${d}${f}${c}`:c,L?_:void 0,i))}return s?(b.res=_,b.usedParams=this.getUsedParamsDetails(i),b):_}extendTranslation(e,t,r,i,s){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const u=Ve(e)&&(r?.interpolation?.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(u){const p=e.match(this.interpolator.nestingRegexp);d=p&&p.length}let f=r.replace&&!Ve(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),e=this.interpolator.interpolate(e,f,r.lng||this.language||i.usedLng,r),u){const p=e.match(this.interpolator.nestingRegexp),y=p&&p.length;d<y&&(r.nest=!1)}!r.lng&&i&&i.res&&(r.lng=this.language||i.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,(...p)=>s?.[0]===p[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${p[0]} in key: ${t[0]}`),null):this.translate(...p,t),r)),r.interpolation&&this.interpolator.reset()}const o=r.postProcess||this.options.postProcess,c=Ve(o)?[o]:o;return e!=null&&c?.length&&r.applyPostProcessor!==!1&&(e=RM.handle(c,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e,t={}){let r,i,s,o,c;return Ve(e)&&(e=[e]),e.forEach(u=>{if(this.isValidLookup(r))return;const d=this.extractFromKey(u,t),f=d.key;i=f;let p=d.namespaces;this.options.fallbackNS&&(p=p.concat(this.options.fallbackNS));const y=t.count!==void 0&&!Ve(t.count),b=y&&!t.ordinal&&t.count===0,_=t.context!==void 0&&(Ve(t.context)||typeof t.context=="number")&&t.context!=="",w=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);p.forEach(S=>{this.isValidLookup(r)||(c=S,!$A[`${w[0]}-${S}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(c)&&($A[`${w[0]}-${S}`]=!0,this.logger.warn(`key "${i}" for languages "${w.join(", ")}" won't get resolved as namespace "${c}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(A=>{if(this.isValidLookup(r))return;o=A;const M=[f];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(M,f,A,S,t);else{let E;y&&(E=this.pluralResolver.getSuffix(A,t.count,t));const U=`${this.options.pluralSeparator}zero`,I=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(y&&(t.ordinal&&E.indexOf(I)===0&&M.push(f+E.replace(I,this.options.pluralSeparator)),M.push(f+E),b&&M.push(f+U)),_){const B=`${f}${this.options.contextSeparator||"_"}${t.context}`;M.push(B),y&&(t.ordinal&&E.indexOf(I)===0&&M.push(B+E.replace(I,this.options.pluralSeparator)),M.push(B+E),b&&M.push(B+U))}}let k;for(;k=M.pop();)this.isValidLookup(r)||(s=k,r=this.getResource(A,S,k,t))}))})}),{res:r,usedKey:i,exactUsedKey:s,usedLng:o,usedNS:c}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,r,i={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,r,i):this.resourceStore.getResource(e,t,r,i)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!Ve(e.replace);let i=r?e.replace:e;if(r&&typeof e.count<"u"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!r){i={...i};for(const s of t)delete i[s]}return i}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,t.length)&&e[r]!==void 0)return!0;return!1}}class qA{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=hs.create("languageUtils")}getScriptPartFromCode(e){if(e=Kh(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Kh(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(Ve(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(r=>{if(t)return;const i=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(i))&&(t=i)}),!t&&this.options.supportedLngs&&e.forEach(r=>{if(t)return;const i=this.getScriptPartFromCode(r);if(this.isSupportedCode(i))return t=i;const s=this.getLanguagePartFromCode(r);if(this.isSupportedCode(s))return t=s;t=this.options.supportedLngs.find(o=>{if(o===s)return o;if(!(o.indexOf("-")<0&&s.indexOf("-")<0)&&(o.indexOf("-")>0&&s.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===s||o.indexOf(s)===0&&s.length>1))return o})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),Ve(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),i=[],s=o=>{o&&(this.isSupportedCode(o)?i.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return Ve(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):Ve(e)&&s(this.formatLanguageCode(e)),r.forEach(o=>{i.indexOf(o)<0&&s(this.formatLanguageCode(o))}),i}}const ZA={zero:0,one:1,two:2,few:3,many:4,other:5},XA={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Tj{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=hs.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const r=Kh(e==="dev"?"en":e),i=t.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:r,type:i});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let o;try{o=new Intl.PluralRules(r,{type:i})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),XA;if(!e.match(/-|_/))return XA;const u=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(u,t)}return this.pluralRulesCache[s]=o,o}needsPlural(e,t={}){let r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t,r={}){return this.getSuffixes(e,r).map(i=>`${t}${i}`)}getSuffixes(e,t={}){let r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?r.resolvedOptions().pluralCategories.sort((i,s)=>ZA[i]-ZA[s]).map(i=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(e,t,r={}){const i=this.getRule(e,r);return i?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,r))}}const KA=(n,e,t,r=".",i=!0)=>{let s=bj(n,e,t);return!s&&i&&Ve(t)&&(s=Px(n,t,r),s===void 0&&(s=Px(e,t,r))),s},Oy=n=>n.replace(/\$/g,"$$$$");class Ej{constructor(e={}){this.logger=hs.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(t=>t),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:i,prefix:s,prefixEscaped:o,suffix:c,suffixEscaped:u,formatSeparator:d,unescapeSuffix:f,unescapePrefix:p,nestingPrefix:y,nestingPrefixEscaped:b,nestingSuffix:_,nestingSuffixEscaped:w,nestingOptionsSeparator:S,maxReplaces:A,alwaysFormat:M}=e.interpolation;this.escape=t!==void 0?t:vj,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=s?Ul(s):o||"{{",this.suffix=c?Ul(c):u||"}}",this.formatSeparator=d||",",this.unescapePrefix=f?"":p||"-",this.unescapeSuffix=this.unescapePrefix?"":f||"",this.nestingPrefix=y?Ul(y):b||Ul("$t("),this.nestingSuffix=_?Ul(_):w||Ul(")"),this.nestingOptionsSeparator=S||",",this.maxReplaces=A||1e3,this.alwaysFormat=M!==void 0?M:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,r)=>t?.source===r?(t.lastIndex=0,t):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,r,i){let s,o,c;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=b=>{if(b.indexOf(this.formatSeparator)<0){const A=KA(t,u,b,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(A,void 0,r,{...i,...t,interpolationkey:b}):A}const _=b.split(this.formatSeparator),w=_.shift().trim(),S=_.join(this.formatSeparator).trim();return this.format(KA(t,u,w,this.options.keySeparator,this.options.ignoreJSONStructure),S,r,{...i,...t,interpolationkey:w})};this.resetRegExp();const f=i?.missingInterpolationHandler||this.options.missingInterpolationHandler,p=i?.interpolation?.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:b=>Oy(b)},{regex:this.regexp,safeValue:b=>this.escapeValue?Oy(this.escape(b)):Oy(b)}].forEach(b=>{for(c=0;s=b.regex.exec(e);){const _=s[1].trim();if(o=d(_),o===void 0)if(typeof f=="function"){const S=f(e,s,i);o=Ve(S)?S:""}else if(i&&Object.prototype.hasOwnProperty.call(i,_))o="";else if(p){o=s[0];continue}else this.logger.warn(`missed to pass in variable ${_} for interpolating ${e}`),o="";else!Ve(o)&&!this.useRawValueToEscape&&(o=GA(o));const w=b.safeValue(o);if(e=e.replace(s[0],w),p?(b.regex.lastIndex+=o.length,b.regex.lastIndex-=s[0].length):b.regex.lastIndex=0,c++,c>=this.maxReplaces)break}}),e}nest(e,t,r={}){let i,s,o;const c=(u,d)=>{const f=this.nestingOptionsSeparator;if(u.indexOf(f)<0)return u;const p=u.split(new RegExp(`${f}[ ]*{`));let y=`{${p[1]}`;u=p[0],y=this.interpolate(y,o);const b=y.match(/'/g),_=y.match(/"/g);((b?.length??0)%2===0&&!_||_.length%2!==0)&&(y=y.replace(/'/g,'"'));try{o=JSON.parse(y),d&&(o={...d,...o})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${u}`,w),`${u}${f}${y}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,u};for(;i=this.nestingRegexp.exec(e);){let u=[];o={...r},o=o.replace&&!Ve(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const d=/{.*}/.test(i[1])?i[1].lastIndexOf("}")+1:i[1].indexOf(this.formatSeparator);if(d!==-1&&(u=i[1].slice(d).split(this.formatSeparator).map(f=>f.trim()).filter(Boolean),i[1]=i[1].slice(0,d)),s=t(c.call(this,i[1].trim(),o),o),s&&i[0]===e&&!Ve(s))return s;Ve(s)||(s=GA(s)),s||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),s=""),u.length&&(s=u.reduce((f,p)=>this.format(f,p,r.lng,{...r,interpolationkey:i[1].trim()}),s.trim())),e=e.replace(i[0],s),this.regexp.lastIndex=0}return e}}const Mj=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const r=n.split("(");e=r[0].toLowerCase().trim();const i=r[1].substring(0,r[1].length-1);e==="currency"&&i.indexOf(":")<0?t.currency||(t.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?t.range||(t.range=i.trim()):i.split(";").forEach(o=>{if(o){const[c,...u]=o.split(":"),d=u.join(":").trim().replace(/^'+|'+$/g,""),f=c.trim();t[f]||(t[f]=d),d==="false"&&(t[f]=!1),d==="true"&&(t[f]=!0),isNaN(d)||(t[f]=parseInt(d,10))}})}return{formatName:e,formatOptions:t}},QA=n=>{const e={};return(t,r,i)=>{let s=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(s={...s,[i.interpolationkey]:void 0});const o=r+JSON.stringify(s);let c=e[o];return c||(c=n(Kh(r),i),e[o]=c),c(t)}},Nj=n=>(e,t,r)=>n(Kh(t),r)(e);class Ij{constructor(e={}){this.logger=hs.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const r=t.cacheInBuiltFormats?QA:Nj;this.formats={number:r((i,s)=>{const o=new Intl.NumberFormat(i,{...s});return c=>o.format(c)}),currency:r((i,s)=>{const o=new Intl.NumberFormat(i,{...s,style:"currency"});return c=>o.format(c)}),datetime:r((i,s)=>{const o=new Intl.DateTimeFormat(i,{...s});return c=>o.format(c)}),relativetime:r((i,s)=>{const o=new Intl.RelativeTimeFormat(i,{...s});return c=>o.format(c,s.range||"day")}),list:r((i,s)=>{const o=new Intl.ListFormat(i,{...s});return c=>o.format(c)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=QA(t)}format(e,t,r,i={}){const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(c=>c.indexOf(")")>-1)){const c=s.findIndex(u=>u.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,c)].join(this.formatSeparator)}return s.reduce((c,u)=>{const{formatName:d,formatOptions:f}=Mj(u);if(this.formats[d]){let p=c;try{const y=i?.formatParams?.[i.interpolationkey]||{},b=y.locale||y.lng||i.locale||i.lng||r;p=this.formats[d](c,b,{...f,...i,...y})}catch(y){this.logger.warn(y)}return p}else this.logger.warn(`there was no format function for ${d}`);return c},e)}}const Rj=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class Pj extends Qp{constructor(e,t,r,i={}){super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=i,this.logger=hs.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(r,i.backend,i)}queueLoad(e,t,r,i){const s={},o={},c={},u={};return e.forEach(d=>{let f=!0;t.forEach(p=>{const y=`${d}|${p}`;!r.reload&&this.store.hasResourceBundle(d,p)?this.state[y]=2:this.state[y]<0||(this.state[y]===1?o[y]===void 0&&(o[y]=!0):(this.state[y]=1,f=!1,o[y]===void 0&&(o[y]=!0),s[y]===void 0&&(s[y]=!0),u[p]===void 0&&(u[p]=!0)))}),f||(c[d]=!0)}),(Object.keys(s).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(s),pending:Object.keys(o),toLoadLanguages:Object.keys(c),toLoadNamespaces:Object.keys(u)}}loaded(e,t,r){const i=e.split("|"),s=i[0],o=i[1];t&&this.emit("failedLoading",s,o,t),!t&&r&&this.store.addResourceBundle(s,o,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&r&&(this.state[e]=0);const c={};this.queue.forEach(u=>{yj(u.loaded,[s],o),Rj(u,e),t&&u.errors.push(t),u.pendingCount===0&&!u.done&&(Object.keys(u.loaded).forEach(d=>{c[d]||(c[d]={});const f=u.loaded[d];f.length&&f.forEach(p=>{c[d][p]===void 0&&(c[d][p]=!0)})}),u.done=!0,u.errors.length?u.callback(u.errors):u.callback())}),this.emit("loaded",c),this.queue=this.queue.filter(u=>!u.done)}read(e,t,r,i=0,s=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:r,tried:i,wait:s,callback:o});return}this.readingCalls++;const c=(d,f)=>{if(this.readingCalls--,this.waitingReads.length>0){const p=this.waitingReads.shift();this.read(p.lng,p.ns,p.fcName,p.tried,p.wait,p.callback)}if(d&&f&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,r,i+1,s*2,o)},s);return}o(d,f)},u=this.backend[r].bind(this.backend);if(u.length===2){try{const d=u(e,t);d&&typeof d.then=="function"?d.then(f=>c(null,f)).catch(c):c(null,d)}catch(d){c(d)}return}return u(e,t,c)}prepareLoading(e,t,r={},i){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();Ve(e)&&(e=this.languageUtils.toResolveHierarchy(e)),Ve(t)&&(t=[t]);const s=this.queueLoad(e,t,r,i);if(!s.toLoad.length)return s.pending.length||i(),null;s.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e,t=""){const r=e.split("|"),i=r[0],s=r[1];this.read(i,s,"read",void 0,void 0,(o,c)=>{o&&this.logger.warn(`${t}loading namespace ${s} for language ${i} failed`,o),!o&&c&&this.logger.log(`${t}loaded namespace ${s} for language ${i}`,c),this.loaded(e,o,c)})}saveMissing(e,t,r,i,s,o={},c=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend?.create){const u={...o,isUpdate:s},d=this.backend.create.bind(this.backend);if(d.length<6)try{let f;d.length===5?f=d(e,t,r,i,u):f=d(e,t,r,i),f&&typeof f.then=="function"?f.then(p=>c(null,p)).catch(c):c(null,f)}catch(f){c(f)}else d(e,t,r,i,c,u)}!e||!e[0]||this.store.addResource(e[0],t,r,i)}}}const JA=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),Ve(n[1])&&(e.defaultValue=n[1]),Ve(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(r=>{e[r]=t[r]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),e5=n=>(Ve(n.ns)&&(n.ns=[n.ns]),Ve(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),Ve(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),n.supportedLngs?.indexOf?.("cimode")<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n),Kf=()=>{},Dj=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};class Rh extends Qp{constructor(e={},t){if(super(),this.options=e5(e),this.services={},this.logger=hs,this.modules={external:[]},Dj(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(Ve(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=JA();this.options={...r,...this.options,...e5(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const i=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?hs.init(i(this.modules.logger),this.options):hs.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:d=Ij;const f=new qA(this.options);this.store=new YA(this.options.resources,this.options);const p=this.services;p.logger=hs,p.resourceStore=this.store,p.languageUtils=f,p.pluralResolver=new Tj(f,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),d&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(p.formatter=i(d),p.formatter.init&&p.formatter.init(p,this.options),this.options.interpolation.format=p.formatter.format.bind(p.formatter)),p.interpolator=new Ej(this.options),p.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},p.backendConnector=new Pj(i(this.modules.backend),p.resourceStore,p,this.options),p.backendConnector.on("*",(b,..._)=>{this.emit(b,..._)}),this.modules.languageDetector&&(p.languageDetector=i(this.modules.languageDetector),p.languageDetector.init&&p.languageDetector.init(p,this.options.detection,this.options)),this.modules.i18nFormat&&(p.i18nFormat=i(this.modules.i18nFormat),p.i18nFormat.init&&p.i18nFormat.init(this)),this.translator=new _p(this.services,this.options),this.translator.on("*",(b,..._)=>{this.emit(b,..._)}),this.modules.external.forEach(b=>{b.init&&b.init(this)})}if(this.format=this.options.interpolation.format,t||(t=Kf),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=(...f)=>this.store[d](...f)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=(...f)=>(this.store[d](...f),this)});const c=zu(),u=()=>{const d=(f,p)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(p),t(f,p)};if(this.languages&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initAsync?u():setTimeout(u,0),c}loadResources(e,t=Kf){let r=t;const i=Ve(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(i?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const s=[],o=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(d=>{d!=="cimode"&&s.indexOf(d)<0&&s.push(d)})};i?o(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>o(u)),this.options.preload?.forEach?.(c=>o(c)),this.services.backendConnector.load(s,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(c)})}else r(null)}reloadResources(e,t,r){const i=zu();return typeof e=="function"&&(r=e,e=void 0),typeof t=="function"&&(r=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),r||(r=Kf),this.services.backendConnector.reload(e,t,s=>{i.resolve(),r(s)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&RM.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const r=this.languages[t];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const r=zu();this.emit("languageChanging",e);const i=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},s=(c,u)=>{u?this.isLanguageChangingTo===e&&(i(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,r.resolve((...d)=>this.t(...d)),t&&t(c,(...d)=>this.t(...d))},o=c=>{!e&&!c&&this.services.languageDetector&&(c=[]);const u=Ve(c)?c:c&&c[0],d=this.store.hasLanguageSomeTranslations(u)?u:this.services.languageUtils.getBestMatchFromCodes(Ve(c)?[c]:c);d&&(this.language||i(d),this.translator.language||this.translator.changeLanguage(d),this.services.languageDetector?.cacheUserLanguage?.(d)),this.loadResources(d,f=>{s(f,d)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),r}getFixedT(e,t,r){const i=(s,o,...c)=>{let u;typeof o!="object"?u=this.options.overloadTranslationOptionHandler([s,o].concat(c)):u={...o},u.lng=u.lng||i.lng,u.lngs=u.lngs||i.lngs,u.ns=u.ns||i.ns,u.keyPrefix!==""&&(u.keyPrefix=u.keyPrefix||r||i.keyPrefix);const d=this.options.keySeparator||".";let f;return u.keyPrefix&&Array.isArray(s)?f=s.map(p=>(typeof p=="function"&&(p=Dx(p,{...this.options,...o})),`${u.keyPrefix}${d}${p}`)):(typeof s=="function"&&(s=Dx(s,{...this.options,...o})),f=u.keyPrefix?`${u.keyPrefix}${d}${s}`:s),this.t(f,u)};return Ve(e)?i.lng=e:i.lngs=e,i.ns=t,i.keyPrefix=r,i}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(c,u)=>{const d=this.services.backendConnector.state[`${c}|${u}`];return d===-1||d===0||d===2};if(t.precheck){const c=t.precheck(this,o);if(c!==void 0)return c}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!i||o(s,e)))}loadNamespaces(e,t){const r=zu();return this.options.ns?(Ve(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{r.resolve(),t&&t(i)}),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=zu();Ve(e)&&(e=[e]);const i=this.options.preload||[],s=e.filter(o=>i.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return s.length?(this.options.preload=i.concat(s),this.loadResources(o=>{r.resolve(),t&&t(o)}),r):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{const i=new Intl.Locale(e);if(i&&i.getTextInfo){const s=i.getTextInfo();if(s&&s.direction)return s.direction}}catch{}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services?.languageUtils||new qA(JA());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){const r=new Rh(e,t);return r.createInstance=Rh.createInstance,r}cloneInstance(e={},t=Kf){const r=e.forkResourceStore;r&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},s=new Rh(i);if((e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(c=>{s[c]=this[c]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},r){const c=Object.keys(this.store.data).reduce((u,d)=>(u[d]={...this.store.data[d]},u[d]=Object.keys(u[d]).reduce((f,p)=>(f[p]={...u[d][p]},f),u[d]),u),{});s.store=new YA(c,i),s.services.resourceStore=s.store}return s.translator=new _p(s.services,i),s.translator.on("*",(c,...u)=>{s.emit(c,...u)}),s.init(i,t),s.translator.options=i,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Ln=Rh.createInstance();Ln.createInstance;Ln.dir;Ln.init;Ln.loadResources;Ln.reloadResources;Ln.use;Ln.changeLanguage;Ln.getFixedT;Ln.t;Ln.exists;Ln.setDefaultNamespace;Ln.hasLoadedNamespace;Ln.loadNamespaces;Ln.loadLanguages;const jj=(n,e,t,r)=>{const i=[t,{code:e,...r||{}}];if(n?.services?.logger?.forward)return n.services.logger.forward(i,"warn","react-i18next::",!0);Uo(i[0])&&(i[0]=`react-i18next:: ${i[0]}`),n?.services?.logger?.warn?n.services.logger.warn(...i):console?.warn&&console.warn(...i)},t5={},DM=(n,e,t,r)=>{Uo(t)&&t5[t]||(Uo(t)&&(t5[t]=new Date),jj(n,e,t,r))},jM=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},jx=(n,e,t)=>{n.loadNamespaces(e,jM(n,t))},n5=(n,e,t,r)=>{if(Uo(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return jx(n,t,r);t.forEach(i=>{n.options.ns.indexOf(i)<0&&n.options.ns.push(i)}),n.loadLanguages(e,jM(n,r))},Bj=(n,e,t={})=>!e.languages||!e.languages.length?(DM(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(r,i)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!i(r.isLanguageChangingTo,n))return!1}}),Uo=n=>typeof n=="string",Oj=n=>typeof n=="object"&&n!==null,Lj=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,zj={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},Uj=n=>zj[n],Fj=n=>n.replace(Lj,Uj);let Bx={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Fj};const Gj=(n={})=>{Bx={...Bx,...n}},Hj=()=>Bx;let BM;const Vj=n=>{BM=n},Wj=()=>BM,Yj={type:"3rdParty",init(n){Gj(n.options.react),Vj(n)}},$j=T.createContext();class qj{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var Ly={exports:{}},zy={};var r5;function Zj(){if(r5)return zy;r5=1;var n=Kp();function e(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function c(p,y){var b=y(),_=r({inst:{value:b,getSnapshot:y}}),w=_[0].inst,S=_[1];return s(function(){w.value=b,w.getSnapshot=y,u(w)&&S({inst:w})},[p,b,y]),i(function(){return u(w)&&S({inst:w}),p(function(){u(w)&&S({inst:w})})},[p]),o(b),b}function u(p){var y=p.getSnapshot;p=p.value;try{var b=y();return!t(p,b)}catch{return!0}}function d(p,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:c;return zy.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,zy}var i5;function Xj(){return i5||(i5=1,Ly.exports=Zj()),Ly.exports}var Kj=Xj();const Qj=(n,e)=>Uo(e)?e:Oj(e)&&Uo(e.defaultValue)?e.defaultValue:Array.isArray(n)?n[n.length-1]:n,Jj={t:Qj,ready:!1},e8=()=>()=>{},xt=(n,e={})=>{const{i18n:t}=e,{i18n:r,defaultNS:i}=T.useContext($j)||{},s=t||r||Wj();s&&!s.reportNamespaces&&(s.reportNamespaces=new qj),s||DM(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=T.useMemo(()=>({...Hj(),...s?.options?.react,...e}),[s,e]),{useSuspense:c,keyPrefix:u}=o,d=i||s?.options?.defaultNS,f=Uo(d)?[d]:d||["translation"],p=T.useMemo(()=>f,f);s?.reportNamespaces?.addUsedNamespaces?.(p);const y=T.useRef(0),b=T.useCallback(R=>{if(!s)return e8;const{bindI18n:P,bindI18nStore:H}=o,Y=()=>{y.current+=1,R()};return P&&s.on(P,Y),H&&s.store.on(H,Y),()=>{P&&P.split(" ").forEach(L=>s.off(L,Y)),H&&H.split(" ").forEach(L=>s.store.off(L,Y))}},[s,o]),_=T.useRef(),w=T.useCallback(()=>{if(!s)return Jj;const R=!!(s.isInitialized||s.initializedStoreOnce)&&p.every(W=>Bj(W,s,o)),P=e.lng||s.language,H=y.current,Y=_.current;if(Y&&Y.ready===R&&Y.lng===P&&Y.keyPrefix===u&&Y.revision===H)return Y;const q={t:s.getFixedT(P,o.nsMode==="fallback"?p:p[0],u),ready:R,lng:P,keyPrefix:u,revision:H};return _.current=q,q},[s,p,u,o,e.lng]),[S,A]=T.useState(0),{t:M,ready:k}=Kj.useSyncExternalStore(b,w,w);T.useEffect(()=>{if(s&&!k&&!c){const R=()=>A(P=>P+1);e.lng?n5(s,e.lng,p,R):jx(s,p,R)}},[s,e.lng,p,k,c,S]);const E=s||{},U=T.useRef(null),I=T.useRef(),B=R=>{const P=Object.getOwnPropertyDescriptors(R);P.__original&&delete P.__original;const H=Object.create(Object.getPrototypeOf(R),P);if(!Object.prototype.hasOwnProperty.call(H,"__original"))try{Object.defineProperty(H,"__original",{value:R,writable:!1,enumerable:!1,configurable:!1})}catch{}return H},G=T.useMemo(()=>{const R=E,P=R?.language;let H=R;R&&(U.current&&U.current.__original===R?I.current!==P?(H=B(R),U.current=H,I.current=P):H=U.current:(H=B(R),U.current=H,I.current=P));const Y=[M,H,k];return Y.t=M,Y.i18n=H,Y.ready=k,Y},[M,E,k,E.resolvedLanguage,E.language,E.languages]);if(s&&c&&!k)throw new Promise(R=>{const P=()=>R();e.lng?n5(s,e.lng,p,P):jx(s,p,P)});return G};class OM{get(e,t){const r=localStorage.getItem(e);return r?r==="true"?!0:r==="false"?!1:t:t}set(e,t){localStorage.setItem(e,t?"true":"false")}getFloat(e,t){const r=localStorage.getItem(e);if(!r)return t;const i=parseFloat(r);return isNaN(i)?t:i}setFloat(e,t){localStorage.setItem(e,t.toString())}emojis(){return this.get("settings.emojis",!0)}performanceOverlay(){return this.get("settings.performanceOverlay",!1)}alertFrame(){return this.get("settings.alertFrame",!0)}anonymousNames(){return this.get("settings.anonymousNames",!1)}lobbyIdVisibility(){return this.get("settings.lobbyIdVisibility",!0)}fxLayer(){return this.get("settings.specialEffects",!0)}structureSprites(){return this.get("settings.structureSprites",!0)}darkMode(){return this.get("settings.darkMode",!0)}leftClickOpensMenu(){return this.get("settings.leftClickOpensMenu",!1)}territoryPatterns(){return this.get("settings.territoryPatterns",!0)}attackRatio(){return this.getFloat("settings.attackRatio",.2)}setAttackRatio(e){this.setFloat("settings.attackRatio",e)}toggleLeftClickOpenMenu(){this.set("settings.leftClickOpensMenu",!this.leftClickOpensMenu())}toggleEmojis(){this.set("settings.emojis",!this.emojis())}togglePerformanceOverlay(){this.set("settings.performanceOverlay",!this.performanceOverlay())}toggleAlertFrame(){this.set("settings.alertFrame",!this.alertFrame())}toggleRandomName(){this.set("settings.anonymousNames",!this.anonymousNames())}toggleLobbyIdVisibility(){this.set("settings.lobbyIdVisibility",!this.lobbyIdVisibility())}toggleFxLayer(){this.set("settings.specialEffects",!this.fxLayer())}toggleStructureSprites(){this.set("settings.structureSprites",!this.structureSprites())}toggleTerritoryPatterns(){this.set("settings.territoryPatterns",!this.territoryPatterns())}toggleDarkMode(){this.set("settings.darkMode",!this.darkMode()),this.darkMode()?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}backgroundMusicVolume(){return this.getFloat("settings.backgroundMusicVolume",0)}setBackgroundMusicVolume(e){this.setFloat("settings.backgroundMusicVolume",e)}soundEffectsVolume(){return this.getFloat("settings.soundEffectsVolume",1)}setSoundEffectsVolume(e){this.setFloat("settings.soundEffectsVolume",e)}}const Ph={toggleView:"Space",buildCity:"Digit1",buildFactory:"Digit2",buildPort:"Digit3",buildDefensePost:"Digit4",buildMissileSilo:"Digit5",buildSAMLauncher:"Digit6",buildWarship:"Digit7",buildAtomBomb:"Digit8",buildHydrogenBomb:"Digit9",buildMIRV:"Digit0",attackRatioDecrease:"KeyT",attackRatioIncrease:"KeyY",boatAttack:"KeyB",groundAttack:"KeyG",zoomOut:"KeyQ",zoomIn:"KeyE",centerCamera:"KeyC",moveUp:"KeyW",moveLeft:"KeyA",moveDown:"KeyS",moveRight:"KeyD",modifierKey:"ControlLeft",altKey:"AltLeft"};function LM(n){return n.startsWith("Key")?n.replace("Key",""):n.startsWith("Digit")?n.replace("Digit",""):n==="Space"?"Space":n}class zM{constructor(e="frontwars"){this.prefix=e}getKey(e){return`${this.prefix}:${e}`}set(e,t){try{const r=JSON.stringify(t);localStorage.setItem(this.getKey(e),r)}catch(r){console.error(`Failed to save ${e} to localStorage:`,r)}}get(e,t=null){try{const r=localStorage.getItem(this.getKey(e));return r===null?t:JSON.parse(r)}catch(r){return console.error(`Failed to read ${e} from localStorage:`,r),t}}remove(e){try{localStorage.removeItem(this.getKey(e))}catch(t){console.error(`Failed to remove ${e} from localStorage:`,t)}}clear(){try{Object.keys(localStorage).forEach(t=>{t.startsWith(`${this.prefix}:`)&&localStorage.removeItem(t)})}catch(e){console.error("Failed to clear localStorage:",e)}}has(e){try{return localStorage.getItem(this.getKey(e))!==null}catch(t){return console.error(`Failed to check ${e} in localStorage:`,t),!1}}}class t8{constructor(){this.storage=new zM("frontwars:player")}getFlag(){return this.storage.get("flag",null)}setFlag(e){this.storage.set("flag",e)}getPattern(){return this.storage.get("pattern",null)}setPattern(e){this.storage.set("pattern",e)}getColorPalette(){return this.storage.get("colorPalette",null)}setColorPalette(e){this.storage.set("colorPalette",e)}getColor(){return this.storage.get("color",null)}setColor(e){this.storage.set("color",e)}getUsername(){return this.storage.get("username","")||""}setUsername(e){this.storage.set("username",e)}getSession(){return this.storage.get("frontwars_session",null)}setSession(e,t){this.storage.set("frontwars_session",{gameID:e,clientID:t})}clear(){this.storage.clear()}}class u2{constructor(){this.storage=new zM("frontwars:app")}getLanguage(){return this.storage.get("language","en")||"en"}setLanguage(e){this.storage.set("language",e)}setKeybinds(e){this.storage.set("keybinds",e)}getKeybinds(){const e=this.storage.get("keybinds",null),t={};for(const r in Ph)t[r]=e?.[r]??Ph[r];return t}getCurrentVersion(){return this.storage.get("current_version",null)}setCurrentVersion(e){this.storage.set("current_version",e)}clear(){this.storage.clear()}}const et=new t8,jo=new u2,Re=new OM,s5="main-menu-container";var yt=(n=>(n.Light="light",n.Dark="dark",n))(yt||{});const UM=T.createContext(void 0);function n8({children:n}){const[e,t]=T.useState(()=>Re.darkMode()?"dark":"light");T.useEffect(()=>{(()=>{const s=document.getElementById(s5);s&&(e==="light"?s.setAttribute("data-theme","light"):s.setAttribute("data-theme","dark"))})()},[e]);const r=()=>{Re.toggleDarkMode();const i=Re.darkMode()?"dark":"light";t(i);const s=document.getElementById(s5);s&&(i==="light"?s.setAttribute("data-theme","light"):s.removeAttribute("data-theme"))};return g.jsx(UM.Provider,{value:{theme:e,toggleTheme:r},children:n})}function Dc(){const n=T.useContext(UM);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n}const a5=[{name:"North America",x:[200,600],y:[200,500]},{name:"South America",x:[400,650],y:[550,900]},{name:"Europe",x:[800,1100],y:[200,450]},{name:"Africa",x:[850,1200],y:[450,800]},{name:"Asia",x:[1100,1700],y:[200,600]},{name:"Australia",x:[1200,1500],y:[650,850]}];function h2(){const n=a5[Math.floor(Math.random()*a5.length)],e=n.x[0]+Math.random()*(n.x[1]-n.x[0]),t=n.y[0]+Math.random()*(n.y[1]-n.y[0]);return{x:e,y:t}}function r8(){const n=4+Math.floor(Math.random()*2),e=[];for(let t=0;t<n;t++){const r=h2();e.push({id:`launcher-${t+1}`,x:r.x,y:r.y,nextMoveTime:Date.now()+15e3+Math.random()*1e4})}return e}function i8(n){let t,r,i=0;do{const s=h2();t=s.x,r=s.y,i++}while(i<100&&n.some(s=>Math.sqrt(Math.pow(t-s.x,2)+Math.pow(r-s.y,2))<150));return{x:t,y:r}}function s8(n,e,t){return t.reduce((r,i)=>{const s=Math.sqrt(Math.pow(n-r.x,2)+Math.pow(e-r.y,2));return Math.sqrt(Math.pow(n-i.x,2)+Math.pow(e-i.y,2))<s?i:r})}function a8(n,e,t,r){const i=Math.sqrt(Math.pow(t-n,2)+Math.pow(r-e,2)),s=(n+t)/2,o=Math.min(i*.25,200),c=Math.min(e,r)-o,u=`M ${n} ${e} Q ${s} ${c} ${t} ${r}`,d=i*1.3;return{path:u,length:d}}function FM({imagePath:n,className:e="",blurAmount:t=3,children:r}){const{theme:i}=Dc(),[s,o]=T.useState(()=>r8()),[c,u]=T.useState([]),[d,f]=T.useState([]),[p,y]=T.useState([]),[b,_]=T.useState(()=>Date.now()),w=T.useRef(null),S=T.useRef(null),A=T.useRef(null),M=T.useRef(null),k=T.useRef(Date.now()),E=n||(i===yt.Light?"/images/background/background_light.png":"/images/background/background.png"),U=()=>{if(i===yt.Light){const G=document.getElementById("main-menu-container"),R=G&&getComputedStyle(G).getPropertyValue("--bg-light-brightness")||"1.0",P=G&&getComputedStyle(G).getPropertyValue("--bg-light-contrast")||"1.1",H=G&&getComputedStyle(G).getPropertyValue("--bg-light-hue-rotate")||"180deg",Y=G&&getComputedStyle(G).getPropertyValue("--bg-light-saturate")||"1.3";return`blur(${t}px) brightness(${R}) contrast(${P}) hue-rotate(${H}) saturate(${Y})`}return`blur(${t}px)`},I=()=>{if(i===yt.Light){const G=document.getElementById("main-menu-container"),R=G&&getComputedStyle(G).getPropertyValue("--bg-light-overlay-opacity")||"0.15";return parseFloat(R)}return 0},B=()=>{if(i===yt.Light){const G=document.getElementById("main-menu-container");return G&&getComputedStyle(G).getPropertyValue("--bg-light-color-overlay")||"rgba(45, 212, 191, 0.25)"}return"transparent"};return T.useEffect(()=>()=>{w.current&&clearInterval(w.current),S.current&&cancelAnimationFrame(S.current),A.current&&clearInterval(A.current)},[]),T.useEffect(()=>(A.current=setInterval(()=>{o(G=>{const R=Date.now();return G.map(P=>{if(R>=P.nextMoveTime){const H=h2();return{...P,x:H.x,y:H.y,nextMoveTime:R+15e3+Math.random()*1e4}}return P})})},1e3),()=>{A.current&&clearInterval(A.current)}),[]),T.useEffect(()=>{const G=()=>{o(R=>{const P={id:`target-${Date.now()}-${Math.random()}`,...i8(R),createdAt:Date.now()};return u(H=>[...H,P]),setTimeout(()=>{o(H=>{const Y=s8(P.x,P.y,H),{path:L,length:q}=a8(Y.x,Y.y,P.x,P.y),W={id:`missile-${Date.now()}-${Math.random()}`,launcherId:Y.id,targetId:P.id,startX:Y.x,startY:Y.y,endX:P.x,endY:P.y,path:L,pathLength:q,createdAt:Date.now()};return f(N=>[...N,W]),H})},300+Math.random()*400),R})};return G(),w.current=setInterval(()=>{G()},4e3+Math.random()*2e3),()=>{w.current&&clearInterval(w.current)}},[]),T.useEffect(()=>{const G=Date.now();_(G),k.current=G;const R=()=>{const P=Date.now(),H=4e3,Y=1500;P-k.current>=33?(_(P),k.current=P):_(L=>L+(P-L)),f(L=>{const q=[],W=new Set,N=L.filter(V=>P-V.createdAt>=H?(q.push({id:`explosion-${P}-${Math.random()}`,x:V.endX,y:V.endY,createdAt:P}),W.add(V.targetId),!1):!0);return q.length>0&&y(V=>[...V,...q]),W.size>0&&u(V=>V.filter(J=>!W.has(J.id))),N}),y(L=>L.filter(q=>P-q.createdAt<Y)),u(L=>L.filter(q=>P-q.createdAt<12e3)),S.current=requestAnimationFrame(R)};return S.current=requestAnimationFrame(R),()=>{S.current&&cancelAnimationFrame(S.current)}},[]),g.jsxs("div",{className:`h-full ${e}`,children:[g.jsx("div",{className:"absolute inset-0 -z-10",style:{backgroundImage:`url(${E})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",filter:U()}}),i===yt.Light&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"absolute inset-0 -z-10",style:{backgroundColor:`rgba(0, 0, 0, ${I()})`,mixBlendMode:"multiply"}}),g.jsx("div",{className:"absolute inset-0 -z-10",style:{backgroundColor:B(),mixBlendMode:"overlay"}})]}),g.jsxs("svg",{ref:M,className:"absolute inset-0 -z-10 w-full h-full",viewBox:"0 0 1920 1080",preserveAspectRatio:"xMidYMid slice",style:{pointerEvents:"none",filter:`blur(${t}px)`},children:[d.map(G=>{const R=b-G.createdAt;if(R<=0)return null;const P=Math.min(R/4e3,1);if(P>=1)return null;const H=G.pathLength*(1-P),Y=Math.max(.3,.9-P*.6);return g.jsxs("g",{children:[g.jsx("path",{d:G.path,fill:"none",stroke:"var(--color-explosion-outer)",strokeWidth:"4",strokeOpacity:Y*.3,strokeDasharray:G.pathLength,strokeDashoffset:H,filter:"url(#glow)"}),g.jsx("path",{d:G.path,fill:"none",stroke:"var(--color-red-500)",strokeWidth:"2",strokeOpacity:Y,strokeDasharray:G.pathLength,strokeDashoffset:H,strokeLinecap:"round"})]},G.id)}),s.map(G=>{const R=b%2e3/2e3,P=.8+Math.sin(R*Math.PI*2)*.2;return g.jsxs("g",{children:[g.jsx("circle",{cx:G.x,cy:G.y,r:12*P,fill:"none",stroke:"var(--color-red-500)",strokeWidth:"1.5",opacity:.3*P}),g.jsx("circle",{cx:G.x,cy:G.y,r:8*P,fill:"var(--color-red-500)",opacity:.5*P}),g.jsx("circle",{cx:G.x,cy:G.y,r:"5",fill:"var(--color-red-600)"}),g.jsx("circle",{cx:G.x,cy:G.y,r:"2",fill:"var(--color-white)"})]},G.id)}),c.map(G=>{const R=b-G.createdAt;if(R<=0)return null;const P=R%1e3/1e3,H=12+Math.sin(P*Math.PI*2)*4;return g.jsxs("g",{children:[g.jsx("circle",{cx:G.x,cy:G.y,r:H,fill:"none",stroke:"var(--color-red-500)",strokeWidth:"1.5",opacity:.6}),g.jsx("circle",{cx:G.x,cy:G.y,r:"14",fill:"none",stroke:"var(--color-red-600)",strokeWidth:"2",opacity:"0.9"}),g.jsx("line",{x1:G.x-10,y1:G.y,x2:G.x+10,y2:G.y,stroke:"var(--color-red-600)",strokeWidth:"2",opacity:"0.9",strokeLinecap:"round"}),g.jsx("line",{x1:G.x,y1:G.y-10,x2:G.x,y2:G.y+10,stroke:"var(--color-red-600)",strokeWidth:"2",opacity:"0.9",strokeLinecap:"round"}),g.jsx("circle",{cx:G.x,cy:G.y,r:"6",fill:"none",stroke:"var(--color-red-500)",strokeWidth:"1.5",opacity:"0.8"}),g.jsx("circle",{cx:G.x,cy:G.y,r:"3",fill:"var(--color-red-600)"})]},G.id)}),p.map(G=>{const R=b-G.createdAt;if(R<=0)return null;const P=Math.min(R/1500,1);if(P>=1)return null;const Y=P*120,L=Math.max(0,1-P*1.2),q=Y*.4,W=Y*.7,N=Y;return g.jsxs("g",{children:[g.jsx("circle",{cx:G.x,cy:G.y,r:N,fill:"none",stroke:"var(--color-explosion-outer)",strokeWidth:"2",opacity:L*.4}),g.jsx("circle",{cx:G.x,cy:G.y,r:W,fill:"var(--color-explosion-middle)",opacity:L*.6}),g.jsx("circle",{cx:G.x,cy:G.y,r:q,fill:"var(--color-explosion-inner)",opacity:L*.9}),g.jsx("circle",{cx:G.x,cy:G.y,r:q*.5,fill:"var(--color-white)",opacity:L*.8})]},G.id)}),g.jsx("defs",{children:g.jsxs("filter",{id:"glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[g.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),g.jsxs("feMerge",{children:[g.jsx("feMergeNode",{in:"coloredBlur"}),g.jsx("feMergeNode",{in:"SourceGraphic"})]})]})})]}),g.jsx("div",{className:"relative h-full z-10",children:r})]})}function o8({className:n=""}){return g.jsx("div",{className:`flex justify-center ${n}`,children:g.jsx("img",{src:"/images/logo/fw.svg",alt:"FrontWars",className:"h-18.75 w-auto",style:{filter:"drop-shadow(1px 1px 0px var(--logo-shadow-teal-500, var(--logo-shadow-light-teal-500))) drop-shadow(-1px -1px 0px var(--logo-shadow-teal-500, var(--logo-shadow-light-teal-500))) drop-shadow(1px -1px 0px var(--logo-shadow-teal-500, var(--logo-shadow-light-teal-500))) drop-shadow(-1px 1px 0px var(--logo-shadow-teal-500, var(--logo-shadow-light-teal-500))) drop-shadow(3px 3px 0px var(--logo-shadow-teal-700, var(--logo-shadow-light-teal-700))) drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.5))"}})})}var l8=NM();function vr({open:n,onClose:e,children:t,width:r,height:i}){return T.useEffect(()=>{if(!n)return;const s=o=>{o.key==="Escape"&&e()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[n,e]),T.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),n?l8.createPortal(g.jsxs("div",{className:"fixed inset-0 z-10000 flex items-center justify-center",onClick:e,children:[g.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm","aria-hidden":"true"}),g.jsxs("div",{className:`relative z-10 bg-gray-900/95 dark:bg-gray-900/95 rounded-lg shadow-xl overflow-hidden flex flex-col mx-4 ${r?"":"w-full max-w-2xl"} ${i?"":"max-h-[90vh]"}`,style:{...r?{width:r}:{},...i?{height:i}:{}},onClick:s=>s.stopPropagation(),children:[g.jsx("button",{onClick:e,className:"absolute top-3 right-3 z-20 p-1.5 rounded-full hover:bg-gray-700/80 active:bg-gray-600/80 transition-colors cursor-pointer flex items-center justify-center bg-gray-800/60 backdrop-blur-sm","aria-label":"Close modal",children:g.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})}),g.jsx("div",{className:"p-6 flex flex-col flex-1 min-h-0",children:t})]})]}),document.body):null}const GM=JSON.parse(`[{"code":"none","name":"None"},{"code":"Abbasid Caliphate","continent":"Asia","name":"Abbasid Caliphate"},{"code":"Achaemenid Empire","continent":"Asia","name":"Achaemenid Empire"},{"code":"ae","continent":"Asia","name":"United Arab Emirates"},{"code":"af","continent":"Asia","name":"Afghanistan"},{"code":"African union","continent":"Africa","name":"African Union"},{"code":"ag","continent":"North America","name":"Antigua and Barbuda"},{"code":"ai","continent":"North America","name":"Anguilla"},{"code":"1_Airgialla","continent":"Europe","name":"Airgialla"},{"code":"al","continent":"Europe","name":"Albania"},{"code":"Alabama","continent":"North America","name":"Alabama"},{"code":"ax","continent":"Europe","name":"Aland Islands"},{"code":"Alaska","continent":"North America","name":"Alaska"},{"code":"dz","continent":"Africa","name":"Algeria"},{"code":"Amazigh flag","continent":"Africa","name":"Amazigh Flag"},{"code":"amazonas","continent":"South America","name":"Amazonas"},{"code":"as","continent":"Oceania","name":"American Samoa"},{"code":"am","continent":"Asia","name":"Armenia"},{"code":"Anarchist flag","name":"Anarchist Flag"},{"code":"ad","continent":"Europe","name":"Andorra"},{"code":"ao","continent":"Africa","name":"Angola"},{"code":"aq","name":"Antarctica"},{"code":"antipope","continent":"Europe","name":"Anti-Pope"},{"code":"aquitaine","continent":"Europe","name":"Aquitaine"},{"code":"ar","continent":"South America","name":"Argentina"},{"code":"Aram Damascus","continent":"Asia","name":"Aram Damascus"},{"code":"Arabia","continent":"Asia","name":"Arabia"},{"code":"Arizona","continent":"North America","name":"Arizona"},{"code":"Arkansas","continent":"North America","name":"Arkansas"},{"code":"armagnac","continent":"Europe","name":"Armagnac"},{"code":"aw","continent":"South America","name":"Aruba"},{"code":"sh-ac","continent":"Africa","name":"Ascension Island"},{"code":"Assyria","continent":"Asia","name":"Assyria"},{"code":"asturias","continent":"Europe","name":"Asturias"},{"code":"Athens","continent":"Europe","name":"Athens"},{"code":"at","continent":"Europe","name":"Austria"},{"code":"austria-hungary","continent":"Europe","name":"Austria-Hungary"},{"code":"au","continent":"Oceania","name":"Australia"},{"code":"az","continent":"Asia","name":"Azerbaijan"},{"code":"Aztec Empire","continent":"North America","name":"Aztec Empire"},{"code":"bs","continent":"North America","name":"Bahamas"},{"code":"bahia","continent":"South America","name":"Bahia"},{"code":"bh","continent":"Asia","name":"Bahrain"},{"code":"baguette","name":"Baguette"},{"code":"bd","continent":"Asia","name":"Bangladesh"},{"code":"bb","continent":"North America","name":"Barbados"},{"code":"Babylonia","continent":"Asia","name":"Babylonia"},{"code":"es-pv","continent":"Europe","name":"Basque Country"},{"code":"by","continent":"Europe","name":"Belarus"},{"code":"be","continent":"Europe","name":"Belgium"},{"code":"bz","continent":"North America","name":"Belize"},{"code":"bj","continent":"Africa","name":"Benin"},{"code":"bm","continent":"North America","name":"Bermuda"},{"code":"bt","continent":"Asia","name":"Bhutan"},{"code":"bo","continent":"South America","name":"Bolivia"},{"code":"bq","continent":"South America","name":"Bonaire, Sint Eustatius and Saba"},{"code":"ba","continent":"Europe","name":"Bosnia and Herzegovina"},{"code":"bw","continent":"Africa","name":"Botswana"},{"code":"bv","name":"Bouvet Island"},{"code":"br","continent":"South America","name":"Brazil"},{"code":"io","continent":"Asia","name":"British Indian Ocean Territory"},{"code":"brittany","continent":"Europe","name":"Brittany"},{"code":"bn","continent":"Asia","name":"Brunei Darussalam"},{"code":"buenos_aires","continent":"South America","name":"Buenos Aires"},{"code":"bg","continent":"Europe","name":"Bulgaria"},{"code":"bf","continent":"Africa","name":"Burkina Faso"},{"code":"burgundy","continent":"Europe","name":"Burgundy"},{"code":"Burma","continent":"Asia","name":"Burma"},{"code":"bi","continent":"Africa","name":"Burundi"},{"code":"Byzantine Empire","continent":"Europe","name":"Byzantine Empire"},{"code":"cv","continent":"Africa","name":"Cabo Verde"},{"code":"California","continent":"North America","name":"California"},{"code":"kh","continent":"Asia","name":"Cambodia"},{"code":"cm","continent":"Africa","name":"Cameroon"},{"code":"ca","continent":"North America","name":"Canada"},{"code":"ic","continent":"Africa","name":"Canary Islands"},{"code":"Capybara","name":"Capybara"},{"code":"Carthage","continent":"Africa","name":"Carthage"},{"code":"castille","continent":"Europe","name":"Castille"},{"code":"catamarca","continent":"South America","name":"Catamarca"},{"code":"es-ct","continent":"Europe","name":"Catalonia"},{"code":"ky","continent":"North America","name":"Cayman Islands"},{"code":"Ceara","continent":"South America","name":"Cear"},{"code":"cf","continent":"Africa","name":"Central African Republic"},{"code":"td","continent":"Africa","name":"Chad"},{"code":"cl","continent":"South America","name":"Chile"},{"code":"cn","continent":"Asia","name":"China"},{"code":"Chinook","continent":"North America","name":"Chinook"},{"code":"cx","continent":"Asia","name":"Christmas Island"},{"code":"Chuvashia","continent":"Europe","name":"Chuvashia"},{"code":"Circassia","continent":"Asia","name":"Circassia"},{"code":"cp","name":"Clipperton Island"},{"code":"cc","continent":"Asia","name":"Cocos (Keeling) Islands"},{"code":"Colchis","continent":"Asia","name":"Colchis"},{"code":"co","continent":"South America","name":"Colombia"},{"code":"Colorado","continent":"North America","name":"Colorado"},{"code":"km","continent":"Africa","name":"Comoros"},{"code":"Communist flag","name":"Communist Flag"},{"code":"Confederate States","continent":"North America","name":"Confederate States","restricted":true},{"code":"1_Connacht","continent":"Europe","name":"Connacht"},{"code":"ck","continent":"Oceania","name":"Cook Islands"},{"code":"cordoba","continent":"Europe","name":"Cordoba"},{"code":"Corsica","continent":"Europe","name":"Corsica"},{"code":"cr","continent":"North America","name":"Costa Rica"},{"code":"ci","continent":"Africa","name":"Cte d'Ivoire"},{"code":"hr","continent":"Europe","name":"Croatia"},{"code":"Cthulhu Republic","name":"Cthulhu Republic"},{"code":"cu","continent":"North America","name":"Cuba"},{"code":"cw","continent":"South America","name":"Curaao"},{"code":"cy","continent":"Europe","name":"Cyprus"},{"code":"cz","continent":"Europe","name":"Czech Republic"},{"code":"Danzig","continent":"Europe","name":"Danzig"},{"code":"1_Dalriata","continent":"Europe","name":"Dl Riata"},{"code":"dk","continent":"Europe","name":"Denmark"},{"code":"cd","continent":"Africa","name":"Democratic Republic of the Congo"},{"code":"dg","continent":"Asia","name":"Diego Garcia"},{"code":"Dilmun","continent":"Asia","name":"Dilmun"},{"code":"dj","continent":"Africa","name":"Djibouti"},{"code":"dm","continent":"North America","name":"Dominica"},{"code":"do","continent":"North America","name":"Dominican Republic"},{"code":"1_Dumnonia","continent":"Europe","name":"Dumnonia"},{"code":"Dutch East India Company","name":"Dutch East India Company"},{"code":"1_Dyfed","continent":"Europe","name":"Dyfed"},{"code":"1_East Anglia","continent":"Europe","name":"East Anglia"},{"code":"east_germany","continent":"Europe","name":"East Germany"},{"code":"ec","continent":"South America","name":"Ecuador"},{"code":"eg","continent":"Africa","name":"Egypt"},{"code":"Elam","continent":"Asia","name":"Elam"},{"code":"sv","continent":"North America","name":"El Salvador"},{"code":"granada","continent":"Europe","name":"Emirate of Granada"},{"code":"Empire of Japan","continent":"Asia","name":"Empire of Japan"},{"code":"Empire of Japan1","continent":"Asia","name":"Empire of Japan"},{"code":"gb-eng","continent":"Europe","name":"England"},{"code":"gq","continent":"Africa","name":"Equatorial Guinea"},{"code":"er","continent":"Africa","name":"Eritrea"},{"code":"1_Essex","continent":"Europe","name":"Essex"},{"code":"ee","continent":"Europe","name":"Estonia"},{"code":"sz","continent":"Africa","name":"Eswatini"},{"code":"et","continent":"Africa","name":"Ethiopia"},{"code":"eu","continent":"Europe","name":"Europe"},{"code":"fk","continent":"South America","name":"Falkland Islands"},{"code":"fo","continent":"Europe","name":"Faroe Islands"},{"code":"Fascist Spain","continent":"Europe","name":"Fascist Spain","restricted":true},{"code":"fm","continent":"Oceania","name":"Federated States of Micronesia"},{"code":"fj","continent":"Oceania","name":"Fiji"},{"code":"fi","continent":"Europe","name":"Finland"},{"code":"Flanders","continent":"Europe","name":"Flanders"},{"code":"Florida","continent":"North America","name":"Florida"},{"code":"1_Fortriu","continent":"Europe","name":"Fortriu"},{"code":"fr","continent":"Europe","name":"France"},{"code":"1_Franks","continent":"Europe","name":"Franks"},{"code":"French foreign legion","name":"French Foreign Legion"},{"code":"gf","continent":"South America","name":"French Guiana"},{"code":"pf","continent":"Oceania","name":"French Polynesia"},{"code":"frost_giant","name":"Frost Giant"},{"code":"tf","continent":"Africa","name":"French Southern Territories"},{"code":"ga","continent":"Africa","name":"Gabon"},{"code":"galapagos","continent":"South America","name":"Galpagos"},{"code":"es-ga","continent":"Europe","name":"Galicia"},{"code":"gm","continent":"Africa","name":"Gambia"},{"code":"Garamant","continent":"Africa","name":"Garamantes"},{"code":"ge","continent":"Asia","name":"Georgia"},{"code":"Georgia_US","continent":"North America","name":"Georgia (US State)"},{"code":"German Empire","continent":"Europe","name":"German Empire","restricted":true},{"code":"de","continent":"Europe","name":"Germany"},{"code":"gh","continent":"Africa","name":"Ghana"},{"code":"gi","continent":"Europe","name":"Gibraltar"},{"code":"gr","continent":"Europe","name":"Greece"},{"code":"gl","continent":"North America","name":"Greenland"},{"code":"gd","continent":"North America","name":"Grenada"},{"code":"gp","continent":"North America","name":"Guadeloupe"},{"code":"gu","continent":"Oceania","name":"Guam"},{"code":"gt","continent":"North America","name":"Guatemala"},{"code":"gg","continent":"Europe","name":"Guernsey"},{"code":"gn","continent":"Africa","name":"Guinea"},{"code":"gw","continent":"Africa","name":"Guinea-Bissau"},{"code":"1_Gwent","continent":"Europe","name":"Gwent"},{"code":"1_Gwynedd","continent":"Europe","name":"Gwynedd"},{"code":"gy","continent":"South America","name":"Guyana"},{"code":"Habsburg Austria","continent":"Europe","name":"Habsburg Austria"},{"code":"ht","continent":"North America","name":"Haiti"},{"code":"Hawaii","continent":"Oceania","name":"Hawaii"},{"code":"hm","name":"Heard Island and McDonald Islands"},{"code":"va","continent":"Europe","name":"Holy See"},{"code":"Holy Roman Empire","continent":"Europe","name":"Holy Roman Empire"},{"code":"hn","continent":"North America","name":"Honduras"},{"code":"hk","continent":"Asia","name":"Hong Kong"},{"code":"hu","continent":"Europe","name":"Hungary"},{"code":"Hyrcania","continent":"Asia","name":"Hyrcania"},{"code":"is","continent":"Europe","name":"Iceland"},{"code":"Idaho","continent":"North America","name":"Idaho"},{"code":"Illinois","continent":"North America","name":"Illinois"},{"code":"in","continent":"Asia","name":"India"},{"code":"Indiana","continent":"North America","name":"Indiana"},{"code":"id","continent":"Asia","name":"Indonesia"},{"code":"Iowa","continent":"North America","name":"Iowa"},{"code":"iq","continent":"Asia","name":"Iraq"},{"code":"ir","continent":"Asia","name":"Iran"},{"code":"ie","continent":"Europe","name":"Ireland"},{"code":"im","continent":"Europe","name":"Isle of Man"},{"code":"il","continent":"Asia","name":"Israel"},{"code":"it","continent":"Europe","name":"Italy"},{"code":"italy","continent":"Europe","name":"Kingdom of Italy"},{"code":"jm","continent":"North America","name":"Jamaica"},{"code":"jp","continent":"Asia","name":"Japan"},{"code":"je","continent":"Europe","name":"Jersey"},{"code":"jo","continent":"Asia","name":"Jordan"},{"code":"Kansas","continent":"North America","name":"Kansas"},{"code":"kz","continent":"Asia","name":"Kazakhstan"},{"code":"Kemet","continent":"Africa","name":"Kemet"},{"code":"ke","continent":"Africa","name":"Kenya"},{"code":"1_Kent","continent":"Europe","name":"Kent"},{"code":"Kentucky","continent":"North America","name":"Kentucky"},{"code":"Khemet","continent":"Africa","name":"Khemet"},{"code":"Kingdom of Egypt","continent":"Africa","name":"Kingdom of Egypt"},{"code":"Kingdom of Iraq","continent":"Asia","name":"Kingdom of Iraq"},{"code":"Kingdom of Jerusalem","continent":"Asia","name":"Kingdom of Jerusalem"},{"code":"Kingdom of Judah","continent":"Asia","name":"Kingdom of Judah"},{"code":"ki","continent":"Oceania","name":"Kiribati"},{"code":"Kiwi","name":"Kiwi"},{"code":"xk","continent":"Europe","name":"Kosovo"},{"code":"kurdistan","continent":"Asia","name":"Kurdistan"},{"code":"Kush","continent":"Africa","name":"Kush"},{"code":"kw","continent":"Asia","name":"Kuwait"},{"code":"kg","continent":"Asia","name":"Kyrgyzstan"},{"code":"1_Laigin","continent":"Europe","name":"Laigin"},{"code":"la","continent":"Asia","name":"Laos"},{"code":"lv","continent":"Europe","name":"Latvia"},{"code":"League of Nations","name":"League of Nations"},{"code":"lb","continent":"Asia","name":"Lebanon"},{"code":"Leinster","continent":"Europe","name":"Leinster"},{"code":"leon","continent":"Europe","name":"Len"},{"code":"ls","continent":"Africa","name":"Lesotho"},{"code":"lr","continent":"Africa","name":"Liberia"},{"code":"Liberalism_flag","name":"Liberalism Flag"},{"code":"Libyan Jamahiriya","continent":"Africa","name":"Libyan Jamahiriya"},{"code":"ly","continent":"Africa","name":"Libya"},{"code":"li","continent":"Europe","name":"Liechtenstein"},{"code":"Listenbourg","name":"Listenbourg"},{"code":"lt","continent":"Europe","name":"Lithuania"},{"code":"Louisiana","continent":"North America","name":"Louisiana"},{"code":"lu","continent":"Europe","name":"Luxembourg"},{"code":"Lydia","continent":"Asia","name":"Lydia"},{"code":"Macedonia","continent":"Europe","name":"Macedonia"},{"code":"mo","continent":"Asia","name":"Macau"},{"code":"mg","continent":"Africa","name":"Madagascar"},{"code":"Maine","continent":"North America","name":"Maine"},{"code":"mw","continent":"Africa","name":"Malawi"},{"code":"my","continent":"Asia","name":"Malaysia"},{"code":"mv","continent":"Asia","name":"Maldives"},{"code":"ml","continent":"Africa","name":"Mali"},{"code":"mt","continent":"Europe","name":"Malta"},{"code":"Maori flag","continent":"Oceania","name":"Mori Flag"},{"code":"mh","continent":"Oceania","name":"Marshall Islands"},{"code":"mq","continent":"North America","name":"Martinique"},{"code":"Maryland","continent":"North America","name":"Maryland"},{"code":"mr","continent":"Africa","name":"Mauritania"},{"code":"mu","continent":"Africa","name":"Mauritius"},{"code":"yt","continent":"Africa","name":"Mayotte"},{"code":"Median Empire","continent":"Asia","name":"Median Empire"},{"code":"1_Mercia","continent":"Europe","name":"Mercia"},{"code":"mx","continent":"North America","name":"Mexico"},{"code":"Michigan","continent":"North America","name":"Michigan"},{"code":"minas_gerais","continent":"South America","name":"Minas Gerais"},{"code":"Minnesota","continent":"North America","name":"Minnesota"},{"code":"Mississippi","continent":"North America","name":"Mississippi"},{"code":"Missouri","continent":"North America","name":"Missouri"},{"code":"md","continent":"Europe","name":"Moldova"},{"code":"mc","continent":"Europe","name":"Monaco"},{"code":"Mongol Empire","continent":"Asia","name":"Mongol Empire"},{"code":"mn","continent":"Asia","name":"Mongolia"},{"code":"Montana","continent":"North America","name":"Montana"},{"code":"me","continent":"Europe","name":"Montenegro"},{"code":"ms","continent":"North America","name":"Montserrat"},{"code":"ma","continent":"Africa","name":"Morocco"},{"code":"mz","continent":"Africa","name":"Mozambique"},{"code":"1_Munster","continent":"Europe","name":"Munster"},{"code":"mm","continent":"Asia","name":"Myanmar"},{"code":"na","continent":"Africa","name":"Namibia"},{"code":"NATO","name":"NATO"},{"code":"nr","continent":"Oceania","name":"Nauru"},{"code":"Nebraska","continent":"North America","name":"Nebraska"},{"code":"np","continent":"Asia","name":"Nepal"},{"code":"nl","continent":"Europe","name":"Netherlands"},{"code":"neuragic_empire","name":"Neuragic Empire"},{"code":"Nevada","continent":"North America","name":"Nevada"},{"code":"nc","continent":"Oceania","name":"New Caledonia"},{"code":"New_Hampshire","continent":"North America","name":"New Hampshire"},{"code":"New_Jersey","continent":"North America","name":"New Jersey"},{"code":"New_Mexico","continent":"North America","name":"New Mexico"},{"code":"New_York","continent":"North America","name":"New York"},{"code":"nz","continent":"Oceania","name":"New Zealand"},{"code":"ni","continent":"North America","name":"Nicaragua"},{"code":"ne","continent":"Africa","name":"Niger"},{"code":"ng","continent":"Africa","name":"Nigeria"},{"code":"nu","continent":"Oceania","name":"Niue"},{"code":"nf","continent":"Oceania","name":"Norfolk Island"},{"code":"normandy","continent":"Europe","name":"Normandy"},{"code":"North karelia","continent":"Europe","name":"North Karelia"},{"code":"North_Carolina","continent":"North America","name":"North Carolina"},{"code":"North_Dakota","continent":"North America","name":"North Dakota"},{"code":"kp","continent":"Asia","name":"North Korea"},{"code":"mk","continent":"Europe","name":"North Macedonia"},{"code":"northern_ireland","continent":"Europe","name":"Northern Ireland"},{"code":"mp","continent":"Oceania","name":"Northern Mariana Islands"},{"code":"1_Northern Ui Neill","continent":"Europe","name":"Northern U Nill"},{"code":"1_Northumbria","continent":"Europe","name":"Northumbria"},{"code":"no","continent":"Europe","name":"Norway"},{"code":"Ohio","continent":"North America","name":"Ohio"},{"code":"Oklahoma","continent":"North America","name":"Oklahoma"},{"code":"om","continent":"Asia","name":"Oman"},{"code":"Oregon","continent":"North America","name":"Oregon"},{"code":"Ottoman Empire","continent":"Asia","name":"Ottoman Empire"},{"code":"pk","continent":"Asia","name":"Pakistan"},{"code":"pw","continent":"Oceania","name":"Palau"},{"code":"Palekh","continent":"Europe","name":"Palekh"},{"code":"pa","continent":"North America","name":"Panama"},{"code":"pg","continent":"Oceania","name":"Papua New Guinea"},{"code":"Para","continent":"South America","name":"Par"},{"code":"py","continent":"South America","name":"Paraguay"},{"code":"paris","continent":"Europe","name":"Paris"},{"code":"Pennsylvania","continent":"North America","name":"Pennsylvania"},{"code":"pe","continent":"South America","name":"Peru"},{"code":"Persia","continent":"Asia","name":"Persia"},{"code":"ph","continent":"Asia","name":"Philippines"},{"code":"Phrygia","continent":"Asia","name":"Phrygia"},{"code":"pn","continent":"Oceania","name":"Pitcairn"},{"code":"pl","continent":"Europe","name":"Poland"},{"code":"polar_bears","name":"Polar Bears"},{"code":"PolishLithuanian Commonwealth","continent":"Europe","name":"PolishLithuanian Commonwealth"},{"code":"pt","continent":"Europe","name":"Portugal"},{"code":"1_Powys","continent":"Europe","name":"Powys"},{"code":"provence","continent":"Europe","name":"Provence"},{"code":"prussia","continent":"Europe","name":"Prussia"},{"code":"pr","continent":"North America","name":"Puerto Rico"},{"code":"qa","continent":"Asia","name":"Qatar"},{"code":"Qing Dynasty","continent":"Asia","name":"Qing Dynasty"},{"code":"Quebec","continent":"North America","name":"Quebec"},{"code":"Republic of China","continent":"Asia","name":"Republic of China"},{"code":"cg","continent":"Africa","name":"Republic of the Congo"},{"code":"Republic of Egypt","continent":"Africa","name":"Republic of Egypt"},{"code":"Republic of Formosa","continent":"Asia","name":"Republic of Formosa"},{"code":"Republic of Korea","continent":"Asia","name":"Republic of Korea"},{"code":"Republic of Pirates","continent":"North America","name":"Republic of Pirates"},{"code":"re","continent":"Africa","name":"Runion"},{"code":"Rhode_Island","continent":"North America","name":"Rhode Island"},{"code":"rio_de_janeiro","continent":"South America","name":"Rio de Janeiro"},{"code":"Romanov Russia","continent":"Europe","name":"Romanov Russia"},{"code":"ro","continent":"Europe","name":"Romania"},{"code":"Ror Empire","name":"Ror Empire"},{"code":"ru","continent":"Europe","name":"Russia"},{"code":"rw","continent":"Africa","name":"Rwanda"},{"code":"Saba kingdom","continent":"Asia","name":"Saba Kingdom"},{"code":"bl","continent":"North America","name":"Saint Barthlemy"},{"code":"sh-hl","continent":"Africa","name":"Saint Helena"},{"code":"kn","continent":"North America","name":"Saint Kitts and Nevis"},{"code":"lc","continent":"North America","name":"Saint Lucia"},{"code":"mf","continent":"North America","name":"Saint Martin"},{"code":"pm","continent":"North America","name":"Saint Pierre and Miquelon"},{"code":"vc","continent":"North America","name":"Saint Vincent and the Grenadines"},{"code":"Sami flag","continent":"Europe","name":"Sami Flag"},{"code":"ws","continent":"Oceania","name":"Samoa"},{"code":"sm","continent":"Europe","name":"San Marino"},{"code":"Santa Cruz","continent":"South America","name":"Santa Cruz"},{"code":"santa_claus","name":"Santa Claus"},{"code":"st","continent":"Africa","name":"Sao Tome and Principe"},{"code":"Sao Paulo","continent":"South America","name":"So Paulo"},{"code":"sardines","name":"Sardines"},{"code":"Sassanid Empire","continent":"Asia","name":"Sassanid Empire"},{"code":"sa","continent":"Asia","name":"Saudi Arabia"},{"code":"gb-sct","continent":"Europe","name":"Scotland"},{"code":"Second Republic of Iraq","continent":"Asia","name":"Second Republic of Iraq"},{"code":"Second Spanish Republic","continent":"Europe","name":"Second Spanish Republic"},{"code":"sn","continent":"Africa","name":"Senegal"},{"code":"rs","continent":"Europe","name":"Serbia"},{"code":"seville","continent":"Europe","name":"Seville"},{"code":"sc","continent":"Africa","name":"Seychelles"},{"code":"Siam","continent":"Asia","name":"Siam"},{"code":"Siberia","continent":"Asia","name":"Siberia"},{"code":"Sicily","continent":"Europe","name":"Sicily"},{"code":"sl","continent":"Africa","name":"Sierra Leone"},{"code":"sg","continent":"Asia","name":"Singapore"},{"code":"sx","continent":"North America","name":"Sint Maarten"},{"code":"sk","continent":"Europe","name":"Slovakia"},{"code":"si","continent":"Europe","name":"Slovenia"},{"code":"Socialist_flag","name":"Socialist Flag"},{"code":"sb","continent":"Oceania","name":"Solomon Islands"},{"code":"so","continent":"Africa","name":"Somalia"},{"code":"za","continent":"Africa","name":"South Africa"},{"code":"South_Carolina","continent":"North America","name":"South Carolina"},{"code":"South_Dakota","continent":"North America","name":"South Dakota"},{"code":"gs","continent":"Antarctica","name":"South Georgia and the South Sandwich Islands"},{"code":"kr","continent":"Asia","name":"South Korea"},{"code":"ss","continent":"Africa","name":"South Sudan"},{"code":"1_Southern Ui Neill","continent":"Europe","name":"Southern U Nill"},{"code":"es","continent":"Europe","name":"Spain"},{"code":"spanish_empire","continent":"Europe","name":"Spanish Empire"},{"code":"Sparta","continent":"Europe","name":"Sparta"},{"code":"SPQR","continent":"Europe","name":"SPQR"},{"code":"lk","continent":"Asia","name":"Sri Lanka"},{"code":"ps","continent":"Asia","name":"State of Palestine"},{"code":"1_Strathclyde","continent":"Europe","name":"Strathclyde"},{"code":"sd","continent":"Africa","name":"Sudan"},{"code":"Sultanate of Nejd","continent":"Asia","name":"Sultanate of Nejd"},{"code":"sr","continent":"South America","name":"Suriname"},{"code":"1_Sussex","continent":"Europe","name":"Sussex"},{"code":"sj","continent":"Europe","name":"Svalbard and Jan Mayen"},{"code":"se","continent":"Europe","name":"Sweden"},{"code":"Sweden Norway Union","continent":"Europe","name":"Sweden Norway Union"},{"code":"ch","continent":"Europe","name":"Switzerland"},{"code":"sy","continent":"Asia","name":"Syria"},{"code":"tw","continent":"Asia","name":"Taiwan"},{"code":"tj","continent":"Asia","name":"Tajikistan"},{"code":"tz","continent":"Africa","name":"Tanzania"},{"code":"Tennessee","continent":"North America","name":"Tennessee"},{"code":"Texas","continent":"North America","name":"Texas"},{"code":"th","continent":"Asia","name":"Thailand"},{"code":"tibet","continent":"Asia","name":"Tibet"},{"code":"tl","continent":"Asia","name":"Timor-Leste"},{"code":"tg","continent":"Africa","name":"Togo"},{"code":"tk","continent":"Oceania","name":"Tokelau"},{"code":"to","continent":"Oceania","name":"Tonga"},{"code":"tt","continent":"South America","name":"Trinidad and Tobago"},{"code":"sh-ta","continent":"Africa","name":"Tristan da Cunha"},{"code":"Trucial States","continent":"Asia","name":"Trucial States"},{"code":"tn","continent":"Africa","name":"Tunisia"},{"code":"tr","continent":"Asia","name":"Trkiye"},{"code":"tm","continent":"Asia","name":"Turkmenistan"},{"code":"tc","continent":"North America","name":"Turks and Caicos Islands"},{"code":"tv","continent":"Oceania","name":"Tuvalu"},{"code":"USA 1776","continent":"North America","name":"USA 1776"},{"code":"ussr","continent":"Europe","name":"USSR"},{"code":"ug","continent":"Africa","name":"Uganda"},{"code":"ua","continent":"Europe","name":"Ukraine"},{"code":"1_Ulaid","continent":"Europe","name":"Ulaid"},{"code":"Umayyad Caliphate","continent":"Asia","name":"Umayyad Caliphate"},{"code":"United Arab Republic","continent":"Asia","name":"United Arab Republic"},{"code":"gb","continent":"Europe","name":"United Kingdom"},{"code":"un","name":"United Nations"},{"code":"us","continent":"North America","name":"United States of America"},{"code":"Urartu","continent":"Asia","name":"Urartu"},{"code":"uy","continent":"South America","name":"Uruguay"},{"code":"Utah","continent":"North America","name":"Utah"},{"code":"uz","continent":"Asia","name":"Uzbekistan"},{"code":"valencia","continent":"Europe","name":"Valencia"},{"code":"vu","continent":"Oceania","name":"Vanuatu"},{"code":"ve","continent":"South America","name":"Venezuela"},{"code":"venice","continent":"Europe","name":"Venice"},{"code":"Vermont","continent":"North America","name":"Vermont"},{"code":"vn","continent":"Asia","name":"Vietnam"},{"code":"vg","continent":"North America","name":"Virgin Islands (British)"},{"code":"vi","continent":"North America","name":"Virgin Islands (U.S.)"},{"code":"Virginia","continent":"North America","name":"Virginia"},{"code":"gb-wls","continent":"Europe","name":"Wales"},{"code":"Wallonia","continent":"Europe","name":"Wallonia"},{"code":"wf","continent":"Oceania","name":"Wallis and Futuna"},{"code":"Washington","continent":"North America","name":"Washington"},{"code":"1_Wessex","continent":"Europe","name":"Wessex"},{"code":"west_germany","continent":"Europe","name":"West Germany"},{"code":"West Roman Empire","continent":"Europe","name":"West Roman Empire"},{"code":"West_Virginia","continent":"North America","name":"West Virginia"},{"code":"eh","continent":"Africa","name":"Western Sahara"},{"code":"Wisconsin","continent":"North America","name":"Wisconsin"},{"code":"Wyoming","continent":"North America","name":"Wyoming"},{"code":"Yellow_Flag","name":"Yellow Flag"},{"code":"ye","continent":"Asia","name":"Yemen"},{"code":"yugoslavia","continent":"Europe","name":"Yugoslavia"},{"code":"Zaire","continent":"Africa","name":"Zaire"},{"code":"zm","continent":"Africa","name":"Zambia"},{"code":"Zheleznogorsk","continent":"Asia","name":"Zheleznogorsk"},{"code":"zw","continent":"Africa","name":"Zimbabwe"}]`);function c8({name:n,code:e,isSelected:t,onClick:r,itemRef:i}){const s=e==="none"?null:`/flags/${e}.svg`;return g.jsxs("button",{ref:i,onClick:r,className:`flex flex-col items-center gap-2 p-2 rounded-lg border transition-colors cursor-pointer ${t?"border-teal-400 bg-teal-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:"w-16 h-12 flex items-center justify-center rounded",children:e==="none"?g.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800 relative",children:g.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}):g.jsx("img",{src:s||void 0,alt:n,loading:"lazy",className:"w-full h-full object-cover rounded",onError:o=>{o.target.style.display="none"}})}),g.jsx("span",{className:"text-white text-sm text-center max-w-[90px] whitespace-normal leading-tight",children:n})]})}function u8({open:n,onClose:e,onSelectFlag:t,currentFlag:r}){const{t:i}=xt(),[s,o]=T.useState(""),[c,u]=T.useState(""),[d,f]=T.useState([]),[p,y]=T.useState(100),b=T.useRef(null),_=T.useRef(null),w=T.useRef(null),S=50;T.useEffect(()=>{const E=setTimeout(()=>{u(s),y(100)},150);return()=>clearTimeout(E)},[s]),T.useEffect(()=>{if(!n){f([]),y(100),o(""),u("");return}(()=>{const U=GM.map(I=>({name:I.name,code:I.code}));f(U)})()},[n]);const A=T.useMemo(()=>{if(!c.trim())return d;const E=c.toLowerCase();return d.filter(U=>U.name.toLowerCase().includes(E)||U.code.toLowerCase().includes(E))},[d,c]);T.useEffect(()=>{if(w.current&&(w.current.disconnect(),w.current=null),!n||A.length===0||p>=A.length)return;const E=setTimeout(()=>{const U=b.current;if(!U||!_.current)return;const I=new IntersectionObserver(B=>{B[0].isIntersecting&&p<A.length&&y(G=>Math.min(G+S,A.length))},{root:_.current,rootMargin:"200px",threshold:.1});I.observe(U),w.current=I},0);return()=>{clearTimeout(E),w.current&&(w.current.disconnect(),w.current=null)}},[n,A.length,p]);const M=T.useMemo(()=>A.slice(0,p),[A,p]),k=E=>{t&&t(E==="none"?null:E),e()};return g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col h-full",children:[g.jsx("div",{className:"flex items-center justify-center mb-4 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:i("select_flag.title")})}),g.jsx("div",{className:"mb-4 shrink-0",children:g.jsx("input",{type:"text",placeholder:i("select_flag.search"),value:s,onChange:E=>o(E.target.value),className:"w-full px-4 py-2 bg-gray-800/80 border border-gray-700/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-teal-400 transition-colors"})}),g.jsxs("div",{ref:_,className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-200px)] pr-4",children:[g.jsx("div",{className:"grid grid-cols-6 gap-3",children:M.map((E,U)=>{let I=null;r&&(I=r.replace(/\.svg$/,""));const B=I===E.code||r===null&&E.code==="none",R=U===M.length-1&&p<A.length;return g.jsx(c8,{name:E.name,code:E.code,isSelected:B,onClick:()=>k(E.code==="none"?null:E.code),itemRef:R?P=>{b.current=P}:void 0},E.code)})}),p<A.length&&g.jsx("div",{className:"flex justify-center py-4",children:g.jsx("div",{className:"text-gray-400 text-sm",children:i("select_flag.loading_more_flags")})})]})]})})}function Jp(n,e){const t=e(n);if(t.length<3)throw new Error("Pattern data is too short to contain required metadata.");const r=t[0];if(r!==0)throw new Error(`Unrecognized pattern version ${r}.`);const i=t[1],s=t[2],o=i&7,c=i>>>3&31,d=(s&3)<<5|c,f=s>>>2&63,p=d+2,y=f+2,b=p*y,_=Math.ceil(b/8);if(t.length-3<_)throw new Error("Pattern data is too short for the specified dimensions.");return{height:y,width:p,scale:o,bytes:t}}const Zp=class Zp{constructor(e,t){const r=Jp(e.patternData,t);this.height=r.height,this.width=r.width,this.scale=r.scale,this.bitmapBytes=r.bytes}isPrimary(e,t){const r=(e>>this.scale)%this.width,s=(t>>this.scale)%this.height*this.width+r;return this.readBit(s)===0}scaledHeight(){return this.height<<this.scale}scaledWidth(){return this.width<<this.scale}readBit(e){const t=Zp.BITMAP_OFFSET+(e>>>3),r=e&7,i=this.bitmapBytes[t];if(i===void 0)throw new Error("Invalid pattern");return i>>>r&1}};Zp.BITMAP_OFFSET=3;let Ox=Zp;new TextEncoder;const o5=new TextDecoder;function h8(n){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(n);const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function eg(n){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(typeof n=="string"?n:o5.decode(n),{alphabet:"base64url"});let e=n;e instanceof Uint8Array&&(e=o5.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/");try{return h8(e)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}function Uy(n){return n.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}function d8({patternData:n,primaryColor:e,secondaryColor:t,isDefault:r}){const i=T.useRef(null);return T.useEffect(()=>{if(!(!i.current||r||!n))try{const s=Jp(n,eg),o=i.current,c=o.getContext("2d");if(!c)return;const u=4;o.width=s.width*u,o.height=s.height*u;const d=e||"#4a5568",f=t||"#718096";c.fillStyle=d,c.fillRect(0,0,o.width,o.height),c.fillStyle=f;const p=3;for(let y=0;y<s.height;y++)for(let b=0;b<s.width;b++){const _=y*s.width+b,w=p+(_>>>3),S=_&7,A=s.bytes[w];A!==void 0&&(A>>>S&1)===1&&c.fillRect(b*u,y*u,u,u)}}catch(s){console.error("Failed to render pattern:",s)}},[n,e,t,r]),r?g.jsx("div",{className:"w-full h-full bg-white rounded flex items-center justify-center",children:g.jsx("span",{className:"text-gray-400 text-xs font-semibold",children:"Default"})}):g.jsx("canvas",{ref:i,className:"w-full h-full rounded",style:{imageRendering:"pixelated"}})}function f8({item:n,isSelected:e,onClick:t}){const r=n.patternName==="default"&&!n.colorPaletteName,i=n.displayName.split(" ")[0],s=n.displayName.split(" ").slice(1).join(" ");return g.jsxs("button",{onClick:t,className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors cursor-pointer ${e?"border-teal-400 bg-teal-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:"w-20 h-16 rounded overflow-hidden",children:g.jsx(d8,{patternData:n.patternData,primaryColor:n.primaryColor,secondaryColor:n.secondaryColor,isDefault:r})}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-white text-sm font-semibold leading-tight",children:i}),s&&g.jsx("div",{className:"text-gray-400 text-xs leading-tight mt-0.5",children:s})]})]})}function m8({color:n,isSelected:e,onClick:t}){return g.jsx("button",{onClick:t,className:`w-full aspect-square rounded border-2 transition-all cursor-pointer ${e?"border-teal-400 ring-2 ring-teal-400 ring-offset-2 ring-offset-gray-900 scale-105":"border-gray-700 hover:border-gray-600 hover:scale-105"}`,style:{backgroundColor:n},"aria-label":`Color ${n}`})}function p8({open:n,onClose:e,onSelectPattern:t,onSelectColor:r,currentPattern:i,currentColorPalette:s,currentColor:o}){const{t:c}=xt(),[u,d]=T.useState(""),[f,p]=T.useState("skins"),[y,b]=T.useState(null),[_,w]=T.useState([]),[S,A]=T.useState([]);T.useEffect(()=>{if(!n)return;(async()=>{try{const R=await(await fetch("/cosmetics/cosmetics.json")).json();b(R);const P=[{patternName:"default",colorPaletteName:null,displayName:"Default"}];if(Object.entries(R.patterns).forEach(([H,Y])=>{Y.colorPalettes&&Y.colorPalettes.length>0?Y.colorPalettes.forEach(L=>{const q=R.colorPalettes?.[L.name];P.push({patternName:H,colorPaletteName:L.name,displayName:`${Uy(H)} ${Uy(L.name)}`,patternData:Y.pattern,primaryColor:q?.primary,secondaryColor:q?.secondary})}):P.push({patternName:H,colorPaletteName:null,displayName:Uy(H),patternData:Y.pattern})}),A(P),R.colorPalettes){const H=Object.values(R.colorPalettes).map(Y=>Y.primary).filter(Y=>Y!==void 0);w(H)}}catch(G){console.error("Failed to load cosmetics:",G)}})()},[n]);const M=T.useMemo(()=>{if(!u.trim())return S;const B=u.toLowerCase();return S.filter(G=>G.displayName.toLowerCase().includes(B)||G.patternName.toLowerCase().includes(B)||G.colorPaletteName&&G.colorPaletteName.toLowerCase().includes(B))},[S,u]),k=(B,G)=>{t&&t(B,G),e()},E=B=>{r&&r(B),e()},U=B=>{const G=B.patternName==="default"?null:B.patternName;return i===G&&s===B.colorPaletteName},I=B=>o===B;return g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col h-full",children:[g.jsx("div",{className:"flex items-center justify-center mb-4 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:c(f==="skins"?"select_pattern.skins":"select_pattern.colors")})}),g.jsxs("div",{className:"flex justify-center gap-2 mb-6 border-b border-gray-700 shrink-0",children:[g.jsx("button",{onClick:()=>p("skins"),className:`px-4 py-2 font-semibold transition-colors -mb-px cursor-pointer ${f==="skins"?"text-teal-400 border-b-2 border-teal-400":"text-gray-400 hover:text-gray-300"}`,children:c("select_pattern.skins")}),g.jsx("button",{onClick:()=>p("colors"),className:`px-4 py-2 font-semibold transition-colors -mb-px cursor-pointer ${f==="colors"?"text-teal-400 border-b-2 border-teal-400":"text-gray-400 hover:text-gray-300"}`,children:c("select_pattern.colors")})]}),f==="skins"&&g.jsx("div",{className:"mb-4 shrink-0",children:g.jsx("input",{type:"text",placeholder:c("select_pattern.search"),value:u,onChange:B=>d(B.target.value),className:"w-full px-4 py-2 bg-gray-800/80 border border-gray-700/50 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-teal-400 transition-colors"})}),g.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-200px)] pr-4",children:[f==="skins"&&g.jsx("div",{className:"grid grid-cols-5 gap-3",children:M.map((B,G)=>g.jsx(f8,{item:B,isSelected:U(B),onClick:()=>k(B.patternName,B.colorPaletteName)},`${B.patternName}-${B.colorPaletteName||"none"}-${G}`))}),f==="colors"&&g.jsx("div",{className:"flex flex-col items-center gap-4",children:g.jsx("div",{className:"grid grid-cols-10 gap-2 w-full",children:_.map((B,G)=>g.jsx(m8,{color:B,isSelected:I(B),onClick:()=>E(B)},`color-${G}-${B}`))})})]})]})})}function g8(n,e){const t={};return(n[n.length-1]===""?[...n,""]:n).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const y8=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,b8=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,x8={};function l5(n,e){return(x8.jsx?b8:y8).test(n)}const v8=/[ \t\n\f\r]/g;function _8(n){return typeof n=="object"?n.type==="text"?c5(n.value):!1:c5(n)}function c5(n){return n.replace(v8,"")===""}class wd{constructor(e,t,r){this.normal=t,this.property=e,r&&(this.space=r)}}wd.prototype.normal={};wd.prototype.property={};wd.prototype.space=void 0;function HM(n,e){const t={},r={};for(const i of n)Object.assign(t,i.property),Object.assign(r,i.normal);return new wd(t,r,e)}function Lx(n){return n.toLowerCase()}class Xr{constructor(e,t){this.attribute=t,this.property=e}}Xr.prototype.attribute="";Xr.prototype.booleanish=!1;Xr.prototype.boolean=!1;Xr.prototype.commaOrSpaceSeparated=!1;Xr.prototype.commaSeparated=!1;Xr.prototype.defined=!1;Xr.prototype.mustUseProperty=!1;Xr.prototype.number=!1;Xr.prototype.overloadedBoolean=!1;Xr.prototype.property="";Xr.prototype.spaceSeparated=!1;Xr.prototype.space=void 0;let w8=0;const Qe=Xo(),$n=Xo(),zx=Xo(),Ae=Xo(),Jt=Xo(),hc=Xo(),li=Xo();function Xo(){return 2**++w8}const Ux=Object.freeze(Object.defineProperty({__proto__:null,boolean:Qe,booleanish:$n,commaOrSpaceSeparated:li,commaSeparated:hc,number:Ae,overloadedBoolean:zx,spaceSeparated:Jt},Symbol.toStringTag,{value:"Module"})),Fy=Object.keys(Ux);class d2 extends Xr{constructor(e,t,r,i){let s=-1;if(super(e,t),u5(this,"space",i),typeof r=="number")for(;++s<Fy.length;){const o=Fy[s];u5(this,Fy[s],(r&Ux[o])===Ux[o])}}}d2.prototype.defined=!0;function u5(n,e,t){t&&(n[e]=t)}function jc(n){const e={},t={};for(const[r,i]of Object.entries(n.properties)){const s=new d2(r,n.transform(n.attributes||{},r),i,n.space);n.mustUseProperty&&n.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),e[r]=s,t[Lx(r)]=r,t[Lx(s.attribute)]=r}return new wd(e,t,n.space)}const VM=jc({properties:{ariaActiveDescendant:null,ariaAtomic:$n,ariaAutoComplete:null,ariaBusy:$n,ariaChecked:$n,ariaColCount:Ae,ariaColIndex:Ae,ariaColSpan:Ae,ariaControls:Jt,ariaCurrent:null,ariaDescribedBy:Jt,ariaDetails:null,ariaDisabled:$n,ariaDropEffect:Jt,ariaErrorMessage:null,ariaExpanded:$n,ariaFlowTo:Jt,ariaGrabbed:$n,ariaHasPopup:null,ariaHidden:$n,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Jt,ariaLevel:Ae,ariaLive:null,ariaModal:$n,ariaMultiLine:$n,ariaMultiSelectable:$n,ariaOrientation:null,ariaOwns:Jt,ariaPlaceholder:null,ariaPosInSet:Ae,ariaPressed:$n,ariaReadOnly:$n,ariaRelevant:null,ariaRequired:$n,ariaRoleDescription:Jt,ariaRowCount:Ae,ariaRowIndex:Ae,ariaRowSpan:Ae,ariaSelected:$n,ariaSetSize:Ae,ariaSort:null,ariaValueMax:Ae,ariaValueMin:Ae,ariaValueNow:Ae,ariaValueText:null,role:null},transform(n,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function WM(n,e){return e in n?n[e]:e}function YM(n,e){return WM(n,e.toLowerCase())}const S8=jc({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:hc,acceptCharset:Jt,accessKey:Jt,action:null,allow:null,allowFullScreen:Qe,allowPaymentRequest:Qe,allowUserMedia:Qe,alt:null,as:null,async:Qe,autoCapitalize:null,autoComplete:Jt,autoFocus:Qe,autoPlay:Qe,blocking:Jt,capture:null,charSet:null,checked:Qe,cite:null,className:Jt,cols:Ae,colSpan:null,content:null,contentEditable:$n,controls:Qe,controlsList:Jt,coords:Ae|hc,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Qe,defer:Qe,dir:null,dirName:null,disabled:Qe,download:zx,draggable:$n,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Qe,formTarget:null,headers:Jt,height:Ae,hidden:zx,high:Ae,href:null,hrefLang:null,htmlFor:Jt,httpEquiv:Jt,id:null,imageSizes:null,imageSrcSet:null,inert:Qe,inputMode:null,integrity:null,is:null,isMap:Qe,itemId:null,itemProp:Jt,itemRef:Jt,itemScope:Qe,itemType:Jt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Qe,low:Ae,manifest:null,max:null,maxLength:Ae,media:null,method:null,min:null,minLength:Ae,multiple:Qe,muted:Qe,name:null,nonce:null,noModule:Qe,noValidate:Qe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Qe,optimum:Ae,pattern:null,ping:Jt,placeholder:null,playsInline:Qe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Qe,referrerPolicy:null,rel:Jt,required:Qe,reversed:Qe,rows:Ae,rowSpan:Ae,sandbox:Jt,scope:null,scoped:Qe,seamless:Qe,selected:Qe,shadowRootClonable:Qe,shadowRootDelegatesFocus:Qe,shadowRootMode:null,shape:null,size:Ae,sizes:null,slot:null,span:Ae,spellCheck:$n,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ae,step:null,style:null,tabIndex:Ae,target:null,title:null,translate:null,type:null,typeMustMatch:Qe,useMap:null,value:$n,width:Ae,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Jt,axis:null,background:null,bgColor:null,border:Ae,borderColor:null,bottomMargin:Ae,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Qe,declare:Qe,event:null,face:null,frame:null,frameBorder:null,hSpace:Ae,leftMargin:Ae,link:null,longDesc:null,lowSrc:null,marginHeight:Ae,marginWidth:Ae,noResize:Qe,noHref:Qe,noShade:Qe,noWrap:Qe,object:null,profile:null,prompt:null,rev:null,rightMargin:Ae,rules:null,scheme:null,scrolling:$n,standby:null,summary:null,text:null,topMargin:Ae,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ae,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Qe,disableRemotePlayback:Qe,prefix:null,property:null,results:Ae,security:null,unselectable:null},space:"html",transform:YM}),A8=jc({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:li,accentHeight:Ae,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ae,amplitude:Ae,arabicForm:null,ascent:Ae,attributeName:null,attributeType:null,azimuth:Ae,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ae,by:null,calcMode:null,capHeight:Ae,className:Jt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ae,diffuseConstant:Ae,direction:null,display:null,dur:null,divisor:Ae,dominantBaseline:null,download:Qe,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ae,enableBackground:null,end:null,event:null,exponent:Ae,externalResourcesRequired:null,fill:null,fillOpacity:Ae,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:hc,g2:hc,glyphName:hc,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ae,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ae,horizOriginX:Ae,horizOriginY:Ae,id:null,ideographic:Ae,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ae,k:Ae,k1:Ae,k2:Ae,k3:Ae,k4:Ae,kernelMatrix:li,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ae,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ae,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ae,overlineThickness:Ae,paintOrder:null,panose1:null,path:null,pathLength:Ae,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Jt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ae,pointsAtY:Ae,pointsAtZ:Ae,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:li,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:li,rev:li,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:li,requiredFeatures:li,requiredFonts:li,requiredFormats:li,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ae,specularExponent:Ae,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ae,strikethroughThickness:Ae,string:null,stroke:null,strokeDashArray:li,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ae,strokeOpacity:Ae,strokeWidth:null,style:null,surfaceScale:Ae,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:li,tabIndex:Ae,tableValues:null,target:null,targetX:Ae,targetY:Ae,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:li,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ae,underlineThickness:Ae,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ae,values:null,vAlphabetic:Ae,vMathematical:Ae,vectorEffect:null,vHanging:Ae,vIdeographic:Ae,version:null,vertAdvY:Ae,vertOriginX:Ae,vertOriginY:Ae,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ae,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:WM}),$M=jc({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(n,e){return"xlink:"+e.slice(5).toLowerCase()}}),qM=jc({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:YM}),ZM=jc({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(n,e){return"xml:"+e.slice(3).toLowerCase()}}),C8={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},k8=/[A-Z]/g,h5=/-[a-z]/g,T8=/^data[-\w.:]+$/i;function E8(n,e){const t=Lx(e);let r=e,i=Xr;if(t in n.normal)return n.property[n.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&T8.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(h5,N8);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!h5.test(s)){let o=s.replace(k8,M8);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}i=d2}return new i(r,e)}function M8(n){return"-"+n.toLowerCase()}function N8(n){return n.charAt(1).toUpperCase()}const I8=HM([VM,S8,$M,qM,ZM],"html"),f2=HM([VM,A8,$M,qM,ZM],"svg");function R8(n){return n.join(" ").trim()}var Fl={},Gy,d5;function P8(){if(d5)return Gy;d5=1;var n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,i=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,c=/^\s+|\s+$/g,u=`
`,d="/",f="*",p="",y="comment",b="declaration";function _(S,A){if(typeof S!="string")throw new TypeError("First argument must be a string");if(!S)return[];A=A||{};var M=1,k=1;function E(q){var W=q.match(e);W&&(M+=W.length);var N=q.lastIndexOf(u);k=~N?q.length-N:k+q.length}function U(){var q={line:M,column:k};return function(W){return W.position=new I(q),R(),W}}function I(q){this.start=q,this.end={line:M,column:k},this.source=A.source}I.prototype.content=S;function B(q){var W=new Error(A.source+":"+M+":"+k+": "+q);if(W.reason=q,W.filename=A.source,W.line=M,W.column=k,W.source=S,!A.silent)throw W}function G(q){var W=q.exec(S);if(W){var N=W[0];return E(N),S=S.slice(N.length),W}}function R(){G(t)}function P(q){var W;for(q=q||[];W=H();)W!==!1&&q.push(W);return q}function H(){var q=U();if(!(d!=S.charAt(0)||f!=S.charAt(1))){for(var W=2;p!=S.charAt(W)&&(f!=S.charAt(W)||d!=S.charAt(W+1));)++W;if(W+=2,p===S.charAt(W-1))return B("End of comment missing");var N=S.slice(2,W-2);return k+=2,E(N),S=S.slice(W),k+=2,q({type:y,comment:N})}}function Y(){var q=U(),W=G(r);if(W){if(H(),!G(i))return B("property missing ':'");var N=G(s),V=q({type:b,property:w(W[0].replace(n,p)),value:N?w(N[0].replace(n,p)):p});return G(o),V}}function L(){var q=[];P(q);for(var W;W=Y();)W!==!1&&(q.push(W),P(q));return q}return R(),L()}function w(S){return S?S.replace(c,p):p}return Gy=_,Gy}var f5;function D8(){if(f5)return Fl;f5=1;var n=Fl&&Fl.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.default=t;const e=n(P8());function t(r,i){let s=null;if(!r||typeof r!="string")return s;const o=(0,e.default)(r),c=typeof i=="function";return o.forEach(u=>{if(u.type!=="declaration")return;const{property:d,value:f}=u;c?i(d,f,u):f&&(s=s||{},s[d]=f)}),s}return Fl}var Uu={},m5;function j8(){if(m5)return Uu;m5=1,Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,i=/^-(ms)-/,s=function(d){return!d||t.test(d)||n.test(d)},o=function(d,f){return f.toUpperCase()},c=function(d,f){return"".concat(f,"-")},u=function(d,f){return f===void 0&&(f={}),s(d)?d:(d=d.toLowerCase(),f.reactCompat?d=d.replace(i,c):d=d.replace(r,c),d.replace(e,o))};return Uu.camelCase=u,Uu}var Fu,p5;function B8(){if(p5)return Fu;p5=1;var n=Fu&&Fu.__importDefault||function(i){return i&&i.__esModule?i:{default:i}},e=n(D8()),t=j8();function r(i,s){var o={};return!i||typeof i!="string"||(0,e.default)(i,function(c,u){c&&u&&(o[(0,t.camelCase)(c,s)]=u)}),o}return r.default=r,Fu=r,Fu}var O8=B8();const L8=Zo(O8),XM=KM("end"),m2=KM("start");function KM(n){return e;function e(t){const r=t&&t.position&&t.position[n]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function z8(n){const e=m2(n),t=XM(n);if(e&&t)return{start:e,end:t}}function Dh(n){return!n||typeof n!="object"?"":"position"in n||"type"in n?g5(n.position):"start"in n||"end"in n?g5(n):"line"in n||"column"in n?Fx(n):""}function Fx(n){return y5(n&&n.line)+":"+y5(n&&n.column)}function g5(n){return Fx(n&&n.start)+"-"+Fx(n&&n.end)}function y5(n){return n&&typeof n=="number"?n:1}class Cr extends Error{constructor(e,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let i="",s={},o=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof e=="string"?i=e:!s.cause&&e&&(o=!0,i=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?s.ruleId=r:(s.source=r.slice(0,u),s.ruleId=r.slice(u+1))}if(!s.place&&s.ancestors&&s.ancestors){const u=s.ancestors[s.ancestors.length-1];u&&(s.place=u.position)}const c=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=c?c.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=c?c.line:void 0,this.name=Dh(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=o&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Cr.prototype.file="";Cr.prototype.name="";Cr.prototype.reason="";Cr.prototype.message="";Cr.prototype.stack="";Cr.prototype.column=void 0;Cr.prototype.line=void 0;Cr.prototype.ancestors=void 0;Cr.prototype.cause=void 0;Cr.prototype.fatal=void 0;Cr.prototype.place=void 0;Cr.prototype.ruleId=void 0;Cr.prototype.source=void 0;const p2={}.hasOwnProperty,U8=new Map,F8=/[A-Z]/g,G8=new Set(["table","tbody","thead","tfoot","tr"]),H8=new Set(["td","th"]),QM="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function V8(n,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=Q8(t,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=K8(t,e.jsx,e.jsxs)}const i={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?f2:I8,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=JM(i,n,void 0);return s&&typeof s!="string"?s:i.create(n,i.Fragment,{children:s||void 0},void 0)}function JM(n,e,t){if(e.type==="element")return W8(n,e,t);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return Y8(n,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return q8(n,e,t);if(e.type==="mdxjsEsm")return $8(n,e);if(e.type==="root")return Z8(n,e,t);if(e.type==="text")return X8(n,e)}function W8(n,e,t){const r=n.schema;let i=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(i=f2,n.schema=i),n.ancestors.push(e);const s=t3(n,e.tagName,!1),o=J8(n,e);let c=y2(n,e);return G8.has(e.tagName)&&(c=c.filter(function(u){return typeof u=="string"?!_8(u):!0})),e3(n,o,s,e),g2(o,c),n.ancestors.pop(),n.schema=r,n.create(e,s,o,t)}function Y8(n,e){if(e.data&&e.data.estree&&n.evaluater){const r=e.data.estree.body[0];return r.type,n.evaluater.evaluateExpression(r.expression)}Qh(n,e.position)}function $8(n,e){if(e.data&&e.data.estree&&n.evaluater)return n.evaluater.evaluateProgram(e.data.estree);Qh(n,e.position)}function q8(n,e,t){const r=n.schema;let i=r;e.name==="svg"&&r.space==="html"&&(i=f2,n.schema=i),n.ancestors.push(e);const s=e.name===null?n.Fragment:t3(n,e.name,!0),o=eB(n,e),c=y2(n,e);return e3(n,o,s,e),g2(o,c),n.ancestors.pop(),n.schema=r,n.create(e,s,o,t)}function Z8(n,e,t){const r={};return g2(r,y2(n,e)),n.create(e,n.Fragment,r,t)}function X8(n,e){return e.value}function e3(n,e,t,r){typeof t!="string"&&t!==n.Fragment&&n.passNode&&(e.node=r)}function g2(n,e){if(e.length>0){const t=e.length>1?e:e[0];t&&(n.children=t)}}function K8(n,e,t){return r;function r(i,s,o,c){const d=Array.isArray(o.children)?t:e;return c?d(s,o,c):d(s,o)}}function Q8(n,e){return t;function t(r,i,s,o){const c=Array.isArray(s.children),u=m2(r);return e(i,s,o,c,{columnNumber:u?u.column-1:void 0,fileName:n,lineNumber:u?u.line:void 0},void 0)}}function J8(n,e){const t={};let r,i;for(i in e.properties)if(i!=="children"&&p2.call(e.properties,i)){const s=tB(n,i,e.properties[i]);if(s){const[o,c]=s;n.tableCellAlignToStyle&&o==="align"&&typeof c=="string"&&H8.has(e.tagName)?r=c:t[o]=c}}if(r){const s=t.style||(t.style={});s[n.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function eB(n,e){const t={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&n.evaluater){const s=r.data.estree.body[0];s.type;const o=s.expression;o.type;const c=o.properties[0];c.type,Object.assign(t,n.evaluater.evaluateExpression(c.argument))}else Qh(n,e.position);else{const i=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&n.evaluater){const c=r.value.data.estree.body[0];c.type,s=n.evaluater.evaluateExpression(c.expression)}else Qh(n,e.position);else s=r.value===null?!0:r.value;t[i]=s}return t}function y2(n,e){const t=[];let r=-1;const i=n.passKeys?new Map:U8;for(;++r<e.children.length;){const s=e.children[r];let o;if(n.passKeys){const u=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(u){const d=i.get(u)||0;o=u+"-"+d,i.set(u,d+1)}}const c=JM(n,s,o);c!==void 0&&t.push(c)}return t}function tB(n,e,t){const r=E8(n.schema,e);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?g8(t):R8(t)),r.property==="style"){let i=typeof t=="object"?t:nB(n,String(t));return n.stylePropertyNameCase==="css"&&(i=rB(i)),["style",i]}return[n.elementAttributeNameCase==="react"&&r.space?C8[r.property]||r.property:r.attribute,t]}}function nB(n,e){try{return L8(e,{reactCompat:!0})}catch(t){if(n.ignoreInvalidStyle)return{};const r=t,i=new Cr("Cannot parse `style` attribute",{ancestors:n.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=n.filePath||void 0,i.url=QM+"#cannot-parse-style-attribute",i}}function t3(n,e,t){let r;if(!t)r={type:"Literal",value:e};else if(e.includes(".")){const i=e.split(".");let s=-1,o;for(;++s<i.length;){const c=l5(i[s])?{type:"Identifier",name:i[s]}:{type:"Literal",value:i[s]};o=o?{type:"MemberExpression",object:o,property:c,computed:!!(s&&c.type==="Literal"),optional:!1}:c}r=o}else r=l5(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const i=r.value;return p2.call(n.components,i)?n.components[i]:i}if(n.evaluater)return n.evaluater.evaluateExpression(r);Qh(n)}function Qh(n,e){const t=new Cr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:n.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=n.filePath||void 0,t.url=QM+"#cannot-handle-mdx-estrees-without-createevaluater",t}function rB(n){const e={};let t;for(t in n)p2.call(n,t)&&(e[iB(t)]=n[t]);return e}function iB(n){let e=n.replace(F8,sB);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function sB(n){return"-"+n.toLowerCase()}const Hy={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},aB={};function oB(n,e){const t=aB,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,i=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return n3(n,r,i)}function n3(n,e,t){if(lB(n)){if("value"in n)return n.type==="html"&&!t?"":n.value;if(e&&"alt"in n&&n.alt)return n.alt;if("children"in n)return b5(n.children,e,t)}return Array.isArray(n)?b5(n,e,t):""}function b5(n,e,t){const r=[];let i=-1;for(;++i<n.length;)r[i]=n3(n[i],e,t);return r.join("")}function lB(n){return!!(n&&typeof n=="object")}const x5=document.createElement("i");function b2(n){const e="&"+n+";";x5.innerHTML=e;const t=x5.textContent;return t.charCodeAt(t.length-1)===59&&n!=="semi"||t===e?!1:t}function ps(n,e,t,r){const i=n.length;let s=0,o;if(e<0?e=-e>i?0:i+e:e=e>i?i:e,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(e,t),n.splice(...o);else for(t&&n.splice(e,t);s<r.length;)o=r.slice(s,s+1e4),o.unshift(e,0),n.splice(...o),s+=1e4,e+=1e4}function Ri(n,e){return n.length>0?(ps(n,n.length,0,e),n):e}const v5={}.hasOwnProperty;function cB(n){const e={};let t=-1;for(;++t<n.length;)uB(e,n[t]);return e}function uB(n,e){let t;for(t in e){const i=(v5.call(n,t)?n[t]:void 0)||(n[t]={}),s=e[t];let o;if(s)for(o in s){v5.call(i,o)||(i[o]=[]);const c=s[o];hB(i[o],Array.isArray(c)?c:c?[c]:[])}}}function hB(n,e){let t=-1;const r=[];for(;++t<e.length;)(e[t].add==="after"?n:r).push(e[t]);ps(n,0,0,r)}function r3(n,e){const t=Number.parseInt(n,e);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function dc(n){return n.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const cs=$a(/[A-Za-z]/),hi=$a(/[\dA-Za-z]/),dB=$a(/[#-'*+\--9=?A-Z^-~]/);function Gx(n){return n!==null&&(n<32||n===127)}const Hx=$a(/\d/),fB=$a(/[\dA-Fa-f]/),mB=$a(/[!-/:-@[-`{-~]/);function He(n){return n!==null&&n<-2}function $r(n){return n!==null&&(n<0||n===32)}function Mt(n){return n===-2||n===-1||n===32}const pB=$a(new RegExp("\\p{P}|\\p{S}","u")),gB=$a(/\s/);function $a(n){return e;function e(t){return t!==null&&t>-1&&n.test(String.fromCharCode(t))}}function Bc(n){const e=[];let t=-1,r=0,i=0;for(;++t<n.length;){const s=n.charCodeAt(t);let o="";if(s===37&&hi(n.charCodeAt(t+1))&&hi(n.charCodeAt(t+2)))i=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(o=String.fromCharCode(s));else if(s>55295&&s<57344){const c=n.charCodeAt(t+1);s<56320&&c>56319&&c<57344?(o=String.fromCharCode(s,c),i=1):o=""}else o=String.fromCharCode(s);o&&(e.push(n.slice(r,t),encodeURIComponent(o)),r=t+i+1,o=""),i&&(t+=i,i=0)}return e.join("")+n.slice(r)}function sn(n,e,t,r){const i=r?r-1:Number.POSITIVE_INFINITY;let s=0;return o;function o(u){return Mt(u)?(n.enter(t),c(u)):e(u)}function c(u){return Mt(u)&&s++<i?(n.consume(u),c):(n.exit(t),e(u))}}const yB={tokenize:bB};function bB(n){const e=n.attempt(this.parser.constructs.contentInitial,r,i);let t;return e;function r(c){if(c===null){n.consume(c);return}return n.enter("lineEnding"),n.consume(c),n.exit("lineEnding"),sn(n,e,"linePrefix")}function i(c){return n.enter("paragraph"),s(c)}function s(c){const u=n.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,o(c)}function o(c){if(c===null){n.exit("chunkText"),n.exit("paragraph"),n.consume(c);return}return He(c)?(n.consume(c),n.exit("chunkText"),s):(n.consume(c),o)}}const xB={tokenize:vB},_5={tokenize:_B};function vB(n){const e=this,t=[];let r=0,i,s,o;return c;function c(k){if(r<t.length){const E=t[r];return e.containerState=E[1],n.attempt(E[0].continuation,u,d)(k)}return d(k)}function u(k){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,i&&M();const E=e.events.length;let U=E,I;for(;U--;)if(e.events[U][0]==="exit"&&e.events[U][1].type==="chunkFlow"){I=e.events[U][1].end;break}A(r);let B=E;for(;B<e.events.length;)e.events[B][1].end={...I},B++;return ps(e.events,U+1,0,e.events.slice(E)),e.events.length=B,d(k)}return c(k)}function d(k){if(r===t.length){if(!i)return y(k);if(i.currentConstruct&&i.currentConstruct.concrete)return _(k);e.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return e.containerState={},n.check(_5,f,p)(k)}function f(k){return i&&M(),A(r),y(k)}function p(k){return e.parser.lazy[e.now().line]=r!==t.length,o=e.now().offset,_(k)}function y(k){return e.containerState={},n.attempt(_5,b,_)(k)}function b(k){return r++,t.push([e.currentConstruct,e.containerState]),y(k)}function _(k){if(k===null){i&&M(),A(0),n.consume(k);return}return i=i||e.parser.flow(e.now()),n.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:s}),w(k)}function w(k){if(k===null){S(n.exit("chunkFlow"),!0),A(0),n.consume(k);return}return He(k)?(n.consume(k),S(n.exit("chunkFlow")),r=0,e.interrupt=void 0,c):(n.consume(k),w)}function S(k,E){const U=e.sliceStream(k);if(E&&U.push(null),k.previous=s,s&&(s.next=k),s=k,i.defineSkip(k.start),i.write(U),e.parser.lazy[k.start.line]){let I=i.events.length;for(;I--;)if(i.events[I][1].start.offset<o&&(!i.events[I][1].end||i.events[I][1].end.offset>o))return;const B=e.events.length;let G=B,R,P;for(;G--;)if(e.events[G][0]==="exit"&&e.events[G][1].type==="chunkFlow"){if(R){P=e.events[G][1].end;break}R=!0}for(A(r),I=B;I<e.events.length;)e.events[I][1].end={...P},I++;ps(e.events,G+1,0,e.events.slice(B)),e.events.length=I}}function A(k){let E=t.length;for(;E-- >k;){const U=t[E];e.containerState=U[1],U[0].exit.call(e,n)}t.length=k}function M(){i.write([null]),s=void 0,i=void 0,e.containerState._closeFlow=void 0}}function _B(n,e,t){return sn(n,n.attempt(this.parser.constructs.document,e,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function w5(n){if(n===null||$r(n)||gB(n))return 1;if(pB(n))return 2}function x2(n,e,t){const r=[];let i=-1;for(;++i<n.length;){const s=n[i].resolveAll;s&&!r.includes(s)&&(e=s(e,t),r.push(s))}return e}const Vx={name:"attention",resolveAll:wB,tokenize:SB};function wB(n,e){let t=-1,r,i,s,o,c,u,d,f;for(;++t<n.length;)if(n[t][0]==="enter"&&n[t][1].type==="attentionSequence"&&n[t][1]._close){for(r=t;r--;)if(n[r][0]==="exit"&&n[r][1].type==="attentionSequence"&&n[r][1]._open&&e.sliceSerialize(n[r][1]).charCodeAt(0)===e.sliceSerialize(n[t][1]).charCodeAt(0)){if((n[r][1]._close||n[t][1]._open)&&(n[t][1].end.offset-n[t][1].start.offset)%3&&!((n[r][1].end.offset-n[r][1].start.offset+n[t][1].end.offset-n[t][1].start.offset)%3))continue;u=n[r][1].end.offset-n[r][1].start.offset>1&&n[t][1].end.offset-n[t][1].start.offset>1?2:1;const p={...n[r][1].end},y={...n[t][1].start};S5(p,-u),S5(y,u),o={type:u>1?"strongSequence":"emphasisSequence",start:p,end:{...n[r][1].end}},c={type:u>1?"strongSequence":"emphasisSequence",start:{...n[t][1].start},end:y},s={type:u>1?"strongText":"emphasisText",start:{...n[r][1].end},end:{...n[t][1].start}},i={type:u>1?"strong":"emphasis",start:{...o.start},end:{...c.end}},n[r][1].end={...o.start},n[t][1].start={...c.end},d=[],n[r][1].end.offset-n[r][1].start.offset&&(d=Ri(d,[["enter",n[r][1],e],["exit",n[r][1],e]])),d=Ri(d,[["enter",i,e],["enter",o,e],["exit",o,e],["enter",s,e]]),d=Ri(d,x2(e.parser.constructs.insideSpan.null,n.slice(r+1,t),e)),d=Ri(d,[["exit",s,e],["enter",c,e],["exit",c,e],["exit",i,e]]),n[t][1].end.offset-n[t][1].start.offset?(f=2,d=Ri(d,[["enter",n[t][1],e],["exit",n[t][1],e]])):f=0,ps(n,r-1,t-r+3,d),t=r+d.length-f-2;break}}for(t=-1;++t<n.length;)n[t][1].type==="attentionSequence"&&(n[t][1].type="data");return n}function SB(n,e){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,i=w5(r);let s;return o;function o(u){return s=u,n.enter("attentionSequence"),c(u)}function c(u){if(u===s)return n.consume(u),c;const d=n.exit("attentionSequence"),f=w5(u),p=!f||f===2&&i||t.includes(u),y=!i||i===2&&f||t.includes(r);return d._open=!!(s===42?p:p&&(i||!y)),d._close=!!(s===42?y:y&&(f||!p)),e(u)}}function S5(n,e){n.column+=e,n.offset+=e,n._bufferIndex+=e}const AB={name:"autolink",tokenize:CB};function CB(n,e,t){let r=0;return i;function i(b){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(b),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),s}function s(b){return cs(b)?(n.consume(b),o):b===64?t(b):d(b)}function o(b){return b===43||b===45||b===46||hi(b)?(r=1,c(b)):d(b)}function c(b){return b===58?(n.consume(b),r=0,u):(b===43||b===45||b===46||hi(b))&&r++<32?(n.consume(b),c):(r=0,d(b))}function u(b){return b===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(b),n.exit("autolinkMarker"),n.exit("autolink"),e):b===null||b===32||b===60||Gx(b)?t(b):(n.consume(b),u)}function d(b){return b===64?(n.consume(b),f):dB(b)?(n.consume(b),d):t(b)}function f(b){return hi(b)?p(b):t(b)}function p(b){return b===46?(n.consume(b),r=0,f):b===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(b),n.exit("autolinkMarker"),n.exit("autolink"),e):y(b)}function y(b){if((b===45||hi(b))&&r++<63){const _=b===45?y:p;return n.consume(b),_}return t(b)}}const tg={partial:!0,tokenize:kB};function kB(n,e,t){return r;function r(s){return Mt(s)?sn(n,i,"linePrefix")(s):i(s)}function i(s){return s===null||He(s)?e(s):t(s)}}const i3={continuation:{tokenize:EB},exit:MB,name:"blockQuote",tokenize:TB};function TB(n,e,t){const r=this;return i;function i(o){if(o===62){const c=r.containerState;return c.open||(n.enter("blockQuote",{_container:!0}),c.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(o),n.exit("blockQuoteMarker"),s}return t(o)}function s(o){return Mt(o)?(n.enter("blockQuotePrefixWhitespace"),n.consume(o),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),e):(n.exit("blockQuotePrefix"),e(o))}}function EB(n,e,t){const r=this;return i;function i(o){return Mt(o)?sn(n,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):s(o)}function s(o){return n.attempt(i3,e,t)(o)}}function MB(n){n.exit("blockQuote")}const s3={name:"characterEscape",tokenize:NB};function NB(n,e,t){return r;function r(s){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(s),n.exit("escapeMarker"),i}function i(s){return mB(s)?(n.enter("characterEscapeValue"),n.consume(s),n.exit("characterEscapeValue"),n.exit("characterEscape"),e):t(s)}}const a3={name:"characterReference",tokenize:IB};function IB(n,e,t){const r=this;let i=0,s,o;return c;function c(p){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(p),n.exit("characterReferenceMarker"),u}function u(p){return p===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(p),n.exit("characterReferenceMarkerNumeric"),d):(n.enter("characterReferenceValue"),s=31,o=hi,f(p))}function d(p){return p===88||p===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(p),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),s=6,o=fB,f):(n.enter("characterReferenceValue"),s=7,o=Hx,f(p))}function f(p){if(p===59&&i){const y=n.exit("characterReferenceValue");return o===hi&&!b2(r.sliceSerialize(y))?t(p):(n.enter("characterReferenceMarker"),n.consume(p),n.exit("characterReferenceMarker"),n.exit("characterReference"),e)}return o(p)&&i++<s?(n.consume(p),f):t(p)}}const A5={partial:!0,tokenize:PB},C5={concrete:!0,name:"codeFenced",tokenize:RB};function RB(n,e,t){const r=this,i={partial:!0,tokenize:U};let s=0,o=0,c;return u;function u(I){return d(I)}function d(I){const B=r.events[r.events.length-1];return s=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,c=I,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),f(I)}function f(I){return I===c?(o++,n.consume(I),f):o<3?t(I):(n.exit("codeFencedFenceSequence"),Mt(I)?sn(n,p,"whitespace")(I):p(I))}function p(I){return I===null||He(I)?(n.exit("codeFencedFence"),r.interrupt?e(I):n.check(A5,w,E)(I)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),y(I))}function y(I){return I===null||He(I)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),p(I)):Mt(I)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),sn(n,b,"whitespace")(I)):I===96&&I===c?t(I):(n.consume(I),y)}function b(I){return I===null||He(I)?p(I):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),_(I))}function _(I){return I===null||He(I)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),p(I)):I===96&&I===c?t(I):(n.consume(I),_)}function w(I){return n.attempt(i,E,S)(I)}function S(I){return n.enter("lineEnding"),n.consume(I),n.exit("lineEnding"),A}function A(I){return s>0&&Mt(I)?sn(n,M,"linePrefix",s+1)(I):M(I)}function M(I){return I===null||He(I)?n.check(A5,w,E)(I):(n.enter("codeFlowValue"),k(I))}function k(I){return I===null||He(I)?(n.exit("codeFlowValue"),M(I)):(n.consume(I),k)}function E(I){return n.exit("codeFenced"),e(I)}function U(I,B,G){let R=0;return P;function P(W){return I.enter("lineEnding"),I.consume(W),I.exit("lineEnding"),H}function H(W){return I.enter("codeFencedFence"),Mt(W)?sn(I,Y,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):Y(W)}function Y(W){return W===c?(I.enter("codeFencedFenceSequence"),L(W)):G(W)}function L(W){return W===c?(R++,I.consume(W),L):R>=o?(I.exit("codeFencedFenceSequence"),Mt(W)?sn(I,q,"whitespace")(W):q(W)):G(W)}function q(W){return W===null||He(W)?(I.exit("codeFencedFence"),B(W)):G(W)}}}function PB(n,e,t){const r=this;return i;function i(o){return o===null?t(o):(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),s)}function s(o){return r.parser.lazy[r.now().line]?t(o):e(o)}}const Vy={name:"codeIndented",tokenize:jB},DB={partial:!0,tokenize:BB};function jB(n,e,t){const r=this;return i;function i(d){return n.enter("codeIndented"),sn(n,s,"linePrefix",5)(d)}function s(d){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?u(d):He(d)?n.attempt(DB,o,u)(d):(n.enter("codeFlowValue"),c(d))}function c(d){return d===null||He(d)?(n.exit("codeFlowValue"),o(d)):(n.consume(d),c)}function u(d){return n.exit("codeIndented"),e(d)}}function BB(n,e,t){const r=this;return i;function i(o){return r.parser.lazy[r.now().line]?t(o):He(o)?(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),i):sn(n,s,"linePrefix",5)(o)}function s(o){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?e(o):He(o)?i(o):t(o)}}const OB={name:"codeText",previous:zB,resolve:LB,tokenize:UB};function LB(n){let e=n.length-4,t=3,r,i;if((n[t][1].type==="lineEnding"||n[t][1].type==="space")&&(n[e][1].type==="lineEnding"||n[e][1].type==="space")){for(r=t;++r<e;)if(n[r][1].type==="codeTextData"){n[t][1].type="codeTextPadding",n[e][1].type="codeTextPadding",t+=2,e-=2;break}}for(r=t-1,e++;++r<=e;)i===void 0?r!==e&&n[r][1].type!=="lineEnding"&&(i=r):(r===e||n[r][1].type==="lineEnding")&&(n[i][1].type="codeTextData",r!==i+2&&(n[i][1].end=n[r-1][1].end,n.splice(i+2,r-i-2),e-=r-i-2,r=i+2),i=void 0);return n}function zB(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function UB(n,e,t){let r=0,i,s;return o;function o(p){return n.enter("codeText"),n.enter("codeTextSequence"),c(p)}function c(p){return p===96?(n.consume(p),r++,c):(n.exit("codeTextSequence"),u(p))}function u(p){return p===null?t(p):p===32?(n.enter("space"),n.consume(p),n.exit("space"),u):p===96?(s=n.enter("codeTextSequence"),i=0,f(p)):He(p)?(n.enter("lineEnding"),n.consume(p),n.exit("lineEnding"),u):(n.enter("codeTextData"),d(p))}function d(p){return p===null||p===32||p===96||He(p)?(n.exit("codeTextData"),u(p)):(n.consume(p),d)}function f(p){return p===96?(n.consume(p),i++,f):i===r?(n.exit("codeTextSequence"),n.exit("codeText"),e(p)):(s.type="codeTextData",d(p))}}class FB{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,t,r){const i=t||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return r&&Gu(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Gu(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Gu(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);Gu(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Gu(this.left,t.reverse())}}}function Gu(n,e){let t=0;if(e.length<1e4)n.push(...e);else for(;t<e.length;)n.push(...e.slice(t,t+1e4)),t+=1e4}function o3(n){const e={};let t=-1,r,i,s,o,c,u,d;const f=new FB(n);for(;++t<f.length;){for(;t in e;)t=e[t];if(r=f.get(t),t&&r[1].type==="chunkFlow"&&f.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,s=0,s<u.length&&u[s][1].type==="lineEndingBlank"&&(s+=2),s<u.length&&u[s][1].type==="content"))for(;++s<u.length&&u[s][1].type!=="content";)u[s][1].type==="chunkText"&&(u[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,GB(f,t)),t=e[t],d=!0);else if(r[1]._container){for(s=t,i=void 0;s--;)if(o=f.get(s),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(i&&(f.get(i)[1].type="lineEndingBlank"),o[1].type="lineEnding",i=s);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;i&&(r[1].end={...f.get(i)[1].start},c=f.slice(i,t),c.unshift(r),f.splice(i,t-i+1,c))}}return ps(n,0,Number.POSITIVE_INFINITY,f.slice(0)),!d}function GB(n,e){const t=n.get(e)[1],r=n.get(e)[2];let i=e-1;const s=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const c=o.events,u=[],d={};let f,p,y=-1,b=t,_=0,w=0;const S=[w];for(;b;){for(;n.get(++i)[1]!==b;);s.push(i),b._tokenizer||(f=r.sliceStream(b),b.next||f.push(null),p&&o.defineSkip(b.start),b._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(f),b._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),p=b,b=b.next}for(b=t;++y<c.length;)c[y][0]==="exit"&&c[y-1][0]==="enter"&&c[y][1].type===c[y-1][1].type&&c[y][1].start.line!==c[y][1].end.line&&(w=y+1,S.push(w),b._tokenizer=void 0,b.previous=void 0,b=b.next);for(o.events=[],b?(b._tokenizer=void 0,b.previous=void 0):S.pop(),y=S.length;y--;){const A=c.slice(S[y],S[y+1]),M=s.pop();u.push([M,M+A.length-1]),n.splice(M,2,A)}for(u.reverse(),y=-1;++y<u.length;)d[_+u[y][0]]=_+u[y][1],_+=u[y][1]-u[y][0]-1;return d}const HB={resolve:WB,tokenize:YB},VB={partial:!0,tokenize:$B};function WB(n){return o3(n),n}function YB(n,e){let t;return r;function r(c){return n.enter("content"),t=n.enter("chunkContent",{contentType:"content"}),i(c)}function i(c){return c===null?s(c):He(c)?n.check(VB,o,s)(c):(n.consume(c),i)}function s(c){return n.exit("chunkContent"),n.exit("content"),e(c)}function o(c){return n.consume(c),n.exit("chunkContent"),t.next=n.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,i}}function $B(n,e,t){const r=this;return i;function i(o){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),sn(n,s,"linePrefix")}function s(o){if(o===null||He(o))return t(o);const c=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?e(o):n.interrupt(r.parser.constructs.flow,t,e)(o)}}function l3(n,e,t,r,i,s,o,c,u){const d=u||Number.POSITIVE_INFINITY;let f=0;return p;function p(A){return A===60?(n.enter(r),n.enter(i),n.enter(s),n.consume(A),n.exit(s),y):A===null||A===32||A===41||Gx(A)?t(A):(n.enter(r),n.enter(o),n.enter(c),n.enter("chunkString",{contentType:"string"}),w(A))}function y(A){return A===62?(n.enter(s),n.consume(A),n.exit(s),n.exit(i),n.exit(r),e):(n.enter(c),n.enter("chunkString",{contentType:"string"}),b(A))}function b(A){return A===62?(n.exit("chunkString"),n.exit(c),y(A)):A===null||A===60||He(A)?t(A):(n.consume(A),A===92?_:b)}function _(A){return A===60||A===62||A===92?(n.consume(A),b):b(A)}function w(A){return!f&&(A===null||A===41||$r(A))?(n.exit("chunkString"),n.exit(c),n.exit(o),n.exit(r),e(A)):f<d&&A===40?(n.consume(A),f++,w):A===41?(n.consume(A),f--,w):A===null||A===32||A===40||Gx(A)?t(A):(n.consume(A),A===92?S:w)}function S(A){return A===40||A===41||A===92?(n.consume(A),w):w(A)}}function c3(n,e,t,r,i,s){const o=this;let c=0,u;return d;function d(b){return n.enter(r),n.enter(i),n.consume(b),n.exit(i),n.enter(s),f}function f(b){return c>999||b===null||b===91||b===93&&!u||b===94&&!c&&"_hiddenFootnoteSupport"in o.parser.constructs?t(b):b===93?(n.exit(s),n.enter(i),n.consume(b),n.exit(i),n.exit(r),e):He(b)?(n.enter("lineEnding"),n.consume(b),n.exit("lineEnding"),f):(n.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===null||b===91||b===93||He(b)||c++>999?(n.exit("chunkString"),f(b)):(n.consume(b),u||(u=!Mt(b)),b===92?y:p)}function y(b){return b===91||b===92||b===93?(n.consume(b),c++,p):p(b)}}function u3(n,e,t,r,i,s){let o;return c;function c(y){return y===34||y===39||y===40?(n.enter(r),n.enter(i),n.consume(y),n.exit(i),o=y===40?41:y,u):t(y)}function u(y){return y===o?(n.enter(i),n.consume(y),n.exit(i),n.exit(r),e):(n.enter(s),d(y))}function d(y){return y===o?(n.exit(s),u(o)):y===null?t(y):He(y)?(n.enter("lineEnding"),n.consume(y),n.exit("lineEnding"),sn(n,d,"linePrefix")):(n.enter("chunkString",{contentType:"string"}),f(y))}function f(y){return y===o||y===null||He(y)?(n.exit("chunkString"),d(y)):(n.consume(y),y===92?p:f)}function p(y){return y===o||y===92?(n.consume(y),f):f(y)}}function jh(n,e){let t;return r;function r(i){return He(i)?(n.enter("lineEnding"),n.consume(i),n.exit("lineEnding"),t=!0,r):Mt(i)?sn(n,r,t?"linePrefix":"lineSuffix")(i):e(i)}}const qB={name:"definition",tokenize:XB},ZB={partial:!0,tokenize:KB};function XB(n,e,t){const r=this;let i;return s;function s(b){return n.enter("definition"),o(b)}function o(b){return c3.call(r,n,c,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(b)}function c(b){return i=dc(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),b===58?(n.enter("definitionMarker"),n.consume(b),n.exit("definitionMarker"),u):t(b)}function u(b){return $r(b)?jh(n,d)(b):d(b)}function d(b){return l3(n,f,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(b)}function f(b){return n.attempt(ZB,p,p)(b)}function p(b){return Mt(b)?sn(n,y,"whitespace")(b):y(b)}function y(b){return b===null||He(b)?(n.exit("definition"),r.parser.defined.push(i),e(b)):t(b)}}function KB(n,e,t){return r;function r(c){return $r(c)?jh(n,i)(c):t(c)}function i(c){return u3(n,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(c)}function s(c){return Mt(c)?sn(n,o,"whitespace")(c):o(c)}function o(c){return c===null||He(c)?e(c):t(c)}}const QB={name:"hardBreakEscape",tokenize:JB};function JB(n,e,t){return r;function r(s){return n.enter("hardBreakEscape"),n.consume(s),i}function i(s){return He(s)?(n.exit("hardBreakEscape"),e(s)):t(s)}}const eO={name:"headingAtx",resolve:tO,tokenize:nO};function tO(n,e){let t=n.length-2,r=3,i,s;return n[r][1].type==="whitespace"&&(r+=2),t-2>r&&n[t][1].type==="whitespace"&&(t-=2),n[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&n[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(i={type:"atxHeadingText",start:n[r][1].start,end:n[t][1].end},s={type:"chunkText",start:n[r][1].start,end:n[t][1].end,contentType:"text"},ps(n,r,t-r+1,[["enter",i,e],["enter",s,e],["exit",s,e],["exit",i,e]])),n}function nO(n,e,t){let r=0;return i;function i(f){return n.enter("atxHeading"),s(f)}function s(f){return n.enter("atxHeadingSequence"),o(f)}function o(f){return f===35&&r++<6?(n.consume(f),o):f===null||$r(f)?(n.exit("atxHeadingSequence"),c(f)):t(f)}function c(f){return f===35?(n.enter("atxHeadingSequence"),u(f)):f===null||He(f)?(n.exit("atxHeading"),e(f)):Mt(f)?sn(n,c,"whitespace")(f):(n.enter("atxHeadingText"),d(f))}function u(f){return f===35?(n.consume(f),u):(n.exit("atxHeadingSequence"),c(f))}function d(f){return f===null||f===35||$r(f)?(n.exit("atxHeadingText"),c(f)):(n.consume(f),d)}}const rO=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],k5=["pre","script","style","textarea"],iO={concrete:!0,name:"htmlFlow",resolveTo:oO,tokenize:lO},sO={partial:!0,tokenize:uO},aO={partial:!0,tokenize:cO};function oO(n){let e=n.length;for(;e--&&!(n[e][0]==="enter"&&n[e][1].type==="htmlFlow"););return e>1&&n[e-2][1].type==="linePrefix"&&(n[e][1].start=n[e-2][1].start,n[e+1][1].start=n[e-2][1].start,n.splice(e-2,2)),n}function lO(n,e,t){const r=this;let i,s,o,c,u;return d;function d(D){return f(D)}function f(D){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(D),p}function p(D){return D===33?(n.consume(D),y):D===47?(n.consume(D),s=!0,w):D===63?(n.consume(D),i=3,r.interrupt?e:O):cs(D)?(n.consume(D),o=String.fromCharCode(D),S):t(D)}function y(D){return D===45?(n.consume(D),i=2,b):D===91?(n.consume(D),i=5,c=0,_):cs(D)?(n.consume(D),i=4,r.interrupt?e:O):t(D)}function b(D){return D===45?(n.consume(D),r.interrupt?e:O):t(D)}function _(D){const ee="CDATA[";return D===ee.charCodeAt(c++)?(n.consume(D),c===ee.length?r.interrupt?e:Y:_):t(D)}function w(D){return cs(D)?(n.consume(D),o=String.fromCharCode(D),S):t(D)}function S(D){if(D===null||D===47||D===62||$r(D)){const ee=D===47,pe=o.toLowerCase();return!ee&&!s&&k5.includes(pe)?(i=1,r.interrupt?e(D):Y(D)):rO.includes(o.toLowerCase())?(i=6,ee?(n.consume(D),A):r.interrupt?e(D):Y(D)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):s?M(D):k(D))}return D===45||hi(D)?(n.consume(D),o+=String.fromCharCode(D),S):t(D)}function A(D){return D===62?(n.consume(D),r.interrupt?e:Y):t(D)}function M(D){return Mt(D)?(n.consume(D),M):P(D)}function k(D){return D===47?(n.consume(D),P):D===58||D===95||cs(D)?(n.consume(D),E):Mt(D)?(n.consume(D),k):P(D)}function E(D){return D===45||D===46||D===58||D===95||hi(D)?(n.consume(D),E):U(D)}function U(D){return D===61?(n.consume(D),I):Mt(D)?(n.consume(D),U):k(D)}function I(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(n.consume(D),u=D,B):Mt(D)?(n.consume(D),I):G(D)}function B(D){return D===u?(n.consume(D),u=null,R):D===null||He(D)?t(D):(n.consume(D),B)}function G(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||$r(D)?U(D):(n.consume(D),G)}function R(D){return D===47||D===62||Mt(D)?k(D):t(D)}function P(D){return D===62?(n.consume(D),H):t(D)}function H(D){return D===null||He(D)?Y(D):Mt(D)?(n.consume(D),H):t(D)}function Y(D){return D===45&&i===2?(n.consume(D),N):D===60&&i===1?(n.consume(D),V):D===62&&i===4?(n.consume(D),F):D===63&&i===3?(n.consume(D),O):D===93&&i===5?(n.consume(D),se):He(D)&&(i===6||i===7)?(n.exit("htmlFlowData"),n.check(sO,X,L)(D)):D===null||He(D)?(n.exit("htmlFlowData"),L(D)):(n.consume(D),Y)}function L(D){return n.check(aO,q,X)(D)}function q(D){return n.enter("lineEnding"),n.consume(D),n.exit("lineEnding"),W}function W(D){return D===null||He(D)?L(D):(n.enter("htmlFlowData"),Y(D))}function N(D){return D===45?(n.consume(D),O):Y(D)}function V(D){return D===47?(n.consume(D),o="",J):Y(D)}function J(D){if(D===62){const ee=o.toLowerCase();return k5.includes(ee)?(n.consume(D),F):Y(D)}return cs(D)&&o.length<8?(n.consume(D),o+=String.fromCharCode(D),J):Y(D)}function se(D){return D===93?(n.consume(D),O):Y(D)}function O(D){return D===62?(n.consume(D),F):D===45&&i===2?(n.consume(D),O):Y(D)}function F(D){return D===null||He(D)?(n.exit("htmlFlowData"),X(D)):(n.consume(D),F)}function X(D){return n.exit("htmlFlow"),e(D)}}function cO(n,e,t){const r=this;return i;function i(o){return He(o)?(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),s):t(o)}function s(o){return r.parser.lazy[r.now().line]?t(o):e(o)}}function uO(n,e,t){return r;function r(i){return n.enter("lineEnding"),n.consume(i),n.exit("lineEnding"),n.attempt(tg,e,t)}}const hO={name:"htmlText",tokenize:dO};function dO(n,e,t){const r=this;let i,s,o;return c;function c(O){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(O),u}function u(O){return O===33?(n.consume(O),d):O===47?(n.consume(O),U):O===63?(n.consume(O),k):cs(O)?(n.consume(O),G):t(O)}function d(O){return O===45?(n.consume(O),f):O===91?(n.consume(O),s=0,_):cs(O)?(n.consume(O),M):t(O)}function f(O){return O===45?(n.consume(O),b):t(O)}function p(O){return O===null?t(O):O===45?(n.consume(O),y):He(O)?(o=p,V(O)):(n.consume(O),p)}function y(O){return O===45?(n.consume(O),b):p(O)}function b(O){return O===62?N(O):O===45?y(O):p(O)}function _(O){const F="CDATA[";return O===F.charCodeAt(s++)?(n.consume(O),s===F.length?w:_):t(O)}function w(O){return O===null?t(O):O===93?(n.consume(O),S):He(O)?(o=w,V(O)):(n.consume(O),w)}function S(O){return O===93?(n.consume(O),A):w(O)}function A(O){return O===62?N(O):O===93?(n.consume(O),A):w(O)}function M(O){return O===null||O===62?N(O):He(O)?(o=M,V(O)):(n.consume(O),M)}function k(O){return O===null?t(O):O===63?(n.consume(O),E):He(O)?(o=k,V(O)):(n.consume(O),k)}function E(O){return O===62?N(O):k(O)}function U(O){return cs(O)?(n.consume(O),I):t(O)}function I(O){return O===45||hi(O)?(n.consume(O),I):B(O)}function B(O){return He(O)?(o=B,V(O)):Mt(O)?(n.consume(O),B):N(O)}function G(O){return O===45||hi(O)?(n.consume(O),G):O===47||O===62||$r(O)?R(O):t(O)}function R(O){return O===47?(n.consume(O),N):O===58||O===95||cs(O)?(n.consume(O),P):He(O)?(o=R,V(O)):Mt(O)?(n.consume(O),R):N(O)}function P(O){return O===45||O===46||O===58||O===95||hi(O)?(n.consume(O),P):H(O)}function H(O){return O===61?(n.consume(O),Y):He(O)?(o=H,V(O)):Mt(O)?(n.consume(O),H):R(O)}function Y(O){return O===null||O===60||O===61||O===62||O===96?t(O):O===34||O===39?(n.consume(O),i=O,L):He(O)?(o=Y,V(O)):Mt(O)?(n.consume(O),Y):(n.consume(O),q)}function L(O){return O===i?(n.consume(O),i=void 0,W):O===null?t(O):He(O)?(o=L,V(O)):(n.consume(O),L)}function q(O){return O===null||O===34||O===39||O===60||O===61||O===96?t(O):O===47||O===62||$r(O)?R(O):(n.consume(O),q)}function W(O){return O===47||O===62||$r(O)?R(O):t(O)}function N(O){return O===62?(n.consume(O),n.exit("htmlTextData"),n.exit("htmlText"),e):t(O)}function V(O){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(O),n.exit("lineEnding"),J}function J(O){return Mt(O)?sn(n,se,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):se(O)}function se(O){return n.enter("htmlTextData"),o(O)}}const v2={name:"labelEnd",resolveAll:gO,resolveTo:yO,tokenize:bO},fO={tokenize:xO},mO={tokenize:vO},pO={tokenize:_O};function gO(n){let e=-1;const t=[];for(;++e<n.length;){const r=n[e][1];if(t.push(n[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const i=r.type==="labelImage"?4:2;r.type="data",e+=i}}return n.length!==t.length&&ps(n,0,n.length,t),n}function yO(n,e){let t=n.length,r=0,i,s,o,c;for(;t--;)if(i=n[t][1],s){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;n[t][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(o){if(n[t][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(s=t,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(o=t);const u={type:n[s][1].type==="labelLink"?"link":"image",start:{...n[s][1].start},end:{...n[n.length-1][1].end}},d={type:"label",start:{...n[s][1].start},end:{...n[o][1].end}},f={type:"labelText",start:{...n[s+r+2][1].end},end:{...n[o-2][1].start}};return c=[["enter",u,e],["enter",d,e]],c=Ri(c,n.slice(s+1,s+r+3)),c=Ri(c,[["enter",f,e]]),c=Ri(c,x2(e.parser.constructs.insideSpan.null,n.slice(s+r+4,o-3),e)),c=Ri(c,[["exit",f,e],n[o-2],n[o-1],["exit",d,e]]),c=Ri(c,n.slice(o+1)),c=Ri(c,[["exit",u,e]]),ps(n,s,n.length,c),n}function bO(n,e,t){const r=this;let i=r.events.length,s,o;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){s=r.events[i][1];break}return c;function c(y){return s?s._inactive?p(y):(o=r.parser.defined.includes(dc(r.sliceSerialize({start:s.end,end:r.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(y),n.exit("labelMarker"),n.exit("labelEnd"),u):t(y)}function u(y){return y===40?n.attempt(fO,f,o?f:p)(y):y===91?n.attempt(mO,f,o?d:p)(y):o?f(y):p(y)}function d(y){return n.attempt(pO,f,p)(y)}function f(y){return e(y)}function p(y){return s._balanced=!0,t(y)}}function xO(n,e,t){return r;function r(p){return n.enter("resource"),n.enter("resourceMarker"),n.consume(p),n.exit("resourceMarker"),i}function i(p){return $r(p)?jh(n,s)(p):s(p)}function s(p){return p===41?f(p):l3(n,o,c,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(p)}function o(p){return $r(p)?jh(n,u)(p):f(p)}function c(p){return t(p)}function u(p){return p===34||p===39||p===40?u3(n,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(p):f(p)}function d(p){return $r(p)?jh(n,f)(p):f(p)}function f(p){return p===41?(n.enter("resourceMarker"),n.consume(p),n.exit("resourceMarker"),n.exit("resource"),e):t(p)}}function vO(n,e,t){const r=this;return i;function i(c){return c3.call(r,n,s,o,"reference","referenceMarker","referenceString")(c)}function s(c){return r.parser.defined.includes(dc(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(c):t(c)}function o(c){return t(c)}}function _O(n,e,t){return r;function r(s){return n.enter("reference"),n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),i}function i(s){return s===93?(n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),n.exit("reference"),e):t(s)}}const wO={name:"labelStartImage",resolveAll:v2.resolveAll,tokenize:SO};function SO(n,e,t){const r=this;return i;function i(c){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(c),n.exit("labelImageMarker"),s}function s(c){return c===91?(n.enter("labelMarker"),n.consume(c),n.exit("labelMarker"),n.exit("labelImage"),o):t(c)}function o(c){return c===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(c):e(c)}}const AO={name:"labelStartLink",resolveAll:v2.resolveAll,tokenize:CO};function CO(n,e,t){const r=this;return i;function i(o){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(o),n.exit("labelMarker"),n.exit("labelLink"),s}function s(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):e(o)}}const Wy={name:"lineEnding",tokenize:kO};function kO(n,e){return t;function t(r){return n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),sn(n,e,"linePrefix")}}const Qm={name:"thematicBreak",tokenize:TO};function TO(n,e,t){let r=0,i;return s;function s(d){return n.enter("thematicBreak"),o(d)}function o(d){return i=d,c(d)}function c(d){return d===i?(n.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||He(d))?(n.exit("thematicBreak"),e(d)):t(d)}function u(d){return d===i?(n.consume(d),r++,u):(n.exit("thematicBreakSequence"),Mt(d)?sn(n,c,"whitespace")(d):c(d))}}const Hr={continuation:{tokenize:IO},exit:PO,name:"list",tokenize:NO},EO={partial:!0,tokenize:DO},MO={partial:!0,tokenize:RO};function NO(n,e,t){const r=this,i=r.events[r.events.length-1];let s=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,o=0;return c;function c(b){const _=r.containerState.type||(b===42||b===43||b===45?"listUnordered":"listOrdered");if(_==="listUnordered"?!r.containerState.marker||b===r.containerState.marker:Hx(b)){if(r.containerState.type||(r.containerState.type=_,n.enter(_,{_container:!0})),_==="listUnordered")return n.enter("listItemPrefix"),b===42||b===45?n.check(Qm,t,d)(b):d(b);if(!r.interrupt||b===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),u(b)}return t(b)}function u(b){return Hx(b)&&++o<10?(n.consume(b),u):(!r.interrupt||o<2)&&(r.containerState.marker?b===r.containerState.marker:b===41||b===46)?(n.exit("listItemValue"),d(b)):t(b)}function d(b){return n.enter("listItemMarker"),n.consume(b),n.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||b,n.check(tg,r.interrupt?t:f,n.attempt(EO,y,p))}function f(b){return r.containerState.initialBlankLine=!0,s++,y(b)}function p(b){return Mt(b)?(n.enter("listItemPrefixWhitespace"),n.consume(b),n.exit("listItemPrefixWhitespace"),y):t(b)}function y(b){return r.containerState.size=s+r.sliceSerialize(n.exit("listItemPrefix"),!0).length,e(b)}}function IO(n,e,t){const r=this;return r.containerState._closeFlow=void 0,n.check(tg,i,s);function i(c){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,sn(n,e,"listItemIndent",r.containerState.size+1)(c)}function s(c){return r.containerState.furtherBlankLines||!Mt(c)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(c)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,n.attempt(MO,e,o)(c))}function o(c){return r.containerState._closeFlow=!0,r.interrupt=void 0,sn(n,n.attempt(Hr,e,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(c)}}function RO(n,e,t){const r=this;return sn(n,i,"listItemIndent",r.containerState.size+1);function i(s){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(s):t(s)}}function PO(n){n.exit(this.containerState.type)}function DO(n,e,t){const r=this;return sn(n,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(s){const o=r.events[r.events.length-1];return!Mt(s)&&o&&o[1].type==="listItemPrefixWhitespace"?e(s):t(s)}}const T5={name:"setextUnderline",resolveTo:jO,tokenize:BO};function jO(n,e){let t=n.length,r,i,s;for(;t--;)if(n[t][0]==="enter"){if(n[t][1].type==="content"){r=t;break}n[t][1].type==="paragraph"&&(i=t)}else n[t][1].type==="content"&&n.splice(t,1),!s&&n[t][1].type==="definition"&&(s=t);const o={type:"setextHeading",start:{...n[r][1].start},end:{...n[n.length-1][1].end}};return n[i][1].type="setextHeadingText",s?(n.splice(i,0,["enter",o,e]),n.splice(s+1,0,["exit",n[r][1],e]),n[r][1].end={...n[s][1].end}):n[r][1]=o,n.push(["exit",o,e]),n}function BO(n,e,t){const r=this;let i;return s;function s(d){let f=r.events.length,p;for(;f--;)if(r.events[f][1].type!=="lineEnding"&&r.events[f][1].type!=="linePrefix"&&r.events[f][1].type!=="content"){p=r.events[f][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||p)?(n.enter("setextHeadingLine"),i=d,o(d)):t(d)}function o(d){return n.enter("setextHeadingLineSequence"),c(d)}function c(d){return d===i?(n.consume(d),c):(n.exit("setextHeadingLineSequence"),Mt(d)?sn(n,u,"lineSuffix")(d):u(d))}function u(d){return d===null||He(d)?(n.exit("setextHeadingLine"),e(d)):t(d)}}const OO={tokenize:LO};function LO(n){const e=this,t=n.attempt(tg,r,n.attempt(this.parser.constructs.flowInitial,i,sn(n,n.attempt(this.parser.constructs.flow,i,n.attempt(HB,i)),"linePrefix")));return t;function r(s){if(s===null){n.consume(s);return}return n.enter("lineEndingBlank"),n.consume(s),n.exit("lineEndingBlank"),e.currentConstruct=void 0,t}function i(s){if(s===null){n.consume(s);return}return n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),e.currentConstruct=void 0,t}}const zO={resolveAll:d3()},UO=h3("string"),FO=h3("text");function h3(n){return{resolveAll:d3(n==="text"?GO:void 0),tokenize:e};function e(t){const r=this,i=this.parser.constructs[n],s=t.attempt(i,o,c);return o;function o(f){return d(f)?s(f):c(f)}function c(f){if(f===null){t.consume(f);return}return t.enter("data"),t.consume(f),u}function u(f){return d(f)?(t.exit("data"),s(f)):(t.consume(f),u)}function d(f){if(f===null)return!0;const p=i[f];let y=-1;if(p)for(;++y<p.length;){const b=p[y];if(!b.previous||b.previous.call(r,r.previous))return!0}return!1}}}function d3(n){return e;function e(t,r){let i=-1,s;for(;++i<=t.length;)s===void 0?t[i]&&t[i][1].type==="data"&&(s=i,i++):(!t[i]||t[i][1].type!=="data")&&(i!==s+2&&(t[s][1].end=t[i-1][1].end,t.splice(s+2,i-s-2),i=s+2),s=void 0);return n?n(t,r):t}}function GO(n,e){let t=0;for(;++t<=n.length;)if((t===n.length||n[t][1].type==="lineEnding")&&n[t-1][1].type==="data"){const r=n[t-1][1],i=e.sliceStream(r);let s=i.length,o=-1,c=0,u;for(;s--;){const d=i[s];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)c++,o--;if(o)break;o=-1}else if(d===-2)u=!0,c++;else if(d!==-1){s++;break}}if(e._contentTypeTextTrailing&&t===n.length&&(c=0),c){const d={type:t===n.length||u||c<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?o:r.start._bufferIndex+o,_index:r.start._index+s,line:r.end.line,column:r.end.column-c,offset:r.end.offset-c},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(n.splice(t,0,["enter",d,e],["exit",d,e]),t+=2)}t++}return n}const HO={42:Hr,43:Hr,45:Hr,48:Hr,49:Hr,50:Hr,51:Hr,52:Hr,53:Hr,54:Hr,55:Hr,56:Hr,57:Hr,62:i3},VO={91:qB},WO={[-2]:Vy,[-1]:Vy,32:Vy},YO={35:eO,42:Qm,45:[T5,Qm],60:iO,61:T5,95:Qm,96:C5,126:C5},$O={38:a3,92:s3},qO={[-5]:Wy,[-4]:Wy,[-3]:Wy,33:wO,38:a3,42:Vx,60:[AB,hO],91:AO,92:[QB,s3],93:v2,95:Vx,96:OB},ZO={null:[Vx,zO]},XO={null:[42,95]},KO={null:[]},QO=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:XO,contentInitial:VO,disable:KO,document:HO,flow:YO,flowInitial:WO,insideSpan:ZO,string:$O,text:qO},Symbol.toStringTag,{value:"Module"}));function JO(n,e,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const i={},s=[];let o=[],c=[];const u={attempt:B(U),check:B(I),consume:M,enter:k,exit:E,interrupt:B(I,{interrupt:!0})},d={code:null,containerState:{},defineSkip:w,events:[],now:_,parser:n,previous:null,sliceSerialize:y,sliceStream:b,write:p};let f=e.tokenize.call(d,u);return e.resolveAll&&s.push(e),d;function p(H){return o=Ri(o,H),S(),o[o.length-1]!==null?[]:(G(e,0),d.events=x2(s,d.events,d),d.events)}function y(H,Y){return tL(b(H),Y)}function b(H){return eL(o,H)}function _(){const{_bufferIndex:H,_index:Y,line:L,column:q,offset:W}=r;return{_bufferIndex:H,_index:Y,line:L,column:q,offset:W}}function w(H){i[H.line]=H.column,P()}function S(){let H;for(;r._index<o.length;){const Y=o[r._index];if(typeof Y=="string")for(H=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===H&&r._bufferIndex<Y.length;)A(Y.charCodeAt(r._bufferIndex));else A(Y)}}function A(H){f=f(H)}function M(H){He(H)?(r.line++,r.column=1,r.offset+=H===-3?2:1,P()):H!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=H}function k(H,Y){const L=Y||{};return L.type=H,L.start=_(),d.events.push(["enter",L,d]),c.push(L),L}function E(H){const Y=c.pop();return Y.end=_(),d.events.push(["exit",Y,d]),Y}function U(H,Y){G(H,Y.from)}function I(H,Y){Y.restore()}function B(H,Y){return L;function L(q,W,N){let V,J,se,O;return Array.isArray(q)?X(q):"tokenize"in q?X([q]):F(q);function F(Se){return ie;function ie(ve){const Ce=ve!==null&&Se[ve],Le=ve!==null&&Se.null,st=[...Array.isArray(Ce)?Ce:Ce?[Ce]:[],...Array.isArray(Le)?Le:Le?[Le]:[]];return X(st)(ve)}}function X(Se){return V=Se,J=0,Se.length===0?N:D(Se[J])}function D(Se){return ie;function ie(ve){return O=R(),se=Se,Se.partial||(d.currentConstruct=Se),Se.name&&d.parser.constructs.disable.null.includes(Se.name)?pe():Se.tokenize.call(Y?Object.assign(Object.create(d),Y):d,u,ee,pe)(ve)}}function ee(Se){return H(se,O),W}function pe(Se){return O.restore(),++J<V.length?D(V[J]):N}}}function G(H,Y){H.resolveAll&&!s.includes(H)&&s.push(H),H.resolve&&ps(d.events,Y,d.events.length-Y,H.resolve(d.events.slice(Y),d)),H.resolveTo&&(d.events=H.resolveTo(d.events,d))}function R(){const H=_(),Y=d.previous,L=d.currentConstruct,q=d.events.length,W=Array.from(c);return{from:q,restore:N};function N(){r=H,d.previous=Y,d.currentConstruct=L,d.events.length=q,c=W,P()}}function P(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function eL(n,e){const t=e.start._index,r=e.start._bufferIndex,i=e.end._index,s=e.end._bufferIndex;let o;if(t===i)o=[n[t].slice(r,s)];else{if(o=n.slice(t,i),r>-1){const c=o[0];typeof c=="string"?o[0]=c.slice(r):o.shift()}s>0&&o.push(n[i].slice(0,s))}return o}function tL(n,e){let t=-1;const r=[];let i;for(;++t<n.length;){const s=n[t];let o;if(typeof s=="string")o=s;else switch(s){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&i)continue;o=" ";break}default:o=String.fromCharCode(s)}i=s===-2,r.push(o)}return r.join("")}function nL(n){const r={constructs:cB([QO,...(n||{}).extensions||[]]),content:i(yB),defined:[],document:i(xB),flow:i(OO),lazy:{},string:i(UO),text:i(FO)};return r;function i(s){return o;function o(c){return JO(r,s,c)}}}function rL(n){for(;!o3(n););return n}const E5=/[\0\t\n\r]/g;function iL(){let n=1,e="",t=!0,r;return i;function i(s,o,c){const u=[];let d,f,p,y,b;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(o||void 0).decode(s)),p=0,e="",t&&(s.charCodeAt(0)===65279&&p++,t=void 0);p<s.length;){if(E5.lastIndex=p,d=E5.exec(s),y=d&&d.index!==void 0?d.index:s.length,b=s.charCodeAt(y),!d){e=s.slice(p);break}if(b===10&&p===y&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),p<y&&(u.push(s.slice(p,y)),n+=y-p),b){case 0:{u.push(65533),n++;break}case 9:{for(f=Math.ceil(n/4)*4,u.push(-2);n++<f;)u.push(-1);break}case 10:{u.push(-4),n=1;break}default:r=!0,n=1}p=y+1}return c&&(r&&u.push(-5),e&&u.push(e),u.push(null)),u}}const sL=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function aL(n){return n.replace(sL,oL)}function oL(n,e,t){if(e)return e;if(t.charCodeAt(0)===35){const i=t.charCodeAt(1),s=i===120||i===88;return r3(t.slice(s?2:1),s?16:10)}return b2(t)||n}const f3={}.hasOwnProperty;function lL(n,e,t){return typeof e!="string"&&(t=e,e=void 0),cL(t)(rL(nL(t).document().write(iL()(n,e,!0))))}function cL(n){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(Xn),autolinkProtocol:R,autolinkEmail:R,atxHeading:s(zt),blockQuote:s(Le),characterEscape:R,characterReference:R,codeFenced:s(st),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:s(st,o),codeText:s(ft,o),codeTextData:R,data:R,codeFlowValue:R,definition:s(Ge),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:s(It),hardBreakEscape:s(tt),hardBreakTrailing:s(tt),htmlFlow:s(mt,o),htmlFlowData:R,htmlText:s(mt,o),htmlTextData:R,image:s(_t),label:o,link:s(Xn),listItem:s(ke),listItemValue:y,listOrdered:s(Kn,p),listUnordered:s(Kn),paragraph:s(nt),reference:D,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:s(zt),strong:s(wt),thematicBreak:s(kn)},exit:{atxHeading:u(),atxHeadingSequence:U,autolink:u(),autolinkEmail:Ce,autolinkProtocol:ve,blockQuote:u(),characterEscapeValue:P,characterReferenceMarkerHexadecimal:pe,characterReferenceMarkerNumeric:pe,characterReferenceValue:Se,characterReference:ie,codeFenced:u(S),codeFencedFence:w,codeFencedFenceInfo:b,codeFencedFenceMeta:_,codeFlowValue:P,codeIndented:u(A),codeText:u(W),codeTextData:P,data:P,definition:u(),definitionDestinationString:E,definitionLabelString:M,definitionTitleString:k,emphasis:u(),hardBreakEscape:u(Y),hardBreakTrailing:u(Y),htmlFlow:u(L),htmlFlowData:P,htmlText:u(q),htmlTextData:P,image:u(V),label:se,labelText:J,lineEnding:H,link:u(N),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:ee,resourceDestinationString:O,resourceTitleString:F,resource:X,setextHeading:u(G),setextHeadingLineSequence:B,setextHeadingText:I,strong:u(),thematicBreak:u()}};m3(e,(n||{}).mdastExtensions||[]);const t={};return r;function r(de){let we={type:"root",children:[]};const Oe={stack:[we],tokenStack:[],config:e,enter:c,exit:d,buffer:o,resume:f,data:t},qe=[];let pt=-1;for(;++pt<de.length;)if(de[pt][1].type==="listOrdered"||de[pt][1].type==="listUnordered")if(de[pt][0]==="enter")qe.push(pt);else{const Qn=qe.pop();pt=i(de,Qn,pt)}for(pt=-1;++pt<de.length;){const Qn=e[de[pt][0]];f3.call(Qn,de[pt][1].type)&&Qn[de[pt][1].type].call(Object.assign({sliceSerialize:de[pt][2].sliceSerialize},Oe),de[pt][1])}if(Oe.tokenStack.length>0){const Qn=Oe.tokenStack[Oe.tokenStack.length-1];(Qn[1]||M5).call(Oe,void 0,Qn[0])}for(we.position={start:wa(de.length>0?de[0][1].start:{line:1,column:1,offset:0}),end:wa(de.length>0?de[de.length-2][1].end:{line:1,column:1,offset:0})},pt=-1;++pt<e.transforms.length;)we=e.transforms[pt](we)||we;return we}function i(de,we,Oe){let qe=we-1,pt=-1,Qn=!1,Dr,Un,hn,dn;for(;++qe<=Oe;){const vt=de[qe];switch(vt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{vt[0]==="enter"?pt++:pt--,dn=void 0;break}case"lineEndingBlank":{vt[0]==="enter"&&(Dr&&!dn&&!pt&&!hn&&(hn=qe),dn=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:dn=void 0}if(!pt&&vt[0]==="enter"&&vt[1].type==="listItemPrefix"||pt===-1&&vt[0]==="exit"&&(vt[1].type==="listUnordered"||vt[1].type==="listOrdered")){if(Dr){let yi=qe;for(Un=void 0;yi--;){const kr=de[yi];if(kr[1].type==="lineEnding"||kr[1].type==="lineEndingBlank"){if(kr[0]==="exit")continue;Un&&(de[Un][1].type="lineEndingBlank",Qn=!0),kr[1].type="lineEnding",Un=yi}else if(!(kr[1].type==="linePrefix"||kr[1].type==="blockQuotePrefix"||kr[1].type==="blockQuotePrefixWhitespace"||kr[1].type==="blockQuoteMarker"||kr[1].type==="listItemIndent"))break}hn&&(!Un||hn<Un)&&(Dr._spread=!0),Dr.end=Object.assign({},Un?de[Un][1].start:vt[1].end),de.splice(Un||qe,0,["exit",Dr,vt[2]]),qe++,Oe++}if(vt[1].type==="listItemPrefix"){const yi={type:"listItem",_spread:!1,start:Object.assign({},vt[1].start),end:void 0};Dr=yi,de.splice(qe,0,["enter",yi,vt[2]]),qe++,Oe++,hn=void 0,dn=!0}}}return de[we][1]._spread=Qn,Oe}function s(de,we){return Oe;function Oe(qe){c.call(this,de(qe),qe),we&&we.call(this,qe)}}function o(){this.stack.push({type:"fragment",children:[]})}function c(de,we,Oe){this.stack[this.stack.length-1].children.push(de),this.stack.push(de),this.tokenStack.push([we,Oe||void 0]),de.position={start:wa(we.start),end:void 0}}function u(de){return we;function we(Oe){de&&de.call(this,Oe),d.call(this,Oe)}}function d(de,we){const Oe=this.stack.pop(),qe=this.tokenStack.pop();if(qe)qe[0].type!==de.type&&(we?we.call(this,de,qe[0]):(qe[1]||M5).call(this,de,qe[0]));else throw new Error("Cannot close `"+de.type+"` ("+Dh({start:de.start,end:de.end})+"): its not open");Oe.position.end=wa(de.end)}function f(){return oB(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function y(de){if(this.data.expectingFirstListItemValue){const we=this.stack[this.stack.length-2];we.start=Number.parseInt(this.sliceSerialize(de),10),this.data.expectingFirstListItemValue=void 0}}function b(){const de=this.resume(),we=this.stack[this.stack.length-1];we.lang=de}function _(){const de=this.resume(),we=this.stack[this.stack.length-1];we.meta=de}function w(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function S(){const de=this.resume(),we=this.stack[this.stack.length-1];we.value=de.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function A(){const de=this.resume(),we=this.stack[this.stack.length-1];we.value=de.replace(/(\r?\n|\r)$/g,"")}function M(de){const we=this.resume(),Oe=this.stack[this.stack.length-1];Oe.label=we,Oe.identifier=dc(this.sliceSerialize(de)).toLowerCase()}function k(){const de=this.resume(),we=this.stack[this.stack.length-1];we.title=de}function E(){const de=this.resume(),we=this.stack[this.stack.length-1];we.url=de}function U(de){const we=this.stack[this.stack.length-1];if(!we.depth){const Oe=this.sliceSerialize(de).length;we.depth=Oe}}function I(){this.data.setextHeadingSlurpLineEnding=!0}function B(de){const we=this.stack[this.stack.length-1];we.depth=this.sliceSerialize(de).codePointAt(0)===61?1:2}function G(){this.data.setextHeadingSlurpLineEnding=void 0}function R(de){const Oe=this.stack[this.stack.length-1].children;let qe=Oe[Oe.length-1];(!qe||qe.type!=="text")&&(qe=$e(),qe.position={start:wa(de.start),end:void 0},Oe.push(qe)),this.stack.push(qe)}function P(de){const we=this.stack.pop();we.value+=this.sliceSerialize(de),we.position.end=wa(de.end)}function H(de){const we=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Oe=we.children[we.children.length-1];Oe.position.end=wa(de.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(we.type)&&(R.call(this,de),P.call(this,de))}function Y(){this.data.atHardBreak=!0}function L(){const de=this.resume(),we=this.stack[this.stack.length-1];we.value=de}function q(){const de=this.resume(),we=this.stack[this.stack.length-1];we.value=de}function W(){const de=this.resume(),we=this.stack[this.stack.length-1];we.value=de}function N(){const de=this.stack[this.stack.length-1];if(this.data.inReference){const we=this.data.referenceType||"shortcut";de.type+="Reference",de.referenceType=we,delete de.url,delete de.title}else delete de.identifier,delete de.label;this.data.referenceType=void 0}function V(){const de=this.stack[this.stack.length-1];if(this.data.inReference){const we=this.data.referenceType||"shortcut";de.type+="Reference",de.referenceType=we,delete de.url,delete de.title}else delete de.identifier,delete de.label;this.data.referenceType=void 0}function J(de){const we=this.sliceSerialize(de),Oe=this.stack[this.stack.length-2];Oe.label=aL(we),Oe.identifier=dc(we).toLowerCase()}function se(){const de=this.stack[this.stack.length-1],we=this.resume(),Oe=this.stack[this.stack.length-1];if(this.data.inReference=!0,Oe.type==="link"){const qe=de.children;Oe.children=qe}else Oe.alt=we}function O(){const de=this.resume(),we=this.stack[this.stack.length-1];we.url=de}function F(){const de=this.resume(),we=this.stack[this.stack.length-1];we.title=de}function X(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function ee(de){const we=this.resume(),Oe=this.stack[this.stack.length-1];Oe.label=we,Oe.identifier=dc(this.sliceSerialize(de)).toLowerCase(),this.data.referenceType="full"}function pe(de){this.data.characterReferenceType=de.type}function Se(de){const we=this.sliceSerialize(de),Oe=this.data.characterReferenceType;let qe;Oe?(qe=r3(we,Oe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):qe=b2(we);const pt=this.stack[this.stack.length-1];pt.value+=qe}function ie(de){const we=this.stack.pop();we.position.end=wa(de.end)}function ve(de){P.call(this,de);const we=this.stack[this.stack.length-1];we.url=this.sliceSerialize(de)}function Ce(de){P.call(this,de);const we=this.stack[this.stack.length-1];we.url="mailto:"+this.sliceSerialize(de)}function Le(){return{type:"blockquote",children:[]}}function st(){return{type:"code",lang:null,meta:null,value:""}}function ft(){return{type:"inlineCode",value:""}}function Ge(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function It(){return{type:"emphasis",children:[]}}function zt(){return{type:"heading",depth:0,children:[]}}function tt(){return{type:"break"}}function mt(){return{type:"html",value:""}}function _t(){return{type:"image",title:null,url:"",alt:null}}function Xn(){return{type:"link",title:null,url:"",children:[]}}function Kn(de){return{type:"list",ordered:de.type==="listOrdered",start:null,spread:de._spread,children:[]}}function ke(de){return{type:"listItem",spread:de._spread,checked:null,children:[]}}function nt(){return{type:"paragraph",children:[]}}function wt(){return{type:"strong",children:[]}}function $e(){return{type:"text",value:""}}function kn(){return{type:"thematicBreak"}}}function wa(n){return{line:n.line,column:n.column,offset:n.offset}}function m3(n,e){let t=-1;for(;++t<e.length;){const r=e[t];Array.isArray(r)?m3(n,r):uL(n,r)}}function uL(n,e){let t;for(t in e)if(f3.call(e,t))switch(t){case"canContainEols":{const r=e[t];r&&n[t].push(...r);break}case"transforms":{const r=e[t];r&&n[t].push(...r);break}case"enter":case"exit":{const r=e[t];r&&Object.assign(n[t],r);break}}}function M5(n,e){throw n?new Error("Cannot close `"+n.type+"` ("+Dh({start:n.start,end:n.end})+"): a different token (`"+e.type+"`, "+Dh({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Dh({start:e.start,end:e.end})+") is still open")}function hL(n){const e=this;e.parser=t;function t(r){return lL(r,{...e.data("settings"),...n,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function dL(n,e){const t={type:"element",tagName:"blockquote",properties:{},children:n.wrap(n.all(e),!0)};return n.patch(e,t),n.applyData(e,t)}function fL(n,e){const t={type:"element",tagName:"br",properties:{},children:[]};return n.patch(e,t),[n.applyData(e,t),{type:"text",value:`
`}]}function mL(n,e){const t=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return e.meta&&(i.data={meta:e.meta}),n.patch(e,i),i=n.applyData(e,i),i={type:"element",tagName:"pre",properties:{},children:[i]},n.patch(e,i),i}function pL(n,e){const t={type:"element",tagName:"del",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function gL(n,e){const t={type:"element",tagName:"em",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function yL(n,e){const t=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),i=Bc(r.toLowerCase()),s=n.footnoteOrder.indexOf(r);let o,c=n.footnoteCounts.get(r);c===void 0?(c=0,n.footnoteOrder.push(r),o=n.footnoteOrder.length):o=s+1,c+=1,n.footnoteCounts.set(r,c);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+i,id:t+"fnref-"+i+(c>1?"-"+c:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};n.patch(e,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return n.patch(e,d),n.applyData(e,d)}function bL(n,e){const t={type:"element",tagName:"h"+e.depth,properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function xL(n,e){if(n.options.allowDangerousHtml){const t={type:"raw",value:e.value};return n.patch(e,t),n.applyData(e,t)}}function p3(n,e){const t=e.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const i=n.all(e),s=i[0];s&&s.type==="text"?s.value="["+s.value:i.unshift({type:"text",value:"["});const o=i[i.length-1];return o&&o.type==="text"?o.value+=r:i.push({type:"text",value:r}),i}function vL(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return p3(n,e);const i={src:Bc(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const s={type:"element",tagName:"img",properties:i,children:[]};return n.patch(e,s),n.applyData(e,s)}function _L(n,e){const t={src:Bc(e.url)};e.alt!==null&&e.alt!==void 0&&(t.alt=e.alt),e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"img",properties:t,children:[]};return n.patch(e,r),n.applyData(e,r)}function wL(n,e){const t={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};n.patch(e,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return n.patch(e,r),n.applyData(e,r)}function SL(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return p3(n,e);const i={href:Bc(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const s={type:"element",tagName:"a",properties:i,children:n.all(e)};return n.patch(e,s),n.applyData(e,s)}function AL(n,e){const t={href:Bc(e.url)};e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"a",properties:t,children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function CL(n,e,t){const r=n.all(e),i=t?kL(t):g3(e),s={},o=[];if(typeof e.checked=="boolean"){const f=r[0];let p;f&&f.type==="element"&&f.tagName==="p"?p=f:(p={type:"element",tagName:"p",properties:{},children:[]},r.unshift(p)),p.children.length>0&&p.children.unshift({type:"text",value:" "}),p.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let c=-1;for(;++c<r.length;){const f=r[c];(i||c!==0||f.type!=="element"||f.tagName!=="p")&&o.push({type:"text",value:`
`}),f.type==="element"&&f.tagName==="p"&&!i?o.push(...f.children):o.push(f)}const u=r[r.length-1];u&&(i||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:s,children:o};return n.patch(e,d),n.applyData(e,d)}function kL(n){let e=!1;if(n.type==="list"){e=n.spread||!1;const t=n.children;let r=-1;for(;!e&&++r<t.length;)e=g3(t[r])}return e}function g3(n){const e=n.spread;return e??n.children.length>1}function TL(n,e){const t={},r=n.all(e);let i=-1;for(typeof e.start=="number"&&e.start!==1&&(t.start=e.start);++i<r.length;){const o=r[i];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:t,children:n.wrap(r,!0)};return n.patch(e,s),n.applyData(e,s)}function EL(n,e){const t={type:"element",tagName:"p",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function ML(n,e){const t={type:"root",children:n.wrap(n.all(e))};return n.patch(e,t),n.applyData(e,t)}function NL(n,e){const t={type:"element",tagName:"strong",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function IL(n,e){const t=n.all(e),r=t.shift(),i=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:n.wrap([r],!0)};n.patch(e.children[0],o),i.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:n.wrap(t,!0)},c=m2(e.children[1]),u=XM(e.children[e.children.length-1]);c&&u&&(o.position={start:c,end:u}),i.push(o)}const s={type:"element",tagName:"table",properties:{},children:n.wrap(i,!0)};return n.patch(e,s),n.applyData(e,s)}function RL(n,e,t){const r=t?t.children:void 0,s=(r?r.indexOf(e):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,c=o?o.length:e.children.length;let u=-1;const d=[];for(;++u<c;){const p=e.children[u],y={},b=o?o[u]:void 0;b&&(y.align=b);let _={type:"element",tagName:s,properties:y,children:[]};p&&(_.children=n.all(p),n.patch(p,_),_=n.applyData(p,_)),d.push(_)}const f={type:"element",tagName:"tr",properties:{},children:n.wrap(d,!0)};return n.patch(e,f),n.applyData(e,f)}function PL(n,e){const t={type:"element",tagName:"td",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}const N5=9,I5=32;function DL(n){const e=String(n),t=/\r?\n|\r/g;let r=t.exec(e),i=0;const s=[];for(;r;)s.push(R5(e.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=t.exec(e);return s.push(R5(e.slice(i),i>0,!1)),s.join("")}function R5(n,e,t){let r=0,i=n.length;if(e){let s=n.codePointAt(r);for(;s===N5||s===I5;)r++,s=n.codePointAt(r)}if(t){let s=n.codePointAt(i-1);for(;s===N5||s===I5;)i--,s=n.codePointAt(i-1)}return i>r?n.slice(r,i):""}function jL(n,e){const t={type:"text",value:DL(String(e.value))};return n.patch(e,t),n.applyData(e,t)}function BL(n,e){const t={type:"element",tagName:"hr",properties:{},children:[]};return n.patch(e,t),n.applyData(e,t)}const OL={blockquote:dL,break:fL,code:mL,delete:pL,emphasis:gL,footnoteReference:yL,heading:bL,html:xL,imageReference:vL,image:_L,inlineCode:wL,linkReference:SL,link:AL,listItem:CL,list:TL,paragraph:EL,root:ML,strong:NL,table:IL,tableCell:PL,tableRow:RL,text:jL,thematicBreak:BL,toml:Qf,yaml:Qf,definition:Qf,footnoteDefinition:Qf};function Qf(){}const y3=-1,ng=0,Bh=1,wp=2,_2=3,w2=4,S2=5,A2=6,b3=7,x3=8,P5=typeof self=="object"?self:globalThis,LL=(n,e)=>{const t=(i,s)=>(n.set(s,i),i),r=i=>{if(n.has(i))return n.get(i);const[s,o]=e[i];switch(s){case ng:case y3:return t(o,i);case Bh:{const c=t([],i);for(const u of o)c.push(r(u));return c}case wp:{const c=t({},i);for(const[u,d]of o)c[r(u)]=r(d);return c}case _2:return t(new Date(o),i);case w2:{const{source:c,flags:u}=o;return t(new RegExp(c,u),i)}case S2:{const c=t(new Map,i);for(const[u,d]of o)c.set(r(u),r(d));return c}case A2:{const c=t(new Set,i);for(const u of o)c.add(r(u));return c}case b3:{const{name:c,message:u}=o;return t(new P5[c](u),i)}case x3:return t(BigInt(o),i);case"BigInt":return t(Object(BigInt(o)),i);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:c}=new Uint8Array(o);return t(new DataView(c),o)}}return t(new P5[s](o),i)};return r},D5=n=>LL(new Map,n)(0),Gl="",{toString:zL}={},{keys:UL}=Object,Hu=n=>{const e=typeof n;if(e!=="object"||!n)return[ng,e];const t=zL.call(n).slice(8,-1);switch(t){case"Array":return[Bh,Gl];case"Object":return[wp,Gl];case"Date":return[_2,Gl];case"RegExp":return[w2,Gl];case"Map":return[S2,Gl];case"Set":return[A2,Gl];case"DataView":return[Bh,t]}return t.includes("Array")?[Bh,t]:t.includes("Error")?[b3,t]:[wp,t]},Jf=([n,e])=>n===ng&&(e==="function"||e==="symbol"),FL=(n,e,t,r)=>{const i=(o,c)=>{const u=r.push(o)-1;return t.set(c,u),u},s=o=>{if(t.has(o))return t.get(o);let[c,u]=Hu(o);switch(c){case ng:{let f=o;switch(u){case"bigint":c=x3,f=o.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+u);f=null;break;case"undefined":return i([y3],o)}return i([c,f],o)}case Bh:{if(u){let y=o;return u==="DataView"?y=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(y=new Uint8Array(o)),i([u,[...y]],o)}const f=[],p=i([c,f],o);for(const y of o)f.push(s(y));return p}case wp:{if(u)switch(u){case"BigInt":return i([u,o.toString()],o);case"Boolean":case"Number":case"String":return i([u,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const f=[],p=i([c,f],o);for(const y of UL(o))(n||!Jf(Hu(o[y])))&&f.push([s(y),s(o[y])]);return p}case _2:return i([c,o.toISOString()],o);case w2:{const{source:f,flags:p}=o;return i([c,{source:f,flags:p}],o)}case S2:{const f=[],p=i([c,f],o);for(const[y,b]of o)(n||!(Jf(Hu(y))||Jf(Hu(b))))&&f.push([s(y),s(b)]);return p}case A2:{const f=[],p=i([c,f],o);for(const y of o)(n||!Jf(Hu(y)))&&f.push(s(y));return p}}const{message:d}=o;return i([c,{name:u,message:d}],o)};return s},j5=(n,{json:e,lossy:t}={})=>{const r=[];return FL(!(e||t),!!e,new Map,r)(n),r},Sp=typeof structuredClone=="function"?(n,e)=>e&&("json"in e||"lossy"in e)?D5(j5(n,e)):structuredClone(n):(n,e)=>D5(j5(n,e));function GL(n,e){const t=[{type:"text",value:""}];return e>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),t}function HL(n,e){return"Back to reference "+(n+1)+(e>1?"-"+e:"")}function VL(n){const e=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",t=n.options.footnoteBackContent||GL,r=n.options.footnoteBackLabel||HL,i=n.options.footnoteLabel||"Footnotes",s=n.options.footnoteLabelTagName||"h2",o=n.options.footnoteLabelProperties||{className:["sr-only"]},c=[];let u=-1;for(;++u<n.footnoteOrder.length;){const d=n.footnoteById.get(n.footnoteOrder[u]);if(!d)continue;const f=n.all(d),p=String(d.identifier).toUpperCase(),y=Bc(p.toLowerCase());let b=0;const _=[],w=n.footnoteCounts.get(p);for(;w!==void 0&&++b<=w;){_.length>0&&_.push({type:"text",value:" "});let M=typeof t=="string"?t:t(u,b);typeof M=="string"&&(M={type:"text",value:M}),_.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+y+(b>1?"-"+b:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,b),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const S=f[f.length-1];if(S&&S.type==="element"&&S.tagName==="p"){const M=S.children[S.children.length-1];M&&M.type==="text"?M.value+=" ":S.children.push({type:"text",value:" "}),S.children.push(..._)}else f.push(..._);const A={type:"element",tagName:"li",properties:{id:e+"fn-"+y},children:n.wrap(f,!0)};n.patch(d,A),c.push(A)}if(c.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Sp(o),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:n.wrap(c,!0)},{type:"text",value:`
`}]}}const v3=(function(n){if(n==null)return qL;if(typeof n=="function")return rg(n);if(typeof n=="object")return Array.isArray(n)?WL(n):YL(n);if(typeof n=="string")return $L(n);throw new Error("Expected function, string, or object as test")});function WL(n){const e=[];let t=-1;for(;++t<n.length;)e[t]=v3(n[t]);return rg(r);function r(...i){let s=-1;for(;++s<e.length;)if(e[s].apply(this,i))return!0;return!1}}function YL(n){const e=n;return rg(t);function t(r){const i=r;let s;for(s in n)if(i[s]!==e[s])return!1;return!0}}function $L(n){return rg(e);function e(t){return t&&t.type===n}}function rg(n){return e;function e(t,r,i){return!!(ZL(t)&&n.call(this,t,typeof r=="number"?r:void 0,i||void 0))}}function qL(){return!0}function ZL(n){return n!==null&&typeof n=="object"&&"type"in n}const _3=[],XL=!0,B5=!1,KL="skip";function QL(n,e,t,r){let i;typeof e=="function"&&typeof t!="function"?(r=t,t=e):i=e;const s=v3(i),o=r?-1:1;c(n,void 0,[])();function c(u,d,f){const p=u&&typeof u=="object"?u:{};if(typeof p.type=="string"){const b=typeof p.tagName=="string"?p.tagName:typeof p.name=="string"?p.name:void 0;Object.defineProperty(y,"name",{value:"node ("+(u.type+(b?"<"+b+">":""))+")"})}return y;function y(){let b=_3,_,w,S;if((!e||s(u,d,f[f.length-1]||void 0))&&(b=JL(t(u,f)),b[0]===B5))return b;if("children"in u&&u.children){const A=u;if(A.children&&b[0]!==KL)for(w=(r?A.children.length:-1)+o,S=f.concat(A);w>-1&&w<A.children.length;){const M=A.children[w];if(_=c(M,w,S)(),_[0]===B5)return _;w=typeof _[1]=="number"?_[1]:w+o}}return b}}}function JL(n){return Array.isArray(n)?n:typeof n=="number"?[XL,n]:n==null?_3:[n]}function w3(n,e,t,r){let i,s,o;typeof e=="function"&&typeof t!="function"?(s=void 0,o=e,i=t):(s=e,o=t,i=r),QL(n,s,c,i);function c(u,d){const f=d[d.length-1],p=f?f.children.indexOf(u):void 0;return o(u,p,f)}}const Wx={}.hasOwnProperty,e9={};function t9(n,e){const t=e||e9,r=new Map,i=new Map,s=new Map,o={...OL,...t.handlers},c={all:d,applyData:r9,definitionById:r,footnoteById:i,footnoteCounts:s,footnoteOrder:[],handlers:o,one:u,options:t,patch:n9,wrap:s9};return w3(n,function(f){if(f.type==="definition"||f.type==="footnoteDefinition"){const p=f.type==="definition"?r:i,y=String(f.identifier).toUpperCase();p.has(y)||p.set(y,f)}}),c;function u(f,p){const y=f.type,b=c.handlers[y];if(Wx.call(c.handlers,y)&&b)return b(c,f,p);if(c.options.passThrough&&c.options.passThrough.includes(y)){if("children"in f){const{children:w,...S}=f,A=Sp(S);return A.children=c.all(f),A}return Sp(f)}return(c.options.unknownHandler||i9)(c,f,p)}function d(f){const p=[];if("children"in f){const y=f.children;let b=-1;for(;++b<y.length;){const _=c.one(y[b],f);if(_){if(b&&y[b-1].type==="break"&&(!Array.isArray(_)&&_.type==="text"&&(_.value=O5(_.value)),!Array.isArray(_)&&_.type==="element")){const w=_.children[0];w&&w.type==="text"&&(w.value=O5(w.value))}Array.isArray(_)?p.push(..._):p.push(_)}}}return p}}function n9(n,e){n.position&&(e.position=z8(n))}function r9(n,e){let t=e;if(n&&n.data){const r=n.data.hName,i=n.data.hChildren,s=n.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&s&&Object.assign(t.properties,Sp(s)),"children"in t&&t.children&&i!==null&&i!==void 0&&(t.children=i)}return t}function i9(n,e){const t=e.data||{},r="value"in e&&!(Wx.call(t,"hProperties")||Wx.call(t,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function s9(n,e){const t=[];let r=-1;for(e&&t.push({type:"text",value:`
`});++r<n.length;)r&&t.push({type:"text",value:`
`}),t.push(n[r]);return e&&n.length>0&&t.push({type:"text",value:`
`}),t}function O5(n){let e=0,t=n.charCodeAt(e);for(;t===9||t===32;)e++,t=n.charCodeAt(e);return n.slice(e)}function L5(n,e){const t=t9(n,e),r=t.one(n,void 0),i=VL(t),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&s.children.push({type:"text",value:`
`},i),s}function a9(n,e){return n&&"run"in n?async function(t,r){const i=L5(t,{file:r,...e});await n.run(i,r)}:function(t,r){return L5(t,{file:r,...n||e})}}function z5(n){if(n)throw n}var Yy,U5;function o9(){if(U5)return Yy;U5=1;var n=Object.prototype.hasOwnProperty,e=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,i=function(d){return typeof Array.isArray=="function"?Array.isArray(d):e.call(d)==="[object Array]"},s=function(d){if(!d||e.call(d)!=="[object Object]")return!1;var f=n.call(d,"constructor"),p=d.constructor&&d.constructor.prototype&&n.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!f&&!p)return!1;var y;for(y in d);return typeof y>"u"||n.call(d,y)},o=function(d,f){t&&f.name==="__proto__"?t(d,f.name,{enumerable:!0,configurable:!0,value:f.newValue,writable:!0}):d[f.name]=f.newValue},c=function(d,f){if(f==="__proto__")if(n.call(d,f)){if(r)return r(d,f).value}else return;return d[f]};return Yy=function u(){var d,f,p,y,b,_,w=arguments[0],S=1,A=arguments.length,M=!1;for(typeof w=="boolean"&&(M=w,w=arguments[1]||{},S=2),(w==null||typeof w!="object"&&typeof w!="function")&&(w={});S<A;++S)if(d=arguments[S],d!=null)for(f in d)p=c(w,f),y=c(d,f),w!==y&&(M&&y&&(s(y)||(b=i(y)))?(b?(b=!1,_=p&&i(p)?p:[]):_=p&&s(p)?p:{},o(w,{name:f,newValue:u(M,_,y)})):typeof y<"u"&&o(w,{name:f,newValue:y}));return w},Yy}var l9=o9();const $y=Zo(l9);function Yx(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function c9(){const n=[],e={run:t,use:r};return e;function t(...i){let s=-1;const o=i.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);c(null,...i);function c(u,...d){const f=n[++s];let p=-1;if(u){o(u);return}for(;++p<i.length;)(d[p]===null||d[p]===void 0)&&(d[p]=i[p]);i=d,f?u9(f,c)(...d):o(null,...d)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return n.push(i),e}}function u9(n,e){let t;return r;function r(...o){const c=n.length>o.length;let u;c&&o.push(i);try{u=n.apply(this,o)}catch(d){const f=d;if(c&&t)throw f;return i(f)}c||(u&&u.then&&typeof u.then=="function"?u.then(s,i):u instanceof Error?i(u):s(u))}function i(o,...c){t||(t=!0,e(o,...c))}function s(o){i(null,o)}}const os={basename:h9,dirname:d9,extname:f9,join:m9,sep:"/"};function h9(n,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Sd(n);let t=0,r=-1,i=n.length,s;if(e===void 0||e.length===0||e.length>n.length){for(;i--;)if(n.codePointAt(i)===47){if(s){t=i+1;break}}else r<0&&(s=!0,r=i+1);return r<0?"":n.slice(t,r)}if(e===n)return"";let o=-1,c=e.length-1;for(;i--;)if(n.codePointAt(i)===47){if(s){t=i+1;break}}else o<0&&(s=!0,o=i+1),c>-1&&(n.codePointAt(i)===e.codePointAt(c--)?c<0&&(r=i):(c=-1,r=o));return t===r?r=o:r<0&&(r=n.length),n.slice(t,r)}function d9(n){if(Sd(n),n.length===0)return".";let e=-1,t=n.length,r;for(;--t;)if(n.codePointAt(t)===47){if(r){e=t;break}}else r||(r=!0);return e<0?n.codePointAt(0)===47?"/":".":e===1&&n.codePointAt(0)===47?"//":n.slice(0,e)}function f9(n){Sd(n);let e=n.length,t=-1,r=0,i=-1,s=0,o;for(;e--;){const c=n.codePointAt(e);if(c===47){if(o){r=e+1;break}continue}t<0&&(o=!0,t=e+1),c===46?i<0?i=e:s!==1&&(s=1):i>-1&&(s=-1)}return i<0||t<0||s===0||s===1&&i===t-1&&i===r+1?"":n.slice(i,t)}function m9(...n){let e=-1,t;for(;++e<n.length;)Sd(n[e]),n[e]&&(t=t===void 0?n[e]:t+"/"+n[e]);return t===void 0?".":p9(t)}function p9(n){Sd(n);const e=n.codePointAt(0)===47;let t=g9(n,!e);return t.length===0&&!e&&(t="."),t.length>0&&n.codePointAt(n.length-1)===47&&(t+="/"),e?"/"+t:t}function g9(n,e){let t="",r=0,i=-1,s=0,o=-1,c,u;for(;++o<=n.length;){if(o<n.length)c=n.codePointAt(o);else{if(c===47)break;c=47}if(c===47){if(!(i===o-1||s===1))if(i!==o-1&&s===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),i=o,s=0;continue}}else if(t.length>0){t="",r=0,i=o,s=0;continue}}e&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+n.slice(i+1,o):t=n.slice(i+1,o),r=o-i-1;i=o,s=0}else c===46&&s>-1?s++:s=-1}return t}function Sd(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}const y9={cwd:b9};function b9(){return"/"}function $x(n){return!!(n!==null&&typeof n=="object"&&"href"in n&&n.href&&"protocol"in n&&n.protocol&&n.auth===void 0)}function x9(n){if(typeof n=="string")n=new URL(n);else if(!$x(n)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+n+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(n.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return v9(n)}function v9(n){if(n.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=n.pathname;let t=-1;for(;++t<e.length;)if(e.codePointAt(t)===37&&e.codePointAt(t+1)===50){const r=e.codePointAt(t+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(e)}const qy=["history","path","basename","stem","extname","dirname"];class S3{constructor(e){let t;e?$x(e)?t={path:e}:typeof e=="string"||_9(e)?t={value:e}:t=e:t={},this.cwd="cwd"in t?"":y9.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<qy.length;){const s=qy[r];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let i;for(i in t)qy.includes(i)||(this[i]=t[i])}get basename(){return typeof this.path=="string"?os.basename(this.path):void 0}set basename(e){Xy(e,"basename"),Zy(e,"basename"),this.path=os.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?os.dirname(this.path):void 0}set dirname(e){F5(this.basename,"dirname"),this.path=os.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?os.extname(this.path):void 0}set extname(e){if(Zy(e,"extname"),F5(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=os.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){$x(e)&&(e=x9(e)),Xy(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?os.basename(this.path,this.extname):void 0}set stem(e){Xy(e,"stem"),Zy(e,"stem"),this.path=os.join(this.dirname||"",e+(this.extname||""))}fail(e,t,r){const i=this.message(e,t,r);throw i.fatal=!0,i}info(e,t,r){const i=this.message(e,t,r);return i.fatal=void 0,i}message(e,t,r){const i=new Cr(e,t,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Zy(n,e){if(n&&n.includes(os.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+os.sep+"`")}function Xy(n,e){if(!n)throw new Error("`"+e+"` cannot be empty")}function F5(n,e){if(!n)throw new Error("Setting `"+e+"` requires `path` to be set too")}function _9(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const w9=(function(n){const r=this.constructor.prototype,i=r[n],s=function(){return i.apply(s,arguments)};return Object.setPrototypeOf(s,r),s}),S9={}.hasOwnProperty;class C2 extends w9{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=c9()}copy(){const e=new C2;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];e.use(...r)}return e.data($y(!0,{},this.namespace)),e}data(e,t){return typeof e=="string"?arguments.length===2?(Jy("data",this.frozen),this.namespace[e]=t,this):S9.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Jy("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=t.call(e,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=em(e),r=this.parser||this.Parser;return Ky("parse",r),r(String(t),t)}process(e,t){const r=this;return this.freeze(),Ky("process",this.parser||this.Parser),Qy("process",this.compiler||this.Compiler),t?i(void 0,t):new Promise(i);function i(s,o){const c=em(e),u=r.parse(c);r.run(u,c,function(f,p,y){if(f||!p||!y)return d(f);const b=p,_=r.stringify(b,y);k9(_)?y.value=_:y.result=_,d(f,y)});function d(f,p){f||!p?o(f):s?s(p):t(void 0,p)}}}processSync(e){let t=!1,r;return this.freeze(),Ky("processSync",this.parser||this.Parser),Qy("processSync",this.compiler||this.Compiler),this.process(e,i),H5("processSync","process",t),r;function i(s,o){t=!0,z5(s),r=o}}run(e,t,r){G5(e),this.freeze();const i=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?s(void 0,r):new Promise(s);function s(o,c){const u=em(t);i.run(e,u,d);function d(f,p,y){const b=p||e;f?c(f):o?o(b):r(void 0,b,y)}}}runSync(e,t){let r=!1,i;return this.run(e,t,s),H5("runSync","run",r),i;function s(o,c){z5(o),i=c,r=!0}}stringify(e,t){this.freeze();const r=em(t),i=this.compiler||this.Compiler;return Qy("stringify",i),G5(e),i(e,r)}use(e,...t){const r=this.attachers,i=this.namespace;if(Jy("use",this.frozen),e!=null)if(typeof e=="function")u(e,t);else if(typeof e=="object")Array.isArray(e)?c(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[f,...p]=d;u(f,p)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");c(d.plugins),d.settings&&(i.settings=$y(!0,i.settings,d.settings))}function c(d){let f=-1;if(d!=null)if(Array.isArray(d))for(;++f<d.length;){const p=d[f];s(p)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,f){let p=-1,y=-1;for(;++p<r.length;)if(r[p][0]===d){y=p;break}if(y===-1)r.push([d,...f]);else if(f.length>0){let[b,..._]=f;const w=r[y][1];Yx(w)&&Yx(b)&&(b=$y(!0,w,b)),r[y]=[d,b,..._]}}}}const A9=new C2().freeze();function Ky(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function Qy(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function Jy(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function G5(n){if(!Yx(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function H5(n,e,t){if(!t)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function em(n){return C9(n)?n:new S3(n)}function C9(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function k9(n){return typeof n=="string"||T9(n)}function T9(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const E9="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",V5=[],W5={allowDangerousHtml:!0},M9=/^(https?|ircs?|mailto|xmpp)$/i,N9=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function I9(n){const e=R9(n),t=P9(n);return D9(e.runSync(e.parse(t),t),n)}function R9(n){const e=n.rehypePlugins||V5,t=n.remarkPlugins||V5,r=n.remarkRehypeOptions?{...n.remarkRehypeOptions,...W5}:W5;return A9().use(hL).use(t).use(a9,r).use(e)}function P9(n){const e=n.children||"",t=new S3;return typeof e=="string"&&(t.value=e),t}function D9(n,e){const t=e.allowedElements,r=e.allowElement,i=e.components,s=e.disallowedElements,o=e.skipHtml,c=e.unwrapDisallowed,u=e.urlTransform||j9;for(const f of N9)Object.hasOwn(e,f.from)&&(""+f.from+(f.to?"use `"+f.to+"` instead":"remove it")+E9+f.id,void 0);return w3(n,d),V8(n,{Fragment:g.Fragment,components:i,ignoreInvalidStyle:!0,jsx:g.jsx,jsxs:g.jsxs,passKeys:!0,passNode:!0});function d(f,p,y){if(f.type==="raw"&&y&&typeof p=="number")return o?y.children.splice(p,1):y.children[p]={type:"text",value:f.value},p;if(f.type==="element"){let b;for(b in Hy)if(Object.hasOwn(Hy,b)&&Object.hasOwn(f.properties,b)){const _=f.properties[b],w=Hy[b];(w===null||w.includes(f.tagName))&&(f.properties[b]=u(String(_||""),b,f))}}if(f.type==="element"){let b=t?!t.includes(f.tagName):s?s.includes(f.tagName):!1;if(!b&&r&&typeof p=="number"&&(b=!r(f,p,y)),b&&y&&typeof p=="number")return c&&f.children?y.children.splice(p,1,...f.children):y.children.splice(p,1),p}}}function j9(n){const e=n.indexOf(":"),t=n.indexOf("?"),r=n.indexOf("#"),i=n.indexOf("/");return e===-1||i!==-1&&e>i||t!==-1&&e>t||r!==-1&&e>r||M9.test(n.slice(0,e))?n:""}const fs="AllPlayers";var en=(n=>(n.Easy="Easy",n.Medium="Medium",n.Hard="Hard",n.Impossible="Impossible",n))(en||{});const Fo="Duos",Go="Trios",Ho="Quads",Sa={Red:"Red",Blue:"Blue",Teal:"Teal",Purple:"Purple",Yellow:"Yellow",Orange:"Orange",Green:"Green",Bot:"Bot"};var Ee=(n=>(n.World="World",n.GiantWorldMap="Giant World Map",n.Europe="Europe",n.EuropeClassic="Europe Classic",n.Mena="Mena",n.NorthAmerica="North America",n.SouthAmerica="South America",n.Oceania="Oceania",n.BlackSea="Black Sea",n.Africa="Africa",n.Pangaea="Pangaea",n.Asia="Asia",n.Mars="Mars",n.Britannia="Britannia",n.GatewayToTheAtlantic="Gateway to the Atlantic",n.Australia="Australia",n.Iceland="Iceland",n.EastAsia="East Asia",n.BetweenTwoSeas="Between Two Seas",n.FaroeIslands="Faroe Islands",n.DeglaciatedAntarctica="Deglaciated Antarctica",n.FalklandIslands="Falkland Islands",n.Baikal="Baikal",n.Halkidiki="Halkidiki",n.StraitOfGibraltar="Strait of Gibraltar",n.Italia="Italia",n.Yenisei="Yenisei",n.Pluto="Pluto",n.GameOfThrones="Game of Thrones",n))(Ee||{});const fc={continental:["World","Giant World Map","North America","South America","Europe","Europe Classic","Asia","Africa","Oceania"],regional:["Black Sea","Britannia","Gateway to the Atlantic","Between Two Seas","Iceland","East Asia","Mena","Australia","Faroe Islands","Falkland Islands","Baikal","Halkidiki","Strait of Gibraltar","Italia","Yenisei"],fantasy:["Pangaea","Pluto","Mars","Deglaciated Antarctica","Game of Thrones"]};var qs=(n=>(n.Singleplayer="Singleplayer",n.Public="Public",n.Private="Private",n))(qs||{}),qn=(n=>(n.FFA="Free For All",n.Team="Team",n))(qn||{}),La=(n=>(n.Compact="Compact",n.Normal="Normal",n))(La||{}),Yr=(n=>(n.Classic="Classic",n.Fast="Fast",n))(Yr||{}),$=(n=>(n.TransportShip="Transport",n.Warship="Warship",n.Shell="Shell",n.SAMMissile="SAMMissile",n.Port="Port",n.AtomBomb="Atom Bomb",n.HydrogenBomb="Hydrogen Bomb",n.TradeShip="Trade Ship",n.MissileSilo="Missile Silo",n.DefensePost="Defense Post",n.SAMLauncher="SAM Launcher",n.City="City",n.MIRV="MIRV",n.MIRVWarhead="MIRV Warhead",n.Construction="Construction",n.Train="Train",n.Factory="Factory",n))($||{}),A3=(n=>(n.Engine="Engine",n.Carriage="Carriage",n))(A3||{});const Y5=["Atom Bomb","Hydrogen Bomb","MIRV Warhead","MIRV"];var $i=(n=>(n[n.Hostile=0]="Hostile",n[n.Distrustful=1]="Distrustful",n[n.Neutral=2]="Neutral",n[n.Friendly=3]="Friendly",n))($i||{});class yr{constructor(e,t){this.x=e,this.y=t,this.strRepr=`Cell[${this.x},${this.y}]`}pos(){return{x:this.x,y:this.y}}toString(){return this.strRepr}}var tr=(n=>(n[n.Plains=0]="Plains",n[n.Highland=1]="Highland",n[n.Mountain=2]="Mountain",n[n.Lake=3]="Lake",n[n.Ocean=4]="Ocean",n))(tr||{}),Xt=(n=>(n.Bot="BOT",n.Human="HUMAN",n.FakeHuman="FAKEHUMAN",n))(Xt||{}),tn=(n=>(n.ATTACK="ATTACK",n.NUKE="NUKE",n.ALLIANCE="ALLIANCE",n.TRADE="TRADE",n.CHAT="CHAT",n))(tn||{});const B9={0:"ATTACK",1:"ATTACK",2:"ATTACK",3:"ATTACK",4:"NUKE",5:"NUKE",6:"NUKE",7:"ATTACK",8:"ATTACK",9:"ATTACK",10:"ATTACK",11:"ATTACK",12:"ATTACK",13:"ALLIANCE",14:"ALLIANCE",15:"ALLIANCE",16:"ALLIANCE",17:"ALLIANCE",24:"ALLIANCE",18:"TRADE",19:"TRADE",20:"TRADE",21:"TRADE",22:"TRADE",23:"CHAT"};function $5(n){return B9[n]}const{slice:O9,forEach:L9}=[];function z9(n){return L9.call(O9.call(arguments,1),e=>{if(e)for(const t in e)n[t]===void 0&&(n[t]=e[t])}),n}function U9(n){return typeof n!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(t=>t.test(n))}const q5=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,F9=function(n,e){const r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},i=encodeURIComponent(e);let s=`${n}=${i}`;if(r.maxAge>0){const o=r.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");s+=`; Max-Age=${Math.floor(o)}`}if(r.domain){if(!q5.test(r.domain))throw new TypeError("option domain is invalid");s+=`; Domain=${r.domain}`}if(r.path){if(!q5.test(r.path))throw new TypeError("option path is invalid");s+=`; Path=${r.path}`}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r.partitioned&&(s+="; Partitioned"),s},Z5={create(n,e,t,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};t&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+t*60*1e3)),r&&(i.domain=r),document.cookie=F9(n,e,i)},read(n){const e=`${n}=`,t=document.cookie.split(";");for(let r=0;r<t.length;r++){let i=t[r];for(;i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return i.substring(e.length,i.length)}return null},remove(n,e){this.create(n,"",-1,e)}};var G9={name:"cookie",lookup(n){let{lookupCookie:e}=n;if(e&&typeof document<"u")return Z5.read(e)||void 0},cacheUserLanguage(n,e){let{lookupCookie:t,cookieMinutes:r,cookieDomain:i,cookieOptions:s}=e;t&&typeof document<"u"&&Z5.create(t,n,r,i,s)}},H9={name:"querystring",lookup(n){let{lookupQuerystring:e}=n,t;if(typeof window<"u"){let{search:r}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));const s=r.substring(1).split("&");for(let o=0;o<s.length;o++){const c=s[o].indexOf("=");c>0&&s[o].substring(0,c)===e&&(t=s[o].substring(c+1))}}return t}},V9={name:"hash",lookup(n){let{lookupHash:e,lookupFromHashIndex:t}=n,r;if(typeof window<"u"){const{hash:i}=window.location;if(i&&i.length>2){const s=i.substring(1);if(e){const o=s.split("&");for(let c=0;c<o.length;c++){const u=o[c].indexOf("=");u>0&&o[c].substring(0,u)===e&&(r=o[c].substring(u+1))}}if(r)return r;if(!r&&t>-1){const o=i.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?o[typeof t=="number"?t:0]?.replace("/",""):void 0}}}return r}};let Hl=null;const X5=()=>{if(Hl!==null)return Hl;try{if(Hl=typeof window<"u"&&window.localStorage!==null,!Hl)return!1;const n="i18next.translate.boo";window.localStorage.setItem(n,"foo"),window.localStorage.removeItem(n)}catch{Hl=!1}return Hl};var W9={name:"localStorage",lookup(n){let{lookupLocalStorage:e}=n;if(e&&X5())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupLocalStorage:t}=e;t&&X5()&&window.localStorage.setItem(t,n)}};let Vl=null;const K5=()=>{if(Vl!==null)return Vl;try{if(Vl=typeof window<"u"&&window.sessionStorage!==null,!Vl)return!1;const n="i18next.translate.boo";window.sessionStorage.setItem(n,"foo"),window.sessionStorage.removeItem(n)}catch{Vl=!1}return Vl};var Y9={name:"sessionStorage",lookup(n){let{lookupSessionStorage:e}=n;if(e&&K5())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupSessionStorage:t}=e;t&&K5()&&window.sessionStorage.setItem(t,n)}},$9={name:"navigator",lookup(n){const e=[];if(typeof navigator<"u"){const{languages:t,userLanguage:r,language:i}=navigator;if(t)for(let s=0;s<t.length;s++)e.push(t[s]);r&&e.push(r),i&&e.push(i)}return e.length>0?e:void 0}},q9={name:"htmlTag",lookup(n){let{htmlTag:e}=n,t;const r=e||(typeof document<"u"?document.documentElement:null);return r&&typeof r.getAttribute=="function"&&(t=r.getAttribute("lang")),t}},Z9={name:"path",lookup(n){let{lookupFromPathIndex:e}=n;if(typeof window>"u")return;const t=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(t)?t[typeof e=="number"?e:0]?.replace("/",""):void 0}},X9={name:"subdomain",lookup(n){let{lookupFromSubdomainIndex:e}=n;const t=typeof e=="number"?e+1:1,r=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(r)return r[t]}};let C3=!1;try{document.cookie,C3=!0}catch{}const k3=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];C3||k3.splice(1,1);const K9=()=>({order:k3,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:n=>n});class T3{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=z9(t,this.options||{},K9()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=i=>i.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=r,this.addDetector(G9),this.addDetector(H9),this.addDetector(W9),this.addDetector(Y9),this.addDetector($9),this.addDetector(q9),this.addDetector(Z9),this.addDetector(X9),this.addDetector(V9)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,t=[];return e.forEach(r=>{if(this.detectors[r]){let i=this.detectors[r].lookup(this.options);i&&typeof i=="string"&&(i=[i]),i&&(t=t.concat(i))}}),t=t.filter(r=>r!=null&&!U9(r)).map(r=>this.options.convertDetectedLanguage(r)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach(r=>{this.detectors[r]&&this.detectors[r].cacheUserLanguage(e,this.options)}))}}T3.type="languageDetector";function qx(n){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qx(n)}function E3(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":qx(XMLHttpRequest))==="object"}function Q9(n){return!!n&&typeof n.then=="function"}function J9(n){return Q9(n)?n:Promise.resolve(n)}const ez="modulepreload",tz=function(n){return"/"+n},Q5={},k2=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(t.map(d=>{if(d=tz(d),d in Q5)return;Q5[d]=!0;const f=d.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":ez,f||(y.as="script"),y.crossOrigin="",y.href=d,c&&y.setAttribute("nonce",c),document.head.appendChild(y),f)return new Promise((b,_)=>{y.addEventListener("load",b),y.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};function J5(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function eC(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?J5(Object(t),!0).forEach(function(r){nz(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):J5(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function nz(n,e,t){return(e=rz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rz(n){var e=iz(n,"string");return Vo(e)=="symbol"?e:e+""}function iz(n,e){if(Vo(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Vo(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Vo(n){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vo(n)}var za=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?za=global.fetch:typeof window<"u"&&window.fetch&&(za=window.fetch);var Jh;E3()&&(typeof global<"u"&&global.XMLHttpRequest?Jh=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(Jh=window.XMLHttpRequest));var Ap;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?Ap=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(Ap=window.ActiveXObject));typeof za!="function"&&(za=void 0);if(!za&&!Jh&&!Ap)try{k2(()=>import("https://frontwars.io/assets/browser-ponyfil-CiRJ3IKS.js").then(n=>n.b),[]).then(function(n){za=n.default}).catch(function(){})}catch{}var Zx=function(e,t){if(t&&Vo(t)==="object"){var r="";for(var i in t)r+="&"+encodeURIComponent(i)+"="+encodeURIComponent(t[i]);if(!r)return e;e=e+(e.indexOf("?")!==-1?"&":"?")+r.slice(1)}return e},tC=function(e,t,r,i){var s=function(u){if(!u.ok)return r(u.statusText||"Error",{status:u.status});u.text().then(function(d){r(null,{status:u.status,data:d})}).catch(r)};if(i){var o=i(e,t);if(o instanceof Promise){o.then(s).catch(r);return}}typeof fetch=="function"?fetch(e,t).then(s).catch(r):za(e,t).then(s).catch(r)},nC=!1,sz=function(e,t,r,i){e.queryStringParams&&(t=Zx(t,e.queryStringParams));var s=eC({},typeof e.customHeaders=="function"?e.customHeaders():e.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(s["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),r&&(s["Content-Type"]="application/json");var o=typeof e.requestOptions=="function"?e.requestOptions(r):e.requestOptions,c=eC({method:r?"POST":"GET",body:r?e.stringify(r):void 0,headers:s},nC?{}:o),u=typeof e.alternateFetch=="function"&&e.alternateFetch.length>=1?e.alternateFetch:void 0;try{tC(t,c,i,u)}catch(d){if(!o||Object.keys(o).length===0||!d.message||d.message.indexOf("not implemented")<0)return i(d);try{Object.keys(o).forEach(function(f){delete c[f]}),tC(t,c,i,u),nC=!0}catch(f){i(f)}}},az=function(e,t,r,i){r&&Vo(r)==="object"&&(r=Zx("",r).slice(1)),e.queryStringParams&&(t=Zx(t,e.queryStringParams));try{var s=Jh?new Jh:new Ap("MSXML2.XMLHTTP.3.0");s.open(r?"POST":"GET",t,1),e.crossDomain||s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.withCredentials=!!e.withCredentials,r&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.overrideMimeType&&s.overrideMimeType("application/json");var o=e.customHeaders;if(o=typeof o=="function"?o():o,o)for(var c in o)s.setRequestHeader(c,o[c]);s.onreadystatechange=function(){s.readyState>3&&i(s.status>=400?s.statusText:null,{status:s.status,data:s.responseText})},s.send(r)}catch(u){console&&console.log(u)}},oz=function(e,t,r,i){if(typeof r=="function"&&(i=r,r=void 0),i=i||function(){},za&&t.indexOf("file:")!==0)return sz(e,t,r,i);if(E3()||typeof ActiveXObject=="function")return az(e,t,r,i);i(new Error("No fetch and no xhr implementation found!"))};function wc(n){"@babel/helpers - typeof";return wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wc(n)}function rC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function eb(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rC(Object(t),!0).forEach(function(r){M3(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):rC(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function lz(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function cz(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,N3(r.key),r)}}function uz(n,e,t){return e&&cz(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function M3(n,e,t){return(e=N3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function N3(n){var e=hz(n,"string");return wc(e)=="symbol"?e:e+""}function hz(n,e){if(wc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(wc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var dz=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(t){return JSON.parse(t)},stringify:JSON.stringify,parsePayload:function(t,r,i){return M3({},r,i||"")},parseLoadPayload:function(t,r){},request:oz,reloadInterval:typeof window<"u"?!1:3600*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},I3=(function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};lz(this,n),this.services=e,this.options=t,this.allOptions=r,this.type="backend",this.init(e,t,r)}return uz(n,[{key:"init",value:function(t){var r=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=t,this.options=eb(eb(eb({},dz()),this.options||{}),i),this.allOptions=s,this.services&&this.options.reloadInterval){var o=setInterval(function(){return r.reload()},this.options.reloadInterval);wc(o)==="object"&&typeof o.unref=="function"&&o.unref()}}},{key:"readMulti",value:function(t,r,i){this._readAny(t,t,r,r,i)}},{key:"read",value:function(t,r,i){this._readAny([t],t,[r],r,i)}},{key:"_readAny",value:function(t,r,i,s,o){var c=this,u=this.options.loadPath;typeof this.options.loadPath=="function"&&(u=this.options.loadPath(t,i)),u=J9(u),u.then(function(d){if(!d)return o(null,{});var f=c.services.interpolator.interpolate(d,{lng:t.join("+"),ns:i.join("+")});c.loadUrl(f,o,r,s)})}},{key:"loadUrl",value:function(t,r,i,s){var o=this,c=typeof i=="string"?[i]:i,u=typeof s=="string"?[s]:s,d=this.options.parseLoadPayload(c,u);this.options.request(this.options,t,d,function(f,p){if(p&&(p.status>=500&&p.status<600||!p.status))return r("failed loading "+t+"; status code: "+p.status,!0);if(p&&p.status>=400&&p.status<500)return r("failed loading "+t+"; status code: "+p.status,!1);if(!p&&f&&f.message){var y=f.message.toLowerCase(),b=["failed","fetch","network","load"].find(function(S){return y.indexOf(S)>-1});if(b)return r("failed loading "+t+": "+f.message,!0)}if(f)return r(f,!1);var _,w;try{typeof p.data=="string"?_=o.options.parse(p.data,i,s):_=p.data}catch{w="failed parsing "+t+" to json"}if(w)return r(w,!1);r(null,_)})}},{key:"create",value:function(t,r,i,s,o){var c=this;if(this.options.addPath){typeof t=="string"&&(t=[t]);var u=this.options.parsePayload(r,i,s),d=0,f=[],p=[];t.forEach(function(y){var b=c.options.addPath;typeof c.options.addPath=="function"&&(b=c.options.addPath(y,r));var _=c.services.interpolator.interpolate(b,{lng:y,ns:r});c.options.request(c.options,_,u,function(w,S){d+=1,f.push(w),p.push(S),d===t.length&&typeof o=="function"&&o(f,p)})})}}},{key:"reload",value:function(){var t=this,r=this.services,i=r.backendConnector,s=r.languageUtils,o=r.logger,c=i.language;if(!(c&&c.toLowerCase()==="cimode")){var u=[],d=function(p){var y=s.toResolveHierarchy(p);y.forEach(function(b){u.indexOf(b)<0&&u.push(b)})};d(c),this.allOptions.preload&&this.allOptions.preload.forEach(function(f){return d(f)}),u.forEach(function(f){t.allOptions.ns.forEach(function(p){i.read(f,p,"read",null,null,function(y,b){y&&o.warn("loading namespace ".concat(p," for language ").concat(f," failed"),y),!y&&b&&o.log("loaded namespace ".concat(p," for language ").concat(f),b),i.loaded("".concat(f,"|").concat(p),y,b)})})})}}}])})();I3.type="backend";const T2=new u2,tm=T2.getLanguage(),fz=Ln.use(I3).use(T3).use(Yj).init({backend:{loadPath:"/locales/{{lng}}.json"},lng:tm||void 0,fallbackLng:{default:["en"]},defaultNS:"translation",ns:["translation"],interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"i18nextLng"},react:{useSuspense:!1},load:"languageOnly"}).then(()=>{if(tm&&tm!==Ln.language)return Ln.changeLanguage(tm)});Ln.on("languageChanged",n=>{T2.setLanguage(n);try{localStorage.setItem("i18nextLng",n)}catch(e){console.error("Failed to save language to localStorage:",e)}});const iC=n=>{T2.setLanguage(n);try{localStorage.setItem("i18nextLng",n)}catch(e){console.error("Failed to save language to localStorage:",e)}return Ln.changeLanguage(n)},mz=/Mac/.test(navigator.userAgent);function Xx(n,e,t){const r=t.x(e),i=t.y(e),s=n.x-r,o=n.y-i;return Math.hypot(s,o)}function pz(n,e){return(t,r)=>{const i=Xx(n,t.tile(),e),s=Xx(n,r.tile(),e);return i-s}}function Kx(n,e){if(!n||!e)return n;let t=n;for(const[r,i]of Object.entries(e)){const s=new RegExp(`\\{${r}\\}`,"g");t=t.replace(s,String(i))}for(let r=1;r<=10;r++){const i=`param${r}`;if(e[i]!==void 0){const s=new RegExp(`\\{${i}\\}`,"g");t=t.replace(s,String(e[i]))}}return t}function R3(n){return String(n).replace(/\s+/g,"_").toLowerCase()}const E2={world:Ee.World,giantworldmap:Ee.GiantWorldMap,northamerica:Ee.NorthAmerica,southamerica:Ee.SouthAmerica,europe:Ee.Europe,europeclassic:Ee.EuropeClassic,asia:Ee.Asia,africa:Ee.Africa,oceania:Ee.Oceania,blacksea:Ee.BlackSea,britannia:Ee.Britannia,gatewaytotheatlantic:Ee.GatewayToTheAtlantic,betweentwoseas:Ee.BetweenTwoSeas,iceland:Ee.Iceland,eastasia:Ee.EastAsia,mena:Ee.Mena,australia:Ee.Australia,faroeislands:Ee.FaroeIslands,falklandislands:Ee.FalklandIslands,baikal:Ee.Baikal,halkidiki:Ee.Halkidiki,straitofgibraltar:Ee.StraitOfGibraltar,italia:Ee.Italia,yenisei:Ee.Yenisei,pangaea:Ee.Pangaea,pluto:Ee.Pluto,mars:Ee.Mars,deglaciatedantarctica:Ee.DeglaciatedAntarctica,gameofthrones:Ee.GameOfThrones},P3=[{labelKey:"difficulty.Easy",value:en.Easy,skulls:1},{labelKey:"difficulty.Medium",value:en.Medium,skulls:2},{labelKey:"difficulty.Hard",value:en.Hard,skulls:3},{labelKey:"difficulty.Impossible",value:en.Impossible,skulls:4}],Jm=[$.City,$.DefensePost,$.Port,$.Warship,$.MissileSilo,$.SAMLauncher,$.AtomBomb,$.HydrogenBomb,$.MIRV,$.Factory];function D3(n){const e=E2[n];return e||(n.includes("_")?n.split("_"):n.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2").split(/\s+/)).map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" ")}function j3(n){if(!n)return n;const e=n.split("|"),t=e[0],r=e.slice(1);let i=Ln.t(t);if(i===t)return n;const s={},o=r.map((c,u)=>{if(typeof c=="string"&&c.includes(".")){if(c.includes("|"))return j3(c);const d=Ln.t(c);if(d!==c){let f=d;f.includes("[P1]")&&u+1<r.length&&(f=f.replace(/\[P1\]/g,r[u+1]));for(let p=2;p<=10&&u+p<r.length;p++){const y=`P${p}`,b=new RegExp(`\\[${y}\\]`,"g");f=f.replace(b,r[u+p])}return f}}return c});for(let c=0;c<o.length;c++){const u=`P${c+1}`;s[u]=o[c],s[`param${c+1}`]=o[c]}for(let c=1;c<=o.length;c++){const u=`P${c}`,d=new RegExp(`\\[${u}\\]`,"g");i=i.replace(d,String(o[c-1]))}return i=Kx(i,s),i}function gz(){return window.location.origin}function B3(){const n=bz();return n||xz()}const O3="persistent_id",yz=5*365*24*60*60;function bz(){const n=document.cookie.split(";");for(const e of n){const[t,r]=e.split("=").map(i=>i.trim());if(t===O3)return r}return null}function xz(){const n=crypto.randomUUID(),e=[`${O3}=${n}`,`max-age=${yz}`,"path=/","SameSite=Strict","Secure"].join(";");return document.cookie=e,n}async function L3(){try{const n=await fetch("/version.txt");return n.ok&&(await n.text()).trim()||null}catch(n){return console.error("Failed to fetch version:",n),null}}function vz({open:n,onClose:e}){const{t}=xt(),[r,i]=T.useState(""),[s,o]=T.useState(!0),[c,u]=T.useState(null);return T.useEffect(()=>{if(!n){i(""),o(!0),u(null);return}(async()=>{try{o(!0),u(null);const f=await fetch("/changelog.md");if(!f.ok)throw new Error(`Failed to load changelog: ${f.status} ${f.statusText}`);const p=await f.text();if(!p||p.trim().length===0)throw new Error("Changelog file is empty");i(p);const y=await L3();y&&jo.setCurrentVersion(y)}catch(f){console.error("Failed to load changelog:",f),u(f instanceof Error?f.message:"Failed to load changelog"),i("")}finally{o(!1)}})()},[n]),g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col max-h-[90vh]",children:[g.jsx("div",{className:"flex items-center justify-center mb-6 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:t("changelog.title")})}),g.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-150px)] pr-4",children:s?g.jsx("div",{className:"text-center text-gray-400 py-8",children:t("changelog.loading")}):c?g.jsxs("div",{className:"text-center text-red-400 py-8",children:[g.jsx("p",{className:"mb-2",children:t("changelog.error_loading")}),g.jsx("p",{className:"text-sm text-gray-400",children:c})]}):r?g.jsx("div",{className:"space-y-8 text-white",children:g.jsx(I9,{components:{p:({children:d})=>g.jsx("span",{className:"text-white text-base",children:d}),ul:({children:d})=>g.jsx("ul",{className:"text-white list-disc list-inside space-y-2 text-sm pl-4",children:d}),li:({children:d})=>g.jsx("li",{className:"text-white",children:d}),h1:({children:d})=>g.jsx("h1",{className:"text-white font-bold text-xl mb-4",children:d}),h2:({children:d})=>g.jsx("h2",{className:"text-white font-bold text-lg mb-3",children:d}),h3:({children:d})=>g.jsx("h3",{className:"text-white font-bold mb-2",children:d}),strong:({children:d})=>g.jsx("strong",{className:"text-white font-bold",children:d})},children:r})}):g.jsx("div",{className:"text-center text-gray-400 py-8",children:t("changelog.no_changelog_available")})})]})})}var mo={},ts={},oi={},sC;function qa(){if(sC)return oi;sC=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isHighSurrogate=n,oi.isLowSurrogate=e,oi.convertSurrogatePairToCodePoint=t,oi.isWordChar=r,oi.isDigit=i,oi.isAlphabetic=s,oi.isLowerCase=o,oi.isUpperCase=c,oi.invertCaseOfAlphabeticChar=u,oi.getAndAssertSingleCodePoint=d;function n(f){return 55296<=f&&f<=56319}function e(f){return 56320<=f&&f<=57343}function t(f,p){return(f-55296)*1024+p-56320+65536}function r(f){return i(f)||s(f)}function i(f){return 48<=f&&f<=57}function s(f){return o(f)||c(f)}function o(f){return 97<=f&&f<=122}function c(f){return 65<=f&&f<=90}function u(f){return f^32}function d(f){if([...f].length!==1)throw new RangeError("Expected the input string to be one code point in length.");return f.codePointAt(0)}return oi}var aC;function z3(){if(aC)return ts;aC=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.keepStartCensorStrategy=e,ts.keepEndCensorStrategy=t,ts.asteriskCensorStrategy=r,ts.grawlixCensorStrategy=i,ts.fixedPhraseCensorStrategy=s,ts.fixedCharCensorStrategy=o,ts.randomCharFromSetCensorStrategy=c;const n=qa();function e(u){return d=>d.overlapsAtStart?u(d):String.fromCodePoint(d.input.codePointAt(d.startIndex))+u({...d,matchLength:d.matchLength-1})}function t(u){return d=>{if(d.overlapsAtEnd)return u(d);const f=String.fromCodePoint(d.input.codePointAt(d.endIndex));return u({...d,matchLength:d.matchLength-1})+f}}function r(){return o("*")}function i(){return c("%@$&*")}function s(u){return()=>u}function o(u){return(0,n.getAndAssertSingleCodePoint)(u),d=>u.repeat(d.matchLength)}function c(u){const d=[...u];if(d.length<2)throw new Error("The character set passed must have at least 2 characters.");return f=>{if(f.matchLength===0)return"";let p=Math.floor(Math.random()*d.length),y=d[p];for(let b=1;b<f.matchLength;b++){let _=Math.floor(Math.random()*(d.length-1));_>=p&&_++,p=_,y+=d[_]}return y}}return ts}var Vu={},nm={},rm={},oC;function _z(){if(oC)return rm;oC=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.compareIntervals=n;function n(e,t,r,i){return e<r?-1:r<e?1:t<i?-1:i<t?1:0}return rm}var lC;function M2(){if(lC)return nm;lC=1,Object.defineProperty(nm,"__esModule",{value:!0}),nm.compareMatchByPositionAndId=e;const n=_z();function e(t,r){const i=(0,n.compareIntervals)(t.startIndex,t.endIndex,r.startIndex,r.endIndex);return i!==0?i:t.termId===r.termId?0:t.termId<r.termId?-1:1}return nm}var cC;function wz(){if(cC)return Vu;cC=1,Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.TextCensor=void 0;const n=M2(),e=z3();let t=class{strategy=(0,e.grawlixCensorStrategy)();setStrategy(i){return this.strategy=i,this}applyTo(i,s){if(s.length===0)return i;const o=[...s].sort(n.compareMatchByPositionAndId);let c="",u=0;for(let d=0;d<o.length;d++){const f=o[d];if(u>f.endIndex)continue;const p=f.startIndex<u;p||(c+=i.slice(u,f.startIndex));const y=Math.max(u,f.startIndex),b=d<o.length-1&&f.endIndex>=o[d+1].startIndex&&f.endIndex<o[d+1].endIndex;c+=this.strategy({...f,startIndex:y,input:i,overlapsAtStart:p,overlapsAtEnd:b}),u=f.endIndex+1}return c+=i.slice(u),c}};return Vu.TextCensor=t,Vu}var po={},im={},uC;function U3(){if(uC)return im;uC=1,Object.defineProperty(im,"__esModule",{value:!0}),im.assignIncrementingIds=n;function n(e){let t=0;return e.map(r=>({id:t++,pattern:r}))}return im}var hC;function F3(){if(hC)return po;hC=1,Object.defineProperty(po,"__esModule",{value:!0}),po.PhraseBuilder=po.DataSet=void 0;const n=U3();let e=class{containers=[];patternCount=0;patternIdToPhraseContainer=new Map;addAll(i){for(const s of i.containers)this.registerContainer(s);return this}removePhrasesIf(i){this.patternCount=0,this.patternIdToPhraseContainer.clear();const s=this.containers.splice(0);for(const o of s)i(o)||this.registerContainer(o);return this}addPhrase(i){const s=i(new t).build();return this.registerContainer(s),this}getPayloadWithPhraseMetadata(i){const s=this.patternIdToPhraseContainer.get(i.termId);if(s===void 0)throw new Error(`The pattern with ID ${i.termId} does not exist in this dataset.`);return{...i,phraseMetadata:this.containers[s].metadata}}build(){return{blacklistedTerms:(0,n.assignIncrementingIds)(this.containers.flatMap(i=>i.patterns)),whitelistedTerms:this.containers.flatMap(i=>i.whitelistedTerms)}}registerContainer(i){const s=this.containers.push(i)-1;for(let o=0,c=this.patternCount;o<i.patterns.length;o++,c++)this.patternIdToPhraseContainer.set(c,s),this.patternCount++}};po.DataSet=e;class t{patterns=[];whitelistedTerms=[];metadata;addPattern(i){return this.patterns.push(i),this}addWhitelistedTerm(i){return this.whitelistedTerms.push(i),this}setMetadata(i){return this.metadata=i,this}build(){return{patterns:this.patterns,whitelistedTerms:this.whitelistedTerms,metadata:this.metadata}}}return po.PhraseBuilder=t,po}var tb={},dC;function Sz(){return dC||(dC=1,Object.defineProperty(tb,"__esModule",{value:!0})),tb}var Wu={},Wl={},Yu={},fC;function N2(){if(fC)return Yu;fC=1,Object.defineProperty(Yu,"__esModule",{value:!0}),Yu.SyntaxKind=void 0;var n;return(function(e){e[e.Optional=0]="Optional",e[e.Wildcard=1]="Wildcard",e[e.Literal=2]="Literal",e[e.BoundaryAssertion=3]="BoundaryAssertion"})(n||(Yu.SyntaxKind=n={})),Yu}var mC;function Az(){if(mC)return Wl;mC=1,Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.potentiallyMatchesEmptyString=e,Wl.compilePatternToRegExp=t,Wl.getRegExpStringForNode=i;const n=N2();function e(s){return s.nodes.every(o=>o.kind===n.SyntaxKind.Optional)}function t(s){let o="";s.requireWordBoundaryAtStart&&(o+="\\b");for(const c of s.nodes)o+=i(c);return s.requireWordBoundaryAtEnd&&(o+="\\b"),new RegExp(o,"gs")}const r=["[",".","*","+","?","^","$","{","}","(",")","|","[","\\","]"].map(s=>s.charCodeAt(0));function i(s){switch(s.kind){case n.SyntaxKind.Literal:{let o="";for(const c of s.chars)r.includes(c)&&(o+="\\"),o+=String.fromCodePoint(c);return o}case n.SyntaxKind.Optional:return`(?:${i(s.childNode)})?`;case n.SyntaxKind.Wildcard:return"."}}return Wl}var $u={},pC;function Cz(){if(pC)return $u;pC=1,Object.defineProperty($u,"__esModule",{value:!0}),$u.TransformerSet=void 0;let n=class{transformers;statefulTransformers;constructor(t){this.transformers=t,this.statefulTransformers=Array.from({length:this.transformers.length});for(let r=0;r<this.transformers.length;r++){const i=this.transformers[r];i.type===1&&(this.statefulTransformers[r]=i.factory())}}applyTo(t){let r=t;for(let i=0;i<this.transformers.length&&r!==void 0;i++){const s=this.transformers[i];s.type===0?r=s.transform(r):r=this.statefulTransformers[i].transform(r)}return r}resetAll(){for(let t=0;t<this.transformers.length;t++)this.transformers[t].type===1&&this.statefulTransformers[t].reset()}};return $u.TransformerSet=n,$u}var qu={},gC;function I2(){if(gC)return qu;gC=1,Object.defineProperty(qu,"__esModule",{value:!0}),qu.CharacterIterator=void 0;const n=qa();let e=class{_input;lastPosition=-1;currentPosition=0;_lastWidth=0;constructor(r){this._input=r??""}get input(){return this._input}setInput(r){return this._input=r,this.reset(),this}reset(){this.lastPosition=-1,this.currentPosition=0,this._lastWidth=0}next(){if(this.done)return{done:!0,value:void 0};this.lastPosition=this.currentPosition;const r=this._input.charCodeAt(this.currentPosition++);if(this._lastWidth=1,this.done||!(0,n.isHighSurrogate)(r))return{done:!1,value:r};const i=this._input.charCodeAt(this.currentPosition);return(0,n.isLowSurrogate)(i)?(this._lastWidth++,this.currentPosition++,{done:!1,value:(0,n.convertSurrogatePairToCodePoint)(r,i)}):{done:!1,value:r}}get position(){return this.lastPosition}get lastWidth(){return this._lastWidth}get done(){return this.currentPosition>=this._input.length}[Symbol.iterator](){return this}};return qu.CharacterIterator=e,qu}var Zu={},yC;function kz(){if(yC)return Zu;yC=1,Object.defineProperty(Zu,"__esModule",{value:!0}),Zu.IntervalCollection=void 0;let n=class{dirty=!1;intervals=[];insert(t,r){this.intervals.push([t,r]),this.dirty=!0}query(t,r){if(this.intervals.length===0)return!1;this.dirty&&(this.dirty=!1,this.intervals.sort((i,s)=>i[0]<s[0]?-1:s[0]<i[0]?1:0));for(const i of this.intervals){if(i[0]>t)break;if(i[0]<=t&&r<=i[1])return!0}return!1}values(){return this.intervals.values()}[Symbol.iterator](){return this.values()}};return Zu.IntervalCollection=n,Zu}var bC;function Tz(){if(bC)return Wu;bC=1,Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.RegExpMatcher=void 0;const n=Az(),e=Cz(),t=qa(),r=I2(),i=kz(),s=M2();class o{blacklistedTerms;whitelistedTerms;blacklistMatcherTransformers;whitelistMatcherTransformers;constructor({blacklistedTerms:u,whitelistedTerms:d=[],blacklistMatcherTransformers:f=[],whitelistMatcherTransformers:p=[]}){this.blacklistedTerms=this.compileTerms(u),this.validateWhitelistedTerms(d),this.whitelistedTerms=d,this.blacklistMatcherTransformers=new e.TransformerSet(f),this.whitelistMatcherTransformers=new e.TransformerSet(p)}getAllMatches(u,d=!1){const f=this.getWhitelistedIntervals(u),[p,y]=this.applyTransformers(u,this.blacklistMatcherTransformers),b=[];for(const _ of this.blacklistedTerms)for(const w of y.matchAll(_.regExp)){const S=p[w.index];let A=p[w.index+w[0].length-1];A<u.length-1&&(0,t.isHighSurrogate)(u.charCodeAt(A))&&(0,t.isLowSurrogate)(u.charCodeAt(A+1))&&A++,f.query(S,A)||b.push({termId:_.id,startIndex:S,endIndex:A,matchLength:[...w[0]].length})}return d&&b.sort(s.compareMatchByPositionAndId),b}hasMatch(u){const d=this.getWhitelistedIntervals(u),[f,p]=this.applyTransformers(u,this.blacklistMatcherTransformers);for(const y of this.blacklistedTerms)for(const b of p.matchAll(y.regExp)){const _=f[b.index];let w=f[b.index+b[0].length-1];if(w<u.length-1&&(0,t.isHighSurrogate)(u.charCodeAt(w))&&(0,t.isLowSurrogate)(u.charCodeAt(w+1))&&w++,!d.query(_,w))return!0}return!1}getWhitelistedIntervals(u){const d=new i.IntervalCollection,[f,p]=this.applyTransformers(u,this.whitelistMatcherTransformers);for(const y of this.whitelistedTerms){let b=0;for(let _=p.indexOf(y,b);_!==-1;_=p.indexOf(y,b)){let w=f[_+y.length-1];w<u.length-1&&(0,t.isHighSurrogate)(u.charCodeAt(w))&&(0,t.isLowSurrogate)(u.charCodeAt(w+1))&&w++,d.insert(f[_],w),b=_+y.length}}return d}applyTransformers(u,d){const f=[];let p="";const y=new r.CharacterIterator(u);for(const b of y){const _=d.applyTo(b);if(_!==void 0)for(p+=String.fromCodePoint(_);f.length<p.length;)f.push(y.position)}return d.resetAll(),[f,p]}compileTerms(u){const d=[],f=new Set;for(const p of u){if(f.has(p.id))throw new Error(`Duplicate blacklisted term ID ${p.id}.`);if((0,n.potentiallyMatchesEmptyString)(p.pattern))throw new Error(`Pattern with ID ${p.id} potentially matches empty string; this is unsupported.`);d.push({id:p.id,regExp:(0,n.compilePatternToRegExp)(p.pattern)}),f.add(p.id)}return d}validateWhitelistedTerms(u){if(u.some(d=>d.length===0))throw new Error("Whitelisted term set contains empty string; this is unsupported.")}}return Wu.RegExpMatcher=o,Wu}var Xu={},xC;function G3(){if(xC)return Xu;xC=1,Object.defineProperty(Xu,"__esModule",{value:!0}),Xu.ParserError=void 0;let n=class extends Error{name="ParserError";line;column;constructor(t,r,i){super(`${r}:${i}: ${t}`),this.line=r,this.column=i}};return Xu.ParserError=n,Xu}var Ku={},Qu={},vC;function Ez(){if(vC)return Qu;vC=1,Object.defineProperty(Qu,"__esModule",{value:!0}),Qu.Parser=void 0;const n=qa(),e=I2(),t=N2(),r=G3(),i=[92,91,93,63,124],s=i.map(u=>`'${String.fromCodePoint(u)}'`).join(", "),o=-1;let c=class{input="";line=1;column=1;position=0;lastColumn=1;lastWidth=0;parse(d){this.setInput(d);const f=[],p=this.nextNode(),y=p?.kind===t.SyntaxKind.BoundaryAssertion;p&&!y&&f.push(p);let b=!1;for(;!this.done;){const _=this.mark(),w=this.nextNode();if(w.kind!==t.SyntaxKind.BoundaryAssertion){f.push(w);continue}this.done||this.reportError("Boundary assertions are not supported in this position; they are only allowed at the start / end of the pattern.",_),b=!0}return{requireWordBoundaryAtStart:y,requireWordBoundaryAtEnd:b,nodes:f}}setInput(d){return this.input=d,this.line=1,this.column=1,this.position=0,this.lastColumn=1,this.lastWidth=0,this}nextNode(){switch(this.peek()){case o:return;case 91:return this.parseOptional();case 93:this.reportError("Unexpected ']' with no corresponding '['.");case 63:return this.parseWildcard();case 124:return this.parseBoundaryAssertion();default:return this.parseLiteral()}}get done(){return this.position>=this.input.length}parseOptional(){const d=this.mark();this.next();const f=this.mark();this.done&&this.reportError("Unexpected unclosed '['.",d),this.accept("[")&&this.reportError("Unexpected nested optional node.",f);const p=this.nextNode();return p.kind===t.SyntaxKind.BoundaryAssertion&&this.reportError("Boundary assertions are not supported in this position; they are only allowed at the start / end of the pattern.",f),this.accept("]")||this.reportError("Unexpected unclosed '['."),{kind:t.SyntaxKind.Optional,childNode:p}}parseWildcard(){return this.next(),{kind:t.SyntaxKind.Wildcard}}parseBoundaryAssertion(){return this.next(),{kind:t.SyntaxKind.BoundaryAssertion}}parseLiteral(){const d=[];for(;!this.done;){if(this.accept("[]?|")){this.backup();break}const f=this.next();if(f===92){this.done&&(this.backup(),this.reportError("Unexpected trailing backslash."));const p=this.next();if(!i.includes(p)){const y=String.fromCodePoint(p);this.backup(),this.reportError(`Cannot escape character '${y}'; the only characters that can be escaped are the following: ${s}.`)}d.push(p)}else d.push(f)}return{kind:t.SyntaxKind.Literal,chars:d}}reportError(d,{line:f=this.line,column:p=this.column}={}){throw new r.ParserError(d,f,p)}mark(){return{line:this.line,column:this.column}}accept(d){const f=this.next(),p=new e.CharacterIterator(d);for(const y of p)if(y===f)return!0;return this.backup(),!1}peek(){const d=this.next();return this.backup(),d}next(){if(this.done)return o;const d=this.input.charCodeAt(this.position++);if(this.lastWidth=1,d===10)return this.lastColumn=this.column,this.column=1,this.line++,d;if(this.lastColumn=this.column++,!(0,n.isHighSurrogate)(d)||this.done)return d;const f=this.input.charCodeAt(this.position);return(0,n.isLowSurrogate)(f)?(this.position++,this.lastWidth++,(0,n.convertSurrogatePairToCodePoint)(d,f)):d}backup(){this.position-=this.lastWidth,this.column=this.lastColumn,this.lastWidth===1&&this.input.charCodeAt(this.position)===10&&this.line--}};return Qu.Parser=c,Qu}var _C;function H3(){if(_C)return Ku;_C=1,Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.pattern=t,Ku.parseRawPattern=r;const n=Ez(),e=new n.Parser;function t(i,...s){let o=i.raw[0];for(const[c,u]of s.entries())o+=String(u),o+=i.raw[c+1];return e.parse(o)}function r(i){return e.parse(i)}return Ku}var nb={},sm={},Ju={},wC;function Ad(){if(wC)return Ju;wC=1,Object.defineProperty(Ju,"__esModule",{value:!0}),Ju.createSimpleTransformer=n,Ju.createStatefulTransformer=e;function n(t){return{type:0,transform:t}}function e(t){return{type:1,factory:t}}return Ju}var eh={},SC;function Mz(){if(SC)return eh;SC=1,Object.defineProperty(eh,"__esModule",{value:!0}),eh.CollapseDuplicatesTransformer=void 0;class n{defaultThreshold;customThresholds;remaining=-1;lastChar=-1;constructor({defaultThreshold:t,customThresholds:r}){this.defaultThreshold=t,this.customThresholds=r}transform(t){if(t===this.lastChar)return this.remaining-- >0?t:void 0;const r=this.customThresholds.get(t)??this.defaultThreshold;return this.remaining=r-1,this.lastChar=t,r>0?t:void 0}reset(){this.remaining=-1,this.lastChar=-1}}return eh.CollapseDuplicatesTransformer=n,eh}var AC;function V3(){if(AC)return sm;AC=1,Object.defineProperty(sm,"__esModule",{value:!0}),sm.collapseDuplicatesTransformer=r;const n=qa(),e=Ad(),t=Mz();function r({defaultThreshold:s=1,customThresholds:o=new Map}={}){const c=i(o);return(0,e.createStatefulTransformer)(()=>new t.CollapseDuplicatesTransformer({defaultThreshold:s,customThresholds:c}))}function i(s){const o=new Map;for(const[c,u]of s){if(u<0)throw new RangeError("Expected all thresholds to be non-negative.");const d=(0,n.getAndAssertSingleCodePoint)(c);o.set(d,u)}return o}return sm}var am={},om={},CC;function R2(){if(CC)return om;CC=1,Object.defineProperty(om,"__esModule",{value:!0}),om.remapCharactersTransformer=r;const n=qa(),e=I2(),t=Ad();function r(s){const o=i(s);return(0,t.createSimpleTransformer)(c=>o.get(c)??c)}function i(s){const o=new Map,c=s instanceof Map?s.entries():Object.entries(s);for(const[u,d]of c){const f=(0,n.getAndAssertSingleCodePoint)(u),p=new e.CharacterIterator(d);for(const y of p)o.set(y,f)}return o}return om}var th={},kC;function Nz(){return kC||(kC=1,Object.defineProperty(th,"__esModule",{value:!0}),th.confusables=void 0,th.confusables=new Map([[" "," "],["0",""],["1","1"],["2",""],["3",""],["4",""],["5",""],["6",""],["7",""],["8",""],["9",""],["A",""],["a",""],["B",""],["b",""],["C",""],["c",""],["D",""],["d",""],["E",""],["e",""],["F",""],["f",""],["G",""],["g",""],["H",""],["h",""],["I",""],["i",""],["J",""],["j",""],["K",""],["k",""],["L",""],["l","|"],["M",""],["m",""],["N",""],["n",""],["O",""],["o",""],["P",""],["p",""],["Q",""],["q",""],["R",""],["r",""],["S",""],["s",""],["T",""],["t",""],["U",""],["u",""],["V",""],["v",""],["W",""],["w",""],["X",""],["x",""],["Y",""],["y",""],["Z",""],["z",""]])),th}var TC;function W3(){if(TC)return am;TC=1,Object.defineProperty(am,"__esModule",{value:!0}),am.resolveConfusablesTransformer=t;const n=R2(),e=Nz();function t(){return(0,n.remapCharactersTransformer)(e.confusables)}return am}var lm={},nh={},EC;function Iz(){return EC||(EC=1,Object.defineProperty(nh,"__esModule",{value:!0}),nh.dictionary=void 0,nh.dictionary=new Map([["a","@4"],["c","("],["e","3"],["g","6"],["i","1|!"],["l","/"],["o","0"],["s","$5"],["t","7"],["z","2"]])),nh}var MC;function Y3(){if(MC)return lm;MC=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.resolveLeetSpeakTransformer=t;const n=R2(),e=Iz();function t(){return(0,n.remapCharactersTransformer)(e.dictionary)}return lm}var cm={},NC;function $3(){if(NC)return cm;NC=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.toAsciiLowerCaseTransformer=t;const n=qa(),e=Ad();function t(){return(0,e.createSimpleTransformer)(r=>(0,n.isUpperCase)(r)?(0,n.invertCaseOfAlphabeticChar)(r):r)}return cm}var IC;function Rz(){return IC||(IC=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.englishDataset=n.englishRecommendedTransformers=n.englishRecommendedWhitelistMatcherTransformers=n.englishRecommendedBlacklistMatcherTransformers=void 0;const e=F3(),t=H3(),r=V3(),i=W3(),s=Y3(),o=$3();n.englishRecommendedBlacklistMatcherTransformers=[(0,i.resolveConfusablesTransformer)(),(0,s.resolveLeetSpeakTransformer)(),(0,o.toAsciiLowerCaseTransformer)(),(0,r.collapseDuplicatesTransformer)({defaultThreshold:1,customThresholds:new Map([["b",2],["e",2],["o",2],["l",2],["s",2],["g",2]])})],n.englishRecommendedWhitelistMatcherTransformers=[(0,o.toAsciiLowerCaseTransformer)(),(0,r.collapseDuplicatesTransformer)({defaultThreshold:Number.POSITIVE_INFINITY,customThresholds:new Map([[" ",1]])})],n.englishRecommendedTransformers={blacklistMatcherTransformers:n.englishRecommendedBlacklistMatcherTransformers,whitelistMatcherTransformers:n.englishRecommendedWhitelistMatcherTransformers},n.englishDataset=new e.DataSet().addPhrase(c=>c.setMetadata({originalWord:"abo"}).addPattern((0,t.pattern)`|ab[b]o[s]|`)).addPhrase(c=>c.setMetadata({originalWord:"abeed"}).addPattern((0,t.pattern)`ab[b]eed`)).addPhrase(c=>c.setMetadata({originalWord:"africoon"}).addPattern((0,t.pattern)`africoon`)).addPhrase(c=>c.setMetadata({originalWord:"anal"}).addPattern((0,t.pattern)`|anal`).addWhitelistedTerm("analabos").addWhitelistedTerm("analagous").addWhitelistedTerm("analav").addWhitelistedTerm("analy").addWhitelistedTerm("analog").addWhitelistedTerm("an al").addPattern((0,t.pattern)`danal`).addPattern((0,t.pattern)`eanal`).addPattern((0,t.pattern)`fanal`).addWhitelistedTerm("fan al").addPattern((0,t.pattern)`ganal`).addWhitelistedTerm("gan al").addPattern((0,t.pattern)`ianal`).addWhitelistedTerm("ian al").addPattern((0,t.pattern)`janal`).addWhitelistedTerm("trojan al").addPattern((0,t.pattern)`kanal`).addPattern((0,t.pattern)`lanal`).addWhitelistedTerm("lan al").addPattern((0,t.pattern)`lanal`).addWhitelistedTerm("lan al").addPattern((0,t.pattern)`oanal|`).addPattern((0,t.pattern)`panal`).addWhitelistedTerm("pan al").addPattern((0,t.pattern)`qanal`).addPattern((0,t.pattern)`ranal`).addPattern((0,t.pattern)`sanal`).addPattern((0,t.pattern)`tanal`).addWhitelistedTerm("tan al").addPattern((0,t.pattern)`uanal`).addWhitelistedTerm("uan al").addPattern((0,t.pattern)`vanal`).addWhitelistedTerm("van al").addPattern((0,t.pattern)`wanal`).addPattern((0,t.pattern)`xanal`).addWhitelistedTerm("texan al").addPattern((0,t.pattern)`yanal`).addPattern((0,t.pattern)`zanal`)).addPhrase(c=>c.setMetadata({originalWord:"anus"}).addPattern((0,t.pattern)`anus`).addWhitelistedTerm("an us").addWhitelistedTerm("tetanus").addWhitelistedTerm("uranus").addWhitelistedTerm("janus").addWhitelistedTerm("manus")).addPhrase(c=>c.setMetadata({originalWord:"arabush"}).addPattern((0,t.pattern)`arab[b]ush`)).addPhrase(c=>c.setMetadata({originalWord:"arse"}).addPattern((0,t.pattern)`|ars[s]e`).addWhitelistedTerm("arsen")).addPhrase(c=>c.setMetadata({originalWord:"ass"}).addPattern((0,t.pattern)`|ass`).addWhitelistedTerm("assa").addWhitelistedTerm("assem").addWhitelistedTerm("assen").addWhitelistedTerm("asser").addWhitelistedTerm("asset").addWhitelistedTerm("assev").addWhitelistedTerm("assi").addWhitelistedTerm("assoc").addWhitelistedTerm("assoi").addWhitelistedTerm("assu")).addPhrase(c=>c.setMetadata({originalWord:"bastard"}).addPattern((0,t.pattern)`bas[s]tard`)).addPhrase(c=>c.setMetadata({originalWord:"bestiality"}).addPattern((0,t.pattern)`be[e][a]s[s]tial`)).addPhrase(c=>c.setMetadata({originalWord:"bitch"}).addPattern((0,t.pattern)`bitch`).addPattern((0,t.pattern)`bich|`)).addPhrase(c=>c.setMetadata({originalWord:"blowjob"}).addPattern((0,t.pattern)`b[b]l[l][o]wj[o]b`)).addPhrase(c=>c.setMetadata({originalWord:"bollocks"}).addPattern((0,t.pattern)`bol[l]ock`)).addPhrase(c=>c.setMetadata({originalWord:"boob"}).addPattern((0,t.pattern)`boob`)).addPhrase(c=>c.setMetadata({originalWord:"boonga"}).addPattern((0,t.pattern)`boonga`).addWhitelistedTerm("baboon ga")).addPhrase(c=>c.setMetadata({originalWord:"buttplug"}).addPattern((0,t.pattern)`buttplug`)).addPhrase(c=>c.setMetadata({originalWord:"chingchong"}).addPattern((0,t.pattern)`chingchong`)).addPhrase(c=>c.setMetadata({originalWord:"chink"}).addPattern((0,t.pattern)`chink`).addWhitelistedTerm("chin k")).addPhrase(c=>c.setMetadata({originalWord:"cock"}).addPattern((0,t.pattern)`|cock|`).addPattern((0,t.pattern)`|cocks`).addPattern((0,t.pattern)`|cockp`).addPattern((0,t.pattern)`|cocke[e]|`).addWhitelistedTerm("cockney")).addPhrase(c=>c.setMetadata({originalWord:"cuck"}).addPattern((0,t.pattern)`cuck`).addWhitelistedTerm("cuckoo")).addPhrase(c=>c.setMetadata({originalWord:"cum"}).addPattern((0,t.pattern)`|cum`).addWhitelistedTerm("cumu").addWhitelistedTerm("cumb")).addPhrase(c=>c.setMetadata({originalWord:"cunt"}).addPattern((0,t.pattern)`|cunt`).addPattern((0,t.pattern)`cunt|`)).addPhrase(c=>c.setMetadata({originalWord:"deepthroat"}).addPattern((0,t.pattern)`deepthro[o]at`).addPattern((0,t.pattern)`deepthro[o]t`)).addPhrase(c=>c.setMetadata({originalWord:"dick"}).addPattern((0,t.pattern)`|dck|`).addPattern((0,t.pattern)`dick`).addWhitelistedTerm("benedick").addWhitelistedTerm("dickens")).addPhrase(c=>c.setMetadata({originalWord:"dildo"}).addPattern((0,t.pattern)`dildo`)).addPhrase(c=>c.setMetadata({originalWord:"doggystyle"}).addPattern((0,t.pattern)`d[o]g[g]ys[s]t[y]l[l]`)).addPhrase(c=>c.setMetadata({originalWord:"double penetration"}).addPattern((0,t.pattern)`double penetra`)).addPhrase(c=>c.setMetadata({originalWord:"dyke"}).addPattern((0,t.pattern)`dyke`).addWhitelistedTerm("van dyke")).addPhrase(c=>c.setMetadata({originalWord:"ejaculate"}).addPattern((0,t.pattern)`e[e]jacul`).addPattern((0,t.pattern)`e[e]jakul`).addPattern((0,t.pattern)`e[e]acul[l]ate`)).addPhrase(c=>c.setMetadata({originalWord:"fag"}).addPattern((0,t.pattern)`|fag`).addPattern((0,t.pattern)`fggot`)).addPhrase(c=>c.setMetadata({originalWord:"felch"}).addPattern((0,t.pattern)`fe[e]l[l]ch`)).addPhrase(c=>c.setMetadata({originalWord:"fellatio"}).addPattern((0,t.pattern)`f[e][e]llat`)).addPhrase(c=>c.setMetadata({originalWord:"finger bang"}).addPattern((0,t.pattern)`fingerbang`)).addPhrase(c=>c.setMetadata({originalWord:"fisting"}).addPattern((0,t.pattern)`fistin`)).addPhrase(c=>c.setMetadata({originalWord:"fuck"}).addPattern((0,t.pattern)`f[?]ck`).addPattern((0,t.pattern)`|fk`).addPattern((0,t.pattern)`|fu|`).addPattern((0,t.pattern)`|fuk`).addWhitelistedTerm("fick").addWhitelistedTerm("kung-fu").addWhitelistedTerm("kung fu")).addPhrase(c=>c.setMetadata({originalWord:"gangbang"}).addPattern((0,t.pattern)`g[?]ngbang`)).addPhrase(c=>c.setMetadata({originalWord:"handjob"}).addPattern((0,t.pattern)`h[?]ndjob`)).addPhrase(c=>c.setMetadata({originalWord:"hentai"}).addPattern((0,t.pattern)`h[e][e]ntai`)).addPhrase(c=>c.setMetadata({originalWord:"hooker"}).addPattern((0,t.pattern)`hooker`)).addPhrase(c=>c.setMetadata({originalWord:"incest"}).addPattern((0,t.pattern)`incest`)).addPhrase(c=>c.setMetadata({originalWord:"jerk off"}).addPattern((0,t.pattern)`jerkoff`)).addPhrase(c=>c.setMetadata({originalWord:"jizz"}).addPattern((0,t.pattern)`jizz`)).addPhrase(c=>c.setMetadata({originalWord:"kike"}).addPattern((0,t.pattern)`kike`)).addPhrase(c=>c.setMetadata({originalWord:"lubejob"}).addPattern((0,t.pattern)`lubejob`)).addPhrase(c=>c.setMetadata({originalWord:"masturbate"}).addPattern((0,t.pattern)`m[?]sturbate`).addPattern((0,t.pattern)`masterbate`)).addPhrase(c=>c.setMetadata({originalWord:"negro"}).addPattern((0,t.pattern)`negro`).addWhitelistedTerm("montenegro").addWhitelistedTerm("negron").addWhitelistedTerm("stoneground").addWhitelistedTerm("winegrow")).addPhrase(c=>c.setMetadata({originalWord:"nigger"}).addPattern((0,t.pattern)`n[i]gger`).addPattern((0,t.pattern)`n[i]gga`).addPattern((0,t.pattern)`|nig|`).addPattern((0,t.pattern)`|nigs|`).addWhitelistedTerm("snigger")).addPhrase(c=>c.setMetadata({originalWord:"orgasm"}).addPattern((0,t.pattern)`[or]gasm`).addWhitelistedTerm("gasma")).addPhrase(c=>c.setMetadata({originalWord:"orgy"}).addPattern((0,t.pattern)`orgy`).addPattern((0,t.pattern)`orgies`).addWhitelistedTerm("porgy")).addPhrase(c=>c.setMetadata({originalWord:"penis"}).addPattern((0,t.pattern)`pe[e]nis`).addPattern((0,t.pattern)`|pnis`).addWhitelistedTerm("pen is")).addPhrase(c=>c.setMetadata({originalWord:"piss"}).addPattern((0,t.pattern)`|piss`)).addPhrase(c=>c.setMetadata({originalWord:"porn"}).addPattern((0,t.pattern)`|prn|`).addPattern((0,t.pattern)`porn`).addWhitelistedTerm("p orna")).addPhrase(c=>c.setMetadata({originalWord:"prick"}).addPattern((0,t.pattern)`|prick[s]|`)).addPhrase(c=>c.setMetadata({originalWord:"pussy"}).addPattern((0,t.pattern)`p[u]ssy`)).addPhrase(c=>c.setMetadata({originalWord:"rape"}).addPattern((0,t.pattern)`|rape`).addPattern((0,t.pattern)`|rapis[s]t`)).addPhrase(c=>c.setMetadata({originalWord:"retard"}).addPattern((0,t.pattern)`retard`)).addPhrase(c=>c.setMetadata({originalWord:"scat"}).addPattern((0,t.pattern)`|s[s]cat|`)).addPhrase(c=>c.setMetadata({originalWord:"semen"}).addPattern((0,t.pattern)`|s[s]e[e]me[e]n`)).addPhrase(c=>c.setMetadata({originalWord:"sex"}).addPattern((0,t.pattern)`|s[s]e[e]x|`).addPattern((0,t.pattern)`|s[s]e[e]xy|`)).addPhrase(c=>c.setMetadata({originalWord:"shit"}).addPattern((0,t.pattern)`|shit`).addPattern((0,t.pattern)`shit|`).addWhitelistedTerm("s hit").addWhitelistedTerm("sh it").addWhitelistedTerm("shi t").addWhitelistedTerm("shitake")).addPhrase(c=>c.setMetadata({originalWord:"slut"}).addPattern((0,t.pattern)`s[s]lut`)).addPhrase(c=>c.setMetadata({originalWord:"spastic"}).addPattern((0,t.pattern)`|spastic`)).addPhrase(c=>c.setMetadata({originalWord:"tit"}).addPattern((0,t.pattern)`|tit|`).addPattern((0,t.pattern)`|tits|`).addPattern((0,t.pattern)`|titt`).addPattern((0,t.pattern)`|tiddies`).addPattern((0,t.pattern)`|tities`)).addPhrase(c=>c.setMetadata({originalWord:"tranny"}).addPattern((0,t.pattern)`|trany`)).addPhrase(c=>c.setMetadata({originalWord:"turd"}).addPattern((0,t.pattern)`|turd`).addWhitelistedTerm("turducken")).addPhrase(c=>c.setMetadata({originalWord:"twat"}).addPattern((0,t.pattern)`|twat`).addWhitelistedTerm("twattle")).addPhrase(c=>c.setMetadata({originalWord:"vagina"}).addPattern((0,t.pattern)`vagina`).addPattern((0,t.pattern)`|v[?]gina`)).addPhrase(c=>c.setMetadata({originalWord:"wank"}).addPattern((0,t.pattern)`|wank`)).addPhrase(c=>c.setMetadata({originalWord:"whore"}).addPattern((0,t.pattern)`|wh[o]re|`).addPattern((0,t.pattern)`|who[o]res[s]|`).addWhitelistedTerm("who're"))})(nb)),nb}var um={},RC;function Pz(){if(RC)return um;RC=1,Object.defineProperty(um,"__esModule",{value:!0}),um.skipNonAlphabeticTransformer=t;const n=qa(),e=Ad();function t(){return(0,e.createSimpleTransformer)(r=>(0,n.isAlphabetic)(r)?r:void 0)}return um}var PC;function Dz(){return PC||(PC=1,(function(n){var e=mo&&mo.__createBinding||(Object.create?(function(r,i,s,o){o===void 0&&(o=s);var c=Object.getOwnPropertyDescriptor(i,s);(!c||("get"in c?!i.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(r,o,c)}):(function(r,i,s,o){o===void 0&&(o=s),r[o]=i[s]})),t=mo&&mo.__exportStar||function(r,i){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,r,s)};Object.defineProperty(n,"__esModule",{value:!0}),t(z3(),n),t(wz(),n),t(F3(),n),t(U3(),n),t(Sz(),n),t(M2(),n),t(Tz(),n),t(N2(),n),t(G3(),n),t(H3(),n),t(Rz(),n),t(V3(),n),t(R2(),n),t(W3(),n),t(Y3(),n),t(Pz(),n),t(Ad(),n),t($3(),n)})(mo)),mo}var jz=Dz();const Lt=Zo(jz);Lt.DataSet;Lt.ParserError;Lt.PhraseBuilder;const Bz=Lt.RegExpMatcher;Lt.SyntaxKind;Lt.TextCensor;Lt.assignIncrementingIds;Lt.asteriskCensorStrategy;const Oz=Lt.collapseDuplicatesTransformer;Lt.compareMatchByPositionAndId;Lt.createSimpleTransformer;Lt.createStatefulTransformer;const Lz=Lt.englishDataset;Lt.englishRecommendedBlacklistMatcherTransformers;const zz=Lt.englishRecommendedTransformers;Lt.englishRecommendedWhitelistMatcherTransformers;Lt.fixedCharCensorStrategy;Lt.fixedPhraseCensorStrategy;Lt.grawlixCensorStrategy;Lt.keepEndCensorStrategy;Lt.keepStartCensorStrategy;Lt.parseRawPattern;Lt.pattern;Lt.randomCharFromSetCensorStrategy;Lt.remapCharactersTransformer;const Uz=Lt.resolveConfusablesTransformer,Fz=Lt.resolveLeetSpeakTransformer,Gz=Lt.skipNonAlphabeticTransformer;Lt.toAsciiLowerCaseTransformer;const{entries:q3,setPrototypeOf:DC,isFrozen:Hz,getPrototypeOf:Vz,getOwnPropertyDescriptor:Wz}=Object;let{freeze:Rr,seal:Oi,create:Qx}=Object,{apply:Jx,construct:e1}=typeof Reflect<"u"&&Reflect;Rr||(Rr=function(e){return e});Oi||(Oi=function(e){return e});Jx||(Jx=function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return e.apply(t,i)});e1||(e1=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return new e(...r)});const hm=Pr(Array.prototype.forEach),Yz=Pr(Array.prototype.lastIndexOf),jC=Pr(Array.prototype.pop),rh=Pr(Array.prototype.push),$z=Pr(Array.prototype.splice),ep=Pr(String.prototype.toLowerCase),rb=Pr(String.prototype.toString),ib=Pr(String.prototype.match),ih=Pr(String.prototype.replace),qz=Pr(String.prototype.indexOf),Zz=Pr(String.prototype.trim),Wi=Pr(Object.prototype.hasOwnProperty),Er=Pr(RegExp.prototype.test),sh=Xz(TypeError);function Pr(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return Jx(n,e,r)}}function Xz(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e1(n,t)}}function lt(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ep;DC&&DC(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=t(i);s!==i&&(Hz(e)||(e[r]=s),i=s)}n[i]=!0}return n}function Kz(n){for(let e=0;e<n.length;e++)Wi(n,e)||(n[e]=null);return n}function Gs(n){const e=Qx(null);for(const[t,r]of q3(n))Wi(n,t)&&(Array.isArray(r)?e[t]=Kz(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=Gs(r):e[t]=r);return e}function ah(n,e){for(;n!==null;){const r=Wz(n,e);if(r){if(r.get)return Pr(r.get);if(typeof r.value=="function")return Pr(r.value)}n=Vz(n)}function t(){return null}return t}const BC=Rr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sb=Rr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ab=Rr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Qz=Rr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ob=Rr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Jz=Rr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),OC=Rr(["#text"]),LC=Rr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),lb=Rr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),zC=Rr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),dm=Rr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),e7=Oi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),t7=Oi(/<%[\w\W]*|[\w\W]*%>/gm),n7=Oi(/\$\{[\w\W]*/gm),r7=Oi(/^data-[\-\w.\u00B7-\uFFFF]+$/),i7=Oi(/^aria-[\-\w]+$/),Z3=Oi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),s7=Oi(/^(?:\w+script|data):/i),a7=Oi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X3=Oi(/^html$/i),o7=Oi(/^[a-z][.\w]*(-[.\w]+)+$/i);var UC=Object.freeze({__proto__:null,ARIA_ATTR:i7,ATTR_WHITESPACE:a7,CUSTOM_ELEMENT:o7,DATA_ATTR:r7,DOCTYPE_NAME:X3,ERB_EXPR:t7,IS_ALLOWED_URI:Z3,IS_SCRIPT_OR_DATA:s7,MUSTACHE_EXPR:e7,TMPLIT_EXPR:n7});const oh={element:1,text:3,progressingInstruction:7,comment:8,document:9},l7=function(){return typeof window>"u"?null:window},c7=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},FC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function K3(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:l7();const e=Pe=>K3(Pe);if(e.version="3.3.0",e.removed=[],!n||!n.document||n.document.nodeType!==oh.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:c,Element:u,NodeFilter:d,NamedNodeMap:f=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:p,DOMParser:y,trustedTypes:b}=n,_=u.prototype,w=ah(_,"cloneNode"),S=ah(_,"remove"),A=ah(_,"nextSibling"),M=ah(_,"childNodes"),k=ah(_,"parentNode");if(typeof o=="function"){const Pe=t.createElement("template");Pe.content&&Pe.content.ownerDocument&&(t=Pe.content.ownerDocument)}let E,U="";const{implementation:I,createNodeIterator:B,createDocumentFragment:G,getElementsByTagName:R}=t,{importNode:P}=r;let H=FC();e.isSupported=typeof q3=="function"&&typeof k=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Y,ERB_EXPR:L,TMPLIT_EXPR:q,DATA_ATTR:W,ARIA_ATTR:N,IS_SCRIPT_OR_DATA:V,ATTR_WHITESPACE:J,CUSTOM_ELEMENT:se}=UC;let{IS_ALLOWED_URI:O}=UC,F=null;const X=lt({},[...BC,...sb,...ab,...ob,...OC]);let D=null;const ee=lt({},[...LC,...lb,...zC,...dm]);let pe=Object.seal(Qx(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Se=null,ie=null;const ve=Object.seal(Qx(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ce=!0,Le=!0,st=!1,ft=!0,Ge=!1,It=!0,zt=!1,tt=!1,mt=!1,_t=!1,Xn=!1,Kn=!1,ke=!0,nt=!1;const wt="user-content-";let $e=!0,kn=!1,de={},we=null;const Oe=lt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let qe=null;const pt=lt({},["audio","video","img","source","image","track"]);let Qn=null;const Dr=lt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Un="http://www.w3.org/1998/Math/MathML",hn="http://www.w3.org/2000/svg",dn="http://www.w3.org/1999/xhtml";let vt=dn,yi=!1,kr=null;const wg=lt({},[Un,hn,dn],rb);let bs=lt({},["mi","mo","mn","ms","mtext"]),xs=lt({},["annotation-xml"]);const il=lt({},["title","style","font","a","script"]);let Jr=null;const sl=["application/xhtml+xml","text/html"],Xa="text/html";let Fn=null,vs=null;const Gc=t.createElement("form"),Qs=function(K){return K instanceof RegExp||K instanceof Function},Hc=function(){let K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(vs&&vs===K)){if((!K||typeof K!="object")&&(K={}),K=Gs(K),Jr=sl.indexOf(K.PARSER_MEDIA_TYPE)===-1?Xa:K.PARSER_MEDIA_TYPE,Fn=Jr==="application/xhtml+xml"?rb:ep,F=Wi(K,"ALLOWED_TAGS")?lt({},K.ALLOWED_TAGS,Fn):X,D=Wi(K,"ALLOWED_ATTR")?lt({},K.ALLOWED_ATTR,Fn):ee,kr=Wi(K,"ALLOWED_NAMESPACES")?lt({},K.ALLOWED_NAMESPACES,rb):wg,Qn=Wi(K,"ADD_URI_SAFE_ATTR")?lt(Gs(Dr),K.ADD_URI_SAFE_ATTR,Fn):Dr,qe=Wi(K,"ADD_DATA_URI_TAGS")?lt(Gs(pt),K.ADD_DATA_URI_TAGS,Fn):pt,we=Wi(K,"FORBID_CONTENTS")?lt({},K.FORBID_CONTENTS,Fn):Oe,Se=Wi(K,"FORBID_TAGS")?lt({},K.FORBID_TAGS,Fn):Gs({}),ie=Wi(K,"FORBID_ATTR")?lt({},K.FORBID_ATTR,Fn):Gs({}),de=Wi(K,"USE_PROFILES")?K.USE_PROFILES:!1,Ce=K.ALLOW_ARIA_ATTR!==!1,Le=K.ALLOW_DATA_ATTR!==!1,st=K.ALLOW_UNKNOWN_PROTOCOLS||!1,ft=K.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ge=K.SAFE_FOR_TEMPLATES||!1,It=K.SAFE_FOR_XML!==!1,zt=K.WHOLE_DOCUMENT||!1,_t=K.RETURN_DOM||!1,Xn=K.RETURN_DOM_FRAGMENT||!1,Kn=K.RETURN_TRUSTED_TYPE||!1,mt=K.FORCE_BODY||!1,ke=K.SANITIZE_DOM!==!1,nt=K.SANITIZE_NAMED_PROPS||!1,$e=K.KEEP_CONTENT!==!1,kn=K.IN_PLACE||!1,O=K.ALLOWED_URI_REGEXP||Z3,vt=K.NAMESPACE||dn,bs=K.MATHML_TEXT_INTEGRATION_POINTS||bs,xs=K.HTML_INTEGRATION_POINTS||xs,pe=K.CUSTOM_ELEMENT_HANDLING||{},K.CUSTOM_ELEMENT_HANDLING&&Qs(K.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(pe.tagNameCheck=K.CUSTOM_ELEMENT_HANDLING.tagNameCheck),K.CUSTOM_ELEMENT_HANDLING&&Qs(K.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(pe.attributeNameCheck=K.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),K.CUSTOM_ELEMENT_HANDLING&&typeof K.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(pe.allowCustomizedBuiltInElements=K.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ge&&(Le=!1),Xn&&(_t=!0),de&&(F=lt({},OC),D=[],de.html===!0&&(lt(F,BC),lt(D,LC)),de.svg===!0&&(lt(F,sb),lt(D,lb),lt(D,dm)),de.svgFilters===!0&&(lt(F,ab),lt(D,lb),lt(D,dm)),de.mathMl===!0&&(lt(F,ob),lt(D,zC),lt(D,dm))),K.ADD_TAGS&&(typeof K.ADD_TAGS=="function"?ve.tagCheck=K.ADD_TAGS:(F===X&&(F=Gs(F)),lt(F,K.ADD_TAGS,Fn))),K.ADD_ATTR&&(typeof K.ADD_ATTR=="function"?ve.attributeCheck=K.ADD_ATTR:(D===ee&&(D=Gs(D)),lt(D,K.ADD_ATTR,Fn))),K.ADD_URI_SAFE_ATTR&&lt(Qn,K.ADD_URI_SAFE_ATTR,Fn),K.FORBID_CONTENTS&&(we===Oe&&(we=Gs(we)),lt(we,K.FORBID_CONTENTS,Fn)),$e&&(F["#text"]=!0),zt&&lt(F,["html","head","body"]),F.table&&(lt(F,["tbody"]),delete Se.tbody),K.TRUSTED_TYPES_POLICY){if(typeof K.TRUSTED_TYPES_POLICY.createHTML!="function")throw sh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof K.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw sh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=K.TRUSTED_TYPES_POLICY,U=E.createHTML("")}else E===void 0&&(E=c7(b,i)),E!==null&&typeof U=="string"&&(U=E.createHTML(""));Rr&&Rr(K),vs=K}},Vc=lt({},[...sb,...ab,...Qz]),Wc=lt({},[...ob,...Jz]),Dd=function(K){let _e=k(K);(!_e||!_e.tagName)&&(_e={namespaceURI:vt,tagName:"template"});const Me=ep(K.tagName),Rt=ep(_e.tagName);return kr[K.namespaceURI]?K.namespaceURI===hn?_e.namespaceURI===dn?Me==="svg":_e.namespaceURI===Un?Me==="svg"&&(Rt==="annotation-xml"||bs[Rt]):!!Vc[Me]:K.namespaceURI===Un?_e.namespaceURI===dn?Me==="math":_e.namespaceURI===hn?Me==="math"&&xs[Rt]:!!Wc[Me]:K.namespaceURI===dn?_e.namespaceURI===hn&&!xs[Rt]||_e.namespaceURI===Un&&!bs[Rt]?!1:!Wc[Me]&&(il[Me]||!Vc[Me]):!!(Jr==="application/xhtml+xml"&&kr[K.namespaceURI]):!1},jr=function(K){rh(e.removed,{element:K});try{k(K).removeChild(K)}catch{S(K)}},Ui=function(K,_e){try{rh(e.removed,{attribute:_e.getAttributeNode(K),from:_e})}catch{rh(e.removed,{attribute:null,from:_e})}if(_e.removeAttribute(K),K==="is")if(_t||Xn)try{jr(_e)}catch{}else try{_e.setAttribute(K,"")}catch{}},Yc=function(K){let _e=null,Me=null;if(mt)K="<remove></remove>"+K;else{const rt=ib(K,/^[\r\n\t ]+/);Me=rt&&rt[0]}Jr==="application/xhtml+xml"&&vt===dn&&(K='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+K+"</body></html>");const Rt=E?E.createHTML(K):K;if(vt===dn)try{_e=new y().parseFromString(Rt,Jr)}catch{}if(!_e||!_e.documentElement){_e=I.createDocument(vt,"template",null);try{_e.documentElement.innerHTML=yi?U:Rt}catch{}}const vn=_e.body||_e.documentElement;return K&&Me&&vn.insertBefore(t.createTextNode(Me),vn.childNodes[0]||null),vt===dn?R.call(_e,zt?"html":"body")[0]:zt?_e.documentElement:vn},$c=function(K){return B.call(K.ownerDocument||K,K,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},bi=function(K){return K instanceof p&&(typeof K.nodeName!="string"||typeof K.textContent!="string"||typeof K.removeChild!="function"||!(K.attributes instanceof f)||typeof K.removeAttribute!="function"||typeof K.setAttribute!="function"||typeof K.namespaceURI!="string"||typeof K.insertBefore!="function"||typeof K.hasChildNodes!="function")},Gn=function(K){return typeof c=="function"&&K instanceof c};function fn(Pe,K,_e){hm(Pe,Me=>{Me.call(e,K,_e,vs)})}const _s=function(K){let _e=null;if(fn(H.beforeSanitizeElements,K,null),bi(K))return jr(K),!0;const Me=Fn(K.nodeName);if(fn(H.uponSanitizeElement,K,{tagName:Me,allowedTags:F}),It&&K.hasChildNodes()&&!Gn(K.firstElementChild)&&Er(/<[/\w!]/g,K.innerHTML)&&Er(/<[/\w!]/g,K.textContent)||K.nodeType===oh.progressingInstruction||It&&K.nodeType===oh.comment&&Er(/<[/\w]/g,K.data))return jr(K),!0;if(!(ve.tagCheck instanceof Function&&ve.tagCheck(Me))&&(!F[Me]||Se[Me])){if(!Se[Me]&&jd(Me)&&(pe.tagNameCheck instanceof RegExp&&Er(pe.tagNameCheck,Me)||pe.tagNameCheck instanceof Function&&pe.tagNameCheck(Me)))return!1;if($e&&!we[Me]){const Rt=k(K)||K.parentNode,vn=M(K)||K.childNodes;if(vn&&Rt){const rt=vn.length;for(let hr=rt-1;hr>=0;--hr){const xi=w(vn[hr],!0);xi.__removalCount=(K.__removalCount||0)+1,Rt.insertBefore(xi,A(K))}}}return jr(K),!0}return K instanceof u&&!Dd(K)||(Me==="noscript"||Me==="noembed"||Me==="noframes")&&Er(/<\/no(script|embed|frames)/i,K.innerHTML)?(jr(K),!0):(Ge&&K.nodeType===oh.text&&(_e=K.textContent,hm([Y,L,q],Rt=>{_e=ih(_e,Rt," ")}),K.textContent!==_e&&(rh(e.removed,{element:K.cloneNode()}),K.textContent=_e)),fn(H.afterSanitizeElements,K,null),!1)},al=function(K,_e,Me){if(ke&&(_e==="id"||_e==="name")&&(Me in t||Me in Gc))return!1;if(!(Le&&!ie[_e]&&Er(W,_e))){if(!(Ce&&Er(N,_e))){if(!(ve.attributeCheck instanceof Function&&ve.attributeCheck(_e,K))){if(!D[_e]||ie[_e]){if(!(jd(K)&&(pe.tagNameCheck instanceof RegExp&&Er(pe.tagNameCheck,K)||pe.tagNameCheck instanceof Function&&pe.tagNameCheck(K))&&(pe.attributeNameCheck instanceof RegExp&&Er(pe.attributeNameCheck,_e)||pe.attributeNameCheck instanceof Function&&pe.attributeNameCheck(_e,K))||_e==="is"&&pe.allowCustomizedBuiltInElements&&(pe.tagNameCheck instanceof RegExp&&Er(pe.tagNameCheck,Me)||pe.tagNameCheck instanceof Function&&pe.tagNameCheck(Me))))return!1}else if(!Qn[_e]){if(!Er(O,ih(Me,J,""))){if(!((_e==="src"||_e==="xlink:href"||_e==="href")&&K!=="script"&&qz(Me,"data:")===0&&qe[K])){if(!(st&&!Er(V,ih(Me,J,"")))){if(Me)return!1}}}}}}}return!0},jd=function(K){return K!=="annotation-xml"&&ib(K,se)},Bd=function(K){fn(H.beforeSanitizeAttributes,K,null);const{attributes:_e}=K;if(!_e||bi(K))return;const Me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:D,forceKeepAttr:void 0};let Rt=_e.length;for(;Rt--;){const vn=_e[Rt],{name:rt,namespaceURI:hr,value:xi}=vn,Br=Fn(rt),Xi=xi;let Jn=rt==="value"?Xi:Zz(Xi);if(Me.attrName=Br,Me.attrValue=Jn,Me.keepAttr=!0,Me.forceKeepAttr=void 0,fn(H.uponSanitizeAttribute,K,Me),Jn=Me.attrValue,nt&&(Br==="id"||Br==="name")&&(Ui(rt,K),Jn=wt+Jn),It&&Er(/((--!?|])>)|<\/(style|title|textarea)/i,Jn)){Ui(rt,K);continue}if(Br==="attributename"&&ib(Jn,"href")){Ui(rt,K);continue}if(Me.forceKeepAttr)continue;if(!Me.keepAttr){Ui(rt,K);continue}if(!ft&&Er(/\/>/i,Jn)){Ui(rt,K);continue}Ge&&hm([Y,L,q],Zc=>{Jn=ih(Jn,Zc," ")});const qc=Fn(K.nodeName);if(!al(qc,Br,Jn)){Ui(rt,K);continue}if(E&&typeof b=="object"&&typeof b.getAttributeType=="function"&&!hr)switch(b.getAttributeType(qc,Br)){case"TrustedHTML":{Jn=E.createHTML(Jn);break}case"TrustedScriptURL":{Jn=E.createScriptURL(Jn);break}}if(Jn!==Xi)try{hr?K.setAttributeNS(hr,rt,Jn):K.setAttribute(rt,Jn),bi(K)?jr(K):jC(e.removed)}catch{Ui(rt,K)}}fn(H.afterSanitizeAttributes,K,null)},Od=function Pe(K){let _e=null;const Me=$c(K);for(fn(H.beforeSanitizeShadowDOM,K,null);_e=Me.nextNode();)fn(H.uponSanitizeShadowNode,_e,null),_s(_e),Bd(_e),_e.content instanceof s&&Pe(_e.content);fn(H.afterSanitizeShadowDOM,K,null)};return e.sanitize=function(Pe){let K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_e=null,Me=null,Rt=null,vn=null;if(yi=!Pe,yi&&(Pe="<!-->"),typeof Pe!="string"&&!Gn(Pe))if(typeof Pe.toString=="function"){if(Pe=Pe.toString(),typeof Pe!="string")throw sh("dirty is not a string, aborting")}else throw sh("toString is not a function");if(!e.isSupported)return Pe;if(tt||Hc(K),e.removed=[],typeof Pe=="string"&&(kn=!1),kn){if(Pe.nodeName){const xi=Fn(Pe.nodeName);if(!F[xi]||Se[xi])throw sh("root node is forbidden and cannot be sanitized in-place")}}else if(Pe instanceof c)_e=Yc("<!---->"),Me=_e.ownerDocument.importNode(Pe,!0),Me.nodeType===oh.element&&Me.nodeName==="BODY"||Me.nodeName==="HTML"?_e=Me:_e.appendChild(Me);else{if(!_t&&!Ge&&!zt&&Pe.indexOf("<")===-1)return E&&Kn?E.createHTML(Pe):Pe;if(_e=Yc(Pe),!_e)return _t?null:Kn?U:""}_e&&mt&&jr(_e.firstChild);const rt=$c(kn?Pe:_e);for(;Rt=rt.nextNode();)_s(Rt),Bd(Rt),Rt.content instanceof s&&Od(Rt.content);if(kn)return Pe;if(_t){if(Xn)for(vn=G.call(_e.ownerDocument);_e.firstChild;)vn.appendChild(_e.firstChild);else vn=_e;return(D.shadowroot||D.shadowrootmode)&&(vn=P.call(r,vn,!0)),vn}let hr=zt?_e.outerHTML:_e.innerHTML;return zt&&F["!doctype"]&&_e.ownerDocument&&_e.ownerDocument.doctype&&_e.ownerDocument.doctype.name&&Er(X3,_e.ownerDocument.doctype.name)&&(hr="<!DOCTYPE "+_e.ownerDocument.doctype.name+`>
`+hr),Ge&&hm([Y,L,q],xi=>{hr=ih(hr,xi," ")}),E&&Kn?E.createHTML(hr):hr},e.setConfig=function(){let Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Hc(Pe),tt=!0},e.clearConfig=function(){vs=null,tt=!1},e.isValidAttribute=function(Pe,K,_e){vs||Hc({});const Me=Fn(Pe),Rt=Fn(K);return al(Me,Rt,_e)},e.addHook=function(Pe,K){typeof K=="function"&&rh(H[Pe],K)},e.removeHook=function(Pe,K){if(K!==void 0){const _e=Yz(H[Pe],K);return _e===-1?void 0:$z(H[Pe],_e,1)[0]}return jC(H[Pe])},e.removeHooks=function(Pe){H[Pe]=[]},e.removeAllHooks=function(){H=FC()},e}K3();let u7=n=>crypto.getRandomValues(new Uint8Array(n)),h7=(n,e,t)=>{let r=(2<<Math.log(n.length-1)/Math.LN2)-1,i=-~(1.6*r*e/n.length);return(s=e)=>{let o="";for(;;){let c=t(i),u=i|0;for(;u--;)if(o+=n[c[u]&r]||"",o.length===s)return o}}},d7=(n,e=21)=>h7(n,e,u7);const cb=["Akkadian","Babylonian","Sumerian","Hittite","Phoenician","Canaanite","Minoan","Mycenaean","Etruscan","Scythian","Thracian","Dacian","Illyrian","Median","Chaldean","Roman","Greek","Byzantine","Persian","Parthian","Seleucid","Ptolemaic","Palmyrene","Macedonian","Carthaginian","Ming","Tang","Song","Yuan","Mauryan","Kushan","Rajput","Mughal","Satavahana","Vijayanagara","Egyptian","Nubian","Kushite","Aksumite","Ethiopian","Songhai","Malian","Ghanaian","Benin","Ashanti","Zulu","Tuareg","Berber","Kanem-Bornu","Buganda","Mossi","Swahili","Somali","Wolof","Umayyad","Abbasid","Ayyubid","Fatimid","Mamluk","Seljuk","Safavid","Ottoman","Almoravid","Almohad","Rashidun","Ziyarid","Frankish","Visigothic","Ostrogothic","Viking","Norman","Saxon","Anglo-Saxon","Celtic","Gaulish","Carolingian","Merovingian","Capetian","Plantagenet","Tudor","Stuart","Habsburg","Romanov","Lancaster","York","Bourbon","Napoleonic","British","French","Spanish","Portuguese","Dutch","Russian","German","Italian","Swedish","Norwegian","Danish","Polish","Hungarian","Austrian","Swiss","Czech","Slovak","Serbian","Croatian","Bosnian","Montenegrin","Bulgarian","Romanian","Apache","Sioux","Cherokee","Navajo","Iroquois","Inuit","Arawak","Carib","Taino","Aztec","Mayan","Incan","Mapuche","Guarani","Tupi","Yanomami","Zuni","Hopi","Kiowa","Comanche","Shoshone","Japanese","Ryukyu","Ainu","Cham","Khmer","Thai","Vietnamese","Burmese","Balinese","Malay","Filipino","Mongolian","Korean","Tibetan","Manchu","Uyghur","Hmong","Karen","Pyu","Hawaiian","Fijian","Tongan","Samoan","Maori","Micronesian","Hebrew","Armenian","Circassian","Georgian","Phoenician","Chaldean","Kurdish","Turkic","Kazakh","Uzbek","Kyrgyz","Tajik","Uighur","Pashtun","Baloch","Afghan","Persian","Kenyan","Ugandan","Bhutanese","Latin","Moldovan","Militant","Spartan"],GC=["Empire","Dynasty","Kingdom","Queendom","Sultanate","Confederation","Union","Republic","Caliphate","Dominion","Realm","State","Federation","Territory","Commonwealth","League","Duchy","Province","Protectorate","Colony","Mandate","Free State","Canton","Region","Nation","Assembly","Hierarchy","Archduchy","Grand Duchy","Metropolis","Cluster","Alliance","Tribunal","Council","Confederacy","Order","Regime","Dominion","Syndicate","Guild","Corporation","Patriarchy","Matriarchy","Legion","Horde","Clan","Brotherhood","Sisterhood","Ascendancy","Supremacy","Province","Tribe","Dominion","Assembly","Republics","Army","Dictatorship","Country","Oligarchy","Monkdom","Throng","Host","Area","District","Fief","Wilderness","Settlement","Parliament","Anarchy","Democracy","Autocracy"];function lh(n,e,t){return Math.min(Math.max(n,e),t)}function Cp(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return Math.abs(e)}function f7(n,e,t,r,i,s,o){const c=Math.floor((s-i)/1e3),u="v0.0.2",d=r.length,f=r.filter(y=>y.intents.length!==0||y.hash!==void 0);return{info:{gameID:n,config:e,players:t,start:i,end:s,duration:c,num_turns:d,winner:o},version:u,turns:f}}function m7(n){throw new Error("Unexpected value: "+n)}function Pi(){return d7("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ",8)()}function p7(n,e){let t=null;if(e==="HUMAN"){const r=Cp(n),i=r%cb.length,s=Math.floor(r/cb.length)%GC.length;t=` ${cb[i]} ${GC[s]}`}return t}const g7=[["","","","",""],["","","","",""],["","","","",""],["","","","",""],["","","","",""],["","","","",""],["","","","",""],["","","","",""],["","","","",""],["","","","",""],["","","","",""]],Q3=g7.flat();function y7(n,e){return typeof e=="bigint"?e.toString():e}function HC(n,e,t){return 1/(1+Math.exp(-e*(n-t)))}new Bz({...Lz.build(),...zz,...Uz(),...Gz(),...Oz(),...Fz()});const ls=3,Ni=27,J3=/^[a-zA-Z0-9_[\] ]+$/u;function Yl(n){return typeof n!="string"?{isValid:!1,error:"Username must be a string"}:n.length<ls?{isValid:!1,error:`Username must be at least ${ls} characters`}:n.length>Ni?{isValid:!1,error:`Username must be at most ${Ni} characters`}:J3.test(n)?{isValid:!0}:{isValid:!1,error:"Username contains invalid characters"}}function fm(n){return Array.from(n).filter(t=>J3.test(t)).join("").slice(0,Ni).padEnd(ls,"x")}function b7(){try{if(new URLSearchParams(self.location.search).has("crazygames"))return!0;if(window!==window.parent&&document.referrer)return new URL(document.referrer).origin.includes("crazygames")}catch{}return!1}class x7{constructor(){this.isCrazyGames=b7(),this.isInitialized=!1,this.loadPromise=null}async init(){console.log("[CrazyGames SDK] isCrazyGames: ",this.isCrazyGames),await this.waitForLoad()}waitForLoad(){return!this.isCrazyGames||this.isInitialized?Promise.resolve():this.loadPromise?this.loadPromise:(this.loadPromise=new Promise((e,t)=>{const r=document.createElement("script");r.src="https://sdk.crazygames.com/crazygames-sdk-v3.js",r.addEventListener("load",async()=>{try{await window.CrazyGames.SDK.init(),this.isInitialized=!0,this.gameLoadComplete()}finally{e()}}),r.addEventListener("error",()=>t(new Error("CrazyGames SDK load error"))),document.head.appendChild(r)}),this.loadPromise)}gameLoadComplete(){console.log("CrazyGames SDK: gameLoadComplete")}async getUsername(){if(await this.waitForLoad(),!this.isCrazyGames||!window.CrazyGames)return"";const e=await window.CrazyGames.SDK.user.getUser();return console.log("[CrazyGames SDK] user",e),e?.username??""}async isInstantMultiplayer(){return await this.waitForLoad(),this.isCrazyGames&&window.CrazyGames.SDK.game.isInstantMultiplayer}gameplayStart(){console.log("CrazyGames SDK: gameplayStart");try{this.isCrazyGames&&window.CrazyGames?.SDK?.game?.gameplayStart&&window.CrazyGames.SDK.game.gameplayStart()}catch(e){console.log("CrazyGames SDK: ",e)}}gameplayStop(){console.log("CrazyGames SDK: gameplayStop");try{this.isCrazyGames&&window.CrazyGames?.SDK?.game?.gameplayStop&&window.CrazyGames.SDK.game.gameplayStop()}catch(e){console.log("CrazyGames SDK: ",e)}}inviteLink(e,t){try{if(this.isCrazyGames&&window.CrazyGames?.SDK?.game?.inviteLink)window.CrazyGames.SDK.game.inviteLink(e,t);else{const r=new URL(window.location.href);Object.entries(e).forEach(([i,s])=>{r.searchParams.set(i,String(s))}),t(null,r.toString())}}catch(r){console.log("CrazyGames inviteLink error:",r),t(r,"")}}showInviteButton(e,t){try{this.isCrazyGames&&window.CrazyGames?.SDK?.game?.showInviteButton?window.CrazyGames.SDK.game.showInviteButton(e,t):(console.log("Invite button would show with params:",e),t(null,""))}catch(r){console.log("CrazyGames showInviteButton error:",r),t(r,"")}}hideInviteButton(){try{this.isCrazyGames&&window.CrazyGames?.SDK?.game?.hideInviteButton&&window.CrazyGames.SDK.game.hideInviteButton()}catch(e){console.log("CrazyGames hideInviteButton error:",e)}}getInviteParam(e,t){try{if(this.isCrazyGames&&window.CrazyGames?.SDK?.game?.getInviteParam)window.CrazyGames.SDK.game.getInviteParam(e,t);else{const i=new URLSearchParams(window.location.search).get(e)??"";t(null,i)}}catch(r){console.log("CrazyGames getInviteParam error:",r),t(r,"")}}async requestMidGameAd(e){if(await this.waitForLoad(),!this.isCrazyGames||!window.CrazyGames?.SDK?.ad?.requestAd){e();return}const t={adFinished:e,adError:e,adStarted:()=>console.log("Start midgame ad")};try{window.CrazyGames.SDK.ad.requestAd("midgame",t)}catch{e()}}async requestBanner(e,t,r){if(this.isCrazyGames){await this.waitForLoad();try{await window.CrazyGames.SDK.banner.requestBanner({id:e,width:t,height:r})}catch(i){console.warn("Failed to request CrazyGames banner:",e,i)}}}async requestResponsiveBanner(e){if(this.isCrazyGames){await this.waitForLoad();try{this.showBanner(e),await window.CrazyGames.SDK.banner.requestResponsiveBanner(e)}catch(t){console.warn("Failed to request CrazyGames responsive banner:",e,t)}}}clearBanners(){this.isCrazyGames&&window.CrazyGames.SDK.banner.clearAllBanners()}showBanner(e){const t=document.getElementById(e);t&&(t.style.display="block")}hideBanner(e){const t=document.getElementById(e);t&&(t.style.display="none")}}const Rn=new x7,e4="Guest",ub=()=>{const n=Math.floor(Math.random()*1e3);return`${e4}${n}`};function v7(){const{t:n}=xt(),[e,t]=T.useState(""),[r,i]=T.useState(null),s=u=>{t(u),i(null),et.setUsername(u)};T.useEffect(()=>{(async()=>{const d=et.getUsername();if(Rn.isCrazyGames&&!(d&&!d.includes(e4)))try{const f=await Rn.getUsername();if(f){s(f);return}}catch(f){console.error("Failed to get CrazySDK username:",f)}if(d)try{if(Yl(d).isValid)t(d),i(null);else{const p=fm(d);if(Yl(p).isValid)t(p),i(null),et.setUsername(p);else{const b=ub();t(b),i(null),et.setUsername(b)}}}catch(f){console.error("Username validation error on load:",f),t(d),i(null)}else{const f=ub();s(f)}})()},[]);const o=u=>{let d=u.target.value;d.length>Ni&&(d=d.slice(0,Ni));try{const f=Yl(d);if(f.isValid)s(d);else{t(d);let p=f.error;if(p||(d.length<ls?p=n("username.too_short",{min:ls}):d.length>Ni?p=n("username.too_long",{max:Ni}):p=n("username.invalid_chars")),i(p),d.length>=ls&&d.length<=Ni){const y=fm(d);Yl(y).isValid&&et.setUsername(y)}}}catch(f){console.error("Username validation error:",f),t(d),d.length>0&&d.length<ls?i(n("username.too_short",{min:ls})):d.length>Ni?i(n("username.too_long",{max:Ni})):d.length>=ls&&d.length<=Ni?(i(null),et.setUsername(d)):i(null)}},c=u=>{const d=u.target.value.trim();if(d.length===0){const f=ub();s(f);return}try{const f=Yl(d);if(!f.isValid&&d.length>0){const p=fm(d);Yl(p).isValid&&s(p)}else f.isValid&&i(null)}catch(f){if(console.error("Username validation error on blur:",f),d.length>0){const p=fm(d);p.length>=ls&&s(p)}}};return g.jsxs("div",{className:"flex-1 relative",children:[g.jsx("div",{className:"rounded-lg border-2 p-2.5 transition-all",style:{borderColor:r?"var(--border-red)":"var(--border-primary)",backgroundColor:"var(--bg-main)",boxShadow:"var(--shadow-button, none)"},children:g.jsx("input",{type:"text",value:e,onChange:o,onBlur:c,placeholder:n("username.enter_username"),className:"px-3 py-1 bg-transparent rounded focus:outline-none font-semibold text-lg w-full",style:{color:"var(--text-primary)"},maxLength:Ni})}),r&&g.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 z-10 rounded-lg px-3 py-2 shadow-lg",style:{backgroundColor:"var(--bg-secondary)"},children:g.jsx("div",{className:"text-sm font-medium",style:{color:"var(--text-orange)"},children:r})})]})}function ge(n,e,t){function r(c,u){var d;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(d=c._zod).traits??(d.traits=new Set),c._zod.traits.add(n),e(c,u);for(const f in o.prototype)f in c||Object.defineProperty(c,f,{value:o.prototype[f].bind(c)});c._zod.constr=o,c._zod.def=u}const i=t?.Parent??Object;class s extends i{}Object.defineProperty(s,"name",{value:n});function o(c){var u;const d=t?.Parent?new s:this;r(d,c),(u=d._zod).deferred??(u.deferred=[]);for(const f of d._zod.deferred)f();return d}return Object.defineProperty(o,"init",{value:r}),Object.defineProperty(o,Symbol.hasInstance,{value:c=>t?.Parent&&c instanceof t.Parent?!0:c?._zod?.traits?.has(n)}),Object.defineProperty(o,"name",{value:n}),o}class mc extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class t4 extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const n4={};function Ua(n){return n4}function _7(n){const e=Object.values(n).filter(r=>typeof r=="number");return Object.entries(n).filter(([r,i])=>e.indexOf(+r)===-1).map(([r,i])=>i)}function t1(n,e){return typeof e=="bigint"?e.toString():e}function ig(n){return{get value(){{const e=n();return Object.defineProperty(this,"value",{value:e}),e}}}}function P2(n){return n==null}function D2(n){const e=n.startsWith("^")?1:0,t=n.endsWith("$")?n.length-1:n.length;return n.slice(e,t)}function w7(n,e){const t=(n.toString().split(".")[1]||"").length,r=e.toString();let i=(r.split(".")[1]||"").length;if(i===0&&/\d?e-\d?/.test(r)){const u=r.match(/\d?e-(\d?)/);u?.[1]&&(i=Number.parseInt(u[1]))}const s=t>i?t:i,o=Number.parseInt(n.toFixed(s).replace(".","")),c=Number.parseInt(e.toFixed(s).replace(".",""));return o%c/10**s}const VC=Symbol("evaluating");function Kt(n,e,t){let r;Object.defineProperty(n,e,{get(){if(r!==VC)return r===void 0&&(r=VC,r=t()),r},set(i){Object.defineProperty(n,e,{value:i})},configurable:!0})}function Ko(n,e,t){Object.defineProperty(n,e,{value:t,writable:!0,enumerable:!0,configurable:!0})}function Qo(...n){const e={};for(const t of n){const r=Object.getOwnPropertyDescriptors(t);Object.assign(e,r)}return Object.defineProperties({},e)}function WC(n){return JSON.stringify(n)}const r4="captureStackTrace"in Error?Error.captureStackTrace:(...n)=>{};function ed(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}const S7=ig(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const n=Function;return new n(""),!0}catch{return!1}});function Sc(n){if(ed(n)===!1)return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(ed(t)===!1||Object.prototype.hasOwnProperty.call(t,"isPrototypeOf")===!1)}function i4(n){return Sc(n)?{...n}:Array.isArray(n)?[...n]:n}const A7=new Set(["string","number","symbol"]);function Ac(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ks(n,e,t){const r=new n._zod.constr(e??n._zod.def);return(!e||t?.parent)&&(r._zod.parent=n),r}function je(n){const e=n;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function C7(n){return Object.keys(n).filter(e=>n[e]._zod.optin==="optional"&&n[e]._zod.optout==="optional")}const k7={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function T7(n,e){const t=n._zod.def,r=Qo(n._zod.def,{get shape(){const i={};for(const s in e){if(!(s in t.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&(i[s]=t.shape[s])}return Ko(this,"shape",i),i},checks:[]});return Ks(n,r)}function E7(n,e){const t=n._zod.def,r=Qo(n._zod.def,{get shape(){const i={...n._zod.def.shape};for(const s in e){if(!(s in t.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&delete i[s]}return Ko(this,"shape",i),i},checks:[]});return Ks(n,r)}function M7(n,e){if(!Sc(e))throw new Error("Invalid input to extend: expected a plain object");const t=n._zod.def.checks;if(t&&t.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const i=Qo(n._zod.def,{get shape(){const s={...n._zod.def.shape,...e};return Ko(this,"shape",s),s},checks:[]});return Ks(n,i)}function N7(n,e){if(!Sc(e))throw new Error("Invalid input to safeExtend: expected a plain object");const t={...n._zod.def,get shape(){const r={...n._zod.def.shape,...e};return Ko(this,"shape",r),r},checks:n._zod.def.checks};return Ks(n,t)}function I7(n,e){const t=Qo(n._zod.def,{get shape(){const r={...n._zod.def.shape,...e._zod.def.shape};return Ko(this,"shape",r),r},get catchall(){return e._zod.def.catchall},checks:[]});return Ks(n,t)}function R7(n,e,t){const r=Qo(e._zod.def,{get shape(){const i=e._zod.def.shape,s={...i};if(t)for(const o in t){if(!(o in i))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(s[o]=n?new n({type:"optional",innerType:i[o]}):i[o])}else for(const o in i)s[o]=n?new n({type:"optional",innerType:i[o]}):i[o];return Ko(this,"shape",s),s},checks:[]});return Ks(e,r)}function P7(n,e,t){const r=Qo(e._zod.def,{get shape(){const i=e._zod.def.shape,s={...i};if(t)for(const o in t){if(!(o in s))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(s[o]=new n({type:"nonoptional",innerType:i[o]}))}else for(const o in i)s[o]=new n({type:"nonoptional",innerType:i[o]});return Ko(this,"shape",s),s},checks:[]});return Ks(e,r)}function oc(n,e=0){if(n.aborted===!0)return!0;for(let t=e;t<n.issues.length;t++)if(n.issues[t]?.continue!==!0)return!0;return!1}function Mo(n,e){return e.map(t=>{var r;return(r=t).path??(r.path=[]),t.path.unshift(n),t})}function mm(n){return typeof n=="string"?n:n?.message}function Fa(n,e,t){const r={...n,path:n.path??[]};if(!n.message){const i=mm(n.inst?._zod.def?.error?.(n))??mm(e?.error?.(n))??mm(t.customError?.(n))??mm(t.localeError?.(n))??"Invalid input";r.message=i}return delete r.inst,delete r.continue,e?.reportInput||delete r.input,r}function j2(n){return Array.isArray(n)?"array":typeof n=="string"?"string":"unknown"}function td(...n){const[e,t,r]=n;return typeof e=="string"?{message:e,code:"custom",input:t,inst:r}:{...e}}const s4=(n,e)=>{n.name="$ZodError",Object.defineProperty(n,"_zod",{value:n._zod,enumerable:!1}),Object.defineProperty(n,"issues",{value:e,enumerable:!1}),n.message=JSON.stringify(e,t1,2),Object.defineProperty(n,"toString",{value:()=>n.message,enumerable:!1})},a4=ge("$ZodError",s4),o4=ge("$ZodError",s4,{Parent:Error});function D7(n,e=t=>t.message){const t={},r=[];for(const i of n.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:t}}function j7(n,e=t=>t.message){const t={_errors:[]},r=i=>{for(const s of i.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>r({issues:o}));else if(s.code==="invalid_key")r({issues:s.issues});else if(s.code==="invalid_element")r({issues:s.issues});else if(s.path.length===0)t._errors.push(e(s));else{let o=t,c=0;for(;c<s.path.length;){const u=s.path[c];c===s.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(e(s))):o[u]=o[u]||{_errors:[]},o=o[u],c++}}};return r(n),t}function B7(n){const e=[],t=n.map(r=>typeof r=="object"?r.key:r);for(const r of t)typeof r=="number"?e.push(`[${r}]`):typeof r=="symbol"?e.push(`[${JSON.stringify(String(r))}]`):/[^\w$]/.test(r)?e.push(`[${JSON.stringify(r)}]`):(e.length&&e.push("."),e.push(r));return e.join("")}function l4(n){const e=[],t=[...n.issues].sort((r,i)=>(r.path??[]).length-(i.path??[]).length);for(const r of t)e.push(` ${r.message}`),r.path?.length&&e.push(`   at ${B7(r.path)}`);return e.join(`
`)}const B2=n=>(e,t,r,i)=>{const s=r?Object.assign(r,{async:!1}):{async:!1},o=e._zod.run({value:t,issues:[]},s);if(o instanceof Promise)throw new mc;if(o.issues.length){const c=new(i?.Err??n)(o.issues.map(u=>Fa(u,s,Ua())));throw r4(c,i?.callee),c}return o.value},O2=n=>async(e,t,r,i)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let o=e._zod.run({value:t,issues:[]},s);if(o instanceof Promise&&(o=await o),o.issues.length){const c=new(i?.Err??n)(o.issues.map(u=>Fa(u,s,Ua())));throw r4(c,i?.callee),c}return o.value},sg=n=>(e,t,r)=>{const i=r?{...r,async:!1}:{async:!1},s=e._zod.run({value:t,issues:[]},i);if(s instanceof Promise)throw new mc;return s.issues.length?{success:!1,error:new(n??a4)(s.issues.map(o=>Fa(o,i,Ua())))}:{success:!0,data:s.value}},O7=sg(o4),ag=n=>async(e,t,r)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let s=e._zod.run({value:t,issues:[]},i);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new n(s.issues.map(o=>Fa(o,i,Ua())))}:{success:!0,data:s.value}},L7=ag(o4),z7=n=>(e,t,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return B2(n)(e,t,i)},U7=n=>(e,t,r)=>B2(n)(e,t,r),F7=n=>async(e,t,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return O2(n)(e,t,i)},G7=n=>async(e,t,r)=>O2(n)(e,t,r),H7=n=>(e,t,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return sg(n)(e,t,i)},V7=n=>(e,t,r)=>sg(n)(e,t,r),W7=n=>async(e,t,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ag(n)(e,t,i)},Y7=n=>async(e,t,r)=>ag(n)(e,t,r),$7=/^[cC][^\s-]{8,}$/,q7=/^[0-9a-z]+$/,Z7=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,X7=/^[0-9a-vA-V]{20}$/,K7=/^[A-Za-z0-9]{27}$/,Q7=/^[a-zA-Z0-9_-]{21}$/,J7=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,eU=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,YC=n=>n?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${n}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,tU=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,nU="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function rU(){return new RegExp(nU,"u")}const iU=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,sU=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,aU=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,oU=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,lU=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,c4=/^[A-Za-z0-9_-]*$/,cU=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,uU=/^\+(?:[0-9]){6,14}[0-9]$/,u4="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",hU=new RegExp(`^${u4}$`);function h4(n){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof n.precision=="number"?n.precision===-1?`${e}`:n.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${n.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function dU(n){return new RegExp(`^${h4(n)}$`)}function fU(n){const e=h4({precision:n.precision}),t=["Z"];n.local&&t.push(""),n.offset&&t.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${e}(?:${t.join("|")})`;return new RegExp(`^${u4}T(?:${r})$`)}const mU=n=>{const e=n?`[\\s\\S]{${n?.minimum??0},${n?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},pU=/^-?\d+n?$/,gU=/^-?\d+$/,yU=/^-?\d+(?:\.\d+)?/,bU=/^(?:true|false)$/i,xU=/^[^A-Z]*$/,vU=/^[^a-z]*$/,Kr=ge("$ZodCheck",(n,e)=>{var t;n._zod??(n._zod={}),n._zod.def=e,(t=n._zod).onattach??(t.onattach=[])}),d4={number:"number",bigint:"bigint",object:"date"},f4=ge("$ZodCheckLessThan",(n,e)=>{Kr.init(n,e);const t=d4[typeof e.value];n._zod.onattach.push(r=>{const i=r._zod.bag,s=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),n._zod.check=r=>{(e.inclusive?r.value<=e.value:r.value<e.value)||r.issues.push({origin:t,code:"too_big",maximum:e.value,input:r.value,inclusive:e.inclusive,inst:n,continue:!e.abort})}}),m4=ge("$ZodCheckGreaterThan",(n,e)=>{Kr.init(n,e);const t=d4[typeof e.value];n._zod.onattach.push(r=>{const i=r._zod.bag,s=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),n._zod.check=r=>{(e.inclusive?r.value>=e.value:r.value>e.value)||r.issues.push({origin:t,code:"too_small",minimum:e.value,input:r.value,inclusive:e.inclusive,inst:n,continue:!e.abort})}}),_U=ge("$ZodCheckMultipleOf",(n,e)=>{Kr.init(n,e),n._zod.onattach.push(t=>{var r;(r=t._zod.bag).multipleOf??(r.multipleOf=e.value)}),n._zod.check=t=>{if(typeof t.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof t.value=="bigint"?t.value%e.value===BigInt(0):w7(t.value,e.value)===0)||t.issues.push({origin:typeof t.value,code:"not_multiple_of",divisor:e.value,input:t.value,inst:n,continue:!e.abort})}}),wU=ge("$ZodCheckNumberFormat",(n,e)=>{Kr.init(n,e),e.format=e.format||"float64";const t=e.format?.includes("int"),r=t?"int":"number",[i,s]=k7[e.format];n._zod.onattach.push(o=>{const c=o._zod.bag;c.format=e.format,c.minimum=i,c.maximum=s,t&&(c.pattern=gU)}),n._zod.check=o=>{const c=o.value;if(t){if(!Number.isInteger(c)){o.issues.push({expected:r,format:e.format,code:"invalid_type",continue:!1,input:c,inst:n});return}if(!Number.isSafeInteger(c)){c>0?o.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:n,origin:r,continue:!e.abort}):o.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:n,origin:r,continue:!e.abort});return}}c<i&&o.issues.push({origin:"number",input:c,code:"too_small",minimum:i,inclusive:!0,inst:n,continue:!e.abort}),c>s&&o.issues.push({origin:"number",input:c,code:"too_big",maximum:s,inst:n})}}),SU=ge("$ZodCheckMaxLength",(n,e)=>{var t;Kr.init(n,e),(t=n._zod.def).when??(t.when=r=>{const i=r.value;return!P2(i)&&i.length!==void 0}),n._zod.onattach.push(r=>{const i=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(r._zod.bag.maximum=e.maximum)}),n._zod.check=r=>{const i=r.value;if(i.length<=e.maximum)return;const o=j2(i);r.issues.push({origin:o,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:n,continue:!e.abort})}}),AU=ge("$ZodCheckMinLength",(n,e)=>{var t;Kr.init(n,e),(t=n._zod.def).when??(t.when=r=>{const i=r.value;return!P2(i)&&i.length!==void 0}),n._zod.onattach.push(r=>{const i=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(r._zod.bag.minimum=e.minimum)}),n._zod.check=r=>{const i=r.value;if(i.length>=e.minimum)return;const o=j2(i);r.issues.push({origin:o,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:n,continue:!e.abort})}}),CU=ge("$ZodCheckLengthEquals",(n,e)=>{var t;Kr.init(n,e),(t=n._zod.def).when??(t.when=r=>{const i=r.value;return!P2(i)&&i.length!==void 0}),n._zod.onattach.push(r=>{const i=r._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),n._zod.check=r=>{const i=r.value,s=i.length;if(s===e.length)return;const o=j2(i),c=s>e.length;r.issues.push({origin:o,...c?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:r.value,inst:n,continue:!e.abort})}}),og=ge("$ZodCheckStringFormat",(n,e)=>{var t,r;Kr.init(n,e),n._zod.onattach.push(i=>{const s=i._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(t=n._zod).check??(t.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:n,continue:!e.abort})}):(r=n._zod).check??(r.check=()=>{})}),kU=ge("$ZodCheckRegex",(n,e)=>{og.init(n,e),n._zod.check=t=>{e.pattern.lastIndex=0,!e.pattern.test(t.value)&&t.issues.push({origin:"string",code:"invalid_format",format:"regex",input:t.value,pattern:e.pattern.toString(),inst:n,continue:!e.abort})}}),TU=ge("$ZodCheckLowerCase",(n,e)=>{e.pattern??(e.pattern=xU),og.init(n,e)}),EU=ge("$ZodCheckUpperCase",(n,e)=>{e.pattern??(e.pattern=vU),og.init(n,e)}),MU=ge("$ZodCheckIncludes",(n,e)=>{Kr.init(n,e);const t=Ac(e.includes),r=new RegExp(typeof e.position=="number"?`^.{${e.position}}${t}`:t);e.pattern=r,n._zod.onattach.push(i=>{const s=i._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),n._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:n,continue:!e.abort})}}),NU=ge("$ZodCheckStartsWith",(n,e)=>{Kr.init(n,e);const t=new RegExp(`^${Ac(e.prefix)}.*`);e.pattern??(e.pattern=t),n._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(t)}),n._zod.check=r=>{r.value.startsWith(e.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:r.value,inst:n,continue:!e.abort})}}),IU=ge("$ZodCheckEndsWith",(n,e)=>{Kr.init(n,e);const t=new RegExp(`.*${Ac(e.suffix)}$`);e.pattern??(e.pattern=t),n._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(t)}),n._zod.check=r=>{r.value.endsWith(e.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:r.value,inst:n,continue:!e.abort})}}),RU=ge("$ZodCheckOverwrite",(n,e)=>{Kr.init(n,e),n._zod.check=t=>{t.value=e.tx(t.value)}});class PU{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const r=e.split(`
`).filter(o=>o),i=Math.min(...r.map(o=>o.length-o.trimStart().length)),s=r.map(o=>o.slice(i)).map(o=>" ".repeat(this.indent*2)+o);for(const o of s)this.content.push(o)}compile(){const e=Function,t=this?.args,i=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...t,i.join(`
`))}}const DU={major:4,minor:1,patch:12},on=ge("$ZodType",(n,e)=>{var t;n??(n={}),n._zod.def=e,n._zod.bag=n._zod.bag||{},n._zod.version=DU;const r=[...n._zod.def.checks??[]];n._zod.traits.has("$ZodCheck")&&r.unshift(n);for(const i of r)for(const s of i._zod.onattach)s(n);if(r.length===0)(t=n._zod).deferred??(t.deferred=[]),n._zod.deferred?.push(()=>{n._zod.run=n._zod.parse});else{const i=(o,c,u)=>{let d=oc(o),f;for(const p of c){if(p._zod.def.when){if(!p._zod.def.when(o))continue}else if(d)continue;const y=o.issues.length,b=p._zod.check(o);if(b instanceof Promise&&u?.async===!1)throw new mc;if(f||b instanceof Promise)f=(f??Promise.resolve()).then(async()=>{await b,o.issues.length!==y&&(d||(d=oc(o,y)))});else{if(o.issues.length===y)continue;d||(d=oc(o,y))}}return f?f.then(()=>o):o},s=(o,c,u)=>{if(oc(o))return o.aborted=!0,o;const d=i(c,r,u);if(d instanceof Promise){if(u.async===!1)throw new mc;return d.then(f=>n._zod.parse(f,u))}return n._zod.parse(d,u)};n._zod.run=(o,c)=>{if(c.skipChecks)return n._zod.parse(o,c);if(c.direction==="backward"){const d=n._zod.parse({value:o.value,issues:[]},{...c,skipChecks:!0});return d instanceof Promise?d.then(f=>s(f,o,c)):s(d,o,c)}const u=n._zod.parse(o,c);if(u instanceof Promise){if(c.async===!1)throw new mc;return u.then(d=>i(d,r,c))}return i(u,r,c)}}n["~standard"]={validate:i=>{try{const s=O7(n,i);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return L7(n,i).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}}),L2=ge("$ZodString",(n,e)=>{on.init(n,e),n._zod.pattern=[...n?._zod.bag?.patterns??[]].pop()??mU(n._zod.bag),n._zod.parse=(t,r)=>{if(e.coerce)try{t.value=String(t.value)}catch{}return typeof t.value=="string"||t.issues.push({expected:"string",code:"invalid_type",input:t.value,inst:n}),t}}),bn=ge("$ZodStringFormat",(n,e)=>{og.init(n,e),L2.init(n,e)}),jU=ge("$ZodGUID",(n,e)=>{e.pattern??(e.pattern=eU),bn.init(n,e)}),BU=ge("$ZodUUID",(n,e)=>{if(e.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(r===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=YC(r))}else e.pattern??(e.pattern=YC());bn.init(n,e)}),OU=ge("$ZodEmail",(n,e)=>{e.pattern??(e.pattern=tU),bn.init(n,e)}),LU=ge("$ZodURL",(n,e)=>{bn.init(n,e),n._zod.check=t=>{try{const r=t.value.trim(),i=new URL(r);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||t.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:cU.source,input:t.value,inst:n,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||t.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:t.value,inst:n,continue:!e.abort})),e.normalize?t.value=i.href:t.value=r;return}catch{t.issues.push({code:"invalid_format",format:"url",input:t.value,inst:n,continue:!e.abort})}}}),zU=ge("$ZodEmoji",(n,e)=>{e.pattern??(e.pattern=rU()),bn.init(n,e)}),UU=ge("$ZodNanoID",(n,e)=>{e.pattern??(e.pattern=Q7),bn.init(n,e)}),FU=ge("$ZodCUID",(n,e)=>{e.pattern??(e.pattern=$7),bn.init(n,e)}),GU=ge("$ZodCUID2",(n,e)=>{e.pattern??(e.pattern=q7),bn.init(n,e)}),HU=ge("$ZodULID",(n,e)=>{e.pattern??(e.pattern=Z7),bn.init(n,e)}),VU=ge("$ZodXID",(n,e)=>{e.pattern??(e.pattern=X7),bn.init(n,e)}),WU=ge("$ZodKSUID",(n,e)=>{e.pattern??(e.pattern=K7),bn.init(n,e)}),YU=ge("$ZodISODateTime",(n,e)=>{e.pattern??(e.pattern=fU(e)),bn.init(n,e)}),$U=ge("$ZodISODate",(n,e)=>{e.pattern??(e.pattern=hU),bn.init(n,e)}),qU=ge("$ZodISOTime",(n,e)=>{e.pattern??(e.pattern=dU(e)),bn.init(n,e)}),ZU=ge("$ZodISODuration",(n,e)=>{e.pattern??(e.pattern=J7),bn.init(n,e)}),XU=ge("$ZodIPv4",(n,e)=>{e.pattern??(e.pattern=iU),bn.init(n,e),n._zod.onattach.push(t=>{const r=t._zod.bag;r.format="ipv4"})}),KU=ge("$ZodIPv6",(n,e)=>{e.pattern??(e.pattern=sU),bn.init(n,e),n._zod.onattach.push(t=>{const r=t._zod.bag;r.format="ipv6"}),n._zod.check=t=>{try{new URL(`http://[${t.value}]`)}catch{t.issues.push({code:"invalid_format",format:"ipv6",input:t.value,inst:n,continue:!e.abort})}}}),QU=ge("$ZodCIDRv4",(n,e)=>{e.pattern??(e.pattern=aU),bn.init(n,e)}),JU=ge("$ZodCIDRv6",(n,e)=>{e.pattern??(e.pattern=oU),bn.init(n,e),n._zod.check=t=>{const r=t.value.split("/");try{if(r.length!==2)throw new Error;const[i,s]=r;if(!s)throw new Error;const o=Number(s);if(`${o}`!==s)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${i}]`)}catch{t.issues.push({code:"invalid_format",format:"cidrv6",input:t.value,inst:n,continue:!e.abort})}}});function p4(n){if(n==="")return!0;if(n.length%4!==0)return!1;try{return atob(n),!0}catch{return!1}}const eF=ge("$ZodBase64",(n,e)=>{e.pattern??(e.pattern=lU),bn.init(n,e),n._zod.onattach.push(t=>{t._zod.bag.contentEncoding="base64"}),n._zod.check=t=>{p4(t.value)||t.issues.push({code:"invalid_format",format:"base64",input:t.value,inst:n,continue:!e.abort})}});function tF(n){if(!c4.test(n))return!1;const e=n.replace(/[-_]/g,r=>r==="-"?"+":"/"),t=e.padEnd(Math.ceil(e.length/4)*4,"=");return p4(t)}const nF=ge("$ZodBase64URL",(n,e)=>{e.pattern??(e.pattern=c4),bn.init(n,e),n._zod.onattach.push(t=>{t._zod.bag.contentEncoding="base64url"}),n._zod.check=t=>{tF(t.value)||t.issues.push({code:"invalid_format",format:"base64url",input:t.value,inst:n,continue:!e.abort})}}),rF=ge("$ZodE164",(n,e)=>{e.pattern??(e.pattern=uU),bn.init(n,e)});function iF(n,e=null){try{const t=n.split(".");if(t.length!==3)return!1;const[r]=t;if(!r)return!1;const i=JSON.parse(atob(r));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const sF=ge("$ZodJWT",(n,e)=>{bn.init(n,e),n._zod.check=t=>{iF(t.value,e.alg)||t.issues.push({code:"invalid_format",format:"jwt",input:t.value,inst:n,continue:!e.abort})}}),g4=ge("$ZodNumber",(n,e)=>{on.init(n,e),n._zod.pattern=n._zod.bag.pattern??yU,n._zod.parse=(t,r)=>{if(e.coerce)try{t.value=Number(t.value)}catch{}const i=t.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return t;const s=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return t.issues.push({expected:"number",code:"invalid_type",input:i,inst:n,...s?{received:s}:{}}),t}}),aF=ge("$ZodNumber",(n,e)=>{wU.init(n,e),g4.init(n,e)}),oF=ge("$ZodBoolean",(n,e)=>{on.init(n,e),n._zod.pattern=bU,n._zod.parse=(t,r)=>{if(e.coerce)try{t.value=!!t.value}catch{}const i=t.value;return typeof i=="boolean"||t.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:n}),t}}),lF=ge("$ZodBigInt",(n,e)=>{on.init(n,e),n._zod.pattern=pU,n._zod.parse=(t,r)=>{if(e.coerce)try{t.value=BigInt(t.value)}catch{}return typeof t.value=="bigint"||t.issues.push({expected:"bigint",code:"invalid_type",input:t.value,inst:n}),t}}),cF=ge("$ZodUnknown",(n,e)=>{on.init(n,e),n._zod.parse=t=>t}),uF=ge("$ZodNever",(n,e)=>{on.init(n,e),n._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:n}),t)});function $C(n,e,t){n.issues.length&&e.issues.push(...Mo(t,n.issues)),e.value[t]=n.value}const hF=ge("$ZodArray",(n,e)=>{on.init(n,e),n._zod.parse=(t,r)=>{const i=t.value;if(!Array.isArray(i))return t.issues.push({expected:"array",code:"invalid_type",input:i,inst:n}),t;t.value=Array(i.length);const s=[];for(let o=0;o<i.length;o++){const c=i[o],u=e.element._zod.run({value:c,issues:[]},r);u instanceof Promise?s.push(u.then(d=>$C(d,t,o))):$C(u,t,o)}return s.length?Promise.all(s).then(()=>t):t}});function kp(n,e,t,r){n.issues.length&&e.issues.push(...Mo(t,n.issues)),n.value===void 0?t in r&&(e.value[t]=void 0):e.value[t]=n.value}function y4(n){const e=Object.keys(n.shape);for(const r of e)if(!n.shape?.[r]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${r}": expected a Zod schema`);const t=C7(n.shape);return{...n,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(t)}}function b4(n,e,t,r,i,s){const o=[],c=i.keySet,u=i.catchall._zod,d=u.def.type;for(const f of Object.keys(e)){if(c.has(f))continue;if(d==="never"){o.push(f);continue}const p=u.run({value:e[f],issues:[]},r);p instanceof Promise?n.push(p.then(y=>kp(y,t,f,e))):kp(p,t,f,e)}return o.length&&t.issues.push({code:"unrecognized_keys",keys:o,input:e,inst:s}),n.length?Promise.all(n).then(()=>t):t}const dF=ge("$ZodObject",(n,e)=>{if(on.init(n,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const c=e.shape;Object.defineProperty(e,"shape",{get:()=>{const u={...c};return Object.defineProperty(e,"shape",{value:u}),u}})}const r=ig(()=>y4(e));Kt(n._zod,"propValues",()=>{const c=e.shape,u={};for(const d in c){const f=c[d]._zod;if(f.values){u[d]??(u[d]=new Set);for(const p of f.values)u[d].add(p)}}return u});const i=ed,s=e.catchall;let o;n._zod.parse=(c,u)=>{o??(o=r.value);const d=c.value;if(!i(d))return c.issues.push({expected:"object",code:"invalid_type",input:d,inst:n}),c;c.value={};const f=[],p=o.shape;for(const y of o.keys){const _=p[y]._zod.run({value:d[y],issues:[]},u);_ instanceof Promise?f.push(_.then(w=>kp(w,c,y,d))):kp(_,c,y,d)}return s?b4(f,d,c,u,r.value,n):f.length?Promise.all(f).then(()=>c):c}}),fF=ge("$ZodObjectJIT",(n,e)=>{dF.init(n,e);const t=n._zod.parse,r=ig(()=>y4(e)),i=y=>{const b=new PU(["shape","payload","ctx"]),_=r.value,w=k=>{const E=WC(k);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};b.write("const input = payload.value;");const S=Object.create(null);let A=0;for(const k of _.keys)S[k]=`key_${A++}`;b.write("const newResult = {};");for(const k of _.keys){const E=S[k],U=WC(k);b.write(`const ${E} = ${w(k)};`),b.write(`
        if (${E}.issues.length) {
          payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${U}, ...iss.path] : [${U}]
          })));
        }
        
        
        if (${E}.value === undefined) {
          if (${U} in input) {
            newResult[${U}] = undefined;
          }
        } else {
          newResult[${U}] = ${E}.value;
        }
        
      `)}b.write("payload.value = newResult;"),b.write("return payload;");const M=b.compile();return(k,E)=>M(y,k,E)};let s;const o=ed,c=!n4.jitless,d=c&&S7.value,f=e.catchall;let p;n._zod.parse=(y,b)=>{p??(p=r.value);const _=y.value;return o(_)?c&&d&&b?.async===!1&&b.jitless!==!0?(s||(s=i(e.shape)),y=s(y,b),f?b4([],_,y,b,p,n):y):t(y,b):(y.issues.push({expected:"object",code:"invalid_type",input:_,inst:n}),y)}});function qC(n,e,t,r){for(const s of n)if(s.issues.length===0)return e.value=s.value,e;const i=n.filter(s=>!oc(s));return i.length===1?(e.value=i[0].value,i[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:t,errors:n.map(s=>s.issues.map(o=>Fa(o,r,Ua())))}),e)}const x4=ge("$ZodUnion",(n,e)=>{on.init(n,e),Kt(n._zod,"optin",()=>e.options.some(i=>i._zod.optin==="optional")?"optional":void 0),Kt(n._zod,"optout",()=>e.options.some(i=>i._zod.optout==="optional")?"optional":void 0),Kt(n._zod,"values",()=>{if(e.options.every(i=>i._zod.values))return new Set(e.options.flatMap(i=>Array.from(i._zod.values)))}),Kt(n._zod,"pattern",()=>{if(e.options.every(i=>i._zod.pattern)){const i=e.options.map(s=>s._zod.pattern);return new RegExp(`^(${i.map(s=>D2(s.source)).join("|")})$`)}});const t=e.options.length===1,r=e.options[0]._zod.run;n._zod.parse=(i,s)=>{if(t)return r(i,s);let o=!1;const c=[];for(const u of e.options){const d=u._zod.run({value:i.value,issues:[]},s);if(d instanceof Promise)c.push(d),o=!0;else{if(d.issues.length===0)return d;c.push(d)}}return o?Promise.all(c).then(u=>qC(u,i,n,s)):qC(c,i,n,s)}}),mF=ge("$ZodDiscriminatedUnion",(n,e)=>{x4.init(n,e);const t=n._zod.parse;Kt(n._zod,"propValues",()=>{const i={};for(const s of e.options){const o=s._zod.propValues;if(!o||Object.keys(o).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(const[c,u]of Object.entries(o)){i[c]||(i[c]=new Set);for(const d of u)i[c].add(d)}}return i});const r=ig(()=>{const i=e.options,s=new Map;for(const o of i){const c=o._zod.propValues?.[e.discriminator];if(!c||c.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(const u of c){if(s.has(u))throw new Error(`Duplicate discriminator value "${String(u)}"`);s.set(u,o)}}return s});n._zod.parse=(i,s)=>{const o=i.value;if(!ed(o))return i.issues.push({code:"invalid_type",expected:"object",input:o,inst:n}),i;const c=r.value.get(o?.[e.discriminator]);return c?c._zod.run(i,s):e.unionFallback?t(i,s):(i.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:e.discriminator,input:o,path:[e.discriminator],inst:n}),i)}}),pF=ge("$ZodIntersection",(n,e)=>{on.init(n,e),n._zod.parse=(t,r)=>{const i=t.value,s=e.left._zod.run({value:i,issues:[]},r),o=e.right._zod.run({value:i,issues:[]},r);return s instanceof Promise||o instanceof Promise?Promise.all([s,o]).then(([u,d])=>ZC(t,u,d)):ZC(t,s,o)}});function n1(n,e){if(n===e)return{valid:!0,data:n};if(n instanceof Date&&e instanceof Date&&+n==+e)return{valid:!0,data:n};if(Sc(n)&&Sc(e)){const t=Object.keys(e),r=Object.keys(n).filter(s=>t.indexOf(s)!==-1),i={...n,...e};for(const s of r){const o=n1(n[s],e[s]);if(!o.valid)return{valid:!1,mergeErrorPath:[s,...o.mergeErrorPath]};i[s]=o.data}return{valid:!0,data:i}}if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return{valid:!1,mergeErrorPath:[]};const t=[];for(let r=0;r<n.length;r++){const i=n[r],s=e[r],o=n1(i,s);if(!o.valid)return{valid:!1,mergeErrorPath:[r,...o.mergeErrorPath]};t.push(o.data)}return{valid:!0,data:t}}return{valid:!1,mergeErrorPath:[]}}function ZC(n,e,t){if(e.issues.length&&n.issues.push(...e.issues),t.issues.length&&n.issues.push(...t.issues),oc(n))return n;const r=n1(e.value,t.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return n.value=r.data,n}const gF=ge("$ZodTuple",(n,e)=>{on.init(n,e);const t=e.items,r=t.length-[...t].reverse().findIndex(i=>i._zod.optin!=="optional");n._zod.parse=(i,s)=>{const o=i.value;if(!Array.isArray(o))return i.issues.push({input:o,inst:n,expected:"tuple",code:"invalid_type"}),i;i.value=[];const c=[];if(!e.rest){const d=o.length>t.length,f=o.length<r-1;if(d||f)return i.issues.push({...d?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},input:o,inst:n,origin:"array"}),i}let u=-1;for(const d of t){if(u++,u>=o.length&&u>=r)continue;const f=d._zod.run({value:o[u],issues:[]},s);f instanceof Promise?c.push(f.then(p=>pm(p,i,u))):pm(f,i,u)}if(e.rest){const d=o.slice(t.length);for(const f of d){u++;const p=e.rest._zod.run({value:f,issues:[]},s);p instanceof Promise?c.push(p.then(y=>pm(y,i,u))):pm(p,i,u)}}return c.length?Promise.all(c).then(()=>i):i}});function pm(n,e,t){n.issues.length&&e.issues.push(...Mo(t,n.issues)),e.value[t]=n.value}const yF=ge("$ZodRecord",(n,e)=>{on.init(n,e),n._zod.parse=(t,r)=>{const i=t.value;if(!Sc(i))return t.issues.push({expected:"record",code:"invalid_type",input:i,inst:n}),t;const s=[];if(e.keyType._zod.values){const o=e.keyType._zod.values;t.value={};for(const u of o)if(typeof u=="string"||typeof u=="number"||typeof u=="symbol"){const d=e.valueType._zod.run({value:i[u],issues:[]},r);d instanceof Promise?s.push(d.then(f=>{f.issues.length&&t.issues.push(...Mo(u,f.issues)),t.value[u]=f.value})):(d.issues.length&&t.issues.push(...Mo(u,d.issues)),t.value[u]=d.value)}let c;for(const u in i)o.has(u)||(c=c??[],c.push(u));c&&c.length>0&&t.issues.push({code:"unrecognized_keys",input:i,inst:n,keys:c})}else{t.value={};for(const o of Reflect.ownKeys(i)){if(o==="__proto__")continue;const c=e.keyType._zod.run({value:o,issues:[]},r);if(c instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(c.issues.length){t.issues.push({code:"invalid_key",origin:"record",issues:c.issues.map(d=>Fa(d,r,Ua())),input:o,path:[o],inst:n}),t.value[c.value]=c.value;continue}const u=e.valueType._zod.run({value:i[o],issues:[]},r);u instanceof Promise?s.push(u.then(d=>{d.issues.length&&t.issues.push(...Mo(o,d.issues)),t.value[c.value]=d.value})):(u.issues.length&&t.issues.push(...Mo(o,u.issues)),t.value[c.value]=u.value)}}return s.length?Promise.all(s).then(()=>t):t}}),bF=ge("$ZodEnum",(n,e)=>{on.init(n,e);const t=_7(e.entries),r=new Set(t);n._zod.values=r,n._zod.pattern=new RegExp(`^(${t.filter(i=>A7.has(typeof i)).map(i=>typeof i=="string"?Ac(i):i.toString()).join("|")})$`),n._zod.parse=(i,s)=>{const o=i.value;return r.has(o)||i.issues.push({code:"invalid_value",values:t,input:o,inst:n}),i}}),xF=ge("$ZodLiteral",(n,e)=>{if(on.init(n,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");n._zod.values=new Set(e.values),n._zod.pattern=new RegExp(`^(${e.values.map(t=>typeof t=="string"?Ac(t):t?Ac(t.toString()):String(t)).join("|")})$`),n._zod.parse=(t,r)=>{const i=t.value;return n._zod.values.has(i)||t.issues.push({code:"invalid_value",values:e.values,input:i,inst:n}),t}}),vF=ge("$ZodTransform",(n,e)=>{on.init(n,e),n._zod.parse=(t,r)=>{if(r.direction==="backward")throw new t4(n.constructor.name);const i=e.transform(t.value,t);if(r.async)return(i instanceof Promise?i:Promise.resolve(i)).then(o=>(t.value=o,t));if(i instanceof Promise)throw new mc;return t.value=i,t}});function XC(n,e){return n.issues.length&&e===void 0?{issues:[],value:void 0}:n}const _F=ge("$ZodOptional",(n,e)=>{on.init(n,e),n._zod.optin="optional",n._zod.optout="optional",Kt(n._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Kt(n._zod,"pattern",()=>{const t=e.innerType._zod.pattern;return t?new RegExp(`^(${D2(t.source)})?$`):void 0}),n._zod.parse=(t,r)=>{if(e.innerType._zod.optin==="optional"){const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(s=>XC(s,t.value)):XC(i,t.value)}return t.value===void 0?t:e.innerType._zod.run(t,r)}}),wF=ge("$ZodNullable",(n,e)=>{on.init(n,e),Kt(n._zod,"optin",()=>e.innerType._zod.optin),Kt(n._zod,"optout",()=>e.innerType._zod.optout),Kt(n._zod,"pattern",()=>{const t=e.innerType._zod.pattern;return t?new RegExp(`^(${D2(t.source)}|null)$`):void 0}),Kt(n._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),n._zod.parse=(t,r)=>t.value===null?t:e.innerType._zod.run(t,r)}),SF=ge("$ZodDefault",(n,e)=>{on.init(n,e),n._zod.optin="optional",Kt(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>{if(r.direction==="backward")return e.innerType._zod.run(t,r);if(t.value===void 0)return t.value=e.defaultValue,t;const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(s=>KC(s,e)):KC(i,e)}});function KC(n,e){return n.value===void 0&&(n.value=e.defaultValue),n}const AF=ge("$ZodPrefault",(n,e)=>{on.init(n,e),n._zod.optin="optional",Kt(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>(r.direction==="backward"||t.value===void 0&&(t.value=e.defaultValue),e.innerType._zod.run(t,r))}),CF=ge("$ZodNonOptional",(n,e)=>{on.init(n,e),Kt(n._zod,"values",()=>{const t=e.innerType._zod.values;return t?new Set([...t].filter(r=>r!==void 0)):void 0}),n._zod.parse=(t,r)=>{const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(s=>QC(s,n)):QC(i,n)}});function QC(n,e){return!n.issues.length&&n.value===void 0&&n.issues.push({code:"invalid_type",expected:"nonoptional",input:n.value,inst:e}),n}const kF=ge("$ZodCatch",(n,e)=>{on.init(n,e),Kt(n._zod,"optin",()=>e.innerType._zod.optin),Kt(n._zod,"optout",()=>e.innerType._zod.optout),Kt(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>{if(r.direction==="backward")return e.innerType._zod.run(t,r);const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(s=>(t.value=s.value,s.issues.length&&(t.value=e.catchValue({...t,error:{issues:s.issues.map(o=>Fa(o,r,Ua()))},input:t.value}),t.issues=[]),t)):(t.value=i.value,i.issues.length&&(t.value=e.catchValue({...t,error:{issues:i.issues.map(s=>Fa(s,r,Ua()))},input:t.value}),t.issues=[]),t)}}),TF=ge("$ZodPipe",(n,e)=>{on.init(n,e),Kt(n._zod,"values",()=>e.in._zod.values),Kt(n._zod,"optin",()=>e.in._zod.optin),Kt(n._zod,"optout",()=>e.out._zod.optout),Kt(n._zod,"propValues",()=>e.in._zod.propValues),n._zod.parse=(t,r)=>{if(r.direction==="backward"){const s=e.out._zod.run(t,r);return s instanceof Promise?s.then(o=>gm(o,e.in,r)):gm(s,e.in,r)}const i=e.in._zod.run(t,r);return i instanceof Promise?i.then(s=>gm(s,e.out,r)):gm(i,e.out,r)}});function gm(n,e,t){return n.issues.length?(n.aborted=!0,n):e._zod.run({value:n.value,issues:n.issues},t)}const EF=ge("$ZodReadonly",(n,e)=>{on.init(n,e),Kt(n._zod,"propValues",()=>e.innerType._zod.propValues),Kt(n._zod,"values",()=>e.innerType._zod.values),Kt(n._zod,"optin",()=>e.innerType._zod.optin),Kt(n._zod,"optout",()=>e.innerType._zod.optout),n._zod.parse=(t,r)=>{if(r.direction==="backward")return e.innerType._zod.run(t,r);const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(JC):JC(i)}});function JC(n){return n.value=Object.freeze(n.value),n}const MF=ge("$ZodCustom",(n,e)=>{Kr.init(n,e),on.init(n,e),n._zod.parse=(t,r)=>t,n._zod.check=t=>{const r=t.value,i=e.fn(r);if(i instanceof Promise)return i.then(s=>ek(s,t,r,n));ek(i,t,r,n)}});function ek(n,e,t,r){if(!n){const i={code:"custom",input:t,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(i.params=r._zod.def.params),e.issues.push(td(i))}}class NF{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){const r=t[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const t=this._map.get(e);return t&&typeof t=="object"&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){const t=e._zod.parent;if(t){const r={...this.get(t)??{}};delete r.id;const i={...r,...this._map.get(e)};return Object.keys(i).length?i:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function IF(){return new NF}const ym=IF();function RF(n,e){return new n({type:"string",...je(e)})}function PF(n,e){return new n({type:"string",format:"email",check:"string_format",abort:!1,...je(e)})}function tk(n,e){return new n({type:"string",format:"guid",check:"string_format",abort:!1,...je(e)})}function v4(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,...je(e)})}function DF(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...je(e)})}function jF(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...je(e)})}function BF(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...je(e)})}function OF(n,e){return new n({type:"string",format:"url",check:"string_format",abort:!1,...je(e)})}function LF(n,e){return new n({type:"string",format:"emoji",check:"string_format",abort:!1,...je(e)})}function zF(n,e){return new n({type:"string",format:"nanoid",check:"string_format",abort:!1,...je(e)})}function UF(n,e){return new n({type:"string",format:"cuid",check:"string_format",abort:!1,...je(e)})}function FF(n,e){return new n({type:"string",format:"cuid2",check:"string_format",abort:!1,...je(e)})}function GF(n,e){return new n({type:"string",format:"ulid",check:"string_format",abort:!1,...je(e)})}function HF(n,e){return new n({type:"string",format:"xid",check:"string_format",abort:!1,...je(e)})}function VF(n,e){return new n({type:"string",format:"ksuid",check:"string_format",abort:!1,...je(e)})}function WF(n,e){return new n({type:"string",format:"ipv4",check:"string_format",abort:!1,...je(e)})}function YF(n,e){return new n({type:"string",format:"ipv6",check:"string_format",abort:!1,...je(e)})}function $F(n,e){return new n({type:"string",format:"cidrv4",check:"string_format",abort:!1,...je(e)})}function qF(n,e){return new n({type:"string",format:"cidrv6",check:"string_format",abort:!1,...je(e)})}function ZF(n,e){return new n({type:"string",format:"base64",check:"string_format",abort:!1,...je(e)})}function XF(n,e){return new n({type:"string",format:"base64url",check:"string_format",abort:!1,...je(e)})}function KF(n,e){return new n({type:"string",format:"e164",check:"string_format",abort:!1,...je(e)})}function _4(n,e){return new n({type:"string",format:"jwt",check:"string_format",abort:!1,...je(e)})}function QF(n,e){return new n({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...je(e)})}function JF(n,e){return new n({type:"string",format:"date",check:"string_format",...je(e)})}function eG(n,e){return new n({type:"string",format:"time",check:"string_format",precision:null,...je(e)})}function tG(n,e){return new n({type:"string",format:"duration",check:"string_format",...je(e)})}function nG(n,e){return new n({type:"number",checks:[],...je(e)})}function rG(n,e){return new n({type:"number",check:"number_format",abort:!1,format:"safeint",...je(e)})}function iG(n,e){return new n({type:"boolean",...je(e)})}function sG(n,e){return new n({type:"bigint",...je(e)})}function aG(n){return new n({type:"unknown"})}function oG(n,e){return new n({type:"never",...je(e)})}function Tp(n,e){return new f4({check:"less_than",...je(e),value:n,inclusive:!1})}function pc(n,e){return new f4({check:"less_than",...je(e),value:n,inclusive:!0})}function Ep(n,e){return new m4({check:"greater_than",...je(e),value:n,inclusive:!1})}function Ma(n,e){return new m4({check:"greater_than",...je(e),value:n,inclusive:!0})}function r1(n,e){return new _U({check:"multiple_of",...je(e),value:n})}function w4(n,e){return new SU({check:"max_length",...je(e),maximum:n})}function Mp(n,e){return new AU({check:"min_length",...je(e),minimum:n})}function S4(n,e){return new CU({check:"length_equals",...je(e),length:n})}function lG(n,e){return new kU({check:"string_format",format:"regex",...je(e),pattern:n})}function cG(n){return new TU({check:"string_format",format:"lowercase",...je(n)})}function uG(n){return new EU({check:"string_format",format:"uppercase",...je(n)})}function hG(n,e){return new MU({check:"string_format",format:"includes",...je(e),includes:n})}function dG(n,e){return new NU({check:"string_format",format:"starts_with",...je(e),prefix:n})}function fG(n,e){return new IU({check:"string_format",format:"ends_with",...je(e),suffix:n})}function Cd(n){return new RU({check:"overwrite",tx:n})}function mG(n){return Cd(e=>e.normalize(n))}function pG(){return Cd(n=>n.trim())}function gG(){return Cd(n=>n.toLowerCase())}function yG(){return Cd(n=>n.toUpperCase())}function bG(n,e,t){return new n({type:"array",element:e,...je(t)})}function xG(n,e,t){return new n({type:"custom",check:"custom",fn:e,...je(t)})}function vG(n){const e=_G(t=>(t.addIssue=r=>{if(typeof r=="string")t.issues.push(td(r,t.value,e._zod.def));else{const i=r;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=t.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),t.issues.push(td(i))}},n(t.value,t)));return e}function _G(n,e){const t=new Kr({check:"custom",...je(e)});return t._zod.check=n,t}const wG=ge("ZodISODateTime",(n,e)=>{YU.init(n,e),Cn.init(n,e)});function SG(n){return QF(wG,n)}const AG=ge("ZodISODate",(n,e)=>{$U.init(n,e),Cn.init(n,e)});function CG(n){return JF(AG,n)}const kG=ge("ZodISOTime",(n,e)=>{qU.init(n,e),Cn.init(n,e)});function TG(n){return eG(kG,n)}const EG=ge("ZodISODuration",(n,e)=>{ZU.init(n,e),Cn.init(n,e)});function MG(n){return tG(EG,n)}const NG=(n,e)=>{a4.init(n,e),n.name="ZodError",Object.defineProperties(n,{format:{value:t=>j7(n,t)},flatten:{value:t=>D7(n,t)},addIssue:{value:t=>{n.issues.push(t),n.message=JSON.stringify(n.issues,t1,2)}},addIssues:{value:t=>{n.issues.push(...t),n.message=JSON.stringify(n.issues,t1,2)}},isEmpty:{get(){return n.issues.length===0}}})},Li=ge("ZodError",NG,{Parent:Error}),IG=B2(Li),RG=O2(Li),PG=sg(Li),DG=ag(Li),jG=z7(Li),BG=U7(Li),OG=F7(Li),LG=G7(Li),zG=H7(Li),UG=V7(Li),FG=W7(Li),GG=Y7(Li),xn=ge("ZodType",(n,e)=>(on.init(n,e),n.def=e,n.type=e.type,Object.defineProperty(n,"_def",{value:e}),n.check=(...t)=>n.clone(Qo(e,{checks:[...e.checks??[],...t.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]})),n.clone=(t,r)=>Ks(n,t,r),n.brand=()=>n,n.register=((t,r)=>(t.add(n,r),n)),n.parse=(t,r)=>IG(n,t,r,{callee:n.parse}),n.safeParse=(t,r)=>PG(n,t,r),n.parseAsync=async(t,r)=>RG(n,t,r,{callee:n.parseAsync}),n.safeParseAsync=async(t,r)=>DG(n,t,r),n.spa=n.safeParseAsync,n.encode=(t,r)=>jG(n,t,r),n.decode=(t,r)=>BG(n,t,r),n.encodeAsync=async(t,r)=>OG(n,t,r),n.decodeAsync=async(t,r)=>LG(n,t,r),n.safeEncode=(t,r)=>zG(n,t,r),n.safeDecode=(t,r)=>UG(n,t,r),n.safeEncodeAsync=async(t,r)=>FG(n,t,r),n.safeDecodeAsync=async(t,r)=>GG(n,t,r),n.refine=(t,r)=>n.check(jH(t,r)),n.superRefine=t=>n.check(BH(t)),n.overwrite=t=>n.check(Cd(t)),n.optional=()=>ak(n),n.nullable=()=>ok(n),n.nullish=()=>ak(ok(n)),n.nonoptional=t=>EH(n,t),n.array=()=>i1(n),n.or=t=>kd([n,t]),n.and=t=>xH(n,t),n.transform=t=>a1(n,M4(t)),n.default=t=>CH(n,t),n.prefault=t=>TH(n,t),n.catch=t=>NH(n,t),n.pipe=t=>a1(n,t),n.readonly=()=>PH(n),n.describe=t=>{const r=n.clone();return ym.add(r,{description:t}),r},Object.defineProperty(n,"description",{get(){return ym.get(n)?.description},configurable:!0}),n.meta=(...t)=>{if(t.length===0)return ym.get(n);const r=n.clone();return ym.add(r,t[0]),r},n.isOptional=()=>n.safeParse(void 0).success,n.isNullable=()=>n.safeParse(null).success,n)),A4=ge("_ZodString",(n,e)=>{L2.init(n,e),xn.init(n,e);const t=n._zod.bag;n.format=t.format??null,n.minLength=t.minimum??null,n.maxLength=t.maximum??null,n.regex=(...r)=>n.check(lG(...r)),n.includes=(...r)=>n.check(hG(...r)),n.startsWith=(...r)=>n.check(dG(...r)),n.endsWith=(...r)=>n.check(fG(...r)),n.min=(...r)=>n.check(Mp(...r)),n.max=(...r)=>n.check(w4(...r)),n.length=(...r)=>n.check(S4(...r)),n.nonempty=(...r)=>n.check(Mp(1,...r)),n.lowercase=r=>n.check(cG(r)),n.uppercase=r=>n.check(uG(r)),n.trim=()=>n.check(pG()),n.normalize=(...r)=>n.check(mG(...r)),n.toLowerCase=()=>n.check(gG()),n.toUpperCase=()=>n.check(yG())}),HG=ge("ZodString",(n,e)=>{L2.init(n,e),A4.init(n,e),n.email=t=>n.check(PF(VG,t)),n.url=t=>n.check(OF(YG,t)),n.jwt=t=>n.check(_4(C4,t)),n.emoji=t=>n.check(LF($G,t)),n.guid=t=>n.check(tk(nk,t)),n.uuid=t=>n.check(v4(_h,t)),n.uuidv4=t=>n.check(DF(_h,t)),n.uuidv6=t=>n.check(jF(_h,t)),n.uuidv7=t=>n.check(BF(_h,t)),n.nanoid=t=>n.check(zF(qG,t)),n.guid=t=>n.check(tk(nk,t)),n.cuid=t=>n.check(UF(ZG,t)),n.cuid2=t=>n.check(FF(XG,t)),n.ulid=t=>n.check(GF(KG,t)),n.base64=t=>n.check(ZF(iH,t)),n.base64url=t=>n.check(XF(sH,t)),n.xid=t=>n.check(HF(QG,t)),n.ksuid=t=>n.check(VF(JG,t)),n.ipv4=t=>n.check(WF(eH,t)),n.ipv6=t=>n.check(YF(tH,t)),n.cidrv4=t=>n.check($F(nH,t)),n.cidrv6=t=>n.check(qF(rH,t)),n.e164=t=>n.check(KF(aH,t)),n.datetime=t=>n.check(SG(t)),n.date=t=>n.check(CG(t)),n.time=t=>n.check(TG(t)),n.duration=t=>n.check(MG(t))});function Et(n){return RF(HG,n)}const Cn=ge("ZodStringFormat",(n,e)=>{bn.init(n,e),A4.init(n,e)}),VG=ge("ZodEmail",(n,e)=>{OU.init(n,e),Cn.init(n,e)}),nk=ge("ZodGUID",(n,e)=>{jU.init(n,e),Cn.init(n,e)}),_h=ge("ZodUUID",(n,e)=>{BU.init(n,e),Cn.init(n,e)});function WG(n){return v4(_h,n)}const YG=ge("ZodURL",(n,e)=>{LU.init(n,e),Cn.init(n,e)}),$G=ge("ZodEmoji",(n,e)=>{zU.init(n,e),Cn.init(n,e)}),qG=ge("ZodNanoID",(n,e)=>{UU.init(n,e),Cn.init(n,e)}),ZG=ge("ZodCUID",(n,e)=>{FU.init(n,e),Cn.init(n,e)}),XG=ge("ZodCUID2",(n,e)=>{GU.init(n,e),Cn.init(n,e)}),KG=ge("ZodULID",(n,e)=>{HU.init(n,e),Cn.init(n,e)}),QG=ge("ZodXID",(n,e)=>{VU.init(n,e),Cn.init(n,e)}),JG=ge("ZodKSUID",(n,e)=>{WU.init(n,e),Cn.init(n,e)}),eH=ge("ZodIPv4",(n,e)=>{XU.init(n,e),Cn.init(n,e)}),tH=ge("ZodIPv6",(n,e)=>{KU.init(n,e),Cn.init(n,e)}),nH=ge("ZodCIDRv4",(n,e)=>{QU.init(n,e),Cn.init(n,e)}),rH=ge("ZodCIDRv6",(n,e)=>{JU.init(n,e),Cn.init(n,e)}),iH=ge("ZodBase64",(n,e)=>{eF.init(n,e),Cn.init(n,e)}),sH=ge("ZodBase64URL",(n,e)=>{nF.init(n,e),Cn.init(n,e)}),aH=ge("ZodE164",(n,e)=>{rF.init(n,e),Cn.init(n,e)}),C4=ge("ZodJWT",(n,e)=>{sF.init(n,e),Cn.init(n,e)});function oH(n){return _4(C4,n)}const k4=ge("ZodNumber",(n,e)=>{g4.init(n,e),xn.init(n,e),n.gt=(r,i)=>n.check(Ep(r,i)),n.gte=(r,i)=>n.check(Ma(r,i)),n.min=(r,i)=>n.check(Ma(r,i)),n.lt=(r,i)=>n.check(Tp(r,i)),n.lte=(r,i)=>n.check(pc(r,i)),n.max=(r,i)=>n.check(pc(r,i)),n.int=r=>n.check(rk(r)),n.safe=r=>n.check(rk(r)),n.positive=r=>n.check(Ep(0,r)),n.nonnegative=r=>n.check(Ma(0,r)),n.negative=r=>n.check(Tp(0,r)),n.nonpositive=r=>n.check(pc(0,r)),n.multipleOf=(r,i)=>n.check(r1(r,i)),n.step=(r,i)=>n.check(r1(r,i)),n.finite=()=>n;const t=n._zod.bag;n.minValue=Math.max(t.minimum??Number.NEGATIVE_INFINITY,t.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,n.maxValue=Math.min(t.maximum??Number.POSITIVE_INFINITY,t.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,n.isInt=(t.format??"").includes("int")||Number.isSafeInteger(t.multipleOf??.5),n.isFinite=!0,n.format=t.format??null});function Nt(n){return nG(k4,n)}const lH=ge("ZodNumberFormat",(n,e)=>{aF.init(n,e),k4.init(n,e)});function rk(n){return rG(lH,n)}const cH=ge("ZodBoolean",(n,e)=>{oF.init(n,e),xn.init(n,e)});function ka(n){return iG(cH,n)}const uH=ge("ZodBigInt",(n,e)=>{lF.init(n,e),xn.init(n,e),n.gte=(r,i)=>n.check(Ma(r,i)),n.min=(r,i)=>n.check(Ma(r,i)),n.gt=(r,i)=>n.check(Ep(r,i)),n.gte=(r,i)=>n.check(Ma(r,i)),n.min=(r,i)=>n.check(Ma(r,i)),n.lt=(r,i)=>n.check(Tp(r,i)),n.lte=(r,i)=>n.check(pc(r,i)),n.max=(r,i)=>n.check(pc(r,i)),n.positive=r=>n.check(Ep(BigInt(0),r)),n.negative=r=>n.check(Tp(BigInt(0),r)),n.nonpositive=r=>n.check(pc(BigInt(0),r)),n.nonnegative=r=>n.check(Ma(BigInt(0),r)),n.multipleOf=(r,i)=>n.check(r1(r,i));const t=n._zod.bag;n.minValue=t.minimum??null,n.maxValue=t.maximum??null,n.format=t.format??null});function hH(n){return sG(uH,n)}const dH=ge("ZodUnknown",(n,e)=>{cF.init(n,e),xn.init(n,e)});function ik(){return aG(dH)}const fH=ge("ZodNever",(n,e)=>{uF.init(n,e),xn.init(n,e)});function mH(n){return oG(fH,n)}const pH=ge("ZodArray",(n,e)=>{hF.init(n,e),xn.init(n,e),n.element=e.element,n.min=(t,r)=>n.check(Mp(t,r)),n.nonempty=t=>n.check(Mp(1,t)),n.max=(t,r)=>n.check(w4(t,r)),n.length=(t,r)=>n.check(S4(t,r)),n.unwrap=()=>n.element});function i1(n,e){return bG(pH,n,e)}const gH=ge("ZodObject",(n,e)=>{fF.init(n,e),xn.init(n,e),Kt(n,"shape",()=>e.shape),n.keyof=()=>Sr(Object.keys(n._zod.def.shape)),n.catchall=t=>n.clone({...n._zod.def,catchall:t}),n.passthrough=()=>n.clone({...n._zod.def,catchall:ik()}),n.loose=()=>n.clone({...n._zod.def,catchall:ik()}),n.strict=()=>n.clone({...n._zod.def,catchall:mH()}),n.strip=()=>n.clone({...n._zod.def,catchall:void 0}),n.extend=t=>M7(n,t),n.safeExtend=t=>N7(n,t),n.merge=t=>I7(n,t),n.pick=t=>T7(n,t),n.omit=t=>E7(n,t),n.partial=(...t)=>R7(N4,n,t[0]),n.required=(...t)=>P7(I4,n,t[0])});function St(n,e){const t={type:"object",shape:n??{},...je(e)};return new gH(t)}const T4=ge("ZodUnion",(n,e)=>{x4.init(n,e),xn.init(n,e),n.options=e.options});function kd(n,e){return new T4({type:"union",options:n,...je(e)})}const yH=ge("ZodDiscriminatedUnion",(n,e)=>{T4.init(n,e),mF.init(n,e)});function z2(n,e,t){return new yH({type:"union",options:e,discriminator:n,...je(t)})}const bH=ge("ZodIntersection",(n,e)=>{pF.init(n,e),xn.init(n,e)});function xH(n,e){return new bH({type:"intersection",left:n,right:e})}const vH=ge("ZodTuple",(n,e)=>{gF.init(n,e),xn.init(n,e),n.rest=t=>n.clone({...n._zod.def,rest:t})});function sk(n,e,t){const r=e instanceof on,i=r?t:e,s=r?e:null;return new vH({type:"tuple",items:n,rest:s,...je(i)})}const E4=ge("ZodRecord",(n,e)=>{yF.init(n,e),xn.init(n,e),n.keyType=e.keyType,n.valueType=e.valueType});function wh(n,e,t){return new E4({type:"record",keyType:n,valueType:e,...je(t)})}function hb(n,e,t){const r=Ks(n);return r._zod.values=void 0,new E4({type:"record",keyType:r,valueType:e,...je(t)})}const s1=ge("ZodEnum",(n,e)=>{bF.init(n,e),xn.init(n,e),n.enum=e.entries,n.options=Object.values(e.entries);const t=new Set(Object.keys(e.entries));n.extract=(r,i)=>{const s={};for(const o of r)if(t.has(o))s[o]=e.entries[o];else throw new Error(`Key ${o} not found in enum`);return new s1({...e,checks:[],...je(i),entries:s})},n.exclude=(r,i)=>{const s={...e.entries};for(const o of r)if(t.has(o))delete s[o];else throw new Error(`Key ${o} not found in enum`);return new s1({...e,checks:[],...je(i),entries:s})}});function Sr(n,e){const t=Array.isArray(n)?Object.fromEntries(n.map(r=>[r,r])):n;return new s1({type:"enum",entries:t,...je(e)})}const _H=ge("ZodLiteral",(n,e)=>{xF.init(n,e),xn.init(n,e),n.values=new Set(e.values),Object.defineProperty(n,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function Ye(n,e){return new _H({type:"literal",values:Array.isArray(n)?n:[n],...je(e)})}const wH=ge("ZodTransform",(n,e)=>{vF.init(n,e),xn.init(n,e),n._zod.parse=(t,r)=>{if(r.direction==="backward")throw new t4(n.constructor.name);t.addIssue=s=>{if(typeof s=="string")t.issues.push(td(s,t.value,e));else{const o=s;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=t.value),o.inst??(o.inst=n),t.issues.push(td(o))}};const i=e.transform(t.value,t);return i instanceof Promise?i.then(s=>(t.value=s,t)):(t.value=i,t)}});function M4(n){return new wH({type:"transform",transform:n})}const N4=ge("ZodOptional",(n,e)=>{_F.init(n,e),xn.init(n,e),n.unwrap=()=>n._zod.def.innerType});function ak(n){return new N4({type:"optional",innerType:n})}const SH=ge("ZodNullable",(n,e)=>{wF.init(n,e),xn.init(n,e),n.unwrap=()=>n._zod.def.innerType});function ok(n){return new SH({type:"nullable",innerType:n})}const AH=ge("ZodDefault",(n,e)=>{SF.init(n,e),xn.init(n,e),n.unwrap=()=>n._zod.def.innerType,n.removeDefault=n.unwrap});function CH(n,e){return new AH({type:"default",innerType:n,get defaultValue(){return typeof e=="function"?e():i4(e)}})}const kH=ge("ZodPrefault",(n,e)=>{AF.init(n,e),xn.init(n,e),n.unwrap=()=>n._zod.def.innerType});function TH(n,e){return new kH({type:"prefault",innerType:n,get defaultValue(){return typeof e=="function"?e():i4(e)}})}const I4=ge("ZodNonOptional",(n,e)=>{CF.init(n,e),xn.init(n,e),n.unwrap=()=>n._zod.def.innerType});function EH(n,e){return new I4({type:"nonoptional",innerType:n,...je(e)})}const MH=ge("ZodCatch",(n,e)=>{kF.init(n,e),xn.init(n,e),n.unwrap=()=>n._zod.def.innerType,n.removeCatch=n.unwrap});function NH(n,e){return new MH({type:"catch",innerType:n,catchValue:typeof e=="function"?e:()=>e})}const IH=ge("ZodPipe",(n,e)=>{TF.init(n,e),xn.init(n,e),n.in=e.in,n.out=e.out});function a1(n,e){return new IH({type:"pipe",in:n,out:e})}const RH=ge("ZodReadonly",(n,e)=>{EF.init(n,e),xn.init(n,e),n.unwrap=()=>n._zod.def.innerType});function PH(n){return new RH({type:"readonly",innerType:n})}const DH=ge("ZodCustom",(n,e)=>{MF.init(n,e),xn.init(n,e)});function jH(n,e={}){return xG(DH,n,e)}function BH(n){return vG(n)}function OH(n,e){return a1(M4(n),e)}const lg=Et().regex(/^[a-z0-9_]+$/).max(32),R4=Et().max(1403).refine(n=>{try{return Jp(n,eg),!0}catch(e){const t=e instanceof Error?JSON.stringify(e.message,null,2):String(e);return console.error(t),!1}},{message:"Invalid pattern"}),P4=St({name:Et(),primary:Et(),secondary:Et()}),LH=St({name:lg,pattern:R4,colorPalettes:St({name:Et()}).array().optional()}),zH=St({colorPalettes:wh(Et(),P4).optional(),patterns:wh(Et(),LH),flag:St({layers:wh(Et(),St({name:Et(),flares:i1(Et()).optional()})),color:wh(Et(),St({color:Et(),name:Et(),flares:i1(Et()).optional()}))}).optional()});function UH({className:n=""}){const[e,t]=T.useState(!1),[r,i]=T.useState(null),[s,o]=T.useState(!1),[c,u]=T.useState(null),[d,f]=T.useState(null),[p,y]=T.useState(null),[b,_]=T.useState(!1),[w,S]=T.useState(null),[A,M]=T.useState(!1),k=T.useRef(null);T.useEffect(()=>{(async()=>{try{const H=await(await fetch("/cosmetics/cosmetics.json")).json(),Y=zH.safeParse(H);if(!Y.success){console.error("Invalid cosmetics.json structure:",Y.error);return}const L=Y.data;S(L);const q=et.getFlag(),W=et.getPattern(),N=et.getColorPalette(),V=et.getColor();let J=W;if(W==="default"?(J=null,et.setPattern(null)):W!==null&&(lg.safeParse(W).success?L.patterns[W]||(console.warn(`Pattern "${W}" not found in cosmetics.json, clearing from localStorage`),et.setPattern(null),et.setColorPalette(null),u(null),f(null),J=null):(console.warn(`Pattern name "${W}" doesn't match schema (must be lowercase alphanumeric with underscores, max 32 chars), clearing from localStorage`),et.setPattern(null),et.setColorPalette(null),u(null),f(null),J=null)),J!==null){if(u(J),N!==null){const O=L.patterns[J]?.colorPalettes?.map(F=>F.name)||[];if(!L.colorPalettes||!L.colorPalettes[N])console.warn(`Color palette "${N}" not found in cosmetics.json, clearing from localStorage`),et.setColorPalette(null),f(null);else if(!O.includes(N))console.warn(`Color palette "${N}" is not allowed for pattern "${J}", clearing from localStorage`),et.setColorPalette(null),f(null);else{const F=L.colorPalettes[N];!F||!F.primary||!F.secondary?(console.warn(`Color palette "${N}" has invalid structure, clearing from localStorage`),et.setColorPalette(null),f(null)):f(N)}}}else u(null),N!==null&&(console.warn(`Color palette "${N}" is set but pattern is null (default), clearing color palette from localStorage`),et.setColorPalette(null),f(null));V!==null&&(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(V)?y(V):(console.warn(`Color "${V}" is not a valid hex color, clearing from localStorage`),et.setColor(null),y(null))),q!==null&&i(q)}catch(P){console.error("Failed to load cosmetics:",P)}})()},[]),T.useEffect(()=>{(async()=>{try{const P=await L3();if(!P)return;const H=jo.getCurrentVersion();M(P!==H)}catch(P){console.error("Failed to check for new version:",P)}})()},[]);const E=R=>{i(R),et.setFlag(R)};T.useEffect(()=>{if(!k.current||!c||!w)return;const R=w.patterns[c];if(R)try{const P=Jp(R.pattern,eg),H=k.current,Y=H.getContext("2d");if(!Y)return;const L=d?w.colorPalettes?.[d]:null,q=L?.primary||"#4a5568",W=L?.secondary||"#718096",N=2;H.width=P.width*N,H.height=P.height*N,Y.fillStyle=q,Y.fillRect(0,0,H.width,H.height),Y.fillStyle=W;const V=3;for(let J=0;J<P.height;J++)for(let se=0;se<P.width;se++){const O=J*P.width+se,F=V+(O>>>3),X=O&7,D=P.bytes[F];D!==void 0&&(D>>>X&1)===1&&Y.fillRect(se*N,J*N,N,N)}}catch(P){console.error("Failed to render pattern:",P)}},[c,d,w]);const U=(R,P)=>{const H=R==="default"?null:R;u(H),f(P),y(null),et.setPattern(H),et.setColorPalette(P),et.setColor(null)},I=R=>{y(R),u(null),f(null),et.setColor(R),et.setPattern(null),et.setColorPalette(null)},B=()=>c&&w?g.jsx("canvas",{ref:k,className:"w-full h-full rounded",style:{imageRendering:"pixelated"}}):p?g.jsx("div",{className:"w-full h-full rounded",style:{backgroundColor:p}}):g.jsxs("div",{className:"w-full h-full rounded relative overflow-hidden",style:{backgroundColor:"var(--pattern-bg, #ffffff)"},children:[g.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-[2px] bg-gray-600 -translate-y-1/2"}),g.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-[2px] bg-gray-600 -translate-x-1/2"}),g.jsx("div",{className:"absolute top-1/2 left-1/2 w-1.5 h-1.5 bg-gray-400 -translate-x-1/2 -translate-y-1/2"})]}),G=()=>{if(!r)return g.jsx("div",{className:"w-full h-full flex items-center justify-center",children:g.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})});const R=r.endsWith(".svg")?r:`${r}.svg`;return g.jsx("img",{src:`/flags/${R}`,alt:"Selected flag",className:"w-full h-full object-cover rounded",onError:P=>{P.target.style.display="none";const H=P.target.parentElement;if(H&&!H.querySelector("svg")){const Y=document.createElement("div");Y.className="w-full h-full flex items-center justify-center";const L=document.createElementNS("http://www.w3.org/2000/svg","svg");L.setAttribute("class","w-6 h-6 text-red-500"),L.setAttribute("fill","none"),L.setAttribute("stroke","currentColor"),L.setAttribute("viewBox","0 0 24 24");const q=document.createElementNS("http://www.w3.org/2000/svg","path");q.setAttribute("stroke-linecap","round"),q.setAttribute("stroke-linejoin","round"),q.setAttribute("stroke-width","3"),q.setAttribute("d","M6 18L18 6M6 6l12 12"),L.appendChild(q),Y.appendChild(L),H.appendChild(Y)}}})};return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:`flex items-center gap-4 justify-center w-full ${n}`,children:[g.jsx("button",{onClick:()=>t(!0),className:"w-15 h-15 flex items-center justify-center rounded-lg border-2 transition-all overflow-hidden cursor-pointer",style:{borderColor:"var(--border-primary)",backgroundColor:"var(--bg-main)",boxShadow:"var(--shadow-button, none)"},onMouseEnter:R=>{R.currentTarget.style.backgroundColor="var(--bg-hover)",R.currentTarget.style.boxShadow="var(--shadow-button-hover, var(--shadow-button, none))"},onMouseLeave:R=>{R.currentTarget.style.backgroundColor="var(--bg-main)",R.currentTarget.style.boxShadow="var(--shadow-button, none)"},children:G()}),g.jsx("button",{onClick:()=>o(!0),className:"w-15 h-15 flex items-center justify-center rounded-lg border-2 transition-all overflow-hidden cursor-pointer","aria-label":"Select pattern",style:{borderColor:"var(--border-primary)",backgroundColor:"var(--bg-main)",boxShadow:"var(--shadow-button, none)"},onMouseEnter:R=>{R.currentTarget.style.backgroundColor="var(--bg-hover)",R.currentTarget.style.boxShadow="var(--shadow-button-hover, var(--shadow-button, none))"},onMouseLeave:R=>{R.currentTarget.style.backgroundColor="var(--bg-main)",R.currentTarget.style.boxShadow="var(--shadow-button, none)"},children:B()}),g.jsx(v7,{}),g.jsxs("button",{onClick:()=>_(!0),className:"w-14 h-14 flex items-center justify-center rounded-lg border-2 transition-all cursor-pointer relative","aria-label":"View release notes",style:{borderColor:"var(--border-primary)",backgroundColor:"var(--bg-main)",boxShadow:"var(--shadow-button, none)"},onMouseEnter:R=>{R.currentTarget.style.backgroundColor="var(--bg-hover)",R.currentTarget.style.boxShadow="var(--shadow-button-hover, var(--shadow-button, none))"},onMouseLeave:R=>{R.currentTarget.style.backgroundColor="var(--bg-main)",R.currentTarget.style.boxShadow="var(--shadow-button, none)"},children:[g.jsxs("svg",{className:"w-9 h-9",fill:"currentColor",viewBox:"0 0 399.19 399.19",xmlns:"http://www.w3.org/2000/svg",style:{color:"var(--text-primary)"},children:[g.jsx("path",{d:"M375.337,97.308c-3.136-4.547-9.364-5.691-13.909-2.557c-4.547,3.135-5.692,9.362-2.557,13.909 c13.295,19.284,20.322,42.543,20.322,67.264c0,24.627-7.35,48.709-20.694,67.81c-3.163,4.527-2.058,10.762,2.47,13.925 c1.744,1.219,3.741,1.804,5.719,1.804c3.155,0,6.262-1.491,8.206-4.273c15.897-22.753,24.3-50.163,24.3-79.265 C399.193,147.131,390.943,119.946,375.337,97.308z"}),g.jsx("path",{d:"M342.47,125.562c-3.134-4.547-9.361-5.692-13.909-2.557c-4.547,3.135-5.691,9.362-2.556,13.909 c7.72,11.197,11.801,24.726,11.801,39.124c0,14.344-4.268,28.352-12.016,39.443c-3.163,4.527-2.058,10.762,2.47,13.925 c1.744,1.218,3.741,1.803,5.719,1.803c3.156,0,6.262-1.49,8.206-4.274c10.22-14.627,15.621-32.228,15.621-50.897 C357.806,157.567,352.503,140.113,342.47,125.562z"}),g.jsx("path",{d:"M303.027,20.495c-4.954,0-9.532,2.757-13.586,8.167c-0.328,0.432-33.738,43.425-117.107,69.128 c-7.914,2.44-16.663,4.163-16.748,4.18c-1.978,0.386-3.888,1.004-5.707,1.82c-3.508-5.791-9.85-9.681-17.1-9.681H48.635 c-11.028,0-20,8.972-20,20v10.979c-1.402-0.22-2.844-0.342-4.317-0.342C10.909,124.746,0,134.272,0,145.98v55.29 c0,11.708,10.909,21.234,24.317,21.234c1.474,0,2.915-0.121,4.317-0.342v8.979c0,11.028,8.972,20,20,20h2.704L76.731,356.46 c3.007,12.47,15.41,22.238,28.237,22.238h26.873c7.017,0,13.365-2.951,17.417-8.096c4.053-5.145,5.434-12.008,3.789-18.83 l-24.262-100.631h3.993c7.253,0,13.597-3.893,17.104-9.687c1.816,0.815,3.724,1.432,5.698,1.818 c0.087,0.017,8.836,1.742,16.748,4.186c83.375,25.756,116.782,68.707,117.09,69.11c4.074,5.433,8.651,8.188,13.604,8.188 c0,0,0,0,0.001,0c4.896,0,9.178-2.776,11.453-7.425c1.307-2.668,1.941-5.862,1.941-9.763V37.681 C316.419,20.977,304.397,20.495,303.027,20.495z M24.317,202.504c-2.463,0-3.935-1.02-4.317-1.5v-54.759 c0.383-0.48,1.854-1.5,4.317-1.5s3.935,1.02,4.317,1.5v54.759C28.252,201.485,26.78,202.504,24.317,202.504z M133.604,356.46 c0.216,0.896,0.127,1.533-0.058,1.768s-0.783,0.471-1.705,0.471h-26.873c-3.662,0-7.936-3.366-8.794-6.926L71.912,251.141h36.3 L133.604,356.46z M48.635,231.141V201.27v-55.29v-31.871h84.145l0,15.539c0,0.004,0,0.007,0,0.011v85.922 c0,0.024,0.002,0.047,0.002,0.071l0,15.489H48.635z M296.419,294.556c-15.581-15.585-52.326-45.861-118.187-66.207 c-8.957-2.768-18.415-4.627-18.813-4.706c-3.413-0.667-6.64-4.585-6.64-8.063v-85.922c0-3.477,3.227-7.394,6.639-8.06 c0.398-0.078,9.853-1.935,18.809-4.697c65.854-20.303,102.604-50.591,118.192-66.192V294.556z"})]}),A&&g.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full border-2 border-white flex items-center justify-center",children:g.jsx("span",{className:"text-white text-xs font-bold",children:"!"})})]})]}),g.jsx(u8,{open:e,onClose:()=>t(!1),onSelectFlag:E,currentFlag:r}),g.jsx(p8,{open:s,onClose:()=>o(!1),onSelectPattern:U,onSelectColor:I,currentPattern:c,currentColorPalette:d,currentColor:p}),g.jsx(vz,{open:b,onClose:()=>{_(!1),M(!1)}})]})}class FH{constructor(){this.listeners=new Map}emit(e){const t=e.constructor,r=this.listeners.get(t);if(r)for(const i of r)i(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){const r=this.listeners.get(e);if(r){const i=r.indexOf(t);i>-1&&r.splice(i,1)}}}class Oh{constructor(e){this.attackRatio=e}}class Cc{constructor(e){this.lobby=e}}class D4{constructor(e){this.lobby=e}}class j4{constructor(e){this.target=e}}class o1{constructor(){}}class Ta{constructor(e,t){this.progress=e,this.message=t}}class l1{constructor(){}}class nd{constructor(e){this.gameStartInfo=e}}class Np{constructor(e){this.game=e}}class Ot{constructor(e){this.game=e}}class B4{constructor(e,t){this.tick=e,this.hash=t}}class rd{constructor(e,t){this.winner=e,this.playersStats=t}}class c1{constructor(e){this.tickDuration=e}}class O4{constructor(e){this.tile=e}}class u1{constructor(e,t){this.targetPlayerID=e,this.troops=t}}class L4{constructor(e){this.attackID=e}}class z4{constructor(e,t,r,i=null){this.targetPlayerID=e,this.targetTile=t,this.troops=r,this.sourceTile=i}}class U4{constructor(e){this.unitID=e}}class U2{constructor(e,t){this.unitId=e,this.unitType=t}}class kc{constructor(e,t){this.unitType=e,this.tile=t}}class F2{constructor(e){this.recipient=e}}class h1{constructor(e,t){this.recipient=e,this.accept=t}}class G2{constructor(e){this.recipient=e}}class F4{constructor(e){this.recipient=e}}class cg{constructor(e,t){this.recipient=e,this.troops=t}}class H2{constructor(e,t){this.recipient=e,this.gold=t}}class G4{constructor(e){this.unitId=e}}class d1{constructor(e,t){this.target=e,this.action=t}}class H4{constructor(e,t){this.recipient=e,this.emojiIndex=t}}class V4{constructor(e){this.target=e}}class W4{constructor(e,t,r){this.recipient=e,this.quickChatKey=t,this.target=r}}class Y4{constructor(e,t){this.unitID=e,this.targetTile=t}}class $4{constructor(e){this.multiplier=e}}class V2{constructor(e){this.paused=e}}class f1{constructor(e,t){this.title=e,this.message=t}}const ae=new FH;class GH{constructor(e){this.game=e}initialize(){ae.on(j4,this.kickPlayerEvent.bind(this)),ae.on(rd,this.sendGameWinner.bind(this)),ae.on(B4,this.sendHash.bind(this)),ae.on(O4,this.spawnIntent.bind(this)),ae.on(u1,this.attackIntent.bind(this)),ae.on(L4,this.cancelAttackIntent.bind(this)),ae.on(z4,this.boatAttackIntent.bind(this)),ae.on(U4,this.cancelBoatIntent.bind(this)),ae.on(U2,this.upgradeStructureIntent.bind(this)),ae.on(kc,this.buildUnitIntent.bind(this)),ae.on(F2,this.allianceRequestIntent.bind(this)),ae.on(h1,this.allianceRequestReplyIntent.bind(this)),ae.on(F4,this.allianceExtensionIntent.bind(this)),ae.on(G2,this.breakAllianceIntent.bind(this)),ae.on(cg,this.donateTroopsIntent.bind(this)),ae.on(H2,this.donateGoldIntent.bind(this)),ae.on(G4,this.deleteUnitIntent.bind(this)),ae.on(d1,this.tradeIntent.bind(this)),ae.on(H4,this.emojiIntent.bind(this)),ae.on(V4,this.targetPlayerIntent.bind(this)),ae.on(W4,this.quickChatIntent.bind(this)),ae.on(Y4,this.moveWarshipIntent.bind(this))}kickPlayerEvent(e){this.game.socket.send({type:"intent",intent:{type:"kick_player",clientID:this.game.clientID,target:e.target}})}sendGameWinner(e){this.game.socket.send({type:"winner",winner:e.winner,allPlayersStats:e.playersStats})}sendHash(e){const{tick:t,hash:r}=e;this.game.socket.send({type:"hash",turnNumber:t,hash:r})}spawnIntent(e){this.game.socket.send({type:"intent",intent:{type:"spawn",clientID:this.game.clientID,tile:e.tile}})}attackIntent(e){this.game.socket.send({type:"intent",intent:{type:"attack",clientID:this.game.clientID,targetID:e.targetPlayerID,troops:e.troops}})}cancelAttackIntent(e){this.game.socket.send({type:"intent",intent:{type:"cancel_attack",clientID:this.game.clientID,attackID:e.attackID}})}boatAttackIntent(e){this.game.socket.send({type:"intent",intent:{type:"boat",clientID:this.game.clientID,targetID:e.targetPlayerID,dst:e.targetTile,src:e.sourceTile,troops:e.troops}})}cancelBoatIntent(e){this.game.socket.send({type:"intent",intent:{type:"cancel_boat",clientID:this.game.clientID,unitID:e.unitID}})}upgradeStructureIntent(e){this.game.socket.send({type:"intent",intent:{type:"upgrade_structure",clientID:this.game.clientID,unit:e.unitType,unitId:e.unitId}}),(window.keepghost === false) && (this.game.placementUnit = null)}buildUnitIntent(e){this.game.socket.send({type:"intent",intent:{type:"build_unit",clientID:this.game.clientID,unit:e.unitType,tile:e.tile}}),(window.keepghost === false) && (this.game.placementUnit = null)}allianceRequestIntent(e){this.game.socket.send({type:"intent",intent:{type:"alliance_request",clientID:this.game.clientID,recipient:e.recipient}})}allianceRequestReplyIntent(e){this.game.socket.send({type:"intent",intent:{type:"alliance_request_reply",clientID:this.game.clientID,requestor:e.recipient,accept:e.accept}})}allianceExtensionIntent(e){this.game.socket.send({type:"intent",intent:{type:"alliance_extension",clientID:this.game.clientID,recipient:e.recipient}})}breakAllianceIntent(e){this.game.socket.send({type:"intent",intent:{type:"break_alliance",clientID:this.game.clientID,recipient:e.recipient}})}donateTroopsIntent(e){this.game.socket.send({type:"intent",intent:{type:"donate_troops",clientID:this.game.clientID,recipient:e.recipient,troops:e.troops}})}donateGoldIntent(e){this.game.socket.send({type:"intent",intent:{type:"donate_gold",clientID:this.game.clientID,recipient:e.recipient,gold:e.gold}})}deleteUnitIntent(e){this.game.socket.send({type:"intent",intent:{type:"delete_unit",clientID:this.game.clientID,unitId:e.unitId}})}tradeIntent(e){this.game.socket.send({type:"intent",intent:{type:"embargo",clientID:this.game.clientID,targetID:e.target,action:e.action}})}emojiIntent(e){this.game.socket.send({type:"intent",intent:{type:"emoji",clientID:this.game.clientID,recipient:e.recipient===fs?fs:e.recipient,emoji:e.emojiIndex}})}targetPlayerIntent(e){this.game.socket.send({type:"intent",intent:{type:"target_player",clientID:this.game.clientID,target:e.target}})}quickChatIntent(e){this.game.socket.send({type:"intent",intent:{type:"quick_chat",clientID:this.game.clientID,recipient:e.recipient,quickChatKey:e.quickChatKey,target:e.target}})}moveWarshipIntent(e){this.game.socket.send({type:"intent",intent:{type:"move_warship",clientID:this.game.clientID,unitId:e.unitID,tile:e.targetTile}})}}function q4(n){if(n<=0)return"0s";const e=Math.floor(n/60),t=n%60;let r="";return e>0&&(r+=`${e}min `),r+=`${t}s`,r.trim()}function Hs(n){return pn(n/10)}function pn(n,e){return n=Number(n),n=Math.max(n,0),n>=1e9?(Math.floor(n/1e7)/100).toFixed(e??2)+"B":n>=1e7?(Math.floor(n/1e5)/10).toFixed(e??1)+"M":n>=1e6?(Math.floor(n/1e4)/100).toFixed(e??2)+"M":n>=1e5?Math.floor(n/1e3)+"K":n>=1e4?(Math.floor(n/100)/10).toFixed(e??1)+"K":n>=1e3?(Math.floor(n/10)/100).toFixed(e??2)+"K":Math.floor(n).toString()}function HH(n){return Object.keys(Ee).find(t=>Ee[t]===n)?.toLowerCase()||"pangaea"}function VH(n,e){return n?n.gameMode===qn.FFA?e("game_mode.ffa"):n.playerTeams===Fo?e("public_lobby.teams_Duos"):n.playerTeams===Go?e("public_lobby.teams_Trios"):n.playerTeams===Ho?e("public_lobby.teams_Quads"):e("public_lobby.teams").replace("{{num}}",String(n.playerTeams)):null}function WH(n,e){if(!n?.economyMode)return null;const t=n.economyMode;if(t===Yr.Fast)return e("economy_mode.fast");if(t===Yr.Classic)return e("economy_mode.classic");const r=String(t);return r.charAt(0).toUpperCase()+r.slice(1)}function YH({className:n=""}){const{t:e}=xt(),{theme:t}=Dc(),[r,i]=T.useState(null),[s,o]=T.useState(!0),[c,u]=T.useState(!1),[d,f]=T.useState(!1),[p,y]=T.useState(null),[b,_]=T.useState(0),w=T.useRef(null),S=T.useRef(null),A=T.useRef(new Map);T.useEffect(()=>{const Y=async()=>{try{const q=await fetch("/api/public_lobbies");if(!q.ok)throw new Error("Failed to fetch lobbies");const W=await q.json();if(W.lobbies&&W.lobbies.length>0){const N=W.lobbies[0];if(i(N),!A.current.has(N.gameID)){const V=N.msUntilStart??0;A.current.set(N.gameID,V+Date.now())}}else i(null);o(!1)}catch(q){console.error("Error fetching lobbies:",q),o(!1)}};Y();const L=setInterval(Y,1e3);return()=>clearInterval(L)},[]);const M=T.useCallback(()=>{d||!r||(u(Y=>{const L=!Y;return y(L?r:null),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{L?ae.emit(new Cc(r)):ae.emit(new D4(r))},500),L}),f(!0),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{f(!1)},500))},[r,d]);T.useEffect(()=>{if(!r){_(0);return}const Y=A.current.get(r.gameID)??0,L=()=>{const W=Math.max(0,Math.floor((Y-Date.now())/1e3));_(W)};L();const q=setInterval(L,1e3);return()=>clearInterval(q)},[r]),T.useEffect(()=>()=>{w.current&&clearTimeout(w.current),S.current&&clearTimeout(S.current)},[]);const k=r?.gameConfig?.gameMap||Ee.Pangaea,E=HH(k),U=r?.numClients||0,I=r?.gameConfig?.maxPlayers||20,B=WH(r?.gameConfig,e),G=VH(r?.gameConfig,e),R=q4(b),P=()=>{const Y=t===yt.Light;return d?Y?"var(--gradient-light-gray-disabled)":"var(--gradient-gray-disabled)":c?Y?"var(--gradient-light-orange-selected)":"var(--gradient-orange-selected)":Y?"var(--gradient-light-teal-default)":"var(--gradient-teal-default)"},H=()=>t===yt.Light?"var(--text-card-title, #4a5568)":"var(--text-primary)";return g.jsxs("div",{onClick:M,className:`border-2 rounded-lg w-full h-[180px] relative overflow-hidden transition-all select-none ${d?"cursor-not-allowed opacity-60":"cursor-pointer"} ${c?"ring-2":""} ${n}`,style:{borderColor:c?"var(--border-orange)":"var(--border-primary)",backgroundColor:c?"var(--bg-orange)":"transparent",...c?{boxShadow:"var(--shadow-light-sunset, 0 20px 25px -5px var(--shadow-orange-400-60, var(--shadow-light-orange)), 0 10px 10px -5px var(--shadow-orange-400-60, var(--shadow-light-orange)))","--tw-ring-color":"var(--ring-orange-300-50, var(--ring-light-orange))"}:{},...!c&&!d?{boxShadow:"var(--shadow-card, var(--shadow-light-ocean, none))"}:{}},onMouseEnter:Y=>{!c&&!d&&(Y.currentTarget.style.borderColor="var(--border-hover)",Y.currentTarget.style.boxShadow="var(--shadow-card-hover, var(--shadow-card, var(--shadow-light-ocean, none)))")},onMouseLeave:Y=>{!c&&!d&&(Y.currentTarget.style.borderColor="var(--border-primary)",Y.currentTarget.style.boxShadow="var(--shadow-card, var(--shadow-light-ocean, none))")},children:[g.jsx("div",{className:"absolute inset-0",children:g.jsx("img",{src:`/maps/${E}/thumbnail.webp`,alt:"Map",className:"w-full h-full object-cover",style:{opacity:.8}})}),g.jsx("div",{className:"absolute inset-0 transition-all duration-300",style:{background:P()}}),g.jsxs("div",{className:"relative flex flex-col justify-start p-4 text-right h-full",children:[g.jsxs("div",{className:"flex flex-col gap-2",children:[g.jsx("h2",{className:"text-[28px] font-bold leading-tight",style:{color:H()},children:e(s?"lobby.card.loading":r?"lobby.card.join_next_game":"lobby.card.no_games_available")}),r&&g.jsxs("div",{className:"flex gap-2 items-center flex-wrap justify-end",children:[g.jsx("span",{className:"text-sm font-semibold rounded px-2.5 py-1 border transition-all",style:{color:H(),backgroundColor:"var(--bg-card)",borderColor:"var(--border-gray)",boxShadow:"var(--shadow-button, none)"},children:B}),g.jsx("span",{className:"text-sm font-semibold rounded px-2.5 py-1 border transition-all",style:{color:H(),backgroundColor:"var(--bg-card)",borderColor:"var(--border-gray)",boxShadow:"var(--shadow-button, none)"},children:G}),g.jsx("span",{className:"text-sm font-semibold",style:{color:H()},children:k})]})]}),r&&g.jsxs("div",{className:"flex flex-col gap-1 mt-auto pt-6",style:{color:H()},children:[g.jsxs("span",{className:"text-base font-semibold",children:[U," / ",I]}),g.jsx("span",{className:"text-base",children:R})]})]})]})}function ic({children:n,onClick:e,className:t="",variant:r="default",disabled:i=!1}){const c=`px-6 py-3 border-2 text-lg rounded-lg transition-colors font-bold cursor-pointer ${{default:"","full-width":"w-full",flex:"flex-1"}[r]} ${t}`.trim();return g.jsx("button",{className:c,onClick:e,disabled:i,style:{backgroundColor:"var(--bg-main)",borderColor:"var(--border-primary)",color:"var(--text-primary)",boxShadow:"var(--shadow-button, none)",transition:"all 0.2s ease"},onMouseEnter:u=>{i||(u.currentTarget.style.backgroundColor="var(--bg-hover)",u.currentTarget.style.boxShadow="var(--shadow-button-hover, var(--shadow-button, none))")},onMouseLeave:u=>{i||(u.currentTarget.style.backgroundColor="var(--bg-main)",u.currentTarget.style.boxShadow="var(--shadow-button, none)")},children:n})}function $H(){const{t:n}=xt();return g.jsxs("footer",{className:"absolute bottom-0 w-full px-4 py-4 flex justify-evenly items-center text-base transition-colors",style:{backgroundColor:"var(--bg-main)",color:"var(--text-secondary)",boxShadow:"var(--shadow-footer, none)"},children:[g.jsxs("div",{className:"flex gap-4",children:[g.jsx("a",{href:"https://frontwars.io/about.txt",className:"transition-colors",style:{color:"var(--text-secondary)"},onMouseEnter:e=>{e.currentTarget.style.color="var(--text-primary)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--text-secondary)"},children:n("footer.about")}),g.jsx("a",{href:"https://www.reddit.com/r/FrontWars/",className:"transition-colors",style:{color:"var(--text-secondary)"},onMouseEnter:e=>{e.currentTarget.style.color="var(--text-primary)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--text-secondary)"},children:n("footer.reddit")}),g.jsx("a",{href:"https://discord.gg/cuF4d6UMG3",className:"transition-colors",style:{color:"var(--text-secondary)"},onMouseEnter:e=>{e.currentTarget.style.color="var(--text-primary)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--text-secondary)"},children:n("footer.join_discord")})]}),g.jsxs("div",{className:"flex gap-4",children:[g.jsx("span",{children:n("footer.copyright")}),g.jsx("a",{href:"/privacy-policy.html",className:"transition-colors",style:{color:"var(--text-secondary)"},onMouseEnter:e=>{e.currentTarget.style.color="var(--text-primary)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--text-secondary)"},children:n("footer.privacy_policy")}),g.jsx("a",{href:"/terms-of-service.html",className:"transition-colors",style:{color:"var(--text-secondary)"},onMouseEnter:e=>{e.currentTarget.style.color="var(--text-primary)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--text-secondary)"},children:n("footer.terms_of_service")})]})]})}class Td{constructor(e,t){this.x=e,this.y=t}}class Z4{constructor(e,t){this.x=e,this.y=t}}class qH{constructor(e,t){this.x=e,this.y=t}}class id{constructor(e,t){this.x=e,this.y=t}}class Bo{constructor(e,t){this.x=e,this.y=t}}class No{constructor(e,t,r){this.x=e,this.y=t,this.delta=r}}class Ip{constructor(e,t){this.deltaX=e,this.deltaY=t}}class ZH{}class sd{constructor(e){this.alternateView=e}}class Lh{constructor(e,t){this.unit=e,this.isSelected=t}}class ad{}class m1{constructor(e){this.structureTypes=e}}class p1{constructor(e,t){this.x=e,this.y=t}}class Rp{constructor(e){this.target=e}}class W2{constructor(e,t){this.x=e,this.y=t}}class X4{}class K4{constructor(){}}class Q4{constructor(){}}class J4{constructor(e,t){this.x=e,this.y=t}}class eN{constructor(e){this.unit=e}}class tp{constructor(e,t){this.x=e,this.y=t}}class Y2{constructor(e){this.player=e}}class g1{constructor(e,t=null){this.player=e,this.tile=t}}function ns({label:n,description:e,checked:t,onChange:r,icon:i}){return g.jsx("div",{className:"bg-gray-800/80 rounded-lg p-4 border border-gray-700/50",children:g.jsxs("div",{className:"flex items-start justify-between gap-4",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i&&g.jsx("span",{className:"text-white text-lg shrink-0",children:i}),g.jsx("h3",{className:"text-white font-semibold text-base",children:n})]}),g.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:e})]}),g.jsx("button",{onClick:r,className:`relative w-14 h-7 rounded-full transition-colors duration-200 shrink-0 cursor-pointer ${t?"bg-green-500":"bg-red-500"}`,"aria-label":`Toggle ${n}`,children:g.jsx("span",{className:`absolute top-1 left-1 w-5 h-5 bg-white rounded-full transition-transform duration-200 ${t?"translate-x-7":"translate-x-0"}`})})]})})}function XH({label:n,description:e,value:t,min:r,max:i,onChange:s,icon:o}){return g.jsxs("div",{className:"bg-gray-800/80 rounded-lg p-4 border border-gray-700/50",children:[g.jsxs("div",{className:"mb-3",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o&&g.jsx("span",{className:"text-white text-lg shrink-0",children:o}),g.jsx("h3",{className:"text-white font-semibold text-base",children:n})]}),g.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:e})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("input",{type:"range",min:r,max:i,value:t,onChange:c=>s(Number(c.target.value)),className:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-teal-400",style:{background:`linear-gradient(to right, rgb(45 212 191) 0%, rgb(45 212 191) ${(t-r)/(i-r)*100}%, rgb(55 65 81) ${(t-r)/(i-r)*100}%, rgb(55 65 81) 100%)`}}),g.jsxs("span",{className:"text-white font-semibold text-base min-w-12 text-right shrink-0",children:[t,"%"]})]})]})}function Mn({title:n,description:e,keybind:t,isListening:r,errorMessage:i,onKeybindClick:s,onReset:o,onUnbind:c}){const{t:u}=xt(),d=t?LM(t):u("settings.unbound");return g.jsx("div",{className:`bg-gray-800/80 rounded-lg p-4 border ${r?"border-teal-400 border-2":i?"border-red-500 border-2":"border-gray-700/50"}`,children:g.jsxs("div",{className:"flex items-start justify-between gap-4",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("h3",{className:"text-white font-semibold text-base mb-1",children:n}),g.jsx("p",{className:"text-gray-400 text-sm leading-relaxed",children:e}),r&&!i&&g.jsx("p",{className:"text-teal-400 text-xs mt-2",children:u("settings.press_key_to_bind")}),i&&g.jsx("p",{className:"text-red-400 text-xs mt-2 font-medium",children:i})]}),g.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[g.jsx("button",{onClick:s,className:`rounded-lg px-4 py-2 text-white font-semibold text-sm transition-colors min-w-[80px] cursor-pointer ${r?"bg-teal-600 hover:bg-teal-500 animate-pulse":"bg-gray-900 hover:bg-gray-800"}`,children:d}),g.jsx("button",{onClick:o,className:"bg-gray-700 rounded-lg px-3 py-2 text-white text-sm hover:bg-gray-600 transition-colors cursor-pointer",children:u("settings.reset")}),g.jsx("button",{onClick:c,className:"bg-gray-700 rounded-lg px-3 py-2 text-white text-sm hover:bg-gray-600 transition-colors cursor-pointer",children:u("settings.unbind")})]})]})})}function $l({title:n,children:e}){return g.jsxs("div",{className:"mb-6",children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-3 text-center",children:n}),g.jsx("div",{className:"space-y-3",children:e})]})}function KH(){const{t:n}=xt(),[e,t]=T.useState(!1),r=()=>{try{localStorage.clear(),console.log("[SettingsModal] All settings cleared"),window.location.reload()}catch(i){console.error("[SettingsModal] Failed to clear settings:",i),alert("Failed to clear settings. Please try again."),t(!1)}};return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"bg-gray-800/80 rounded-lg p-4 border border-red-600/50",children:g.jsx("button",{onClick:()=>t(!0),className:"w-full px-4 py-2 text-sm rounded-lg border transition-colors font-semibold cursor-pointer bg-red-600/20 hover:bg-red-600/30 border-red-600/50 text-red-400 hover:text-red-300",children:n("settings.reset_all_settings","Reset all settings")})}),g.jsx(vr,{open:e,onClose:()=>t(!1),width:"500px",children:g.jsxs("div",{className:"flex flex-col gap-4",children:[g.jsx("h2",{className:"text-2xl font-bold text-red-500",children:n("settings.reset_all_settings","Reset all settings")}),g.jsx("div",{className:"text-gray-300",children:g.jsx("p",{className:"text-yellow-400 text-sm font-semibold mb-2",children:n("settings.reset_all_confirm","Are you sure? This will reset ALL settings including preferences, keybinds, and game settings. The page will reload.")})}),g.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-700",children:[g.jsx("button",{onClick:r,className:"px-4 py-2 text-sm rounded-lg border transition-colors font-semibold cursor-pointer bg-red-600 hover:bg-red-700 border-red-700 text-white flex-1",children:n("settings.reset_all_confirm_button","Yes, Reset Everything")}),g.jsx("button",{onClick:()=>t(!1),className:"px-4 py-2 text-sm rounded-lg border transition-colors font-semibold cursor-pointer bg-gray-700 hover:bg-gray-600 border-gray-600 text-white flex-1",children:n("common.cancel","Cancel")})]})]})})]})}function tN({open:n,onClose:e}){const{t}=xt(),[r,i]=T.useState("basic"),s={toggleView:t("settings.keybind_titles.toggle_view"),buildCity:t("settings.keybind_titles.build_city"),buildFactory:t("settings.keybind_titles.build_factory"),buildPort:t("settings.keybind_titles.build_port"),buildDefensePost:t("settings.keybind_titles.build_defense_post"),buildMissileSilo:t("settings.keybind_titles.build_missile_silo"),buildSAMLauncher:t("settings.keybind_titles.build_sam_launcher"),buildWarship:t("settings.keybind_titles.build_warship"),buildAtomBomb:t("settings.keybind_titles.build_atom_bomb"),buildHydrogenBomb:t("settings.keybind_titles.build_hydrogen_bomb"),buildMIRV:t("settings.keybind_titles.build_mirv"),attackRatioDecrease:t("settings.keybind_titles.decrease_attack_ratio"),attackRatioIncrease:t("settings.keybind_titles.increase_attack_ratio"),boatAttack:t("settings.keybind_titles.boat_attack"),groundAttack:t("settings.keybind_titles.ground_attack"),zoomOut:t("settings.keybind_titles.zoom_out"),zoomIn:t("settings.keybind_titles.zoom_in"),centerCamera:t("settings.keybind_titles.center_camera"),moveUp:t("settings.keybind_titles.move_up"),moveLeft:t("settings.keybind_titles.move_left"),moveDown:t("settings.keybind_titles.move_down"),moveRight:t("settings.keybind_titles.move_right"),modifierKey:t("settings.keybind_titles.modifier_key"),altKey:t("settings.keybind_titles.alt_key")},[o,c]=T.useState(()=>{const ee=jo.getKeybinds();return{...Ph,...ee}}),[u,d]=T.useState(null),[f,p]=T.useState(null);T.useEffect(()=>{if(n){const ee=jo.getKeybinds();c({...Ph,...ee})}},[n]);const{theme:y,toggleTheme:b}=Dc(),[_,w]=T.useState(Re.emojis()),[S,A]=T.useState(Re.alertFrame()),[M,k]=T.useState(Re.fxLayer()),[E,U]=T.useState(Re.structureSprites()),[I,B]=T.useState(Re.leftClickOpensMenu()),[G,R]=T.useState(Re.anonymousNames()),[P,H]=T.useState(!Re.lobbyIdVisibility()),[Y,L]=T.useState(Re.territoryPatterns()),[q,W]=T.useState(Re.performanceOverlay()),[N,V]=T.useState(Re.attackRatio()*100),J=(ee,pe,Se)=>{pe(!ee),Se()},se=ee=>{V(ee),Re.setAttackRatio(ee/100)},O=T.useCallback((ee,pe)=>{c(Se=>{const ie={...Se,[ee]:pe};return jo.setKeybinds(ie),ie})},[]),F=T.useCallback(ee=>{d(ee),p(null)},[]),X=T.useCallback(ee=>{const pe=Ph[ee];pe&&O(ee,pe)},[O]),D=T.useCallback(ee=>{O(ee,"")},[O]);return T.useEffect(()=>{if(!u)return;const ee=pe=>{pe.preventDefault(),pe.stopPropagation();const Se=pe.code;if(Se==="Escape"){d(null);return}const ie=Object.entries(o).find(([ve,Ce])=>ve!==u&&Ce===Se&&Ce!=="")?.[0];if(ie){const ve=s[ie]||ie;p(t("settings.key_already_bound",{action:ve}));return}O(u,Se),d(null),p(null)};return window.addEventListener("keydown",ee),()=>{window.removeEventListener("keydown",ee)}},[u,o,O]),T.useEffect(()=>{n||(d(null),p(null))},[n]),g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col h-full",children:[g.jsx("div",{className:"flex items-center justify-center mb-4 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:t("settings.title")})}),g.jsxs("div",{className:"flex justify-center gap-2 mb-6 border-b border-gray-700 shrink-0",children:[g.jsx("button",{onClick:()=>i("basic"),className:`px-4 py-2 font-semibold transition-colors -mb-px cursor-pointer ${r==="basic"?"text-teal-400 border-b-2 border-teal-400":"text-gray-400 hover:text-gray-300"}`,children:t("settings.basic")}),g.jsx("button",{onClick:()=>i("keybinds"),className:`px-4 py-2 font-semibold transition-colors -mb-px cursor-pointer ${r==="keybinds"?"text-teal-400 border-b-2 border-teal-400":"text-gray-400 hover:text-gray-300"}`,children:t("settings.keybinds")})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-200px)] pr-4",children:[r==="basic"&&g.jsxs("div",{className:"space-y-3",children:[g.jsx(ns,{label:t("settings.dark_mode"),description:t("settings.dark_mode_desc"),checked:y===yt.Dark,onChange:b}),g.jsx(ns,{label:t("settings.emojis"),description:t("settings.emojis_desc"),checked:_,onChange:()=>J(_,w,()=>Re.toggleEmojis())}),g.jsx(ns,{label:t("settings.alert_frame"),description:t("settings.alert_frame_desc"),checked:S,onChange:()=>J(S,A,()=>Re.toggleAlertFrame())}),g.jsx(ns,{label:t("settings.special_effects"),description:t("settings.special_effects_desc"),checked:M,onChange:()=>J(M,k,()=>Re.toggleFxLayer())}),g.jsx(ns,{label:t("settings.structure_sprites"),description:t("settings.structure_sprites_desc"),checked:E,onChange:()=>J(E,U,()=>Re.toggleStructureSprites())}),g.jsx(ns,{label:t("settings.left_click_to_open_menu"),description:t("settings.left_click_to_open_menu_desc"),checked:I,onChange:()=>J(I,B,()=>Re.toggleLeftClickOpenMenu())}),g.jsx(ns,{label:t("settings.hidden_names"),description:t("settings.hidden_names_desc"),checked:G,onChange:()=>J(G,R,()=>Re.toggleRandomName())}),g.jsx(ns,{label:t("settings.hidden_lobby_ids"),description:t("settings.hidden_lobby_ids_desc"),checked:P,onChange:()=>{Re.toggleLobbyIdVisibility(),H(!Re.lobbyIdVisibility())}}),g.jsx(ns,{label:t("settings.territory_patterns"),description:t("settings.territory_patterns_desc"),checked:Y,icon:"",onChange:()=>J(Y,L,()=>Re.toggleTerritoryPatterns())}),g.jsx(ns,{label:t("settings.performance_overlay"),description:t("settings.performance_overlay_desc"),checked:q,onChange:()=>J(q,W,()=>ae.emit(new ad))}),g.jsx(XH,{label:t("settings.attack_ratio"),description:t("settings.attack_ratio_desc"),value:N,min:1,max:100,onChange:se,icon:""}),g.jsx(KH,{})]}),r==="keybinds"&&g.jsxs("div",{className:"space-y-6",children:[g.jsx($l,{title:t("settings.keybind_sections.view_options"),children:g.jsx(Mn,{title:s.toggleView,description:t("settings.keybind_descriptions.toggle_view"),keybind:o.toggleView||"",isListening:u==="toggleView",errorMessage:u==="toggleView"?f:null,onKeybindClick:()=>F("toggleView"),onReset:()=>X("toggleView"),onUnbind:()=>D("toggleView")})}),g.jsxs($l,{title:t("settings.keybind_sections.build_controls"),children:[g.jsx(Mn,{title:s.buildCity,description:t("settings.keybind_descriptions.build_city"),keybind:o.buildCity||"",isListening:u==="buildCity",errorMessage:u==="buildCity"?f:null,onKeybindClick:()=>F("buildCity"),onReset:()=>X("buildCity"),onUnbind:()=>D("buildCity")}),g.jsx(Mn,{title:s.buildFactory,description:t("settings.keybind_descriptions.build_factory"),keybind:o.buildFactory||"",isListening:u==="buildFactory",errorMessage:u==="buildFactory"?f:null,onKeybindClick:()=>F("buildFactory"),onReset:()=>X("buildFactory"),onUnbind:()=>D("buildFactory")}),g.jsx(Mn,{title:s.buildPort,description:t("settings.keybind_descriptions.build_port"),keybind:o.buildPort||"",isListening:u==="buildPort",errorMessage:u==="buildPort"?f:null,onKeybindClick:()=>F("buildPort"),onReset:()=>X("buildPort"),onUnbind:()=>D("buildPort")}),g.jsx(Mn,{title:s.buildDefensePost,description:t("settings.keybind_descriptions.build_defense_post"),keybind:o.buildDefensePost||"",isListening:u==="buildDefensePost",errorMessage:u==="buildDefensePost"?f:null,onKeybindClick:()=>F("buildDefensePost"),onReset:()=>X("buildDefensePost"),onUnbind:()=>D("buildDefensePost")}),g.jsx(Mn,{title:s.buildMissileSilo,description:t("settings.keybind_descriptions.build_missile_silo"),keybind:o.buildMissileSilo||"",isListening:u==="buildMissileSilo",errorMessage:u==="buildMissileSilo"?f:null,onKeybindClick:()=>F("buildMissileSilo"),onReset:()=>X("buildMissileSilo"),onUnbind:()=>D("buildMissileSilo")}),g.jsx(Mn,{title:s.buildSAMLauncher,description:t("settings.keybind_descriptions.build_sam_launcher"),keybind:o.buildSAMLauncher||"",isListening:u==="buildSAMLauncher",errorMessage:u==="buildSAMLauncher"?f:null,onKeybindClick:()=>F("buildSAMLauncher"),onReset:()=>X("buildSAMLauncher"),onUnbind:()=>D("buildSAMLauncher")}),g.jsx(Mn,{title:s.buildWarship,description:t("settings.keybind_descriptions.build_warship"),keybind:o.buildWarship||"",isListening:u==="buildWarship",errorMessage:u==="buildWarship"?f:null,onKeybindClick:()=>F("buildWarship"),onReset:()=>X("buildWarship"),onUnbind:()=>D("buildWarship")}),g.jsx(Mn,{title:s.buildAtomBomb,description:t("settings.keybind_descriptions.build_atom_bomb"),keybind:o.buildAtomBomb||"",isListening:u==="buildAtomBomb",errorMessage:u==="buildAtomBomb"?f:null,onKeybindClick:()=>F("buildAtomBomb"),onReset:()=>X("buildAtomBomb"),onUnbind:()=>D("buildAtomBomb")}),g.jsx(Mn,{title:s.buildHydrogenBomb,description:t("settings.keybind_descriptions.build_hydrogen_bomb"),keybind:o.buildHydrogenBomb||"",isListening:u==="buildHydrogenBomb",errorMessage:u==="buildHydrogenBomb"?f:null,onKeybindClick:()=>F("buildHydrogenBomb"),onReset:()=>X("buildHydrogenBomb"),onUnbind:()=>D("buildHydrogenBomb")}),g.jsx(Mn,{title:s.buildMIRV,description:t("settings.keybind_descriptions.build_mirv"),keybind:o.buildMIRV||"",isListening:u==="buildMIRV",errorMessage:u==="buildMIRV"?f:null,onKeybindClick:()=>F("buildMIRV"),onReset:()=>X("buildMIRV"),onUnbind:()=>D("buildMIRV")})]}),g.jsxs($l,{title:t("settings.keybind_sections.attack_ratio_controls"),children:[g.jsx(Mn,{title:s.attackRatioDecrease,description:t("settings.keybind_descriptions.decrease_attack_ratio"),keybind:o.attackRatioDecrease||"",isListening:u==="attackRatioDecrease",errorMessage:u==="attackRatioDecrease"?f:null,onKeybindClick:()=>F("attackRatioDecrease"),onReset:()=>X("attackRatioDecrease"),onUnbind:()=>D("attackRatioDecrease")}),g.jsx(Mn,{title:s.attackRatioIncrease,description:t("settings.keybind_descriptions.increase_attack_ratio"),keybind:o.attackRatioIncrease||"",isListening:u==="attackRatioIncrease",errorMessage:u==="attackRatioIncrease"?f:null,onKeybindClick:()=>F("attackRatioIncrease"),onReset:()=>X("attackRatioIncrease"),onUnbind:()=>D("attackRatioIncrease")})]}),g.jsxs($l,{title:t("settings.keybind_sections.attack_keybinds"),children:[g.jsx(Mn,{title:s.boatAttack,description:t("settings.keybind_descriptions.boat_attack"),keybind:o.boatAttack||"",isListening:u==="boatAttack",errorMessage:u==="boatAttack"?f:null,onKeybindClick:()=>F("boatAttack"),onReset:()=>X("boatAttack"),onUnbind:()=>D("boatAttack")}),g.jsx(Mn,{title:s.groundAttack,description:t("settings.keybind_descriptions.ground_attack"),keybind:o.groundAttack||"",isListening:u==="groundAttack",errorMessage:u==="groundAttack"?f:null,onKeybindClick:()=>F("groundAttack"),onReset:()=>X("groundAttack"),onUnbind:()=>D("groundAttack")})]}),g.jsxs($l,{title:t("settings.keybind_sections.zoom_controls"),children:[g.jsx(Mn,{title:s.zoomOut,description:t("settings.keybind_descriptions.zoom_out"),keybind:o.zoomOut||"",isListening:u==="zoomOut",errorMessage:u==="zoomOut"?f:null,onKeybindClick:()=>F("zoomOut"),onReset:()=>X("zoomOut"),onUnbind:()=>D("zoomOut")}),g.jsx(Mn,{title:s.zoomIn,description:t("settings.keybind_descriptions.zoom_in"),keybind:o.zoomIn||"",isListening:u==="zoomIn",errorMessage:u==="zoomIn"?f:null,onKeybindClick:()=>F("zoomIn"),onReset:()=>X("zoomIn"),onUnbind:()=>D("zoomIn")})]}),g.jsxs($l,{title:t("settings.keybind_sections.camera_movement"),children:[g.jsx(Mn,{title:s.centerCamera,description:t("settings.keybind_descriptions.center_camera"),keybind:o.centerCamera||"",isListening:u==="centerCamera",errorMessage:u==="centerCamera"?f:null,onKeybindClick:()=>F("centerCamera"),onReset:()=>X("centerCamera"),onUnbind:()=>D("centerCamera")}),g.jsx(Mn,{title:s.moveUp,description:t("settings.keybind_descriptions.move_up"),keybind:o.moveUp||"",isListening:u==="moveUp",errorMessage:u==="moveUp"?f:null,onKeybindClick:()=>F("moveUp"),onReset:()=>X("moveUp"),onUnbind:()=>D("moveUp")}),g.jsx(Mn,{title:s.moveLeft,description:t("settings.keybind_descriptions.move_left"),keybind:o.moveLeft||"",isListening:u==="moveLeft",errorMessage:u==="moveLeft"?f:null,onKeybindClick:()=>F("moveLeft"),onReset:()=>X("moveLeft"),onUnbind:()=>D("moveLeft")}),g.jsx(Mn,{title:s.moveDown,description:t("settings.keybind_descriptions.move_down"),keybind:o.moveDown||"",isListening:u==="moveDown",errorMessage:u==="moveDown"?f:null,onKeybindClick:()=>F("moveDown"),onReset:()=>X("moveDown"),onUnbind:()=>D("moveDown")}),g.jsx(Mn,{title:s.moveRight,description:t("settings.keybind_descriptions.move_right"),keybind:o.moveRight||"",isListening:u==="moveRight",errorMessage:u==="moveRight"?f:null,onKeybindClick:()=>F("moveRight"),onReset:()=>X("moveRight"),onUnbind:()=>D("moveRight")})]})]})]})]})})}function QH(){const[n,e]=T.useState(!1),{theme:t,toggleTheme:r}=Dc();return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"absolute top-6 right-6 z-10",children:g.jsx("button",{onClick:()=>r(),className:"w-14 h-14 flex items-center justify-center transition-all cursor-pointer","aria-label":t===yt.Dark?"Switch to light theme":"Switch to dark theme",style:{color:t===yt.Dark?"var(--icon-primary)":"var(--icon-hover)",backgroundColor:"transparent",border:"none",outline:"none"},onMouseEnter:i=>{i.currentTarget.style.color=t===yt.Dark?"var(--icon-hover)":"var(--icon-primary)"},onMouseLeave:i=>{i.currentTarget.style.color=t===yt.Dark?"var(--icon-primary)":"var(--icon-hover)";const s=i.currentTarget.querySelector("svg");s&&(s.style.filter="var(--icon-drop-shadow, none)")},children:t===yt.Dark?g.jsx("svg",{className:"w-14 h-14 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{filter:"var(--icon-drop-shadow, none)"},children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):g.jsx("svg",{className:"w-14 h-14 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{filter:"var(--icon-drop-shadow, none)"},children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})})}),g.jsx("div",{className:"absolute bottom-6 right-6 z-10",children:g.jsx("button",{onClick:()=>e(!0),className:"w-20 h-20 flex items-center justify-center transition-all cursor-pointer","aria-label":"Open settings",style:{color:t===yt.Dark?"var(--icon-primary)":"var(--icon-hover)",backgroundColor:"transparent",border:"none",outline:"none"},onMouseEnter:i=>{i.currentTarget.style.color=t===yt.Dark?"var(--icon-hover)":"var(--icon-primary)"},onMouseLeave:i=>{i.currentTarget.style.color=t===yt.Dark?"var(--icon-primary)":"var(--icon-hover)",i.currentTarget.querySelector("svg")},children:g.jsxs("svg",{className:"w-20 h-20 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{filter:"var(--icon-drop-shadow, none)"},children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),g.jsx(tN,{open:n,onClose:()=>e(!1)})]})}var Oo=(n=>(n[n.Dev=0]="Dev",n[n.Preprod=1]="Preprod",n[n.Prod=2]="Prod",n))(Oo||{}),JH={grad:.9,turn:360,rad:360/(2*Math.PI)},Us=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},sr=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},ji=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},nN=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},lk=function(n){return{r:ji(n.r,0,255),g:ji(n.g,0,255),b:ji(n.b,0,255),a:ji(n.a)}},db=function(n){return{r:sr(n.r),g:sr(n.g),b:sr(n.b),a:sr(n.a,3)}},eV=/^#([0-9a-f]{3,8})$/i,bm=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},rN=function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=Math.max(e,t,r),o=s-Math.min(e,t,r),c=o?s===e?(t-r)/o:s===t?2+(r-e)/o:4+(e-t)/o:0;return{h:60*(c<0?c+6:c),s:s?o/s*100:0,v:s/255*100,a:i}},iN=function(n){var e=n.h,t=n.s,r=n.v,i=n.a;e=e/360*6,t/=100,r/=100;var s=Math.floor(e),o=r*(1-t),c=r*(1-(e-s)*t),u=r*(1-(1-e+s)*t),d=s%6;return{r:255*[r,c,o,o,u,r][d],g:255*[u,r,r,c,o,o][d],b:255*[o,o,u,r,r,c][d],a:i}},ck=function(n){return{h:nN(n.h),s:ji(n.s,0,100),l:ji(n.l,0,100),a:ji(n.a)}},uk=function(n){return{h:sr(n.h),s:sr(n.s),l:sr(n.l),a:sr(n.a,3)}},hk=function(n){return iN((t=(e=n).s,{h:e.h,s:(t*=((r=e.l)<50?r:100-r)/100)>0?2*t/(r+t)*100:0,v:r+t,a:e.a}));var e,t,r},zh=function(n){return{h:(e=rN(n)).h,s:(i=(200-(t=e.s))*(r=e.v)/100)>0&&i<200?t*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,t,r,i},tV=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,nV=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rV=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,iV=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y1={string:[[function(n){var e=eV.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?sr(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?sr(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=rV.exec(n)||iV.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:lk({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=tV.exec(n)||nV.exec(n);if(!e)return null;var t,r,i=ck({h:(t=e[1],r=e[2],r===void 0&&(r="deg"),Number(t)*(JH[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return hk(i)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=i===void 0?1:i;return Us(e)&&Us(t)&&Us(r)?lk({r:Number(e),g:Number(t),b:Number(r),a:Number(s)}):null},"rgb"],[function(n){var e=n.h,t=n.s,r=n.l,i=n.a,s=i===void 0?1:i;if(!Us(e)||!Us(t)||!Us(r))return null;var o=ck({h:Number(e),s:Number(t),l:Number(r),a:Number(s)});return hk(o)},"hsl"],[function(n){var e=n.h,t=n.s,r=n.v,i=n.a,s=i===void 0?1:i;if(!Us(e)||!Us(t)||!Us(r))return null;var o=(function(c){return{h:nN(c.h),s:ji(c.s,0,100),v:ji(c.v,0,100),a:ji(c.a)}})({h:Number(e),s:Number(t),v:Number(r),a:Number(s)});return iN(o)},"hsv"]]},dk=function(n,e){for(var t=0;t<e.length;t++){var r=e[t][0](n);if(r)return[r,e[t][1]]}return[null,void 0]},sV=function(n){return typeof n=="string"?dk(n.trim(),y1.string):typeof n=="object"&&n!==null?dk(n,y1.object):[null,void 0]},fb=function(n,e){var t=zh(n);return{h:t.h,s:ji(t.s+100*e,0,100),l:t.l,a:t.a}},mb=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},fk=function(n,e){var t=zh(n);return{h:t.h,s:t.s,l:ji(t.l+100*e,0,100),a:t.a}},od=(function(){function n(e){this.parsed=sV(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return sr(mb(this.rgba),2)},n.prototype.isDark=function(){return mb(this.rgba)<.5},n.prototype.isLight=function(){return mb(this.rgba)>=.5},n.prototype.toHex=function(){return e=db(this.rgba),t=e.r,r=e.g,i=e.b,o=(s=e.a)<1?bm(sr(255*s)):"","#"+bm(t)+bm(r)+bm(i)+o;var e,t,r,i,s,o},n.prototype.toRgb=function(){return db(this.rgba)},n.prototype.toRgbString=function(){return e=db(this.rgba),t=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+t+", "+r+", "+i+", "+s+")":"rgb("+t+", "+r+", "+i+")";var e,t,r,i,s},n.prototype.toHsl=function(){return uk(zh(this.rgba))},n.prototype.toHslString=function(){return e=uk(zh(this.rgba)),t=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+t+", "+r+"%, "+i+"%, "+s+")":"hsl("+t+", "+r+"%, "+i+"%)";var e,t,r,i,s},n.prototype.toHsv=function(){return e=rN(this.rgba),{h:sr(e.h),s:sr(e.s),v:sr(e.v),a:sr(e.a,3)};var e},n.prototype.invert=function(){return j({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),j(fb(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),j(fb(this.rgba,-e))},n.prototype.grayscale=function(){return j(fb(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),j(fk(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),j(fk(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?j({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):sr(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=zh(this.rgba);return typeof e=="number"?j({h:e,s:t.s,l:t.l,a:t.a}):sr(t.h)},n.prototype.isEqual=function(e){return this.toHex()===j(e).toHex()},n})(),j=function(n){return n instanceof od?n:new od(n)},mk=[],Ed=function(n){n.forEach(function(e){mk.indexOf(e)<0&&(e(od,y1),mk.push(e))})},np={exports:{}},aV=np.exports,pk;function oV(){return pk||(pk=1,(function(n){(function(e,t,r){function i(u){var d=this,f=c();d.next=function(){var p=2091639*d.s0+d.c*23283064365386963e-26;return d.s0=d.s1,d.s1=d.s2,d.s2=p-(d.c=p|0)},d.c=1,d.s0=f(" "),d.s1=f(" "),d.s2=f(" "),d.s0-=f(u),d.s0<0&&(d.s0+=1),d.s1-=f(u),d.s1<0&&(d.s1+=1),d.s2-=f(u),d.s2<0&&(d.s2+=1),f=null}function s(u,d){return d.c=u.c,d.s0=u.s0,d.s1=u.s1,d.s2=u.s2,d}function o(u,d){var f=new i(u),p=d&&d.state,y=f.next;return y.int32=function(){return f.next()*4294967296|0},y.double=function(){return y()+(y()*2097152|0)*11102230246251565e-32},y.quick=y,p&&(typeof p=="object"&&s(p,f),y.state=function(){return s(f,{})}),y}function c(){var u=4022871197,d=function(f){f=String(f);for(var p=0;p<f.length;p++){u+=f.charCodeAt(p);var y=.02519603282416938*u;u=y>>>0,y-=u,y*=u,u=y>>>0,y-=u,u+=y*4294967296}return(u>>>0)*23283064365386963e-26};return d}t&&t.exports?t.exports=o:this.alea=o})(aV,n)})(np)),np.exports}var rp={exports:{}},lV=rp.exports,gk;function cV(){return gk||(gk=1,(function(n){(function(e,t,r){function i(c){var u=this,d="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var p=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^p^p>>>8},c===(c|0)?u.x=c:d+=c;for(var f=0;f<d.length+64;f++)u.x^=d.charCodeAt(f)|0,u.next()}function s(c,u){return u.x=c.x,u.y=c.y,u.z=c.z,u.w=c.w,u}function o(c,u){var d=new i(c),f=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var y=d.next()>>>11,b=(d.next()>>>0)/4294967296,_=(y+b)/(1<<21);while(_===0);return _},p.int32=d.next,p.quick=p,f&&(typeof f=="object"&&s(f,d),p.state=function(){return s(d,{})}),p}t&&t.exports?t.exports=o:this.xor128=o})(lV,n)})(rp)),rp.exports}var ip={exports:{}},uV=ip.exports,yk;function hV(){return yk||(yk=1,(function(n){(function(e,t,r){function i(c){var u=this,d="";u.next=function(){var p=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(p^p<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,c===(c|0)?u.x=c:d+=c;for(var f=0;f<d.length+64;f++)u.x^=d.charCodeAt(f)|0,f==d.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function s(c,u){return u.x=c.x,u.y=c.y,u.z=c.z,u.w=c.w,u.v=c.v,u.d=c.d,u}function o(c,u){var d=new i(c),f=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var y=d.next()>>>11,b=(d.next()>>>0)/4294967296,_=(y+b)/(1<<21);while(_===0);return _},p.int32=d.next,p.quick=p,f&&(typeof f=="object"&&s(f,d),p.state=function(){return s(d,{})}),p}t&&t.exports?t.exports=o:this.xorwow=o})(uV,n)})(ip)),ip.exports}var sp={exports:{}},dV=sp.exports,bk;function fV(){return bk||(bk=1,(function(n){(function(e,t,r){function i(c){var u=this;u.next=function(){var f=u.x,p=u.i,y,b;return y=f[p],y^=y>>>7,b=y^y<<24,y=f[p+1&7],b^=y^y>>>10,y=f[p+3&7],b^=y^y>>>3,y=f[p+4&7],b^=y^y<<7,y=f[p+7&7],y=y^y<<13,b^=y^y<<9,f[p]=b,u.i=p+1&7,b};function d(f,p){var y,b=[];if(p===(p|0))b[0]=p;else for(p=""+p,y=0;y<p.length;++y)b[y&7]=b[y&7]<<15^p.charCodeAt(y)+b[y+1&7]<<13;for(;b.length<8;)b.push(0);for(y=0;y<8&&b[y]===0;++y);for(y==8?b[7]=-1:b[y],f.x=b,f.i=0,y=256;y>0;--y)f.next()}d(u,c)}function s(c,u){return u.x=c.x.slice(),u.i=c.i,u}function o(c,u){c==null&&(c=+new Date);var d=new i(c),f=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var y=d.next()>>>11,b=(d.next()>>>0)/4294967296,_=(y+b)/(1<<21);while(_===0);return _},p.int32=d.next,p.quick=p,f&&(f.x&&s(f,d),p.state=function(){return s(d,{})}),p}t&&t.exports?t.exports=o:this.xorshift7=o})(dV,n)})(sp)),sp.exports}var ap={exports:{}},mV=ap.exports,xk;function pV(){return xk||(xk=1,(function(n){(function(e,t,r){function i(c){var u=this;u.next=function(){var f=u.w,p=u.X,y=u.i,b,_;return u.w=f=f+1640531527|0,_=p[y+34&127],b=p[y=y+1&127],_^=_<<13,b^=b<<17,_^=_>>>15,b^=b>>>12,_=p[y]=_^b,u.i=y,_+(f^f>>>16)|0};function d(f,p){var y,b,_,w,S,A=[],M=128;for(p===(p|0)?(b=p,p=null):(p=p+"\0",b=0,M=Math.max(M,p.length)),_=0,w=-32;w<M;++w)p&&(b^=p.charCodeAt((w+32)%p.length)),w===0&&(S=b),b^=b<<10,b^=b>>>15,b^=b<<4,b^=b>>>13,w>=0&&(S=S+1640531527|0,y=A[w&127]^=b+S,_=y==0?_+1:0);for(_>=128&&(A[(p&&p.length||0)&127]=-1),_=127,w=512;w>0;--w)b=A[_+34&127],y=A[_=_+1&127],b^=b<<13,y^=y<<17,b^=b>>>15,y^=y>>>12,A[_]=b^y;f.w=S,f.X=A,f.i=_}d(u,c)}function s(c,u){return u.i=c.i,u.w=c.w,u.X=c.X.slice(),u}function o(c,u){c==null&&(c=+new Date);var d=new i(c),f=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var y=d.next()>>>11,b=(d.next()>>>0)/4294967296,_=(y+b)/(1<<21);while(_===0);return _},p.int32=d.next,p.quick=p,f&&(f.X&&s(f,d),p.state=function(){return s(d,{})}),p}t&&t.exports?t.exports=o:this.xor4096=o})(mV,n)})(ap)),ap.exports}var op={exports:{}},gV=op.exports,vk;function yV(){return vk||(vk=1,(function(n){(function(e,t,r){function i(c){var u=this,d="";u.next=function(){var p=u.b,y=u.c,b=u.d,_=u.a;return p=p<<25^p>>>7^y,y=y-b|0,b=b<<24^b>>>8^_,_=_-p|0,u.b=p=p<<20^p>>>12^y,u.c=y=y-b|0,u.d=b<<16^y>>>16^_,u.a=_-p|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,c===Math.floor(c)?(u.a=c/4294967296|0,u.b=c|0):d+=c;for(var f=0;f<d.length+20;f++)u.b^=d.charCodeAt(f)|0,u.next()}function s(c,u){return u.a=c.a,u.b=c.b,u.c=c.c,u.d=c.d,u}function o(c,u){var d=new i(c),f=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var y=d.next()>>>11,b=(d.next()>>>0)/4294967296,_=(y+b)/(1<<21);while(_===0);return _},p.int32=d.next,p.quick=p,f&&(typeof f=="object"&&s(f,d),p.state=function(){return s(d,{})}),p}t&&t.exports?t.exports=o:this.tychei=o})(gV,n)})(op)),op.exports}var lp={exports:{}};const bV={},xV=Object.freeze(Object.defineProperty({__proto__:null,default:bV},Symbol.toStringTag,{value:"Module"})),vV=sj(xV);var _V=lp.exports,_k;function wV(){return _k||(_k=1,(function(n){(function(e,t,r){var i=256,s=6,o=52,c="random",u=r.pow(i,s),d=r.pow(2,o),f=d*2,p=i-1,y;function b(E,U,I){var B=[];U=U==!0?{entropy:!0}:U||{};var G=A(S(U.entropy?[E,k(t)]:E??M(),3),B),R=new _(B),P=function(){for(var H=R.g(s),Y=u,L=0;H<d;)H=(H+L)*i,Y*=i,L=R.g(1);for(;H>=f;)H/=2,Y/=2,L>>>=1;return(H+L)/Y};return P.int32=function(){return R.g(4)|0},P.quick=function(){return R.g(4)/4294967296},P.double=P,A(k(R.S),t),(U.pass||I||function(H,Y,L,q){return q&&(q.S&&w(q,R),H.state=function(){return w(R,{})}),L?(r[c]=H,Y):H})(P,G,"global"in U?U.global:this==r,U.state)}function _(E){var U,I=E.length,B=this,G=0,R=B.i=B.j=0,P=B.S=[];for(I||(E=[I++]);G<i;)P[G]=G++;for(G=0;G<i;G++)P[G]=P[R=p&R+E[G%I]+(U=P[G])],P[R]=U;(B.g=function(H){for(var Y,L=0,q=B.i,W=B.j,N=B.S;H--;)Y=N[q=p&q+1],L=L*i+N[p&(N[q]=N[W=p&W+Y])+(N[W]=Y)];return B.i=q,B.j=W,L})(i)}function w(E,U){return U.i=E.i,U.j=E.j,U.S=E.S.slice(),U}function S(E,U){var I=[],B=typeof E,G;if(U&&B=="object")for(G in E)try{I.push(S(E[G],U-1))}catch{}return I.length?I:B=="string"?E:E+"\0"}function A(E,U){for(var I=E+"",B,G=0;G<I.length;)U[p&G]=p&(B^=U[p&G]*19)+I.charCodeAt(G++);return k(U)}function M(){try{var E;return y&&(E=y.randomBytes)?E=E(i):(E=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(E)),k(E)}catch{var U=e.navigator,I=U&&U.plugins;return[+new Date,e,I,e.screen,k(t)]}}function k(E){return String.fromCharCode.apply(0,E)}if(A(r.random(),t),n.exports){n.exports=b;try{y=vV}catch{}}else r["seed"+c]=b})(typeof self<"u"?self:_V,[],Math)})(lp)),lp.exports}var pb,wk;function SV(){if(wk)return pb;wk=1;var n=oV(),e=cV(),t=hV(),r=fV(),i=pV(),s=yV(),o=wV();return o.alea=n,o.xor128=e,o.xorwow=t,o.xorshift7=r,o.xor4096=i,o.tychei=s,pb=o,pb}var AV=SV();const CV=Zo(AV),Xp=class Xp{constructor(e){this.rng=CV(String(e))}next(){return this.rng()}nextInt(e,t){return Math.floor(this.rng()*(t-e))+e}nextFloat(e,t){return this.rng()*(t-e)+e}nextID(){return Math.floor(this.rng()*Xp.POW36_8).toString(36).padStart(8,"0")}randElement(e){if(e.length===0)throw new Error("array must not be empty");return e[this.nextInt(0,e.length)]}randFromSet(e){const t=e.size;if(t===0)throw new Error("set must not be empty");const r=this.nextInt(0,t);let i=0;for(const s of e){if(i===r)return s;i++}throw new Error("Unexpected error selecting element from set")}chance(e){return Math.floor(this.rng()*e)===0}shuffleArray(e){const t=[...e];for(let r=t.length-1;r>0;r--){const i=this.nextInt(0,r+1);[t[r],t[i]]=[t[i],t[r]]}return t}};Xp.POW36_8=Math.pow(36,8);let ld=Xp;var gb=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},ch=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},qi=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},yb=function(n){var e=n/255;return e<.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},bb=function(n){return 255*(n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n)},$2=96.422,q2=100,Z2=82.521,kV=function(n){var e,t,r={x:.9555766*(e=n).x+-.0230393*e.y+.0631636*e.z,y:-.0282895*e.x+1.0099416*e.y+.0210077*e.z,z:.0122982*e.x+-.020483*e.y+1.3299098*e.z};return t={r:bb(.032404542*r.x-.015371385*r.y-.004985314*r.z),g:bb(-.00969266*r.x+.018760108*r.y+41556e-8*r.z),b:bb(556434e-9*r.x-.002040259*r.y+.010572252*r.z),a:n.a},{r:qi(t.r,0,255),g:qi(t.g,0,255),b:qi(t.b,0,255),a:qi(t.a)}},TV=function(n){var e=yb(n.r),t=yb(n.g),r=yb(n.b);return(function(i){return{x:qi(i.x,0,$2),y:qi(i.y,0,q2),z:qi(i.z,0,Z2),a:qi(i.a)}})((function(i){return{x:1.0478112*i.x+.0228866*i.y+-.050127*i.z,y:.0295424*i.x+.9904844*i.y+-.0170491*i.z,z:-.0092345*i.x+.0150436*i.y+.7521316*i.z,a:i.a}})({x:100*(.4124564*e+.3575761*t+.1804375*r),y:100*(.2126729*e+.7151522*t+.072175*r),z:100*(.0193339*e+.119192*t+.9503041*r),a:n.a}))},Uh=216/24389,gc=24389/27,EV=function(n){var e=n.l,t=n.a,r=n.b,i=n.alpha,s=i===void 0?1:i;if(!gb(e)||!gb(t)||!gb(r))return null;var o=(function(c){return{l:qi(c.l,0,400),a:c.a,b:c.b,alpha:qi(c.alpha)}})({l:Number(e),a:Number(t),b:Number(r),alpha:Number(s)});return MV(o)},MV=function(n){var e=(n.l+16)/116,t=n.a/500+e,r=e-n.b/200;return kV({x:(Math.pow(t,3)>Uh?Math.pow(t,3):(116*t-16)/gc)*$2,y:(n.l>8?Math.pow((n.l+16)/116,3):n.l/gc)*q2,z:(Math.pow(r,3)>Uh?Math.pow(r,3):(116*r-16)/gc)*Z2,a:n.alpha})};function sN(n,e){n.prototype.toLab=function(){return r=TV(this.rgba),s=r.y/q2,o=r.z/Z2,i=(i=r.x/$2)>Uh?Math.cbrt(i):(gc*i+16)/116,t={l:116*(s=s>Uh?Math.cbrt(s):(gc*s+16)/116)-16,a:500*(i-s),b:200*(s-(o=o>Uh?Math.cbrt(o):(gc*o+16)/116)),alpha:r.a},{l:ch(t.l,2),a:ch(t.a,2),b:ch(t.b,2),alpha:ch(t.alpha,3)};var t,r,i,s,o},n.prototype.delta=function(t){t===void 0&&(t="#FFF");var r=t instanceof n?t:new n(t),i=(function(s,o){var c=s.l,u=s.a,d=s.b,f=o.l,p=o.a,y=o.b,b=180/Math.PI,_=Math.PI/180,w=Math.pow(Math.pow(u,2)+Math.pow(d,2),.5),S=Math.pow(Math.pow(p,2)+Math.pow(y,2),.5),A=(c+f)/2,M=Math.pow((w+S)/2,7),k=.5*(1-Math.pow(M/(M+Math.pow(25,7)),.5)),E=u*(1+k),U=p*(1+k),I=Math.pow(Math.pow(E,2)+Math.pow(d,2),.5),B=Math.pow(Math.pow(U,2)+Math.pow(y,2),.5),G=(I+B)/2,R=E===0&&d===0?0:Math.atan2(d,E)*b,P=U===0&&y===0?0:Math.atan2(y,U)*b;R<0&&(R+=360),P<0&&(P+=360);var H=P-R,Y=Math.abs(P-R);Y>180&&P<=R?H+=360:Y>180&&P>R&&(H-=360);var L=R+P;Y<=180?L/=2:L=(R+P<360?L+360:L-360)/2;var q=1-.17*Math.cos(_*(L-30))+.24*Math.cos(2*_*L)+.32*Math.cos(_*(3*L+6))-.2*Math.cos(_*(4*L-63)),W=f-c,N=B-I,V=2*Math.sin(_*H/2)*Math.pow(I*B,.5),J=1+.015*Math.pow(A-50,2)/Math.pow(20+Math.pow(A-50,2),.5),se=1+.045*G,O=1+.015*G*q,F=30*Math.exp(-1*Math.pow((L-275)/25,2)),X=-2*Math.pow(M/(M+Math.pow(25,7)),.5)*Math.sin(2*_*F);return Math.pow(Math.pow(W/1/J,2)+Math.pow(N/1/se,2)+Math.pow(V/1/O,2)+X*N*V/(1*se*1*O),.5)})(this.toLab(),r.toLab())/100;return qi(ch(i,3))},e.object.push([EV,"lab"])}var NV={grad:.9,turn:360,rad:360/(2*Math.PI)},xb=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},lc=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},Vs=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},vb=function(n){var e=n/255;return e<.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},_b=function(n){return 255*(n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n)},X2=96.422,K2=100,Q2=82.521,IV=function(n){var e,t,r={x:.9555766*(e=n).x+-.0230393*e.y+.0631636*e.z,y:-.0282895*e.x+1.0099416*e.y+.0210077*e.z,z:.0122982*e.x+-.020483*e.y+1.3299098*e.z};return t={r:_b(.032404542*r.x-.015371385*r.y-.004985314*r.z),g:_b(-.00969266*r.x+.018760108*r.y+41556e-8*r.z),b:_b(556434e-9*r.x-.002040259*r.y+.010572252*r.z),a:n.a},{r:Vs(t.r,0,255),g:Vs(t.g,0,255),b:Vs(t.b,0,255),a:Vs(t.a)}},RV=function(n){var e=vb(n.r),t=vb(n.g),r=vb(n.b);return(function(i){return{x:Vs(i.x,0,X2),y:Vs(i.y,0,K2),z:Vs(i.z,0,Q2),a:Vs(i.a)}})((function(i){return{x:1.0478112*i.x+.0228866*i.y+-.050127*i.z,y:.0295424*i.x+.9904844*i.y+-.0170491*i.z,z:-.0092345*i.x+.0150436*i.y+.7521316*i.z,a:i.a}})({x:100*(.4124564*e+.3575761*t+.1804375*r),y:100*(.2126729*e+.7151522*t+.072175*r),z:100*(.0193339*e+.119192*t+.9503041*r),a:n.a}))},Fh=216/24389,yc=24389/27,aN=function(n){return{l:Vs(n.l,0,100),c:n.c,h:(e=n.h,(e=isFinite(e)?e%360:0)>0?e:e+360),a:n.a};var e},Sk=function(n){return{l:lc(n.l,2),c:lc(n.c,2),h:lc(n.h,2),a:lc(n.a,3)}},PV=function(n){var e=n.l,t=n.c,r=n.h,i=n.a,s=i===void 0?1:i;if(!xb(e)||!xb(t)||!xb(r))return null;var o=aN({l:Number(e),c:Number(t),h:Number(r),a:Number(s)});return oN(o)},Ak=function(n){var e=(function(s){var o=RV(s),c=o.x/X2,u=o.y/K2,d=o.z/Q2;return c=c>Fh?Math.cbrt(c):(yc*c+16)/116,{l:116*(u=u>Fh?Math.cbrt(u):(yc*u+16)/116)-16,a:500*(c-u),b:200*(u-(d=d>Fh?Math.cbrt(d):(yc*d+16)/116)),alpha:o.a}})(n),t=lc(e.a,3),r=lc(e.b,3),i=Math.atan2(r,t)/Math.PI*180;return{l:e.l,c:Math.sqrt(t*t+r*r),h:i<0?i+360:i,a:e.alpha}},oN=function(n){return e={l:n.l,a:n.c*Math.cos(n.h*Math.PI/180),b:n.c*Math.sin(n.h*Math.PI/180),alpha:n.a},r=e.a/500+(t=(e.l+16)/116),i=t-e.b/200,IV({x:(Math.pow(r,3)>Fh?Math.pow(r,3):(116*r-16)/yc)*X2,y:(e.l>8?Math.pow((e.l+16)/116,3):e.l/yc)*K2,z:(Math.pow(i,3)>Fh?Math.pow(i,3):(116*i-16)/yc)*Q2,a:e.alpha});var e,t,r,i},DV=/^lch\(\s*([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)\s+([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,jV=function(n){var e=DV.exec(n);if(!e)return null;var t,r,i=aN({l:Number(e[1]),c:Number(e[2]),h:(t=e[3],r=e[4],r===void 0&&(r="deg"),Number(t)*(NV[r]||1)),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return oN(i)};function lN(n,e){n.prototype.toLch=function(){return Sk(Ak(this.rgba))},n.prototype.toLchString=function(){return t=Sk(Ak(this.rgba)),r=t.l,i=t.c,s=t.h,(o=t.a)<1?"lch("+r+"% "+i+" "+s+" / "+o+")":"lch("+r+"% "+i+" "+s+")";var t,r,i,s,o},e.string.push([jV,"lch"]),e.object.push([PV,"lch"])}function yn(n,e){let t=n.length;Array.isArray(n[0])||(n=[n]),Array.isArray(e[0])||(e=e.map(o=>[o]));let r=e[0].length,i=e[0].map((o,c)=>e.map(u=>u[c])),s=n.map(o=>i.map(c=>{let u=0;if(!Array.isArray(o)){for(let d of c)u+=o*d;return u}for(let d=0;d<o.length;d++)u+=o[d]*(c[d]||0);return u}));return t===1&&(s=s[0]),r===1?s.map(o=>o[0]):s}function Md(n){return Da(n)==="string"}function Da(n){return(Object.prototype.toString.call(n).match(/^\[object\s+(.*?)\]$/)[1]||"").toLowerCase()}function Pp(n,{precision:e,unit:t}){return Ga(n)?"none":cN(n,e)+(t??"")}function Ga(n){return Number.isNaN(n)||n instanceof Number&&n?.none}function Zn(n){return Ga(n)?0:n}function cN(n,e){if(n===0)return 0;let t=~~n,r=0;t&&e&&(r=~~Math.log10(Math.abs(t))+1);const i=10**(e-r);return Math.floor(n*i+.5)/i}const BV={deg:1,grad:.9,rad:180/Math.PI,turn:360};function uN(n){if(!n)return;n=n.trim();const e=/^([a-z]+)\((.+?)\)$/i,t=/^-?[\d.]+$/,r=/%|deg|g?rad|turn$/,i=/\/?\s*(none|[-\w.]+(?:%|deg|g?rad|turn)?)/g;let s=n.match(e);if(s){let o=[];return s[2].replace(i,(c,u)=>{let d=u.match(r),f=u;if(d){let p=d[0],y=f.slice(0,-p.length);p==="%"?(f=new Number(y/100),f.type="<percentage>"):(f=new Number(y*BV[p]),f.type="<angle>",f.unit=p)}else t.test(f)?(f=new Number(f),f.type="<number>"):f==="none"&&(f=new Number(NaN),f.none=!0);c.startsWith("/")&&(f=f instanceof Number?f:new Number(f),f.alpha=!0),typeof f=="object"&&f instanceof Number&&(f.raw=u),o.push(f)}),{name:s[1].toLowerCase(),rawName:s[1],rawArgs:s[2],args:o}}}function hN(n){return n[n.length-1]}function cd(n,e,t){return isNaN(n)?e:isNaN(e)?n:n+(e-n)*t}function dN(n,e,t){return(t-n)/(e-n)}function J2(n,e,t){return cd(e[0],e[1],dN(n[0],n[1],t))}function fN(n){return n.map(e=>e.split("|").map(t=>{t=t.trim();let r=t.match(/^(<[a-z]+>)\[(-?[.\d]+),\s*(-?[.\d]+)\]?$/);if(r){let i=new String(r[1]);return i.range=[+r[2],+r[3]],i}return t}))}function mN(n,e,t){return Math.max(Math.min(t,e),n)}function ug(n,e){return Math.sign(n)===Math.sign(e)?n:-n}function ds(n,e){return ug(Math.abs(n)**e,n)}function ev(n,e){return e===0?0:n/e}function pN(n,e,t=0,r=n.length){for(;t<r;){const i=t+r>>1;n[i]<e?t=i+1:r=i}return t}var OV=Object.freeze({__proto__:null,bisectLeft:pN,clamp:mN,copySign:ug,interpolate:cd,interpolateInv:dN,isNone:Ga,isString:Md,last:hN,mapRange:J2,multiplyMatrices:yn,parseCoordGrammar:fN,parseFunction:uN,serializeNumber:Pp,skipNone:Zn,spow:ds,toPrecision:cN,type:Da,zdiv:ev});class LV{add(e,t,r){if(typeof arguments[0]!="string"){for(var e in arguments[0])this.add(e,arguments[0][e],arguments[1]);return}(Array.isArray(e)?e:[e]).forEach(function(i){this[i]=this[i]||[],t&&this[i][r?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(r){r.call(t&&t.context?t.context:t,t)})}}const Ha=new LV;var pi={gamut_mapping:"css",precision:5,deltaE:"76",verbose:"production".toLowerCase()!=="test",warn:function(e){this.verbose&&globalThis?.console?.warn?.(e)}};const Nr={D50:[.3457/.3585,1,(1-.3457-.3585)/.3585],D65:[.3127/.329,1,(1-.3127-.329)/.329]};function b1(n){return Array.isArray(n)?n:Nr[n]}function Dp(n,e,t,r={}){if(n=b1(n),e=b1(e),!n||!e)throw new TypeError(`Missing white point to convert ${n?"":"from"}${!n&&!e?"/":""}${e?"":"to"}`);if(n===e)return t;let i={W1:n,W2:e,XYZ:t,options:r};if(Ha.run("chromatic-adaptation-start",i),i.M||(i.W1===Nr.D65&&i.W2===Nr.D50?i.M=[[1.0479297925449969,.022946870601609652,-.05019226628920524],[.02962780877005599,.9904344267538799,-.017073799063418826],[-.009243040646204504,.015055191490298152,.7518742814281371]]:i.W1===Nr.D50&&i.W2===Nr.D65&&(i.M=[[.955473421488075,-.02309845494876471,.06325924320057072],[-.0283697093338637,1.0099953980813041,.021041441191917323],[.012314014864481998,-.020507649298898964,1.330365926242124]])),Ha.run("chromatic-adaptation-end",i),i.M)return yn(i.M,i.XYZ);throw new TypeError("Only Bradford CAT with white points D50 and D65 supported for now.")}const zV=new Set(["<number>","<percentage>","<angle>"]);function Ck(n,e,t,r){return Object.entries(n.coords).map(([s,o],c)=>{let u=e.coordGrammar[c],d=r[c],f=d?.type,p;if(d.none?p=u.find(_=>zV.has(_)):p=u.find(_=>_==f),!p){let _=o.name||s;throw new TypeError(`${f??d.raw} not allowed for ${_} in ${t}()`)}let y=p.range;f==="<percentage>"&&(y||=[0,1]);let b=o.range||o.refRange;return y&&b&&(r[c]=J2(y,b,r[c])),p})}function gN(n,{meta:e}={}){let t={str:String(n)?.trim()};if(Ha.run("parse-start",t),t.color)return t.color;if(t.parsed=uN(t.str),t.parsed){let r=t.parsed.name;if(r==="color"){let i=t.parsed.args.shift(),s=i.startsWith("--")?i.substring(2):`--${i}`,o=[i,s],c=t.parsed.rawArgs.indexOf("/")>0?t.parsed.args.pop():1;for(let f of Ne.all){let p=f.getFormat("color");if(p&&(o.includes(p.id)||p.ids?.filter(y=>o.includes(y)).length)){const y=Object.keys(f.coords).map((_,w)=>t.parsed.args[w]||0);let b;return p.coordGrammar&&(b=Ck(f,p,"color",y)),e&&Object.assign(e,{formatId:"color",types:b}),p.id.startsWith("--")&&!i.startsWith("--")&&pi.warn(`${f.name} is a non-standard space and not currently supported in the CSS spec. Use prefixed color(${p.id}) instead of color(${i}).`),i.startsWith("--")&&!p.id.startsWith("--")&&pi.warn(`${f.name} is a standard space and supported in the CSS spec. Use color(${p.id}) instead of prefixed color(${i}).`),{spaceId:f.id,coords:y,alpha:c}}}let u="",d=i in Ne.registry?i:s;if(d in Ne.registry){let f=Ne.registry[d].formats?.color?.id;f&&(u=`Did you mean color(${f})?`)}throw new TypeError(`Cannot parse color(${i}). `+(u||"Missing a plugin?"))}else for(let i of Ne.all){let s=i.getFormat(r);if(s&&s.type==="function"){let o=1;(s.lastAlpha||hN(t.parsed.args).alpha)&&(o=t.parsed.args.pop());let c=t.parsed.args,u;return s.coordGrammar&&(u=Ck(i,s,r,c)),e&&Object.assign(e,{formatId:s.name,types:u}),{spaceId:i.id,coords:c,alpha:o}}}}else for(let r of Ne.all)for(let i in r.formats){let s=r.formats[i];if(s.type!=="custom"||s.test&&!s.test(t.str))continue;let o=s.parse(t.str);if(o)return o.alpha??=1,e&&(e.formatId=i),o}throw new TypeError(`Could not parse ${n} as a color. Missing a plugin?`)}function Je(n){if(Array.isArray(n))return n.map(Je);if(!n)throw new TypeError("Empty color reference");Md(n)&&(n=gN(n));let e=n.space||n.spaceId;return e instanceof Ne||(n.space=Ne.get(e)),n.alpha===void 0&&(n.alpha=1),n}const UV=75e-6;class Ne{constructor(e){this.id=e.id,this.name=e.name,this.base=e.base?Ne.get(e.base):null,this.aliases=e.aliases,this.base&&(this.fromBase=e.fromBase,this.toBase=e.toBase);let t=e.coords??this.base.coords;for(let i in t)"name"in t[i]||(t[i].name=i);this.coords=t;let r=e.white??this.base.white??"D65";this.white=b1(r),this.formats=e.formats??{};for(let i in this.formats){let s=this.formats[i];s.type||="function",s.name||=i}this.formats.color?.id||(this.formats.color={...this.formats.color??{},id:e.cssId||this.id}),e.gamutSpace?this.gamutSpace=e.gamutSpace==="self"?this:Ne.get(e.gamutSpace):this.isPolar?this.gamutSpace=this.base:this.gamutSpace=this,this.gamutSpace.isUnbounded&&(this.inGamut=(i,s)=>!0),this.referred=e.referred,Object.defineProperty(this,"path",{value:FV(this).reverse(),writable:!1,enumerable:!0,configurable:!0}),Ha.run("colorspace-init-end",this)}inGamut(e,{epsilon:t=UV}={}){if(!this.equals(this.gamutSpace))return e=this.to(this.gamutSpace,e),this.gamutSpace.inGamut(e,{epsilon:t});let r=Object.values(this.coords);return e.every((i,s)=>{let o=r[s];if(o.type!=="angle"&&o.range){if(Number.isNaN(i))return!0;let[c,u]=o.range;return(c===void 0||i>=c-t)&&(u===void 0||i<=u+t)}return!0})}get isUnbounded(){return Object.values(this.coords).every(e=>!("range"in e))}get cssId(){return this.formats?.color?.id||this.id}get isPolar(){for(let e in this.coords)if(this.coords[e].type==="angle")return!0;return!1}getFormat(e){if(typeof e=="object")return e=kk(e,this),e;let t;return e==="default"?t=Object.values(this.formats)[0]:t=this.formats[e],t?(t=kk(t,this),t):null}equals(e){return e?this===e||this.id===e||this.id===e.id:!1}to(e,t){if(arguments.length===1){const c=Je(e);[e,t]=[c.space,c.coords]}if(e=Ne.get(e),this.equals(e))return t;t=t.map(c=>Number.isNaN(c)?0:c);let r=this.path,i=e.path,s,o;for(let c=0;c<r.length&&r[c].equals(i[c]);c++)s=r[c],o=c;if(!s)throw new Error(`Cannot convert between color spaces ${this} and ${e}: no connection space was found`);for(let c=r.length-1;c>o;c--)t=r[c].toBase(t);for(let c=o+1;c<i.length;c++)t=i[c].fromBase(t);return t}from(e,t){if(arguments.length===1){const r=Je(e);[e,t]=[r.space,r.coords]}return e=Ne.get(e),e.to(this,t)}toString(){return`${this.name} (${this.id})`}getMinCoords(){let e=[];for(let t in this.coords){let r=this.coords[t],i=r.range||r.refRange;e.push(i?.min??0)}return e}static registry={};static get all(){return[...new Set(Object.values(Ne.registry))]}static register(e,t){if(arguments.length===1&&(t=arguments[0],e=t.id),t=this.get(t),this.registry[e]&&this.registry[e]!==t)throw new Error(`Duplicate color space registration: '${e}'`);if(this.registry[e]=t,arguments.length===1&&t.aliases)for(let r of t.aliases)this.register(r,t);return t}static get(e,...t){if(!e||e instanceof Ne)return e;if(Da(e)==="string"){let i=Ne.registry[e.toLowerCase()];if(!i)throw new TypeError(`No color space found with id = "${e}"`);return i}if(t.length)return Ne.get(...t);throw new TypeError(`${e} is not a valid color space`)}static resolveCoord(e,t){let r=Da(e),i,s;if(r==="string"?e.includes(".")?[i,s]=e.split("."):[i,s]=[,e]:Array.isArray(e)?[i,s]=e:(i=e.space,s=e.coordId),i=Ne.get(i),i||(i=t),!i)throw new TypeError(`Cannot resolve coordinate reference ${e}: No color space specified and relative references are not allowed here`);if(r=Da(s),r==="number"||r==="string"&&s>=0){let u=Object.entries(i.coords)[s];if(u)return{space:i,id:u[0],index:s,...u[1]}}i=Ne.get(i);let o=s.toLowerCase(),c=0;for(let u in i.coords){let d=i.coords[u];if(u.toLowerCase()===o||d.name?.toLowerCase()===o)return{space:i,id:u,index:c,...d};c++}throw new TypeError(`No "${s}" coordinate found in ${i.name}. Its coordinates are: ${Object.keys(i.coords).join(", ")}`)}static DEFAULT_FORMAT={type:"functions",name:"color"}}function FV(n){let e=[n];for(let t=n;t=t.base;)e.push(t);return e}function kk(n,{coords:e}={}){if(n.coords&&!n.coordGrammar){n.type||="function",n.name||="color",n.coordGrammar=fN(n.coords);let t=Object.entries(e).map(([r,i],s)=>{let o=n.coordGrammar[s][0],c=i.range||i.refRange,u=o.range,d="";return o=="<percentage>"?(u=[0,100],d="%"):o=="<angle>"&&(d="deg"),{fromRange:c,toRange:u,suffix:d}});n.serializeCoords=(r,i)=>r.map((s,o)=>{let{fromRange:c,toRange:u,suffix:d}=t[o];return c&&u&&(s=J2(c,u,s)),s=Pp(s,{precision:i,unit:d}),s})}return n}var xr=new Ne({id:"xyz-d65",name:"XYZ D65",coords:{x:{name:"X"},y:{name:"Y"},z:{name:"Z"}},white:"D65",formats:{color:{ids:["xyz-d65","xyz"]}},aliases:["xyz"]});class Qr extends Ne{constructor(e){e.coords||(e.coords={r:{range:[0,1],name:"Red"},g:{range:[0,1],name:"Green"},b:{range:[0,1],name:"Blue"}}),e.base||(e.base=xr),e.toXYZ_M&&e.fromXYZ_M&&(e.toBase??=t=>{let r=yn(e.toXYZ_M,t);return this.white!==this.base.white&&(r=Dp(this.white,this.base.white,r)),r},e.fromBase??=t=>(t=Dp(this.base.white,this.white,t),yn(e.fromXYZ_M,t))),e.referred??="display",super(e)}}function Nd(n,e){return n=Je(n),!e||n.space.equals(e)?n.coords.slice():(e=Ne.get(e),e.from(n))}function di(n,e){n=Je(n);let{space:t,index:r}=Ne.resolveCoord(e,n.space);return Nd(n,t)[r]}function tv(n,e,t){return n=Je(n),e=Ne.get(e),n.coords=e.to(n.space,t),n}tv.returns="color";function Zs(n,e,t){if(n=Je(n),arguments.length===2&&Da(arguments[1])==="object"){let r=arguments[1];for(let i in r)Zs(n,i,r[i])}else{typeof t=="function"&&(t=t(di(n,e)));let{space:r,index:i}=Ne.resolveCoord(e,n.space),s=Nd(n,r);s[i]=t,tv(n,r,s)}return n}Zs.returns="color";var nv=new Ne({id:"xyz-d50",name:"XYZ D50",white:"D50",base:xr,fromBase:n=>Dp(xr.white,"D50",n),toBase:n=>Dp("D50",xr.white,n)});const GV=216/24389,Tk=24/116,xm=24389/27;let wb=Nr.D50;var fi=new Ne({id:"lab",name:"Lab",coords:{l:{refRange:[0,100],name:"Lightness"},a:{refRange:[-125,125]},b:{refRange:[-125,125]}},white:wb,base:nv,fromBase(n){let t=n.map((r,i)=>r/wb[i]).map(r=>r>GV?Math.cbrt(r):(xm*r+16)/116);return[116*t[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])]},toBase(n){let e=[];return e[1]=(n[0]+16)/116,e[0]=n[1]/500+e[1],e[2]=e[1]-n[2]/200,[e[0]>Tk?Math.pow(e[0],3):(116*e[0]-16)/xm,n[0]>8?Math.pow((n[0]+16)/116,3):n[0]/xm,e[2]>Tk?Math.pow(e[2],3):(116*e[2]-16)/xm].map((r,i)=>r*wb[i])},formats:{lab:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});function ys(n){return(n%360+360)%360}function HV(n,e){if(n==="raw")return e;let[t,r]=e.map(ys),i=r-t;return n==="increasing"?i<0&&(r+=360):n==="decreasing"?i>0&&(t+=360):n==="longer"?-180<i&&i<180&&(i>0?t+=360:r+=360):n==="shorter"&&(i>180?t+=360:i<-180&&(r+=360)),[t,r]}var ud=new Ne({id:"lch",name:"LCH",coords:{l:{refRange:[0,100],name:"Lightness"},c:{refRange:[0,150],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:fi,fromBase(n){let[e,t,r]=n,i;const s=.02;return Math.abs(t)<s&&Math.abs(r)<s?i=NaN:i=Math.atan2(r,t)*180/Math.PI,[e,Math.sqrt(t**2+r**2),ys(i)]},toBase(n){let[e,t,r]=n;return t<0&&(t=0),isNaN(r)&&(r=0),[e,t*Math.cos(r*Math.PI/180),t*Math.sin(r*Math.PI/180)]},formats:{lch:{coords:["<number> | <percentage>","<number> | <percentage>","<number> | <angle>"]}}});const Ek=25**7,jp=Math.PI,Mk=180/jp,ql=jp/180;function Nk(n){const e=n*n;return e*e*e*n}function yN(n,e,{kL:t=1,kC:r=1,kH:i=1}={}){[n,e]=Je([n,e]);let[s,o,c]=fi.from(n),u=ud.from(fi,[s,o,c])[1],[d,f,p]=fi.from(e),y=ud.from(fi,[d,f,p])[1];u<0&&(u=0),y<0&&(y=0);let b=(u+y)/2,_=Nk(b),w=.5*(1-Math.sqrt(_/(_+Ek))),S=(1+w)*o,A=(1+w)*f,M=Math.sqrt(S**2+c**2),k=Math.sqrt(A**2+p**2),E=S===0&&c===0?0:Math.atan2(c,S),U=A===0&&p===0?0:Math.atan2(p,A);E<0&&(E+=2*jp),U<0&&(U+=2*jp),E*=Mk,U*=Mk;let I=d-s,B=k-M,G=U-E,R=E+U,P=Math.abs(G),H;M*k===0?H=0:P<=180?H=G:G>180?H=G-360:G<-180?H=G+360:pi.warn("the unthinkable has happened");let Y=2*Math.sqrt(k*M)*Math.sin(H*ql/2),L=(s+d)/2,q=(M+k)/2,W=Nk(q),N;M*k===0?N=R:P<=180?N=R/2:R<360?N=(R+360)/2:N=(R-360)/2;let V=(L-50)**2,J=1+.015*V/Math.sqrt(20+V),se=1+.045*q,O=1;O-=.17*Math.cos((N-30)*ql),O+=.24*Math.cos(2*N*ql),O+=.32*Math.cos((3*N+6)*ql),O-=.2*Math.cos((4*N-63)*ql);let F=1+.015*q*O,X=30*Math.exp(-1*((N-275)/25)**2),D=2*Math.sqrt(W/(W+Ek)),ee=-1*Math.sin(2*X*ql)*D,pe=(I/(t*J))**2;return pe+=(B/(r*se))**2,pe+=(Y/(i*F))**2,pe+=ee*(B/(r*se))*(Y/(i*F)),Math.sqrt(pe)}const VV=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],WV=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],YV=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],$V=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]];var Tc=new Ne({id:"oklab",name:"Oklab",coords:{l:{refRange:[0,1],name:"Lightness"},a:{refRange:[-.4,.4]},b:{refRange:[-.4,.4]}},white:"D65",base:xr,fromBase(n){let t=yn(VV,n).map(r=>Math.cbrt(r));return yn(YV,t)},toBase(n){let t=yn($V,n).map(r=>r**3);return yn(WV,t)},formats:{oklab:{coords:["<percentage> | <number>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});function x1(n,e){[n,e]=Je([n,e]);let[t,r,i]=Tc.from(n),[s,o,c]=Tc.from(e),u=t-s,d=r-o,f=i-c;return Math.sqrt(u**2+d**2+f**2)}const qV=75e-6;function Lo(n,e,{epsilon:t=qV}={}){n=Je(n),e||(e=n.space),e=Ne.get(e);let r=n.coords;return e!==n.space&&(r=e.from(n)),e.inGamut(r,{epsilon:t})}function Ec(n){return{space:n.space,coords:n.coords.slice(),alpha:n.alpha}}function bN(n,e,t="lab"){t=Ne.get(t);let r=t.from(n),i=t.from(e);return Math.sqrt(r.reduce((s,o,c)=>{let u=i[c];return isNaN(o)||isNaN(u)?s:s+(u-o)**2},0))}function ZV(n,e){return bN(n,e,"lab")}const XV=Math.PI,Ik=XV/180;function KV(n,e,{l:t=2,c:r=1}={}){[n,e]=Je([n,e]);let[i,s,o]=fi.from(n),[,c,u]=ud.from(fi,[i,s,o]),[d,f,p]=fi.from(e),y=ud.from(fi,[d,f,p])[1];c<0&&(c=0),y<0&&(y=0);let b=i-d,_=c-y,w=s-f,S=o-p,A=w**2+S**2-_**2,M=.511;i>=16&&(M=.040975*i/(1+.01765*i));let k=.0638*c/(1+.0131*c)+.638,E;Number.isNaN(u)&&(u=0),u>=164&&u<=345?E=.56+Math.abs(.2*Math.cos((u+168)*Ik)):E=.36+Math.abs(.4*Math.cos((u+35)*Ik));let U=Math.pow(c,4),I=Math.sqrt(U/(U+1900)),B=k*(I*E+1-I),G=(b/(t*M))**2;return G+=(_/(r*k))**2,G+=A/B**2,Math.sqrt(G)}const Rk=203;var rv=new Ne({id:"xyz-abs-d65",cssId:"--xyz-abs-d65",name:"Absolute XYZ D65",coords:{x:{refRange:[0,9504.7],name:"Xa"},y:{refRange:[0,1e4],name:"Ya"},z:{refRange:[0,10888.3],name:"Za"}},base:xr,fromBase(n){return n.map(e=>Math.max(e*Rk,0))},toBase(n){return n.map(e=>Math.max(e/Rk,0))}});const vm=1.15,_m=.66,Pk=2610/2**14,QV=2**14/2610,Dk=3424/2**12,jk=2413/2**7,Bk=2392/2**7,JV=1.7*2523/2**5,Ok=2**5/(1.7*2523),wm=-.56,Sb=16295499532821565e-27,eW=[[.41478972,.579999,.014648],[-.20151,1.120649,.0531008],[-.0166008,.2648,.6684799]],tW=[[1.9242264357876067,-1.0047923125953657,.037651404030618],[.35031676209499907,.7264811939316552,-.06538442294808501],[-.09098281098284752,-.3127282905230739,1.5227665613052603]],nW=[[.5,.5,0],[3.524,-4.066708,.542708],[.199076,1.096799,-1.295875]],rW=[[1,.1386050432715393,.05804731615611886],[.9999999999999999,-.1386050432715393,-.05804731615611886],[.9999999999999998,-.09601924202631895,-.8118918960560388]];var xN=new Ne({id:"jzazbz",name:"Jzazbz",coords:{jz:{refRange:[0,1],name:"Jz"},az:{refRange:[-.5,.5]},bz:{refRange:[-.5,.5]}},base:rv,fromBase(n){let[e,t,r]=n,i=vm*e-(vm-1)*r,s=_m*t-(_m-1)*e,c=yn(eW,[i,s,r]).map(function(y){let b=Dk+jk*(y/1e4)**Pk,_=1+Bk*(y/1e4)**Pk;return(b/_)**JV}),[u,d,f]=yn(nW,c);return[(1+wm)*u/(1+wm*u)-Sb,d,f]},toBase(n){let[e,t,r]=n,i=(e+Sb)/(1+wm-wm*(e+Sb)),o=yn(rW,[i,t,r]).map(function(y){let b=Dk-y**Ok,_=Bk*y**Ok-jk;return 1e4*(b/_)**QV}),[c,u,d]=yn(tW,o),f=(c+(vm-1)*d)/vm,p=(u+(_m-1)*f)/_m;return[f,p,d]},formats:{color:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),v1=new Ne({id:"jzczhz",name:"JzCzHz",coords:{jz:{refRange:[0,1],name:"Jz"},cz:{refRange:[0,1],name:"Chroma"},hz:{refRange:[0,360],type:"angle",name:"Hue"}},base:xN,fromBase(n){let[e,t,r]=n,i;const s=2e-4;return Math.abs(t)<s&&Math.abs(r)<s?i=NaN:i=Math.atan2(r,t)*180/Math.PI,[e,Math.sqrt(t**2+r**2),ys(i)]},toBase(n){return[n[0],n[1]*Math.cos(n[2]*Math.PI/180),n[1]*Math.sin(n[2]*Math.PI/180)]}});function iW(n,e){[n,e]=Je([n,e]);let[t,r,i]=v1.from(n),[s,o,c]=v1.from(e),u=t-s,d=r-o;Number.isNaN(i)&&Number.isNaN(c)?(i=0,c=0):Number.isNaN(i)?i=c:Number.isNaN(c)&&(c=i);let f=i-c,p=2*Math.sqrt(r*o)*Math.sin(f/2*(Math.PI/180));return Math.sqrt(u**2+d**2+p**2)}const vN=3424/4096,_N=2413/128,wN=2392/128,Lk=2610/16384,sW=2523/32,aW=16384/2610,zk=32/2523,oW=[[.3592832590121217,.6976051147779502,-.035891593232029],[-.1920808463704993,1.100476797037432,.0753748658519118],[.0070797844607479,.0748396662186362,.8433265453898765]],lW=[[2048/4096,2048/4096,0],[6610/4096,-13613/4096,7003/4096],[17933/4096,-17390/4096,-543/4096]],cW=[[.9999999999999998,.0086090370379328,.111029625003026],[.9999999999999998,-.0086090370379328,-.1110296250030259],[.9999999999999998,.5600313357106791,-.3206271749873188]],uW=[[2.0701522183894223,-1.3263473389671563,.2066510476294053],[.3647385209748072,.6805660249472273,-.0453045459220347],[-.0497472075358123,-.0492609666966131,1.1880659249923042]];var _1=new Ne({id:"ictcp",name:"ICTCP",coords:{i:{refRange:[0,1],name:"I"},ct:{refRange:[-.5,.5],name:"CT"},cp:{refRange:[-.5,.5],name:"CP"}},base:rv,fromBase(n){let e=yn(oW,n);return hW(e)},toBase(n){let e=dW(n);return yn(uW,e)}});function hW(n){let e=n.map(function(t){let r=vN+_N*(t/1e4)**Lk,i=1+wN*(t/1e4)**Lk;return(r/i)**sW});return yn(lW,e)}function dW(n){return yn(cW,n).map(function(r){let i=Math.max(r**zk-vN,0),s=_N-wN*r**zk;return 1e4*(i/s)**aW})}function fW(n,e){[n,e]=Je([n,e]);let[t,r,i]=_1.from(n),[s,o,c]=_1.from(e);return 720*Math.sqrt((t-s)**2+.25*(r-o)**2+(i-c)**2)}const mW=Nr.D65,SN=.42,Uk=1/SN,Ab=2*Math.PI,AN=[[.401288,.650173,-.051461],[-.250268,1.204414,.045854],[-.002079,.048952,.953127]],pW=[[1.8620678550872327,-1.0112546305316843,.14918677544445175],[.38752654323613717,.6214474419314753,-.008973985167612518],[-.015841498849333856,-.03412293802851557,1.0499644368778496]],gW=[[460,451,288],[460,-891,-261],[460,-220,-6300]],yW={dark:[.8,.525,.8],dim:[.9,.59,.9],average:[1,.69,1]},Co={h:[20.14,90,164.25,237.53,380.14],e:[.8,.7,1,1.2,.8],H:[0,100,200,300,400]},bW=180/Math.PI,Fk=Math.PI/180;function CN(n,e){return n.map(r=>{const i=ds(e*Math.abs(r)*.01,SN);return 400*ug(i,r)/(i+27.13)})}function xW(n,e){const t=100/e*27.13**Uk;return n.map(r=>{const i=Math.abs(r);return ug(t*ds(i/(400-i),Uk),r)})}function vW(n){let e=ys(n);e<=Co.h[0]&&(e+=360);const t=pN(Co.h,e)-1,[r,i]=Co.h.slice(t,t+2),[s,o]=Co.e.slice(t,t+2),c=Co.H[t],u=(e-r)/s;return c+100*u/(u+(i-e)/o)}function _W(n){let e=(n%400+400)%400;const t=Math.floor(.01*e);e=e%100;const[r,i]=Co.h.slice(t,t+2),[s,o]=Co.e.slice(t,t+2);return ys((e*(o*r-s*i)-100*r*o)/(e*(o-s)-100*o))}function kN(n,e,t,r,i){const s={};s.discounting=i,s.refWhite=n,s.surround=r;const o=n.map(w=>w*100);s.la=e,s.yb=t;const c=o[1],u=yn(AN,o);r=yW[s.surround];const d=r[0];s.c=r[1],s.nc=r[2];const p=(1/(5*s.la+1))**4;s.fl=p*s.la+.1*(1-p)*(1-p)*Math.cbrt(5*s.la),s.flRoot=s.fl**.25,s.n=s.yb/c,s.z=1.48+Math.sqrt(s.n),s.nbb=.725*s.n**-.2,s.ncb=s.nbb;const y=Math.max(Math.min(d*(1-1/3.6*Math.exp((-s.la-42)/92)),1),0);s.dRgb=u.map(w=>cd(1,c/w,y)),s.dRgbInv=s.dRgb.map(w=>1/w);const b=u.map((w,S)=>w*s.dRgb[S]),_=CN(b,s.fl);return s.aW=s.nbb*(2*_[0]+_[1]+.05*_[2]),s}const Gk=kN(mW,64/Math.PI*.2,20,"average",!1);function w1(n,e){if(!(n.J!==void 0^n.Q!==void 0))throw new Error("Conversion requires one and only one: 'J' or 'Q'");if(!(n.C!==void 0^n.M!==void 0^n.s!==void 0))throw new Error("Conversion requires one and only one: 'C', 'M' or 's'");if(!(n.h!==void 0^n.H!==void 0))throw new Error("Conversion requires one and only one: 'h' or 'H'");if(n.J===0||n.Q===0)return[0,0,0];let t=0;n.h!==void 0?t=ys(n.h)*Fk:t=_W(n.H)*Fk;const r=Math.cos(t),i=Math.sin(t);let s=0;n.J!==void 0?s=ds(n.J,1/2)*.1:n.Q!==void 0&&(s=.25*e.c*n.Q/((e.aW+4)*e.flRoot));let o=0;n.C!==void 0?o=n.C/s:n.M!==void 0?o=n.M/e.flRoot/s:n.s!==void 0&&(o=4e-4*n.s**2*(e.aW+4)/e.c);const c=ds(o*Math.pow(1.64-Math.pow(.29,e.n),-.73),10/9),u=.25*(Math.cos(t+2)+3.8),d=e.aW*ds(s,2/e.c/e.z),f=5e4/13*e.nc*e.ncb*u,p=d/e.nbb,y=23*(p+.305)*ev(c,23*f+c*(11*r+108*i)),b=y*r,_=y*i,w=xW(yn(gW,[p,b,_]).map(S=>S*1/1403),e.fl);return yn(pW,w.map((S,A)=>S*e.dRgbInv[A])).map(S=>S/100)}function TN(n,e){const t=n.map(k=>k*100),r=CN(yn(AN,t).map((k,E)=>k*e.dRgb[E]),e.fl),i=r[0]+(-12*r[1]+r[2])/11,s=(r[0]+r[1]-2*r[2])/9,o=(Math.atan2(s,i)%Ab+Ab)%Ab,c=.25*(Math.cos(o+2)+3.8),u=5e4/13*e.nc*e.ncb*ev(c*Math.sqrt(i**2+s**2),r[0]+r[1]+1.05*r[2]+.305),d=ds(u,.9)*Math.pow(1.64-Math.pow(.29,e.n),.73),f=e.nbb*(2*r[0]+r[1]+.05*r[2]),p=ds(f/e.aW,.5*e.c*e.z),y=100*ds(p,2),b=4/e.c*p*(e.aW+4)*e.flRoot,_=d*p,w=_*e.flRoot,S=ys(o*bW),A=vW(S),M=50*ds(e.c*d/(e.aW+4),1/2);return{J:y,C:_,h:S,s:M,Q:b,M:w,H:A}}var wW=new Ne({id:"cam16-jmh",cssId:"--cam16-jmh",name:"CAM16-JMh",coords:{j:{refRange:[0,100],name:"J"},m:{refRange:[0,105],name:"Colorfulness"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:xr,fromBase(n){const e=TN(n,Gk);return[e.J,e.M,e.h]},toBase(n){return w1({J:n[0],M:n[1],h:n[2]},Gk)}});const SW=Nr.D65,AW=216/24389,EN=24389/27;function CW(n){return 116*(n>AW?Math.cbrt(n):(EN*n+16)/116)-16}function S1(n){return n>8?Math.pow((n+16)/116,3):n/EN}function kW(n,e){let[t,r,i]=n,s=[],o=0;if(i===0)return[0,0,0];let c=S1(i);i>0?o=.00379058511492914*i**2+.608983189401032*i+.9155088574762233:o=9514440756550361e-21*i**2+.08693057439788597*i-21.928975842194614;const u=2e-12,d=15;let f=0,p=1/0;for(;f<=d;){s=w1({J:o,C:r,h:t},e);const y=Math.abs(s[1]-c);if(y<p){if(y<=u)return s;p=y}o=o-(s[1]-c)*o/(2*s[1]),f+=1}return w1({J:o,C:r,h:t},e)}function TW(n,e){const t=CW(n[1]);if(t===0)return[0,0,0];const r=TN(n,iv);return[ys(r.h),r.C,t]}const iv=kN(SW,200/Math.PI*S1(50),S1(50)*100,"average",!1);var hd=new Ne({id:"hct",name:"HCT",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},c:{refRange:[0,145],name:"Colorfulness"},t:{refRange:[0,100],name:"Tone"}},base:xr,fromBase(n){return TW(n)},toBase(n){return kW(n,iv)},formats:{color:{id:"--hct",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}});const EW=Math.PI/180,Hk=[1,.007,.0228];function Vk(n){n[1]<0&&(n=hd.fromBase(hd.toBase(n)));const e=Math.log(Math.max(1+Hk[2]*n[1]*iv.flRoot,1))/Hk[2],t=n[0]*EW,r=e*Math.cos(t),i=e*Math.sin(t);return[n[2],r,i]}function MW(n,e){[n,e]=Je([n,e]);let[t,r,i]=Vk(hd.from(n)),[s,o,c]=Vk(hd.from(e));return Math.sqrt((t-s)**2+(r-o)**2+(i-c)**2)}var Mc={deltaE76:ZV,deltaECMC:KV,deltaE2000:yN,deltaEJz:iW,deltaEITP:fW,deltaEOK:x1,deltaEHCT:MW};function NW(n){const e=n?Math.floor(Math.log10(Math.abs(n))):0;return Math.max(parseFloat(`1e${e-2}`),1e-6)}const Wk={hct:{method:"hct.c",jnd:2,deltaEMethod:"hct",blackWhiteClamp:{}},"hct-tonal":{method:"hct.c",jnd:0,deltaEMethod:"hct",blackWhiteClamp:{channel:"hct.t",min:0,max:100}}};function Va(n,{method:e=pi.gamut_mapping,space:t=void 0,deltaEMethod:r="",jnd:i=2,blackWhiteClamp:s={}}={}){if(n=Je(n),Md(arguments[1])?t=arguments[1]:t||(t=n.space),t=Ne.get(t),Lo(n,t,{epsilon:0}))return n;let o;if(e==="css")o=IW(n,{space:t});else{if(e!=="clip"&&!Lo(n,t)){Object.prototype.hasOwnProperty.call(Wk,e)&&({method:e,jnd:i,deltaEMethod:r,blackWhiteClamp:s}=Wk[e]);let c=yN;if(r!==""){for(let d in Mc)if("deltae"+r.toLowerCase()===d.toLowerCase()){c=Mc[d];break}}let u=Va(gn(n,t),{method:"clip",space:t});if(c(n,u)>i){if(Object.keys(s).length===3){let M=Ne.resolveCoord(s.channel),k=di(gn(n,M.space),M.id);if(Ga(k)&&(k=0),k>=s.max)return gn({space:"xyz-d65",coords:Nr.D65},n.space);if(k<=s.min)return gn({space:"xyz-d65",coords:[0,0,0]},n.space)}let d=Ne.resolveCoord(e),f=d.space,p=d.id,y=gn(n,f);y.coords.forEach((M,k)=>{Ga(M)&&(y.coords[k]=0)});let _=(d.range||d.refRange)[0],w=NW(i),S=_,A=di(y,p);for(;A-S>w;){let M=Ec(y);M=Va(M,{space:t,method:"clip"}),c(y,M)-i<w?S=di(y,p):A=di(y,p),Zs(y,p,(S+A)/2)}o=gn(y,t)}else o=u}else o=gn(n,t);if(e==="clip"||!Lo(o,t,{epsilon:0})){let c=Object.values(t.coords).map(u=>u.range||[]);o.coords=o.coords.map((u,d)=>{let[f,p]=c[d];return f!==void 0&&(u=Math.max(f,u)),p!==void 0&&(u=Math.min(u,p)),u})}}return t!==n.space&&(o=gn(o,n.space)),n.coords=o.coords,n}Va.returns="color";const Yk={WHITE:{space:Tc,coords:[1,0,0]},BLACK:{space:Tc,coords:[0,0,0]}};function IW(n,{space:e}={}){n=Je(n),e||(e=n.space),e=Ne.get(e);const i=Ne.get("oklch");if(e.isUnbounded)return gn(n,e);const s=gn(n,i);let o=s.coords[0];if(o>=1){const _=gn(Yk.WHITE,e);return _.alpha=n.alpha,gn(_,e)}if(o<=0){const _=gn(Yk.BLACK,e);return _.alpha=n.alpha,gn(_,e)}if(Lo(s,e,{epsilon:0}))return gn(s,e);function c(_){const w=gn(_,e),S=Object.values(e.coords);return w.coords=w.coords.map((A,M)=>{if("range"in S[M]){const[k,E]=S[M].range;return mN(k,A,E)}return A}),w}let u=0,d=s.coords[1],f=!0,p=Ec(s),y=c(p),b=x1(y,p);if(b<.02)return y;for(;d-u>1e-4;){const _=(u+d)/2;if(p.coords[1]=_,f&&Lo(p,e,{epsilon:0}))u=_;else if(y=c(p),b=x1(y,p),b<.02){if(.02-b<1e-4)break;f=!1,u=_}else d=_}return y}function gn(n,e,{inGamut:t}={}){n=Je(n),e=Ne.get(e);let r=e.from(n),i={space:e,coords:r,alpha:n.alpha};return t&&(i=Va(i,t===!0?void 0:t)),i}gn.returns="color";function Gh(n,{precision:e=pi.precision,format:t="default",inGamut:r=!0,...i}={}){let s;n=Je(n);let o=t;t=n.space.getFormat(t)??n.space.getFormat("default")??Ne.DEFAULT_FORMAT;let c=n.coords.slice();if(r||=t.toGamut,r&&!Lo(n)&&(c=Va(Ec(n),r===!0?void 0:r).coords),t.type==="custom")if(i.precision=e,t.serialize)s=t.serialize(c,n.alpha,i);else throw new TypeError(`format ${o} can only be used to parse colors, not for serialization`);else{let u=t.name||"color";t.serializeCoords?c=t.serializeCoords(c,e):e!==null&&(c=c.map(y=>Pp(y,{precision:e})));let d=[...c];if(u==="color"){let y=t.id||t.ids?.[0]||n.space.id;d.unshift(y)}let f=n.alpha;e!==null&&(f=Pp(f,{precision:e}));let p=n.alpha>=1||t.noAlpha?"":`${t.commas?",":" /"} ${f}`;s=`${u}(${d.join(t.commas?", ":" ")}${p})`}return s}const RW=[[.6369580483012914,.14461690358620832,.1688809751641721],[.2627002120112671,.6779980715188708,.05930171646986196],[0,.028072693049087428,1.060985057710791]],PW=[[1.716651187971268,-.355670783776392,-.25336628137366],[-.666684351832489,1.616481236634939,.0157685458139111],[.017639857445311,-.042770613257809,.942103121235474]];var hg=new Qr({id:"rec2020-linear",cssId:"--rec2020-linear",name:"Linear REC.2020",white:"D65",toXYZ_M:RW,fromXYZ_M:PW});const Sm=1.09929682680944,$k=.018053968510807;var MN=new Qr({id:"rec2020",name:"REC.2020",base:hg,toBase(n){return n.map(function(e){return e<$k*4.5?e/4.5:Math.pow((e+Sm-1)/Sm,1/.45)})},fromBase(n){return n.map(function(e){return e>=$k?Sm*Math.pow(e,.45)-(Sm-1):4.5*e})}});const DW=[[.4865709486482162,.26566769316909306,.1982172852343625],[.2289745640697488,.6917385218365064,.079286914093745],[0,.04511338185890264,1.043944368900976]],jW=[[2.493496911941425,-.9313836179191239,-.40271078445071684],[-.8294889695615747,1.7626640603183463,.023624685841943577],[.03584583024378447,-.07617238926804182,.9568845240076872]];var NN=new Qr({id:"p3-linear",cssId:"--display-p3-linear",name:"Linear P3",white:"D65",toXYZ_M:DW,fromXYZ_M:jW});const BW=[[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],nr=[[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]];var IN=new Qr({id:"srgb-linear",name:"Linear sRGB",white:"D65",toXYZ_M:BW,fromXYZ_M:nr}),qk={aliceblue:[240/255,248/255,1],antiquewhite:[250/255,235/255,215/255],aqua:[0,1,1],aquamarine:[127/255,1,212/255],azure:[240/255,1,1],beige:[245/255,245/255,220/255],bisque:[1,228/255,196/255],black:[0,0,0],blanchedalmond:[1,235/255,205/255],blue:[0,0,1],blueviolet:[138/255,43/255,226/255],brown:[165/255,42/255,42/255],burlywood:[222/255,184/255,135/255],cadetblue:[95/255,158/255,160/255],chartreuse:[127/255,1,0],chocolate:[210/255,105/255,30/255],coral:[1,127/255,80/255],cornflowerblue:[100/255,149/255,237/255],cornsilk:[1,248/255,220/255],crimson:[220/255,20/255,60/255],cyan:[0,1,1],darkblue:[0,0,139/255],darkcyan:[0,139/255,139/255],darkgoldenrod:[184/255,134/255,11/255],darkgray:[169/255,169/255,169/255],darkgreen:[0,100/255,0],darkgrey:[169/255,169/255,169/255],darkkhaki:[189/255,183/255,107/255],darkmagenta:[139/255,0,139/255],darkolivegreen:[85/255,107/255,47/255],darkorange:[1,140/255,0],darkorchid:[153/255,50/255,204/255],darkred:[139/255,0,0],darksalmon:[233/255,150/255,122/255],darkseagreen:[143/255,188/255,143/255],darkslateblue:[72/255,61/255,139/255],darkslategray:[47/255,79/255,79/255],darkslategrey:[47/255,79/255,79/255],darkturquoise:[0,206/255,209/255],darkviolet:[148/255,0,211/255],deeppink:[1,20/255,147/255],deepskyblue:[0,191/255,1],dimgray:[105/255,105/255,105/255],dimgrey:[105/255,105/255,105/255],dodgerblue:[30/255,144/255,1],firebrick:[178/255,34/255,34/255],floralwhite:[1,250/255,240/255],forestgreen:[34/255,139/255,34/255],fuchsia:[1,0,1],gainsboro:[220/255,220/255,220/255],ghostwhite:[248/255,248/255,1],gold:[1,215/255,0],goldenrod:[218/255,165/255,32/255],gray:[128/255,128/255,128/255],green:[0,128/255,0],greenyellow:[173/255,1,47/255],grey:[128/255,128/255,128/255],honeydew:[240/255,1,240/255],hotpink:[1,105/255,180/255],indianred:[205/255,92/255,92/255],indigo:[75/255,0,130/255],ivory:[1,1,240/255],khaki:[240/255,230/255,140/255],lavender:[230/255,230/255,250/255],lavenderblush:[1,240/255,245/255],lawngreen:[124/255,252/255,0],lemonchiffon:[1,250/255,205/255],lightblue:[173/255,216/255,230/255],lightcoral:[240/255,128/255,128/255],lightcyan:[224/255,1,1],lightgoldenrodyellow:[250/255,250/255,210/255],lightgray:[211/255,211/255,211/255],lightgreen:[144/255,238/255,144/255],lightgrey:[211/255,211/255,211/255],lightpink:[1,182/255,193/255],lightsalmon:[1,160/255,122/255],lightseagreen:[32/255,178/255,170/255],lightskyblue:[135/255,206/255,250/255],lightslategray:[119/255,136/255,153/255],lightslategrey:[119/255,136/255,153/255],lightsteelblue:[176/255,196/255,222/255],lightyellow:[1,1,224/255],lime:[0,1,0],limegreen:[50/255,205/255,50/255],linen:[250/255,240/255,230/255],magenta:[1,0,1],maroon:[128/255,0,0],mediumaquamarine:[102/255,205/255,170/255],mediumblue:[0,0,205/255],mediumorchid:[186/255,85/255,211/255],mediumpurple:[147/255,112/255,219/255],mediumseagreen:[60/255,179/255,113/255],mediumslateblue:[123/255,104/255,238/255],mediumspringgreen:[0,250/255,154/255],mediumturquoise:[72/255,209/255,204/255],mediumvioletred:[199/255,21/255,133/255],midnightblue:[25/255,25/255,112/255],mintcream:[245/255,1,250/255],mistyrose:[1,228/255,225/255],moccasin:[1,228/255,181/255],navajowhite:[1,222/255,173/255],navy:[0,0,128/255],oldlace:[253/255,245/255,230/255],olive:[128/255,128/255,0],olivedrab:[107/255,142/255,35/255],orange:[1,165/255,0],orangered:[1,69/255,0],orchid:[218/255,112/255,214/255],palegoldenrod:[238/255,232/255,170/255],palegreen:[152/255,251/255,152/255],paleturquoise:[175/255,238/255,238/255],palevioletred:[219/255,112/255,147/255],papayawhip:[1,239/255,213/255],peachpuff:[1,218/255,185/255],peru:[205/255,133/255,63/255],pink:[1,192/255,203/255],plum:[221/255,160/255,221/255],powderblue:[176/255,224/255,230/255],purple:[128/255,0,128/255],rebeccapurple:[102/255,51/255,153/255],red:[1,0,0],rosybrown:[188/255,143/255,143/255],royalblue:[65/255,105/255,225/255],saddlebrown:[139/255,69/255,19/255],salmon:[250/255,128/255,114/255],sandybrown:[244/255,164/255,96/255],seagreen:[46/255,139/255,87/255],seashell:[1,245/255,238/255],sienna:[160/255,82/255,45/255],silver:[192/255,192/255,192/255],skyblue:[135/255,206/255,235/255],slateblue:[106/255,90/255,205/255],slategray:[112/255,128/255,144/255],slategrey:[112/255,128/255,144/255],snow:[1,250/255,250/255],springgreen:[0,1,127/255],steelblue:[70/255,130/255,180/255],tan:[210/255,180/255,140/255],teal:[0,128/255,128/255],thistle:[216/255,191/255,216/255],tomato:[1,99/255,71/255],turquoise:[64/255,224/255,208/255],violet:[238/255,130/255,238/255],wheat:[245/255,222/255,179/255],white:[1,1,1],whitesmoke:[245/255,245/255,245/255],yellow:[1,1,0],yellowgreen:[154/255,205/255,50/255]};let Zk=Array(3).fill("<percentage> | <number>[0, 255]"),Xk=Array(3).fill("<number>[0, 255]");var Nc=new Qr({id:"srgb",name:"sRGB",base:IN,fromBase:n=>n.map(e=>{let t=e<0?-1:1,r=e*t;return r>.0031308?t*(1.055*r**(1/2.4)-.055):12.92*e}),toBase:n=>n.map(e=>{let t=e<0?-1:1,r=e*t;return r<=.04045?e/12.92:t*((r+.055)/1.055)**2.4}),formats:{rgb:{coords:Zk},rgb_number:{name:"rgb",commas:!0,coords:Xk,noAlpha:!0},color:{},rgba:{coords:Zk,commas:!0,lastAlpha:!0},rgba_number:{name:"rgba",commas:!0,coords:Xk},hex:{type:"custom",toGamut:!0,test:n=>/^#([a-f0-9]{3,4}){1,2}$/i.test(n),parse(n){n.length<=5&&(n=n.replace(/[a-f0-9]/gi,"$&$&"));let e=[];return n.replace(/[a-f0-9]{2}/gi,t=>{e.push(parseInt(t,16)/255)}),{spaceId:"srgb",coords:e.slice(0,3),alpha:e.slice(3)[0]}},serialize:(n,e,{collapse:t=!0}={})=>{e<1&&n.push(e),n=n.map(s=>Math.round(s*255));let r=t&&n.every(s=>s%17===0);return"#"+n.map(s=>r?(s/17).toString(16):s.toString(16).padStart(2,"0")).join("")}},keyword:{type:"custom",test:n=>/^[a-z]+$/i.test(n),parse(n){n=n.toLowerCase();let e={spaceId:"srgb",coords:null,alpha:1};if(n==="transparent"?(e.coords=qk.black,e.alpha=0):e.coords=qk[n],e.coords)return e}}}}),RN=new Qr({id:"p3",cssId:"display-p3",name:"P3",base:NN,fromBase:Nc.fromBase,toBase:Nc.toBase});pi.display_space=Nc;let OW;if(typeof CSS<"u"&&CSS.supports)for(let n of[fi,MN,RN]){let e=n.getMinCoords(),r=Gh({space:n,coords:e,alpha:1});if(CSS.supports("color",r)){pi.display_space=n;break}}function LW(n,{space:e=pi.display_space,...t}={}){let r=Gh(n,t);if(typeof CSS>"u"||CSS.supports("color",r)||!pi.display_space)r=new String(r),r.color=n;else{let i=n;if((n.coords.some(Ga)||Ga(n.alpha))&&!(OW??=CSS.supports("color","hsl(none 50% 50%)"))&&(i=Ec(n),i.coords=i.coords.map(Zn),i.alpha=Zn(i.alpha),r=Gh(i,t),CSS.supports("color",r)))return r=new String(r),r.color=i,r;i=gn(i,e),r=new String(Gh(i,t)),r.color=i}return r}function zW(n,e){return n=Je(n),e=Je(e),n.space===e.space&&n.alpha===e.alpha&&n.coords.every((t,r)=>t===e.coords[r])}function Wa(n){return di(n,[xr,"y"])}function PN(n,e){Zs(n,[xr,"y"],e)}function UW(n){Object.defineProperty(n.prototype,"luminance",{get(){return Wa(this)},set(e){PN(this,e)}})}var FW=Object.freeze({__proto__:null,getLuminance:Wa,register:UW,setLuminance:PN});function GW(n,e){n=Je(n),e=Je(e);let t=Math.max(Wa(n),0),r=Math.max(Wa(e),0);return r>t&&([t,r]=[r,t]),(t+.05)/(r+.05)}const HW=.56,VW=.57,WW=.62,YW=.65,Kk=.022,$W=1.414,qW=.1,ZW=5e-4,XW=1.14,Qk=.027,KW=1.14;function Jk(n){return n>=Kk?n:n+(Kk-n)**$W}function Zl(n){let e=n<0?-1:1,t=Math.abs(n);return e*Math.pow(t,2.4)}function QW(n,e){e=Je(e),n=Je(n);let t,r,i,s,o,c;e=gn(e,"srgb"),[s,o,c]=e.coords;let u=Zl(s)*.2126729+Zl(o)*.7151522+Zl(c)*.072175;n=gn(n,"srgb"),[s,o,c]=n.coords;let d=Zl(s)*.2126729+Zl(o)*.7151522+Zl(c)*.072175,f=Jk(u),p=Jk(d),y=p>f;return Math.abs(p-f)<ZW?r=0:y?(t=p**HW-f**VW,r=t*XW):(t=p**YW-f**WW,r=t*KW),Math.abs(r)<qW?i=0:r>0?i=r-Qk:i=r+Qk,i*100}function JW(n,e){n=Je(n),e=Je(e);let t=Math.max(Wa(n),0),r=Math.max(Wa(e),0);r>t&&([t,r]=[r,t]);let i=t+r;return i===0?0:(t-r)/i}const eY=5e4;function tY(n,e){n=Je(n),e=Je(e);let t=Math.max(Wa(n),0),r=Math.max(Wa(e),0);return r>t&&([t,r]=[r,t]),r===0?eY:(t-r)/r}function nY(n,e){n=Je(n),e=Je(e);let t=di(n,[fi,"l"]),r=di(e,[fi,"l"]);return Math.abs(t-r)}const rY=216/24389,eT=24/116,Am=24389/27;let Cb=Nr.D65;var A1=new Ne({id:"lab-d65",name:"Lab D65",coords:{l:{refRange:[0,100],name:"Lightness"},a:{refRange:[-125,125]},b:{refRange:[-125,125]}},white:Cb,base:xr,fromBase(n){let t=n.map((r,i)=>r/Cb[i]).map(r=>r>rY?Math.cbrt(r):(Am*r+16)/116);return[116*t[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])]},toBase(n){let e=[];return e[1]=(n[0]+16)/116,e[0]=n[1]/500+e[1],e[2]=e[1]-n[2]/200,[e[0]>eT?Math.pow(e[0],3):(116*e[0]-16)/Am,n[0]>8?Math.pow((n[0]+16)/116,3):n[0]/Am,e[2]>eT?Math.pow(e[2],3):(116*e[2]-16)/Am].map((r,i)=>r*Cb[i])},formats:{"lab-d65":{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});const kb=Math.pow(5,.5)*.5+.5;function iY(n,e){n=Je(n),e=Je(e);let t=di(n,[A1,"l"]),r=di(e,[A1,"l"]),i=Math.abs(Math.pow(t,kb)-Math.pow(r,kb)),s=Math.pow(i,1/kb)*Math.SQRT2-40;return s<7.5?0:s}var cp=Object.freeze({__proto__:null,contrastAPCA:QW,contrastDeltaPhi:iY,contrastLstar:nY,contrastMichelson:JW,contrastWCAG21:GW,contrastWeber:tY});function sY(n,e,t={}){Md(t)&&(t={algorithm:t});let{algorithm:r,...i}=t;if(!r){let s=Object.keys(cp).map(o=>o.replace(/^contrast/,"")).join(", ");throw new TypeError(`contrast() function needs a contrast algorithm. Please specify one of: ${s}`)}n=Je(n),e=Je(e);for(let s in cp)if("contrast"+r.toLowerCase()===s.toLowerCase())return cp[s](n,e,i);throw new TypeError(`Unknown contrast algorithm: ${r}`)}function dg(n){let[e,t,r]=Nd(n,xr),i=e+15*t+3*r;return[4*e/i,9*t/i]}function DN(n){let[e,t,r]=Nd(n,xr),i=e+t+r;return[e/i,t/i]}function aY(n){Object.defineProperty(n.prototype,"uv",{get(){return dg(this)}}),Object.defineProperty(n.prototype,"xy",{get(){return DN(this)}})}var oY=Object.freeze({__proto__:null,register:aY,uv:dg,xy:DN});function Sh(n,e,t={}){Md(t)&&(t={method:t});let{method:r=pi.deltaE,...i}=t;for(let s in Mc)if("deltae"+r.toLowerCase()===s.toLowerCase())return Mc[s](n,e,i);throw new TypeError(`Unknown deltaE method: ${r}`)}function lY(n,e=.25){let r=[Ne.get("oklch","lch"),"l"];return Zs(n,r,i=>i*(1+e))}function cY(n,e=.25){let r=[Ne.get("oklch","lch"),"l"];return Zs(n,r,i=>i*(1-e))}var uY=Object.freeze({__proto__:null,darken:cY,lighten:lY});function jN(n,e,t=.5,r={}){return[n,e]=[Je(n),Je(e)],Da(t)==="object"&&([t,r]=[.5,t]),Id(n,e,r)(t)}function BN(n,e,t={}){let r;sv(n)&&([r,t]=[n,e],[n,e]=r.rangeArgs.colors);let{maxDeltaE:i,deltaEMethod:s,steps:o=2,maxSteps:c=1e3,...u}=t;r||([n,e]=[Je(n),Je(e)],r=Id(n,e,u));let d=Sh(n,e),f=i>0?Math.max(o,Math.ceil(d/i)+1):o,p=[];if(c!==void 0&&(f=Math.min(f,c)),f===1)p=[{p:.5,color:r(.5)}];else{let y=1/(f-1);p=Array.from({length:f},(b,_)=>{let w=_*y;return{p:w,color:r(w)}})}if(i>0){let y=p.reduce((b,_,w)=>{if(w===0)return 0;let S=Sh(_.color,p[w-1].color,s);return Math.max(b,S)},0);for(;y>i;){y=0;for(let b=1;b<p.length&&p.length<c;b++){let _=p[b-1],w=p[b],S=(w.p+_.p)/2,A=r(S);y=Math.max(y,Sh(A,_.color),Sh(A,w.color)),p.splice(b,0,{p:S,color:r(S)}),b++}}}return p=p.map(y=>y.color),p}function Id(n,e,t={}){if(sv(n)){let[u,d]=[n,e];return Id(...u.rangeArgs.colors,{...u.rangeArgs.options,...d})}let{space:r,outputSpace:i,progression:s,premultiplied:o}=t;n=Je(n),e=Je(e),n=Ec(n),e=Ec(e);let c={colors:[n,e],options:t};if(r?r=Ne.get(r):r=Ne.registry[pi.interpolationSpace]||n.space,i=i?Ne.get(i):r,n=gn(n,r),e=gn(e,r),n=Va(n),e=Va(e),r.coords.h&&r.coords.h.type==="angle"){let u=t.hue=t.hue||"shorter",d=[r,"h"],[f,p]=[di(n,d),di(e,d)];isNaN(f)&&!isNaN(p)?f=p:isNaN(p)&&!isNaN(f)&&(p=f),[f,p]=HV(u,[f,p]),Zs(n,d,f),Zs(e,d,p)}return o&&(n.coords=n.coords.map(u=>u*n.alpha),e.coords=e.coords.map(u=>u*e.alpha)),Object.assign(u=>{u=s?s(u):u;let d=n.coords.map((y,b)=>{let _=e.coords[b];return cd(y,_,u)}),f=cd(n.alpha,e.alpha,u),p={space:r,coords:d,alpha:f};return o&&(p.coords=p.coords.map(y=>y/f)),i!==r&&(p=gn(p,i)),p},{rangeArgs:c})}function sv(n){return Da(n)==="function"&&!!n.rangeArgs}pi.interpolationSpace="lab";function hY(n){n.defineFunction("mix",jN,{returns:"color"}),n.defineFunction("range",Id,{returns:"function<color>"}),n.defineFunction("steps",BN,{returns:"array<color>"})}var dY=Object.freeze({__proto__:null,isRange:sv,mix:jN,range:Id,register:hY,steps:BN}),ON=new Ne({id:"hsl",name:"HSL",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:Nc,fromBase:n=>{let e=Math.max(...n),t=Math.min(...n),[r,i,s]=n,[o,c,u]=[NaN,0,(t+e)/2],d=e-t;if(d!==0){switch(c=u===0||u===1?0:(e-u)/Math.min(u,1-u),e){case r:o=(i-s)/d+(i<s?6:0);break;case i:o=(s-r)/d+2;break;case s:o=(r-i)/d+4}o=o*60}return c<0&&(o+=180,c=Math.abs(c)),o>=360&&(o-=360),[o,c*100,u*100]},toBase:n=>{let[e,t,r]=n;e=e%360,e<0&&(e+=360),t/=100,r/=100;function i(s){let o=(s+e/30)%12,c=t*Math.min(r,1-r);return r-c*Math.max(-1,Math.min(o-3,9-o,1))}return[i(0),i(8),i(4)]},formats:{hsl:{coords:["<number> | <angle>","<percentage>","<percentage>"]},hsla:{coords:["<number> | <angle>","<percentage>","<percentage>"],commas:!0,lastAlpha:!0}}}),LN=new Ne({id:"hsv",name:"HSV",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},v:{range:[0,100],name:"Value"}},base:ON,fromBase(n){let[e,t,r]=n;t/=100,r/=100;let i=r+t*Math.min(r,1-r);return[e,i===0?0:200*(1-r/i),100*i]},toBase(n){let[e,t,r]=n;t/=100,r/=100;let i=r*(1-t/2);return[e,i===0||i===1?0:(r-i)/Math.min(i,1-i)*100,i*100]},formats:{color:{id:"--hsv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),fY=new Ne({id:"hwb",name:"HWB",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},w:{range:[0,100],name:"Whiteness"},b:{range:[0,100],name:"Blackness"}},base:LN,fromBase(n){let[e,t,r]=n;return[e,r*(100-t)/100,100-r]},toBase(n){let[e,t,r]=n;t/=100,r/=100;let i=t+r;if(i>=1){let c=t/i;return[e,0,c*100]}let s=1-r,o=s===0?0:1-t/s;return[e,o*100,s*100]},formats:{hwb:{coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}});const mY=[[.5766690429101305,.1855582379065463,.1882286462349947],[.29734497525053605,.6273635662554661,.07529145849399788],[.02703136138641234,.07068885253582723,.9913375368376388]],pY=[[2.0415879038107465,-.5650069742788596,-.34473135077832956],[-.9692436362808795,1.8759675015077202,.04155505740717557],[.013444280632031142,-.11836239223101838,1.0151749943912054]];var zN=new Qr({id:"a98rgb-linear",cssId:"--a98-rgb-linear",name:"Linear Adobe 98 RGB compatible",white:"D65",toXYZ_M:mY,fromXYZ_M:pY}),gY=new Qr({id:"a98rgb",cssId:"a98-rgb",name:"Adobe 98 RGB compatible",base:zN,toBase:n=>n.map(e=>Math.pow(Math.abs(e),563/256)*Math.sign(e)),fromBase:n=>n.map(e=>Math.pow(Math.abs(e),256/563)*Math.sign(e))});const yY=[[.7977666449006423,.13518129740053308,.0313477341283922],[.2880748288194013,.711835234241873,8993693872564e-17],[0,0,.8251046025104602]],bY=[[1.3457868816471583,-.25557208737979464,-.05110186497554526],[-.5446307051249019,1.5082477428451468,.02052744743642139],[0,0,1.2119675456389452]];var UN=new Qr({id:"prophoto-linear",cssId:"--prophoto-rgb-linear",name:"Linear ProPhoto",white:"D50",base:nv,toXYZ_M:yY,fromXYZ_M:bY});const xY=1/512,vY=16/512;var _Y=new Qr({id:"prophoto",cssId:"prophoto-rgb",name:"ProPhoto",base:UN,toBase(n){return n.map(e=>e<vY?e/16:e**1.8)},fromBase(n){return n.map(e=>e>=xY?e**(1/1.8):16*e)}}),wY=new Ne({id:"oklch",name:"Oklch",coords:{l:{refRange:[0,1],name:"Lightness"},c:{refRange:[0,.4],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},white:"D65",base:Tc,fromBase(n){let[e,t,r]=n,i;const s=2e-4;return Math.abs(t)<s&&Math.abs(r)<s?i=NaN:i=Math.atan2(r,t)*180/Math.PI,[e,Math.sqrt(t**2+r**2),ys(i)]},toBase(n){let[e,t,r]=n,i,s;return isNaN(r)?(i=0,s=0):(i=t*Math.cos(r*Math.PI/180),s=t*Math.sin(r*Math.PI/180)),[e,i,s]},formats:{oklch:{coords:["<percentage> | <number>","<number> | <percentage>[0,1]","<number> | <angle>"]}}});let FN=Nr.D65;const SY=216/24389,tT=24389/27,[nT,rT]=dg({space:xr,coords:FN});var GN=new Ne({id:"luv",name:"Luv",coords:{l:{refRange:[0,100],name:"Lightness"},u:{refRange:[-215,215]},v:{refRange:[-215,215]}},white:FN,base:xr,fromBase(n){let e=[Zn(n[0]),Zn(n[1]),Zn(n[2])],t=e[1],[r,i]=dg({space:xr,coords:e});if(!Number.isFinite(r)||!Number.isFinite(i))return[0,0,0];let s=t<=SY?tT*t:116*Math.cbrt(t)-16;return[s,13*s*(r-nT),13*s*(i-rT)]},toBase(n){let[e,t,r]=n;if(e===0||Ga(e))return[0,0,0];t=Zn(t),r=Zn(r);let i=t/(13*e)+nT,s=r/(13*e)+rT,o=e<=8?e/tT:Math.pow((e+16)/116,3);return[o*(9*i/(4*s)),o,o*((12-3*i-20*s)/(4*s))]},formats:{color:{id:"--luv",coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),av=new Ne({id:"lchuv",name:"LChuv",coords:{l:{refRange:[0,100],name:"Lightness"},c:{refRange:[0,220],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:GN,fromBase(n){let[e,t,r]=n,i;const s=.02;return Math.abs(t)<s&&Math.abs(r)<s?i=NaN:i=Math.atan2(r,t)*180/Math.PI,[e,Math.sqrt(t**2+r**2),ys(i)]},toBase(n){let[e,t,r]=n;return t<0&&(t=0),isNaN(r)&&(r=0),[e,t*Math.cos(r*Math.PI/180),t*Math.sin(r*Math.PI/180)]},formats:{color:{id:"--lchuv",coords:["<number> | <percentage>","<number> | <percentage>","<number> | <angle>"]}}});const AY=216/24389,CY=24389/27,iT=nr[0][0],sT=nr[0][1],Tb=nr[0][2],aT=nr[1][0],oT=nr[1][1],Eb=nr[1][2],lT=nr[2][0],cT=nr[2][1],Mb=nr[2][2];function Xl(n,e,t){const r=e/(Math.sin(t)-n*Math.cos(t));return r<0?1/0:r}function Bp(n){const e=Math.pow(n+16,3)/1560896,t=e>AY?e:n/CY,r=t*(284517*iT-94839*Tb),i=t*(838422*Tb+769860*sT+731718*iT),s=t*(632260*Tb-126452*sT),o=t*(284517*aT-94839*Eb),c=t*(838422*Eb+769860*oT+731718*aT),u=t*(632260*Eb-126452*oT),d=t*(284517*lT-94839*Mb),f=t*(838422*Mb+769860*cT+731718*lT),p=t*(632260*Mb-126452*cT);return{r0s:r/s,r0i:i*n/s,r1s:r/(s+126452),r1i:(i-769860)*n/(s+126452),g0s:o/u,g0i:c*n/u,g1s:o/(u+126452),g1i:(c-769860)*n/(u+126452),b0s:d/p,b0i:f*n/p,b1s:d/(p+126452),b1i:(f-769860)*n/(p+126452)}}function uT(n,e){const t=e/360*Math.PI*2,r=Xl(n.r0s,n.r0i,t),i=Xl(n.r1s,n.r1i,t),s=Xl(n.g0s,n.g0i,t),o=Xl(n.g1s,n.g1i,t),c=Xl(n.b0s,n.b0i,t),u=Xl(n.b1s,n.b1i,t);return Math.min(r,i,s,o,c,u)}var kY=new Ne({id:"hsluv",name:"HSLuv",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:av,gamutSpace:Nc,fromBase(n){let[e,t,r]=[Zn(n[0]),Zn(n[1]),Zn(n[2])],i;if(e>99.9999999)i=0,e=100;else if(e<1e-8)i=0,e=0;else{let s=Bp(e),o=uT(s,r);i=t/o*100}return[r,i,e]},toBase(n){let[e,t,r]=[Zn(n[0]),Zn(n[1]),Zn(n[2])],i;if(r>99.9999999)r=100,i=0;else if(r<1e-8)r=0,i=0;else{let s=Bp(r);i=uT(s,e)/100*t}return[r,i,e]},formats:{color:{id:"--hsluv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}});nr[0][0];nr[0][1];nr[0][2];nr[1][0];nr[1][1];nr[1][2];nr[2][0];nr[2][1];nr[2][2];function Kl(n,e){return Math.abs(e)/Math.sqrt(Math.pow(n,2)+1)}function hT(n){let e=Kl(n.r0s,n.r0i),t=Kl(n.r1s,n.r1i),r=Kl(n.g0s,n.g0i),i=Kl(n.g1s,n.g1i),s=Kl(n.b0s,n.b0i),o=Kl(n.b1s,n.b1i);return Math.min(e,t,r,i,s,o)}var TY=new Ne({id:"hpluv",name:"HPLuv",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:av,gamutSpace:"self",fromBase(n){let[e,t,r]=[Zn(n[0]),Zn(n[1]),Zn(n[2])],i;if(e>99.9999999)i=0,e=100;else if(e<1e-8)i=0,e=0;else{let s=Bp(e),o=hT(s);i=t/o*100}return[r,i,e]},toBase(n){let[e,t,r]=[Zn(n[0]),Zn(n[1]),Zn(n[2])],i;if(r>99.9999999)r=100,i=0;else if(r<1e-8)r=0,i=0;else{let s=Bp(r);i=hT(s)/100*t}return[r,i,e]},formats:{color:{id:"--hpluv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}});const dT=203,fT=2610/2**14,EY=2**14/2610,MY=2523/2**5,mT=2**5/2523,pT=3424/2**12,gT=2413/2**7,yT=2392/2**7;var NY=new Qr({id:"rec2100pq",cssId:"rec2100-pq",name:"REC.2100-PQ",base:hg,toBase(n){return n.map(function(e){return(Math.max(e**mT-pT,0)/(gT-yT*e**mT))**EY*1e4/dT})},fromBase(n){return n.map(function(e){let t=Math.max(e*dT/1e4,0),r=pT+gT*t**fT,i=1+yT*t**fT;return(r/i)**MY})}});const bT=.17883277,xT=.28466892,vT=.55991073,Nb=3.7743;var IY=new Qr({id:"rec2100hlg",cssId:"rec2100-hlg",name:"REC.2100-HLG",referred:"scene",base:hg,toBase(n){return n.map(function(e){return e<=.5?e**2/3*Nb:(Math.exp((e-vT)/bT)+xT)/12*Nb})},fromBase(n){return n.map(function(e){return e/=Nb,e<=1/12?Math.sqrt(3*e):bT*Math.log(12*e-xT)+vT})}});const HN={};Ha.add("chromatic-adaptation-start",n=>{n.options.method&&(n.M=VN(n.W1,n.W2,n.options.method))});Ha.add("chromatic-adaptation-end",n=>{n.M||(n.M=VN(n.W1,n.W2,n.options.method))});function fg({id:n,toCone_M:e,fromCone_M:t}){HN[n]=arguments[0]}function VN(n,e,t="Bradford"){let r=HN[t],[i,s,o]=yn(r.toCone_M,n),[c,u,d]=yn(r.toCone_M,e),f=[[c/i,0,0],[0,u/s,0],[0,0,d/o]],p=yn(f,r.toCone_M);return yn(r.fromCone_M,p)}fg({id:"von Kries",toCone_M:[[.40024,.7076,-.08081],[-.2263,1.16532,.0457],[0,0,.91822]],fromCone_M:[[1.8599363874558397,-1.1293816185800916,.21989740959619328],[.3611914362417676,.6388124632850422,-6370596838649899e-21],[0,0,1.0890636230968613]]});fg({id:"Bradford",toCone_M:[[.8951,.2664,-.1614],[-.7502,1.7135,.0367],[.0389,-.0685,1.0296]],fromCone_M:[[.9869929054667121,-.14705425642099013,.15996265166373122],[.4323052697233945,.5183602715367774,.049291228212855594],[-.00852866457517732,.04004282165408486,.96848669578755]]});fg({id:"CAT02",toCone_M:[[.7328,.4296,-.1624],[-.7036,1.6975,.0061],[.003,.0136,.9834]],fromCone_M:[[1.0961238208355142,-.27886900021828726,.18274517938277307],[.4543690419753592,.4735331543074117,.07209780371722911],[-.009627608738429355,-.00569803121611342,1.0153256399545427]]});fg({id:"CAT16",toCone_M:[[.401288,.650173,-.051461],[-.250268,1.204414,.045854],[-.002079,.048952,.953127]],fromCone_M:[[1.862067855087233,-1.0112546305316845,.14918677544445172],[.3875265432361372,.6214474419314753,-.008973985167612521],[-.01584149884933386,-.03412293802851557,1.0499644368778496]]});Object.assign(Nr,{A:[1.0985,1,.35585],C:[.98074,1,1.18232],D55:[.95682,1,.92149],D75:[.94972,1,1.22638],E:[1,1,1],F2:[.99186,1,.67393],F7:[.95041,1,1.08747],F11:[1.00962,1,.6435]});Nr.ACES=[.32168/.33767,1,(1-.32168-.33767)/.33767];const RY=[[.6624541811085053,.13400420645643313,.1561876870049078],[.27222871678091454,.6740817658111484,.05368951740793705],[-.005574649490394108,.004060733528982826,1.0103391003129971]],PY=[[1.6410233796943257,-.32480329418479,-.23642469523761225],[-.6636628587229829,1.6153315916573379,.016756347685530137],[.011721894328375376,-.008284441996237409,.9883948585390215]];var WN=new Qr({id:"acescg",cssId:"--acescg",name:"ACEScg",coords:{r:{range:[0,65504],name:"Red"},g:{range:[0,65504],name:"Green"},b:{range:[0,65504],name:"Blue"}},referred:"scene",white:Nr.ACES,toXYZ_M:RY,fromXYZ_M:PY});const Cm=2**-16,Ib=-.35828683,km=(Math.log2(65504)+9.72)/17.52;var DY=new Qr({id:"acescc",cssId:"--acescc",name:"ACEScc",coords:{r:{range:[Ib,km],name:"Red"},g:{range:[Ib,km],name:"Green"},b:{range:[Ib,km],name:"Blue"}},referred:"scene",base:WN,toBase(n){const e=-.3013698630136986;return n.map(function(t){return t<=e?(2**(t*17.52-9.72)-Cm)*2:t<km?2**(t*17.52-9.72):65504})},fromBase(n){return n.map(function(e){return e<=0?(Math.log2(Cm)+9.72)/17.52:e<Cm?(Math.log2(Cm+e*.5)+9.72)/17.52:(Math.log2(e)+9.72)/17.52})}}),_T=Object.freeze({__proto__:null,A98RGB:gY,A98RGB_Linear:zN,ACEScc:DY,ACEScg:WN,CAM16_JMh:wW,HCT:hd,HPLuv:TY,HSL:ON,HSLuv:kY,HSV:LN,HWB:fY,ICTCP:_1,JzCzHz:v1,Jzazbz:xN,LCH:ud,LCHuv:av,Lab:fi,Lab_D65:A1,Luv:GN,OKLCH:wY,OKLab:Tc,P3:RN,P3_Linear:NN,ProPhoto:_Y,ProPhoto_Linear:UN,REC_2020:MN,REC_2020_Linear:hg,REC_2100_HLG:IY,REC_2100_PQ:NY,XYZ_ABS_D65:rv,XYZ_D50:nv,XYZ_D65:xr,sRGB:Nc,sRGB_Linear:IN});let gi=class Vr{constructor(...e){let t;e.length===1&&(t=Je(e[0]));let r,i,s;t?(r=t.space||t.spaceId,i=t.coords,s=t.alpha):[r,i,s]=e,Object.defineProperty(this,"space",{value:Ne.get(r),writable:!1,enumerable:!0,configurable:!0}),this.coords=i?i.slice():[0,0,0],this.alpha=s>1||s===void 0?1:s<0?0:s;for(let o=0;o<this.coords.length;o++)this.coords[o]==="NaN"&&(this.coords[o]=NaN);for(let o in this.space.coords)Object.defineProperty(this,o,{get:()=>this.get(o),set:c=>this.set(o,c)})}get spaceId(){return this.space.id}clone(){return new Vr(this.space,this.coords,this.alpha)}toJSON(){return{spaceId:this.spaceId,coords:this.coords,alpha:this.alpha}}display(...e){let t=LW(this,...e);return t.color=new Vr(t.color),t}static get(e,...t){return e instanceof Vr?e:new Vr(e,...t)}static defineFunction(e,t,r=t){let{instance:i=!0,returns:s}=r,o=function(...c){let u=t(...c);if(s==="color")u=Vr.get(u);else if(s==="function<color>"){let d=u;u=function(...f){let p=d(...f);return Vr.get(p)},Object.assign(u,d)}else s==="array<color>"&&(u=u.map(d=>Vr.get(d)));return u};e in Vr||(Vr[e]=o),i&&(Vr.prototype[e]=function(...c){return o(this,...c)})}static defineFunctions(e){for(let t in e)Vr.defineFunction(t,e[t],e[t])}static extend(e){if(e.register)e.register(Vr);else for(let t in e)Vr.defineFunction(t,e[t])}};gi.defineFunctions({get:di,getAll:Nd,set:Zs,setAll:tv,to:gn,equals:zW,inGamut:Lo,toGamut:Va,distance:bN,toString:Gh});Object.assign(gi,{util:OV,hooks:Ha,WHITES:Nr,Space:Ne,spaces:Ne.registry,parse:gN,defaults:pi});for(let n of Object.keys(_T))Ne.register(_T[n]);for(let n in Ne.registry)C1(n,Ne.registry[n]);Ha.add("colorspace-init-end",n=>{C1(n.id,n),n.aliases?.forEach(e=>{C1(e,n)})});function C1(n,e){let t=n.replace(/-/g,"_");Object.defineProperty(gi.prototype,t,{get(){let r=this.getAll(n);return typeof Proxy>"u"?r:new Proxy(r,{has:(i,s)=>{try{return Ne.resolveCoord([e,s]),!0}catch{}return Reflect.has(i,s)},get:(i,s,o)=>{if(s&&typeof s!="symbol"&&!(s in i)){let{index:c}=Ne.resolveCoord([e,s]);if(c>=0)return i[c]}return Reflect.get(i,s,o)},set:(i,s,o,c)=>{if(s&&typeof s!="symbol"&&!(s in i)||s>=0){let{index:u}=Ne.resolveCoord([e,s]);if(u>=0)return i[u]=o,this.setAll(n,i),!0}return Reflect.set(i,s,o,c)}})},set(r){this.setAll(n,r)},configurable:!0,enumerable:!0})}gi.extend(Mc);gi.extend({deltaE:Sh});Object.assign(gi,{deltaEMethods:Mc});gi.extend(uY);gi.extend({contrast:sY});gi.extend(oY);gi.extend(FW);gi.extend(dY);gi.extend(cp);Ed([lN]);Ed([sN]);const jY=j({h:0,s:82,l:56}),BY=j({h:224,s:100,l:58}),OY=j({h:172,s:66,l:50}),LY=j({h:271,s:81,l:56}),zY=j({h:45,s:93,l:47}),UY=j({h:25,s:95,l:53}),FY=j({h:128,s:49,l:50}),GY=j({h:36,s:10,l:80}),HY=Jo(jY),VY=Jo(BY),WY=Jo(OY),YY=Jo(LY),$Y=Jo(zY),qY=Jo(UY),ZY=Jo(FY),XY=[j(GY)];function Jo(n){const{h:e,s:t,l:r}=n.toHsl(),i=64;return Array.from({length:i},(s,o)=>{const c=o/(i-1),u=t*(1-.3*c),d=Math.min(100,r+c*30);return j({h:e,s:u,l:d})})}const wT=[j({r:230,g:100,b:100}),j({r:100,g:180,b:230}),j({r:230,g:180,b:80}),j({r:180,g:100,b:230}),j({r:80,g:200,b:120}),j({r:230,g:130,b:180}),j({r:100,g:160,b:80}),j({r:230,g:150,b:100}),j({r:80,g:130,b:190}),j({r:210,g:210,b:100}),j({r:190,g:100,b:130}),j({r:100,g:210,b:210}),j({r:210,g:140,b:80}),j({r:150,g:110,b:190}),j({r:180,g:210,b:120}),j({r:210,g:100,b:160}),j({r:100,g:140,b:110}),j({r:230,g:180,b:180}),j({r:120,g:120,b:190}),j({r:190,g:170,b:100}),j({r:100,g:180,b:160}),j({r:210,g:160,b:200}),j({r:170,g:190,b:100}),j({r:100,g:130,b:150}),j({r:230,g:140,b:140}),j({r:140,g:180,b:220}),j({r:200,g:160,b:110}),j({r:180,g:130,b:180}),j({r:130,g:200,b:130}),j({r:220,g:120,b:120}),j({r:120,g:160,b:200}),j({r:200,g:200,b:140}),j({r:160,g:120,b:160}),j({r:140,g:180,b:140}),j({r:200,g:130,b:110}),j({r:130,g:170,b:190}),j({r:190,g:180,b:160}),j({r:170,g:140,b:190}),j({r:160,g:190,b:160}),j({r:190,g:150,b:130}),j({r:140,g:150,b:180}),j({r:180,g:170,b:140}),j({r:150,g:130,b:150}),j({r:170,g:190,b:180}),j({r:190,g:140,b:150}),j({r:130,g:180,b:170}),j({r:180,g:160,b:180}),j({r:160,g:180,b:140}),j({r:170,g:150,b:170}),j({r:100,g:180,b:230}),j({r:230,g:180,b:80}),j({r:180,g:100,b:230}),j({r:80,g:200,b:120}),j({r:230,g:130,b:180}),j({r:100,g:160,b:80}),j({r:230,g:150,b:100}),j({r:80,g:130,b:190}),j({r:210,g:210,b:100}),j({r:190,g:100,b:130}),j({r:100,g:210,b:210}),j({r:210,g:140,b:80}),j({r:150,g:110,b:190}),j({r:180,g:210,b:120}),j({r:210,g:100,b:160}),j({r:100,g:140,b:110}),j({r:230,g:180,b:180}),j({r:120,g:120,b:190}),j({r:190,g:170,b:100}),j({r:100,g:180,b:160}),j({r:210,g:160,b:200}),j({r:170,g:190,b:100}),j({r:100,g:130,b:150}),j({r:230,g:140,b:140}),j({r:140,g:180,b:220}),j({r:200,g:160,b:110}),j({r:180,g:130,b:180}),j({r:130,g:200,b:130}),j({r:220,g:120,b:120}),j({r:120,g:160,b:200}),j({r:200,g:200,b:140}),j({r:160,g:120,b:160}),j({r:140,g:180,b:140}),j({r:200,g:130,b:110}),j({r:130,g:170,b:190}),j({r:190,g:180,b:160}),j({r:170,g:140,b:190}),j({r:160,g:190,b:160}),j({r:190,g:150,b:130}),j({r:140,g:150,b:180}),j({r:180,g:170,b:140}),j({r:150,g:130,b:150}),j({r:170,g:190,b:180}),j({r:190,g:140,b:150}),j({r:130,g:180,b:170}),j({r:180,g:160,b:180}),j({r:160,g:180,b:140}),j({r:170,g:150,b:170})],ST=[j({r:16,g:185,b:129}),j({r:34,g:197,b:94}),j({r:45,g:212,b:191}),j({r:48,g:178,b:180}),j({r:52,g:211,b:153}),j({r:56,g:189,b:248}),j({r:59,g:130,b:246}),j({r:67,g:190,b:84}),j({r:74,g:222,b:128}),j({r:79,g:70,b:229}),j({r:82,g:183,b:136}),j({r:96,g:165,b:250}),j({r:99,g:202,b:253}),j({r:110,g:231,b:183}),j({r:124,g:58,b:237}),j({r:125,g:211,b:252}),j({r:132,g:204,b:22}),j({r:133,g:77,b:14}),j({r:134,g:239,b:172}),j({r:147,g:51,b:234}),j({r:147,g:197,b:253}),j({r:151,g:255,b:187}),j({r:163,g:230,b:53}),j({r:167,g:139,b:250}),j({r:168,g:85,b:247}),j({r:179,g:136,b:255}),j({r:186,g:255,b:201}),j({r:190,g:92,b:251}),j({r:192,g:132,b:252}),j({r:202,g:138,b:4}),j({r:202,g:225,b:255}),j({r:204,g:204,b:255}),j({r:217,g:70,b:239}),j({r:220,g:38,b:38}),j({r:220,g:220,b:255}),j({r:220,g:240,b:250}),j({r:230,g:250,b:210}),j({r:230,g:255,b:250}),j({r:233,g:213,b:255}),j({r:234,g:88,b:12}),j({r:234,g:179,b:8}),j({r:235,g:75,b:75}),j({r:236,g:72,b:153}),j({r:239,g:68,b:68}),j({r:240,g:171,b:252}),j({r:240,g:240,b:200}),j({r:244,g:114,b:182}),j({r:245,g:101,b:101}),j({r:245,g:158,b:11}),j({r:248,g:113,b:113}),j({r:249,g:115,b:22}),j({r:250,g:215,b:225}),j({r:250,g:250,b:210}),j({r:251,g:113,b:133}),j({r:251,g:146,b:60}),j({r:251,g:191,b:36}),j({r:251,g:235,b:245}),j({r:252,g:165,b:165}),j({r:252,g:211,b:77}),j({r:253,g:164,b:175}),j({r:255,g:204,b:229}),j({r:255,g:223,b:186}),j({r:255,g:240,b:200})],AT=[j({r:190,g:120,b:120}),j({r:120,g:160,b:190}),j({r:190,g:160,b:100}),j({r:160,g:120,b:190}),j({r:100,g:170,b:130}),j({r:190,g:130,b:160}),j({r:120,g:150,b:100}),j({r:190,g:140,b:120}),j({r:100,g:120,b:160}),j({r:170,g:170,b:120}),j({r:160,g:120,b:130}),j({r:120,g:170,b:170}),j({r:170,g:140,b:100}),j({r:140,g:120,b:160}),j({r:150,g:170,b:130}),j({r:170,g:120,b:140}),j({r:120,g:140,b:120}),j({r:180,g:160,b:160}),j({r:130,g:130,b:160}),j({r:160,g:150,b:120}),j({r:120,g:160,b:150}),j({r:170,g:150,b:170}),j({r:150,g:160,b:120}),j({r:120,g:130,b:140}),j({r:180,g:140,b:140}),j({r:140,g:160,b:170}),j({r:170,g:150,b:130}),j({r:160,g:130,b:160}),j({r:130,g:170,b:130}),j({r:170,g:130,b:130}),j({r:130,g:150,b:170}),j({r:170,g:170,b:140}),j({r:150,g:130,b:150}),j({r:140,g:160,b:140}),j({r:170,g:130,b:120}),j({r:130,g:150,b:160}),j({r:160,g:160,b:150}),j({r:150,g:140,b:160}),j({r:150,g:170,b:150}),j({r:160,g:140,b:130}),j({r:140,g:150,b:160}),j({r:160,g:150,b:140}),j({r:140,g:130,b:140}),j({r:150,g:160,b:160}),j({r:160,g:140,b:150}),j({r:130,g:160,b:150}),j({r:160,g:150,b:160}),j({r:150,g:160,b:140}),j({r:150,g:140,b:150})],CT=[j({r:0,g:5,b:0}),j({r:0,g:15,b:0}),j({r:0,g:25,b:0}),j({r:0,g:35,b:0}),j({r:0,g:45,b:0}),j({r:0,g:55,b:0}),j({r:0,g:65,b:0}),j({r:0,g:75,b:0}),j({r:0,g:85,b:0}),j({r:0,g:95,b:0}),j({r:0,g:105,b:0}),j({r:0,g:115,b:0}),j({r:0,g:125,b:0}),j({r:0,g:135,b:0}),j({r:0,g:145,b:0}),j({r:0,g:155,b:0}),j({r:0,g:165,b:0}),j({r:0,g:175,b:0}),j({r:0,g:185,b:0}),j({r:0,g:195,b:5}),j({r:0,g:205,b:10}),j({r:0,g:215,b:15}),j({r:0,g:225,b:20}),j({r:0,g:235,b:25}),j({r:0,g:245,b:30}),j({r:0,g:255,b:35}),j({r:10,g:255,b:45}),j({r:20,g:255,b:55}),j({r:30,g:255,b:65}),j({r:40,g:255,b:75}),j({r:50,g:255,b:85}),j({r:60,g:255,b:95}),j({r:70,g:255,b:105}),j({r:80,g:255,b:115}),j({r:90,g:255,b:125}),j({r:100,g:255,b:135}),j({r:110,g:255,b:145}),j({r:120,g:255,b:155}),j({r:130,g:255,b:165}),j({r:140,g:255,b:175}),j({r:150,g:200,b:255}),j({r:150,g:255,b:185}),j({r:160,g:215,b:255}),j({r:160,g:255,b:195}),j({r:170,g:190,b:255}),j({r:170,g:225,b:255}),j({r:170,g:255,b:205}),j({r:180,g:180,b:255}),j({r:180,g:235,b:250}),j({r:180,g:255,b:215}),j({r:190,g:140,b:195}),j({r:190,g:245,b:240}),j({r:190,g:255,b:225}),j({r:195,g:145,b:200}),j({r:200,g:150,b:205}),j({r:200,g:170,b:255}),j({r:200,g:255,b:215}),j({r:200,g:255,b:235}),j({r:205,g:155,b:210}),j({r:210,g:160,b:215}),j({r:210,g:255,b:245}),j({r:215,g:165,b:220}),j({r:215,g:255,b:200}),j({r:220,g:160,b:255}),j({r:220,g:170,b:225}),j({r:220,g:255,b:255}),j({r:225,g:175,b:230}),j({r:225,g:255,b:175}),j({r:230,g:180,b:235}),j({r:230,g:250,b:255}),j({r:235,g:150,b:255}),j({r:235,g:185,b:240}),j({r:240,g:190,b:245}),j({r:240,g:240,b:255}),j({r:240,g:250,b:160}),j({r:245,g:160,b:240}),j({r:245,g:195,b:250}),j({r:245,g:245,b:175}),j({r:250,g:200,b:255}),j({r:250,g:230,b:255}),j({r:255,g:170,b:225}),j({r:255,g:185,b:215}),j({r:255,g:195,b:235}),j({r:255,g:200,b:220}),j({r:255,g:205,b:245}),j({r:255,g:205,b:255}),j({r:255,g:210,b:230}),j({r:255,g:210,b:250}),j({r:255,g:210,b:255}),j({r:255,g:215,b:195}),j({r:255,g:215,b:245}),j({r:255,g:220,b:235}),j({r:255,g:220,b:250}),j({r:255,g:225,b:180}),j({r:255,g:225,b:255}),j({r:255,g:230,b:245}),j({r:255,g:235,b:200}),j({r:255,g:235,b:235}),j({r:255,g:240,b:220}),j({r:255,g:245,b:210})];Ed([lN]);Ed([sN]);class Tm{constructor(e,t){this.assigned=new Map,this.teamPlayerColors=new Map,this.availableColors=[...e],this.fallbackColors=[...e,...t]}getTeamColorVariations(e){switch(e){case Sa.Blue:return VY;case Sa.Red:return HY;case Sa.Teal:return WY;case Sa.Purple:return YY;case Sa.Yellow:return $Y;case Sa.Orange:return qY;case Sa.Green:return ZY;case Sa.Bot:return XY;default:return[this.assignColor(e)]}}assignColor(e){if(this.assigned.has(e))return this.assigned.get(e);this.availableColors.length===0&&(this.availableColors=[...this.fallbackColors]);let t=0;if(this.assigned.size===0||this.assigned.size>50)t=new ld(Cp(e)).nextInt(0,this.availableColors.length);else{const i=Array.from(this.assigned.values());t=KY(this.availableColors,i)??0}const r=this.availableColors.splice(t,1)[0];return this.assigned.set(e,r),r}assignTeamColor(e){return this.getTeamColorVariations(e)[0]}assignTeamPlayerColor(e,t){if(this.teamPlayerColors.has(t))return this.teamPlayerColors.get(t);const r=this.getTeamColorVariations(e),s=Cp(t)%r.length,o=r[s];return this.teamPlayerColors.set(t,o),o}}function KY(n,e){if(e.length===0)throw new Error("No assigned colors");const t=e.map(kT);let r=0,i=0;for(let s=0;s<n.length;s++){const o=n[s],c=QY(kT(o),t);c>r&&(r=c,i=s)}return i}function QY(n,e){return e.reduce((t,r)=>Math.min(t,JY(n,r)),1/0)}function JY(n,e){return n.deltaE(e,"2000")}function kT(n){const e=n.toLab();return new gi("lab",[e.l,e.a,e.b])}class YN{constructor(){this.borderColorCache=new Map,this.rand=new ld(123),this.humanColorAllocator=new Tm(ST,CT),this.botColorAllocator=new Tm(AT,AT),this.teamColorAllocator=new Tm(ST,CT),this.nationColorAllocator=new Tm(wT,wT),this.background=j({r:27,g:35,b:48}),this.shore=j({r:204,g:203,b:158}),this.falloutColors=[j({r:120,g:255,b:71}),j({r:130,g:255,b:85}),j({r:110,g:245,b:65}),j({r:125,g:255,b:75}),j({r:115,g:250,b:68})],this.water=j({r:70,g:132,b:180}),this.shorelineWater=j({r:100,g:143,b:255}),this._selfColor=j({r:0,g:255,b:0}),this._allyColor=j({r:255,g:255,b:0}),this._neutralColor=j({r:128,g:128,b:128}),this._enemyColor=j({r:255,g:0,b:0}),this._spawnHighlightColor=j({r:255,g:213,b:79})}teamColor(e){return this.teamColorAllocator.assignTeamColor(e)}territoryColor(e){const t=e.team();return t!==null?this.teamColorAllocator.assignTeamPlayerColor(t,e.id()):e.type()===Xt.Human?this.humanColorAllocator.assignColor(e.id()):e.type()===Xt.Bot?this.botColorAllocator.assignColor(e.id()):this.nationColorAllocator.assignColor(e.id())}borderColor(e){return e.darken(.125)}defendedBorderColors(e){return{light:e.darken(.2),dark:e.darken(.4)}}focusedBorderColor(){return j({r:230,g:230,b:230})}textColor(e){return e.type()===Xt.Human?"#000000":"#4D4D4D"}terrainColor(e,t){const r=e.magnitude(t);if(e.isShore(t))return this.shore;switch(e.terrainType(t)){case tr.Ocean:case tr.Lake:{const i=this.water.rgba;return e.isShoreline(t)&&e.isWater(t)?this.shorelineWater:j({r:Math.max(i.r-10+(11-Math.min(r,10)),0),g:Math.max(i.g-10+(11-Math.min(r,10)),0),b:Math.max(i.b-10+(11-Math.min(r,10)),0)})}case tr.Plains:return j({r:190,g:220-2*r,b:138});case tr.Highland:return j({r:200+2*r,g:183+2*r,b:138+2*r});case tr.Mountain:return j({r:230+r/2,g:230+r/2,b:230+r/2})}}backgroundColor(){return this.background}falloutColor(){return this.rand.randElement(this.falloutColors)}font(){return"Overpass, sans-serif"}selfColor(){return this._selfColor}allyColor(){return this._allyColor}neutralColor(){return this._neutralColor}enemyColor(){return this._enemyColor}spawnHighlightColor(){return this._spawnHighlightColor}}class e$ extends YN{constructor(){super(...arguments),this.darkShore=j({r:134,g:133,b:88}),this.darkWater=j({r:14,g:11,b:30}),this.darkShorelineWater=j({r:50,g:50,b:50})}terrainColor(e,t){const r=e.magnitude(t);if(e.isShore(t))return this.darkShore;switch(e.terrainType(t)){case tr.Ocean:case tr.Lake:{const i=this.darkWater.rgba;return e.isShoreline(t)&&e.isWater(t)?this.darkShorelineWater:e.magnitude(t)<10?j({r:Math.max(i.r+9-r,0),g:Math.max(i.g+9-r,0),b:Math.max(i.b+9-r,0)}):this.darkWater}case tr.Plains:return j({r:140,g:170-2*r,b:88});case tr.Highland:return j({r:150+2*r,g:133+2*r,b:88+2*r});case tr.Mountain:return j({r:180+r/2,g:180+r/2,b:180+r/2})}}}var Mr={};const t$=15e4,n$=Math.LN2/5e4,r$=St({keys:St({alg:Ye("EdDSA"),crv:Ye("Ed25519"),kty:Ye("OKP"),x:Et()}).array().min(1)}),i$={[Ee.Africa]:[100,70,50],[Ee.Asia]:[50,40,30],[Ee.Australia]:[70,40,30],[Ee.Baikal]:[100,70,50],[Ee.BetweenTwoSeas]:[70,50,40],[Ee.BlackSea]:[50,30,30],[Ee.Britannia]:[50,30,20],[Ee.DeglaciatedAntarctica]:[50,40,30],[Ee.EastAsia]:[50,30,20],[Ee.Europe]:[100,70,50],[Ee.EuropeClassic]:[50,30,30],[Ee.FalklandIslands]:[50,30,20],[Ee.FaroeIslands]:[20,15,10],[Ee.GatewayToTheAtlantic]:[100,70,50],[Ee.GiantWorldMap]:[100,70,50],[Ee.Halkidiki]:[100,50,40],[Ee.Iceland]:[50,40,30],[Ee.Italia]:[50,30,20],[Ee.Mars]:[70,40,30],[Ee.Mena]:[70,50,40],[Ee.NorthAmerica]:[70,40,30],[Ee.Oceania]:[10,10,10],[Ee.Pangaea]:[20,15,10],[Ee.Pluto]:[100,70,50],[Ee.SouthAmerica]:[70,50,40],[Ee.StraitOfGibraltar]:[100,70,50],[Ee.World]:[50,30,20],[Ee.Yenisei]:[150,100,70],[Ee.GameOfThrones]:[50,30,20]};class ov{allowedFlares(){}stripePublishableKey(){return Mr.STRIPE_PUBLISHABLE_KEY??""}domain(){return Mr.DOMAIN??""}subdomain(){return Mr.SUBDOMAIN??""}cloudflareAccountId(){return Mr.CF_ACCOUNT_ID??""}cloudflareApiToken(){return Mr.CF_API_TOKEN??""}cloudflareConfigPath(){return Mr.CF_CONFIG_PATH??""}cloudflareCredsPath(){return Mr.CF_CREDS_PATH??""}jwtIssuer(){const e=this.jwtAudience();return e==="localhost"?"http://localhost:8787":`https://api.${e}`}async jwkPublicKey(){if(this.publicKey)return this.publicKey;const e=this.jwtIssuer()+"/.well-known/jwks.json";console.log(`Fetching JWKS from ${e}`);const t=await fetch(e),r=r$.safeParse(await t.json());if(!r.success){const i=l4(r.error);throw console.error("Error parsing JWKS",i),new Error("Invalid JWKS")}return this.publicKey=r.data.keys[0],this.publicKey}gitCommit(){return Mr.GIT_COMMIT??""}r2Endpoint(){return`https://${Mr.CF_ACCOUNT_ID}.r2.cloudflarestorage.com`}r2AccessKey(){return Mr.R2_ACCESS_KEY??""}r2SecretKey(){return Mr.R2_SECRET_KEY??""}r2Bucket(){return Mr.R2_BUCKET??""}apiKey(){return Mr.API_KEY??""}adminHeader(){return"x-admin-key"}adminToken(){return Mr.ADMIN_TOKEN??"dummy-admin-token"}turnIntervalMs(){return 100}gameCreationRate(){return 60*1e3}lobbyMaxPlayers(e,t,r){const[i,s,o]=i$[e]??[50,30,20],c=Math.random(),u=c<.3?i:c<.6?s:o;let d=Math.min(t===qn.Team?Math.ceil(u*1.5):u,i);if(r===void 0)return d;switch(r){case Fo:d-=d%2;break;case Go:d-=d%3;break;case Ho:d-=d%4;break;default:d-=d%r;break}return d}workerIndex(e){return Cp(e)%this.numWorkers()}workerPath(e){return`w${this.workerIndex(e)}`}workerPort(e){return this.workerPortByIndex(this.workerIndex(e))}workerPortByIndex(e){return 3001+e}}class $N{constructor(e,t,r,i){this._serverConfig=e,this._gameConfig=t,this._userSettings=r,this._isReplay=i,this.pastelTheme=new YN,this.pastelThemeDark=new e$}stripePublishableKey(){return Mr.STRIPE_PUBLISHABLE_KEY??""}isReplay(){return this._isReplay}samHittingChance(){return .8}samWarheadHittingChance(){return .5}traitorDefenseDebuff(){return .5}traitorSpeedDebuff(){return .8}traitorDuration(){return 300}spawnImmunityDuration(){return 50}upgradeCooldownTicks(){return 1}gameConfig(){return this._gameConfig}serverConfig(){return this._serverConfig}userSettings(){if(this._userSettings===null)throw new Error("userSettings is null");return this._userSettings}difficultyModifier(e){switch(e){case en.Easy:return 1;case en.Medium:return 3;case en.Hard:return 9;case en.Impossible:return 18}}cityTroopIncrease(){return 25e4}falloutDefenseModifier(e){return 5-e*2}SAMCooldown(){return 75}SiloCooldown(){return 75}defensePostRange(){return 30}defensePostDefenseBonus(){return 5}defensePostSpeedBonus(){return 3}playerTeams(){return this._gameConfig.playerTeams??0}spawnNPCs(){return!this._gameConfig.disableNPCs}isUnitDisabled(e){return this._gameConfig.disabledUnits?.includes(e)??!1}bots(){return this._gameConfig.bots}instantBuild(){return this._gameConfig.instantBuild}infiniteGold(){return this._gameConfig.infiniteGold}donateGold(){return this._gameConfig.donateGold}infiniteTroops(){return this._gameConfig.infiniteTroops}donateTroops(){return this._gameConfig.donateTroops}trainSpawnRate(e){return(e+10)*20}trainSpawnRateFast(e){return Math.min(1400,Math.round(40*Math.pow(e,.5)))}trainGold(e){switch(e){case"ally":return 60000n;case"team":case"other":return 30000n;case"self":return 15000n}}trainGoldFast(e){switch(e){case"team":return 50000n;case"self":return 25000n;case"ally":case"other":return 12500n}}trainStationMinRange(){return 15}trainStationMaxRange(){return 80}railroadMaxSize(){return 100}tradeShipGold(e,t){const r=Math.floor(1e5+100*e),i=t-1,s=1+2*(i/(i+5));return BigInt(Math.floor(r*s))}tradeShipGoldFast(e,t){const r=Math.floor(5e4+100*e),i=.25,s=.9;let o=1;for(let c=0;c<t;c++)o+=i*Math.pow(s,c);return BigInt(Math.floor(r*o))}tradeShipSpawnRateFast(e){if(e<20)return 5;if(e<=150){const t=e-20;return Math.floor(Math.pow(t,.85)+5)}return 1e6}tradeShipSpawnRate(e,t,r){const i=Math.sqrt(this.tradeShipBaseSpawn(e,r)*this.tradeShipPortMultiplier(t));return Math.floor(25/i)}tradeShipBaseSpawn(e,t){if(t<3)return 1;const r=Math.LN2/10;return 1-HC(e,r,55)}tradeShipPortMultiplier(e){return 1/(1+.1*e)}unitInfo(e){switch(e){case $.TransportShip:return{cost:()=>0n,territoryBound:!1};case $.Warship:return{cost:this.costWrapper(t=>Math.min(1e6,(t+1)*25e4),$.Warship),territoryBound:!1,maxHealth:1e3};case $.Shell:return{cost:()=>0n,territoryBound:!1,damage:250};case $.SAMMissile:return{cost:()=>0n,territoryBound:!1};case $.Port:return{cost:this.costWrapper(t=>Math.min(1e6,Math.pow(2,t)*125e3),$.Port,$.Factory),territoryBound:!0,constructionDuration:this.instantBuild()?0:20,upgradable:!0,canBuildTrainStation:!0};case $.AtomBomb:return{cost:this.costWrapper(()=>75e4,$.AtomBomb),territoryBound:!1};case $.HydrogenBomb:return{cost:this.costWrapper(()=>5e6,$.HydrogenBomb),territoryBound:!1};case $.MIRV:return{cost:this.costWrapper(()=>35e6,$.MIRV),territoryBound:!1};case $.MIRVWarhead:return{cost:()=>0n,territoryBound:!1};case $.TradeShip:return{cost:()=>0n,territoryBound:!1};case $.MissileSilo:return{cost:this.costWrapper(()=>1e6,$.MissileSilo),territoryBound:!0,constructionDuration:this.instantBuild()?0:100,upgradable:!0};case $.DefensePost:return{cost:this.costWrapper(t=>Math.min(25e4,(t+1)*5e4),$.DefensePost),territoryBound:!0,constructionDuration:this.instantBuild()?0:50};case $.SAMLauncher:return{cost:this.costWrapper(t=>Math.min(3e6,(t+1)*15e5),$.SAMLauncher),territoryBound:!0,constructionDuration:this.instantBuild()?0:300,upgradable:!0};case $.City:return{cost:this.costWrapper(t=>Math.min(1e6,Math.pow(2,t)*125e3),$.City),territoryBound:!0,constructionDuration:this.instantBuild()?0:20,upgradable:!0,canBuildTrainStation:!0};case $.Factory:return{cost:this.costWrapper(t=>Math.min(1e6,Math.pow(2,t)*125e3),$.Factory,$.Port),territoryBound:!0,constructionDuration:this.instantBuild()?0:20,canBuildTrainStation:!0,experimental:!0,upgradable:!0};case $.Construction:return{cost:()=>0n,territoryBound:!0};case $.Train:return{cost:()=>0n,territoryBound:!1,experimental:!0};default:m7(e)}}costWrapper(e,...t){return r=>{if(r.type()===Xt.Human&&this.infiniteGold())return 0n;const i=t.reduce((s,o)=>s+Math.min(r.unitsOwned(o),r.unitsConstructed(o)),0);return BigInt(e(i))}}defaultDonationAmount(e){return Math.floor(e.troops()/3)}donateCooldown(){return 100}deleteUnitCooldown(){return 50}emojiMessageDuration(){return 50}emojiMessageCooldown(){return 50}targetDuration(){return 100}targetCooldown(){return 150}allianceRequestDuration(){return 200}allianceRequestCooldown(){return 300}allianceDuration(){return 300*10}temporaryEmbargoDuration(){return 300*10}percentageTilesOwnedToWin(){return this._gameConfig.gameMode===qn.Team?95:80}boatMaxNumber(){return 3}numSpawnPhaseTurns(){return this._gameConfig.gameType===qs.Singleplayer?100:300}numBots(){return this.bots()}theme(){return this.userSettings().darkMode()?this.pastelThemeDark:this.pastelTheme}attackLogic(e,t,r,i,s){let o=0,c=0;const u=e.terrainType(s);switch(u){case tr.Plains:o=80,c=16.5;break;case tr.Highland:o=100,c=20;break;case tr.Mountain:o=120,c=25;break;default:throw new Error(`terrain type ${u} not supported`)}if(i.isPlayer()){for(const d of e.nearbyUnits(s,e.config().defensePostRange(),$.DefensePost))if(d.unit.owner()===i){o*=this.defensePostDefenseBonus(),c*=this.defensePostSpeedBonus();break}}if(e.hasFallout(s)){const d=e.numTilesWithFallout()/e.numLandTiles();o*=this.falloutDefenseModifier(d),c*=this.falloutDefenseModifier(d)}if(r.isPlayer()&&i.isPlayer()&&(i.isDisconnected()&&r.isOnSameTeam(i)&&(o=0),r.type()===Xt.Human&&i.type()===Xt.Bot&&(o*=.8),r.type()===Xt.FakeHuman&&i.type()===Xt.Bot&&(o*=.8)),i.isPlayer()){const d=1-HC(i.numTilesOwned(),n$,t$),f=.7+.3*d,p=.7+.3*d;let y=1;r.numTilesOwned()>1e5&&(y=Math.sqrt(1e5/r.numTilesOwned())**.7);let b=1;return r.numTilesOwned()>1e5&&(b=(1e5/r.numTilesOwned())**.6),{attackerTroopLoss:lh(i.troops()/t,.6,2)*o*.8*p*y*(i.isTraitor()?this.traitorDefenseDebuff():1),defenderTroopLoss:i.troops()/i.numTilesOwned(),tilesPerTickUsed:lh(i.troops()/(5*t),.2,1.5)*c*f*b*(i.isTraitor()?this.traitorSpeedDebuff():1)}}else return{attackerTroopLoss:r.type()===Xt.Bot?o/10:o/5,defenderTroopLoss:0,tilesPerTickUsed:lh(2e3*Math.max(10,c)/t,5,100)}}attackTilesPerTick(e,t,r,i){return r.isPlayer()?lh(5*e/r.troops()*2,.01,.5)*i*3:i*2}boatAttackAmount(e,t){return Math.floor(e.troops()/5)}warshipShellLifetime(){return 20}radiusPortSpawn(){return 20}proximityBonusPortsNb(e){return lh(e/3,4,e)}attackAmount(e,t){return e.type()===Xt.Bot?e.troops()/20:e.troops()/5}startManpower(e){if(e.playerType===Xt.Bot)return 1e4;if(e.playerType===Xt.FakeHuman)switch(this._gameConfig.difficulty){case en.Easy:return 2500*(e?.nation?.strength??1);case en.Medium:return 5e3*(e?.nation?.strength??1);case en.Hard:return 2e4*(e?.nation?.strength??1);case en.Impossible:return 5e4*(e?.nation?.strength??1)}return this.infiniteTroops()?1e6:25e3}maxTroops(e){const t=e.type()===Xt.Human&&this.infiniteTroops()?1e9:2*(Math.pow(e.numTilesOwned(),.6)*1e3+5e4)+e.units($.City).map(r=>r.level()).reduce((r,i)=>r+i,0)*this.cityTroopIncrease();if(e.type()===Xt.Bot)return t/3;if(e.type()===Xt.Human)return t;switch(this._gameConfig.difficulty){case en.Easy:return t*.5;case en.Medium:return t*1;case en.Hard:return t*1.5;case en.Impossible:return t*2}}troopIncreaseRate(e){const t=this.maxTroops(e);let r=10+Math.pow(e.troops(),.73)/4;const i=1-e.troops()/t;if(r*=i,e.type()===Xt.Bot&&(r*=.6),e.type()===Xt.FakeHuman)switch(this._gameConfig.difficulty){case en.Easy:r*=.9;break;case en.Medium:r*=1;break;case en.Hard:r*=1.1;break;case en.Impossible:r*=1.2;break}return Math.min(e.troops()+r,t)-e.troops()}goldAdditionRate(e){return e.type()===Xt.Bot?50n:100n}nukeMagnitudes(e){switch(e){case $.MIRVWarhead:return{inner:12,outer:18};case $.AtomBomb:return{inner:12,outer:30};case $.HydrogenBomb:return{inner:80,outer:100}}throw new Error(`Unknown nuke type: ${e}`)}nukeAllianceBreakThreshold(){return 100}defaultNukeSpeed(){return 6}defaultNukeTargetableRange(){return 150}defaultSamRange(){return 70}defaultSamMissileSpeed(){return 12}nukeDeathFactor(e,t,r,i){if(e!==$.MIRVWarhead)return 5*t/Math.max(1,r);const s=.03*i,o=Math.max(0,t-s),c=500,u=o/i;return c*(1-Math.exp(-2*u))}structureMinDist(){return 15}shellLifetime(){return 50}warshipPatrolRange(){return 100}warshipTargettingRange(){return 130}warshipShellAttackRate(){return 20}defensePostShellAttackRate(){return 100}safeFromPiratesCooldownMax(){return 20}defensePostTargettingRange(){return 75}allianceExtensionPromptOffset(){return 300}}class s$ extends ov{adminToken(){return"WARNING_DEV_ADMIN_KEY_DO_NOT_USE_IN_PRODUCTION"}apiKey(){return"WARNING_DEV_API_KEY_DO_NOT_USE_IN_PRODUCTION"}env(){return Oo.Dev}gameCreationRate(){return 5*1e3}samWarheadHittingChance(){return 1}samHittingChance(){return 1}numWorkers(){return 2}jwtAudience(){return"localhost"}gitCommit(){return"DEV"}domain(){return"localhost"}subdomain(){return""}}class a$ extends $N{constructor(e,t,r,i){super(e,t,r,i)}unitInfo(e){return super.unitInfo(e)}}const o$=new class extends ov{env(){return Oo.Preprod}numWorkers(){return 20}jwtAudience(){return"frontwars.io"}allowedFlares(){return[]}},l$=new class extends ov{numWorkers(){return 40}env(){return Oo.Prod}jwtAudience(){return"frontwars.io"}};let Em=null;async function c$(n,e,t=!1){const r=await Na();switch(r.env()){case Oo.Dev:return new a$(r,n,e,t);case Oo.Preprod:case Oo.Prod:return console.log("using prod config"),new $N(r,n,e,t);default:throw Error("unsupported server configuration: prod")}}async function Na(){if(Em)return Em;const n=await fetch("/api/env");if(!n.ok)throw new Error(`Failed to fetch server config: ${n.status} ${n.statusText}`);const e=await n.json();return console.log("Server config loaded:",e),Em=u$(e.game_env),Em}function u$(n){switch(n){case"dev":return console.log("using dev server config"),new s$;case"staging":return console.log("using preprod server config"),o$;case"prod":return console.log("using prod server config"),l$;default:throw Error(`unsupported server configuration: ${n}`)}}const up="data:text/plain;base64,djI2LjM=",Ht=class Ht{constructor(e,t){this.prefix=e,this.cacheBuster=t,this.maps=new Map,this.currentVersion=up.trim()}static clearCache(){typeof window<"u"&&(localStorage.setItem(Ht.CACHE_CLEAR_KEY,up),Ht.metadataCache=null,localStorage.removeItem(Ht.METADATA_CACHE_KEY),localStorage.removeItem(Ht.METADATA_CACHE_TIMESTAMP_KEY),console.log(" Map cache cleared - fresh map data will be loaded on next game"))}static globalClearCache(){Ht.clearCache()}shouldForceFreshLoad(){if(typeof window>"u")return!1;const e=localStorage.getItem(Ht.CACHE_CLEAR_KEY);return e?this.currentVersion!==e:!0}getMapData(e){this.shouldForceFreshLoad()&&(this.maps.clear(),typeof window<"u"&&localStorage.setItem(Ht.CACHE_CLEAR_KEY,this.currentVersion));const t=this.maps.get(e);if(t)return t;const i=Object.keys(Ee).find(o=>Ee[o]===e)?.toLowerCase();if(!i)throw new Error(`Unknown map: ${e}`);const s={mapBin:()=>this.loadBinaryFromUrl(this.url(i,"map.bin")),miniMapBin:()=>this.loadBinaryFromUrl(this.url(i,"mini_map.bin")),manifest:()=>this.loadJsonFromUrl(this.url(i,"manifest.json")),webpPath:async()=>this.url(i,"thumbnail.webp")};return this.maps.set(e,s),s}url(e,t){let r=`${this.prefix}/${e}/${t}`;if(this.cacheBuster&&(r+=`${r.includes("?")?"&":"?"}v=${this.cacheBuster}`),this.shouldForceFreshLoad()){const i=Date.now();r+=`${r.includes("?")?"&":"?"}nocache=${i}`}return r}async loadBinaryFromUrl(e){const t=this.shouldForceFreshLoad()?{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}:{},r=await fetch(e,t);if(!r.ok)throw new Error(`Failed to load ${e}: ${r.statusText}`);const i=await r.arrayBuffer();return new Uint8Array(i)}async loadJsonFromUrl(e){const t=this.shouldForceFreshLoad()?{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}:{},r=await fetch(e,t);if(!r.ok)throw new Error(`Failed to load ${e}: ${r.statusText}`);return r.json()}static isMetadataCacheValid(){if(typeof window>"u")return!1;const e=localStorage.getItem(Ht.CACHE_CLEAR_KEY),t=up.trim();if(e!==t)return!1;const r=localStorage.getItem(Ht.METADATA_CACHE_TIMESTAMP_KEY);if(!r)return!1;const i=parseInt(r,10);return!(isNaN(i)||Date.now()-i>Ht.METADATA_CACHE_MAX_AGE)}static async getAvailableMaps(e="/maps"){if(Ht.metadataCache)return Ht.metadataCache;if(Ht.isMetadataCacheValid())try{const r=localStorage.getItem(Ht.METADATA_CACHE_KEY);if(r){const i=JSON.parse(r);return Ht.metadataCache=i,console.log(" Loaded map metadata from cache"),Ht.metadataCache}}catch(r){console.warn("Failed to parse cached map metadata:",r),Ht.clearCache()}console.log(" Fetching fresh map metadata...");const t=await Ht.fetchAvailableMaps(e);if(Ht.metadataCache=t,typeof window<"u")try{localStorage.setItem(Ht.METADATA_CACHE_KEY,JSON.stringify(t)),localStorage.setItem(Ht.METADATA_CACHE_TIMESTAMP_KEY,Date.now().toString())}catch(r){console.warn("Failed to store map metadata in cache:",r)}return t}static async fetchAvailableMaps(e){const r=Object.keys(Ee).map(s=>s.toLowerCase()).map(async s=>{try{const o=await fetch(`${e}/${s}/manifest.json`,{cache:"default"});if(o.ok){await o.json();const c=Object.keys(Ee).find(d=>d.toLowerCase()===s),u=c?Ee[c]:void 0;return u?{dir:s,type:u,name:u,thumbnail:`${e}/${s}/thumbnail.webp`}:null}return null}catch(o){return console.warn(`Failed to load map ${s}:`,o),null}});return(await Promise.all(r)).filter(s=>s!==null)}};Ht.CACHE_CLEAR_KEY="frontwars_cache_cleared",Ht.METADATA_CACHE_KEY="frontwars_map_metadata_cache",Ht.METADATA_CACHE_TIMESTAMP_KEY="frontwars_map_metadata_cache_timestamp",Ht.METADATA_CACHE_MAX_AGE=1440*60*1e3,Ht.metadataCache=null;let dd=Ht;function h$({open:n,onClose:e}){const{t}=xt(),[r,i]=T.useState(""),[s,o]=T.useState(!0),[c,u]=T.useState(!1),[d,f]=T.useState(Ee.World),[p,y]=T.useState(!1),[b,_]=T.useState(en.Medium),[w,S]=T.useState(qn.FFA),[A,M]=T.useState(Yr.Classic),[k,E]=T.useState(2),[U,I]=T.useState(400),[B,G]=T.useState(!1),[R,P]=T.useState(!1),[H,Y]=T.useState(!0),[L,q]=T.useState(!0),[W,N]=T.useState(!1),[V,J]=T.useState(!1),[se,O]=T.useState(!1),[F,X]=T.useState([]),[D,ee]=T.useState([]),[pe,Se]=T.useState(""),[ie,ve]=T.useState([]),Ce=T.useRef(null),Le=T.useRef(null),st=T.useRef(!1);T.useEffect(()=>{if(!n)return;(async()=>{try{const wt=(await dd.getAvailableMaps("/maps")).map($e=>({dir:$e.dir,type:$e.type,name:E2[$e.dir]||D3($e.dir),thumbnail:$e.thumbnail}));ve(wt)}catch(nt){console.error("Failed to load maps:",nt),ve([])}})()},[n]);const ft=T.useMemo(()=>{const ke=[],nt=[],wt=[];return ie.forEach($e=>{fc.continental.includes($e.type)?ke.push($e):fc.regional.includes($e.type)?nt.push($e):fc.fantasy.includes($e.type)&&wt.push($e)}),{continental:ke,regional:nt,other:wt}},[ie]),Ge=T.useCallback(async()=>{if(!r)return;const ke=await Na(),nt=d;try{return await fetch(`${window.location.origin}/${ke.workerPath(r)}/api/game/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({gameMap:nt,gameMapSize:se?La.Compact:La.Normal,difficulty:b,disableNPCs:B,bots:U,infiniteGold:W,donateGold:H,infiniteTroops:V,donateTroops:L,instantBuild:R,gameMode:w,disabledUnits:F,playerTeams:k,economyMode:A})})}catch(wt){console.error("Error updating game config:",wt)}},[r,d,p,se,b,B,U,W,H,V,L,R,w,F,k,A]),It=T.useCallback(async()=>{if(!r)return;const ke=await Na();try{const nt=await fetch(`/${ke.workerPath(r)}/api/game/${r}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(nt.ok){const wt=await nt.json();console.log("Got game info response:",wt),ee(wt.clients??[])}}catch(nt){console.error("Error polling players:",nt)}},[r]),zt=T.useCallback(async()=>{try{await navigator.clipboard.writeText(`${location.origin}/#game=${r}`),u(!0),setTimeout(()=>{u(!1)},2e3)}catch(ke){console.error(`Failed to copy text: ${ke}`)}},[r]),tt=T.useCallback(ke=>{X(nt=>nt.includes(ke)?nt.filter($e=>$e!==ke):[...nt,ke])},[]),mt=T.useCallback(ke=>{const nt=parseInt(ke.target.value);isNaN(nt)||nt<0||nt>400||(I(nt),Le.current!==null&&clearTimeout(Le.current),Le.current=window.setTimeout(()=>{Ge(),Le.current=null},300))},[Ge]),_t=T.useCallback(async()=>{if(D.length<2)return;let ke=d;if(p){const wt=Object.values(Ee),$e=Math.floor(Math.random()*wt.length);ke=wt[$e],f(ke)}await Ge(),console.log(`Starting private game with map: ${Ee[ke]} ${p?" (Randomly selected)":""}`);const nt=await Na();try{(await fetch(`${window.location.origin}/${nt.workerPath(r)}/api/start_game/${r}`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok&&e()}catch(wt){console.error("Error starting game:",wt)}},[D.length,d,p,Ge,r,e]),Xn=T.useCallback(ke=>{ae.emit(new j4(ke))},[]),Kn=T.useCallback(()=>{Rn.hideInviteButton()},[]);return T.useEffect(()=>{if(!n){st.current=!1,i(""),Se(""),ee([]);return}if(st.current)return;st.current=!0,(async()=>{const nt=Pi();Se(nt);try{const wt=await Na(),$e=Pi(),kn=await fetch(`/${wt.workerPath($e)}/api/create_game/${$e}?creatorClientID=${encodeURIComponent(nt)}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!kn.ok){const we=await kn.text();throw console.error("Server error response:",we),new Error(`HTTP error! status: ${kn.status}`)}const de=await kn.json();if(console.log("Lobby created successfully:",de),i(de.gameID),ae.emit(new Cc(de)),de.gameID){const we={roomId:de.gameID};Rn.showInviteButton(we,(Oe,qe)=>{Oe?console.log("Invite button error:",Oe):console.log("Invite button shown with link:",qe)})}}catch(wt){console.error("Failed to create lobby:",wt),st.current=!1,e()}})()},[n,e]),T.useEffect(()=>{if(!(!n||!r))return Ce.current=setInterval(()=>{It()},1e3),()=>{Ce.current&&(clearInterval(Ce.current),Ce.current=null)}},[n,r,It]),T.useEffect(()=>{if(!r)return;const ke=setTimeout(()=>{Ge()},100);return()=>clearTimeout(ke)},[d,p,se,b,B,R,H,L,W,V,w,F,k,A,Ge,r]),T.useEffect(()=>{n||(Ce.current&&(clearInterval(Ce.current),Ce.current=null),Le.current!==null&&(clearTimeout(Le.current),Le.current=null),Kn(),u(!1))},[n,Kn]),g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col h-full max-w-4xl mx-auto max-h-[90vh]",children:[g.jsx("div",{className:"flex items-center justify-center mb-4 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:t("lobby.create.title")})}),g.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6 shrink-0",children:[g.jsx("button",{onClick:()=>o(!s),className:"p-2 text-white hover:bg-gray-700/50 rounded transition-colors cursor-pointer","aria-label":"Toggle lobby code visibility",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s?g.jsxs(g.Fragment,{children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}):g.jsx(g.Fragment,{children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})})}),g.jsx("span",{className:"text-white font-mono text-lg cursor-pointer",onClick:zt,children:s?r:""}),g.jsx("button",{onClick:zt,className:"p-2 text-white hover:bg-gray-700/50 rounded transition-colors cursor-pointer","aria-label":"Copy lobby code",children:c?g.jsx("span",{className:"text-green-400 text-lg",children:""}):g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-250px)] pr-4 space-y-6",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("lobby.create.map")}),ft.continental.length>0&&g.jsxs("div",{className:"mb-6",children:[g.jsx("h4",{className:"text-white font-semibold text-base mb-3 text-center",children:t("map_categories.continental")}),g.jsx("div",{className:"grid grid-cols-4 gap-4 justify-items-center max-w-4xl mx-auto",children:ft.continental.map(ke=>g.jsxs("button",{onClick:()=>{f(ke.type),y(!1)},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${d===ke.type&&!p?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("img",{src:ke.thumbnail,alt:ke.name,className:"w-full aspect-video rounded object-cover"}),g.jsx("span",{className:"text-white text-sm text-center break-words line-clamp-2",children:ke.name})]},ke.dir))})]}),ft.regional.length>0&&g.jsxs("div",{className:"mb-6",children:[g.jsx("h4",{className:"text-white font-semibold text-base mb-3 text-center",children:t("map_categories.regional")}),g.jsx("div",{className:"grid grid-cols-4 gap-4 justify-items-center max-w-4xl mx-auto",children:ft.regional.map(ke=>g.jsxs("button",{onClick:()=>{f(ke.type),y(!1)},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${d===ke.type&&!p?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("img",{src:ke.thumbnail,alt:ke.name,className:"w-full aspect-video rounded object-cover"}),g.jsx("span",{className:"text-white text-sm text-center break-words line-clamp-2",children:ke.name})]},ke.dir))})]}),ft.other.length>0&&g.jsxs("div",{className:"mb-6",children:[g.jsx("h4",{className:"text-white font-semibold text-base mb-3 text-center",children:t("map_categories.fantasy")}),g.jsxs("div",{className:"grid grid-cols-4 gap-4 justify-items-center max-w-4xl mx-auto",children:[ft.other.map(ke=>g.jsxs("button",{onClick:()=>{f(ke.type),y(!1)},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${d===ke.type&&!p?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("img",{src:ke.thumbnail,alt:ke.name,className:"w-full aspect-video rounded object-cover"}),g.jsx("span",{className:"text-white text-sm text-center break-words line-clamp-2",children:ke.name})]},ke.dir)),g.jsxs("button",{onClick:()=>{y(!0),Ge()},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${p?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("img",{src:"/images/RandomMap.webp",alt:"Random",className:"w-full aspect-video rounded object-cover"}),g.jsx("span",{className:"text-white text-sm text-center break-words line-clamp-2",children:t("map.random")})]})]})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("lobby.create.difficulty")}),g.jsx("div",{className:"grid grid-cols-4 gap-3 justify-items-center max-w-4xl mx-auto",children:P3.map(ke=>g.jsxs("button",{onClick:()=>{_(ke.value),Ge()},className:`flex flex-col items-center justify-center gap-2 p-4 rounded-lg border transition-colors w-full cursor-pointer min-h-[100px] ${b===ke.value?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:"flex gap-1 shrink-0",children:Array.from({length:4}).map((nt,wt)=>{const $e=wt<ke.skulls,kn=ke.value===en.Impossible&&wt===0;return g.jsxs("div",{className:"relative",children:[g.jsxs("svg",{className:`w-6 h-6 ${$e?kn?"text-red-500":"text-red-600":"text-gray-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12c0 5.52 4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8 0-4.41 3.59-8 8-8s8 3.59 8 8c0 4.41-3.59 8-8 8z"}),g.jsx("circle",{cx:"9",cy:"10",r:"1.5",fill:"currentColor"}),g.jsx("circle",{cx:"15",cy:"10",r:"1.5",fill:"currentColor"}),g.jsx("path",{d:"M12 16c-1.1 0-2-.9-2-2h4c0 1.1-.9 2-2 2z",fill:"currentColor"})]}),kn&&g.jsxs("svg",{className:"absolute top-0 left-0 w-6 h-6 text-orange-500",fill:"currentColor",viewBox:"0 0 24 24",style:{filter:"drop-shadow(0 0 2px rgba(255, 69, 0, 0.8))"},children:[g.jsx("path",{d:"M12 2l-1.5 3h3L12 2zm0 0l1.5 3h-3L12 2z"}),g.jsx("path",{d:"M10 4l-1 2h2l-1-2zm4 0l1 2h-2l1-2z"})]})]},wt)})}),g.jsx("span",{className:"text-white text-sm font-semibold text-center break-words whitespace-normal line-clamp-2",children:t(ke.labelKey)})]},ke.value))})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("lobby.create.mode")}),g.jsxs("div",{className:"flex justify-center items-center gap-2",children:[g.jsx("button",{onClick:()=>{S(qn.FFA),Ge()},className:`p-3 rounded-lg border transition-colors min-w-[120px] cursor-pointer ${w===qn.FFA?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal",children:t("game_mode.ffa")})}),g.jsx("button",{onClick:()=>{S(qn.Team),Ge()},className:`p-3 rounded-lg border transition-colors min-w-[120px] cursor-pointer ${w===qn.Team?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal",children:t("game_mode.teams")})})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("lobby.create.economy_mode")}),g.jsxs("div",{className:"flex justify-center items-center gap-2",children:[g.jsx("button",{onClick:()=>{M(Yr.Classic),Ge()},className:`p-3 rounded-lg border transition-colors min-w-[120px] cursor-pointer ${A===Yr.Classic?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal",children:t("economy_mode.classic")})}),g.jsx("button",{onClick:()=>{M(Yr.Fast),Ge()},className:`p-3 rounded-lg border transition-colors min-w-[120px] cursor-pointer ${A===Yr.Fast?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal",children:t("economy_mode.fast")})})]})]}),w===qn.Team&&g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("lobby.create.number_of_teams")}),g.jsxs("div",{className:"grid grid-cols-5 gap-3 justify-items-center max-w-4xl mx-auto",children:[[2,3,4,5,6,7].map(ke=>g.jsx("button",{onClick:()=>{E(ke),Ge()},className:`p-3 rounded-lg border transition-colors w-full cursor-pointer ${k===ke?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal text-center",children:t("public_lobby.teams",{num:ke})})},ke)),g.jsx("button",{onClick:()=>{E(Ho),Ge()},className:`p-3 rounded-lg border transition-colors w-full cursor-pointer ${k===Ho?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsxs("span",{className:"text-white font-semibold block break-words whitespace-normal text-center",children:[g.jsx("span",{className:"block",children:t("lobby.create.quads")}),g.jsxs("span",{className:"text-xs font-normal",children:["(",t("lobby.create.teams_of_4"),")"]})]})}),g.jsx("button",{onClick:()=>{E(Go),Ge()},className:`p-3 rounded-lg border transition-colors w-full cursor-pointer ${k===Go?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsxs("span",{className:"text-white font-semibold block break-words whitespace-normal text-center",children:[g.jsx("span",{className:"block",children:t("lobby.create.trios")}),g.jsxs("span",{className:"text-xs font-normal",children:["(",t("lobby.create.teams_of_3"),")"]})]})}),g.jsx("button",{onClick:()=>{E(Fo),Ge()},className:`p-3 rounded-lg border transition-colors w-full cursor-pointer ${k===Fo?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsxs("span",{className:"text-white font-semibold block break-words whitespace-normal text-center",children:[g.jsx("span",{className:"block",children:t("lobby.create.duos")}),g.jsxs("span",{className:"text-xs font-normal",children:["(",t("lobby.create.teams_of_2"),")"]})]})})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("lobby.create.options")}),g.jsxs("div",{className:"space-y-4",children:[g.jsx("div",{className:"bg-gray-800/80 rounded-lg p-4 border border-gray-700/50 max-w-2xl mx-auto",children:g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("label",{className:"text-white font-semibold min-w-[80px]",children:[t("host_modal.bots")," ",U]}),g.jsx("input",{type:"range",min:0,max:400,value:U,onChange:mt,className:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-400",style:{background:`linear-gradient(to right, rgb(96 165 250) 0%, rgb(96 165 250) ${U/400*100}%, rgb(55 65 81) ${U/400*100}%, rgb(55 65 81) 100%)`}})]})}),g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 justify-items-center max-w-4xl mx-auto",children:[g.jsxs("button",{onClick:()=>{G(!B),Ge()},className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${B?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${B?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("lobby.create.disable_nations")})]}),g.jsxs("button",{onClick:()=>{P(!R),Ge()},className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${R?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${R?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("lobby.create.instant_build")})]}),g.jsxs("button",{onClick:()=>{N(!W),Ge()},className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${W?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${W?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("lobby.create.infinite_gold")})]}),g.jsxs("button",{onClick:()=>{J(!V),Ge()},className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${V?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${V?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("lobby.create.infinite_troops")})]}),g.jsxs("button",{onClick:()=>{O(!se),Ge()},className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${se?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${se?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("lobby.create.mini_map")})]})]})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("lobby.create.enable_settings")}),g.jsx("div",{className:"grid grid-cols-5 gap-3 justify-items-center max-w-4xl mx-auto",children:Jm.map(ke=>{const nt=!F.includes(ke);return g.jsxs("button",{onClick:()=>{tt(ke),Ge()},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${nt?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[nt?g.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}):g.jsx("div",{className:"w-6 h-6 border-2 border-gray-600 rounded"}),g.jsx("span",{className:"text-white text-xs text-center break-words whitespace-normal",children:t(`unit_type.${R3(ke)}`)})]},ke)})})]}),g.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-700 shrink-0",children:[g.jsx("div",{className:"text-center mb-4",children:g.jsxs("span",{className:"text-white font-semibold text-lg",children:[D.length," ",D.length===1?t("host_modal.player"):t("host_modal.players")]})}),g.jsx("div",{className:"space-y-2 max-w-2xl mx-auto mb-4",children:D.map(ke=>g.jsxs("div",{className:"bg-gray-800/80 rounded-lg p-3 border border-gray-700/50 flex items-center justify-between",children:[g.jsxs("span",{className:"text-white font-semibold",children:[ke.username,ke.clientID===pe&&g.jsxs("span",{className:"text-green-400 ml-2",children:["(",t("host_modal.host_badge"),")"]})]}),ke.clientID!==pe&&g.jsx("button",{onClick:()=>Xn(ke.clientID),className:"text-red-400 hover:text-red-300 text-xl font-bold px-2",title:`Remove ${ke.username}`,children:""})]},ke.clientID))})]})]}),g.jsx("div",{className:"pt-4 border-t border-gray-700 shrink-0 flex justify-center",children:g.jsx("button",{onClick:_t,disabled:D.length<2,className:`px-8 py-3 text-white rounded-lg transition-colors cursor-pointer font-semibold ${D.length<2?"bg-gray-600 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}`,children:D.length===1?t("host_modal.waiting"):t("host_modal.start")})})]})})}const $t=Et().regex(/^[a-zA-Z0-9]+$/).length(8),qN=WG(),d$=oH(),ZN=Et().regex(/^([a-zA-Z0-9\s.,!?@#$%&*()\-_+=[\]{}|;:"'/\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff]|[])*$/u).max(1e3),XN=ZN,f$=[{key:"troops",requiresPlayer:!1},{key:"troops_frontlines",requiresPlayer:!1},{key:"gold",requiresPlayer:!1},{key:"no_attack",requiresPlayer:!1},{key:"sorry_attack",requiresPlayer:!1},{key:"alliance",requiresPlayer:!1},{key:"help_defend",requiresPlayer:!0},{key:"trade_partners",requiresPlayer:!1}],m$=[{key:"attack",requiresPlayer:!0},{key:"mirv",requiresPlayer:!0},{key:"focus",requiresPlayer:!0},{key:"finish",requiresPlayer:!0},{key:"build_warships",requiresPlayer:!1}],p$=[{key:"defend",requiresPlayer:!0},{key:"defend_from",requiresPlayer:!0},{key:"dont_attack",requiresPlayer:!0},{key:"ally",requiresPlayer:!0},{key:"build_posts",requiresPlayer:!1}],g$=[{key:"hello",requiresPlayer:!1},{key:"good_job",requiresPlayer:!1},{key:"good_luck",requiresPlayer:!1},{key:"have_fun",requiresPlayer:!1},{key:"gg",requiresPlayer:!1},{key:"nice_to_meet",requiresPlayer:!1},{key:"well_played",requiresPlayer:!1},{key:"hi_again",requiresPlayer:!1},{key:"bye",requiresPlayer:!1},{key:"thanks",requiresPlayer:!1},{key:"oops",requiresPlayer:!1},{key:"trust_me",requiresPlayer:!1},{key:"trust_broken",requiresPlayer:!1},{key:"ruining_games",requiresPlayer:!1},{key:"dont_do_that",requiresPlayer:!1},{key:"same_team",requiresPlayer:!1}],y$=[{key:"go",requiresPlayer:!1},{key:"strategy",requiresPlayer:!1},{key:"fun",requiresPlayer:!1},{key:"team_up",requiresPlayer:!0},{key:"pr",requiresPlayer:!1},{key:"build_closer",requiresPlayer:!1},{key:"coastline",requiresPlayer:!1}],b$=[{key:"strong",requiresPlayer:!0},{key:"weak",requiresPlayer:!0},{key:"mirv_soon",requiresPlayer:!0},{key:"number1_warning",requiresPlayer:!1},{key:"stalemate",requiresPlayer:!1},{key:"has_allies",requiresPlayer:!0},{key:"no_allies",requiresPlayer:!0},{key:"betrayed",requiresPlayer:!0},{key:"betrayed_me",requiresPlayer:!0},{key:"getting_big",requiresPlayer:!0},{key:"danger_base",requiresPlayer:!0},{key:"saving_for_mirv",requiresPlayer:!0},{key:"mirv_ready",requiresPlayer:!0},{key:"snowballing",requiresPlayer:!0},{key:"cheating",requiresPlayer:!0},{key:"stop_trading",requiresPlayer:!0}],x$={help:f$,attack:m$,defend:p$,greet:g$,misc:y$,warnings:b$},zn=St({clientID:$t}),v$=zn.extend({type:Ye("alliance_extension"),recipient:$t}),_$=zn.extend({type:Ye("attack"),targetID:$t.nullable(),troops:Nt().nonnegative().nullable()}),w$=zn.extend({type:Ye("spawn"),tile:Nt()}),S$=zn.extend({type:Ye("boat"),targetID:$t.nullable(),troops:Nt().nonnegative(),dst:Nt(),src:Nt().nullable()}),A$=zn.extend({type:Ye("alliance_request"),recipient:$t}),C$=zn.extend({type:Ye("alliance_request_reply"),requestor:$t,accept:ka()}),k$=zn.extend({type:Ye("break_alliance"),recipient:$t}),T$=zn.extend({type:Ye("target_player"),target:$t}),E$=Nt().nonnegative().max(Q3.length-1),M$=zn.extend({type:Ye("emoji"),recipient:kd([$t,Ye(fs)]),emoji:E$}),N$=zn.extend({type:Ye("embargo"),targetID:$t,action:kd([Ye("start"),Ye("stop")])}),I$=zn.extend({type:Ye("donate_gold"),recipient:$t,gold:Nt().nullable()}),R$=zn.extend({type:Ye("donate_troops"),recipient:$t,troops:Nt().nullable()}),P$=zn.extend({type:Ye("build_unit"),unit:Sr($),tile:Nt()}),D$=zn.extend({type:Ye("upgrade_structure"),unit:Sr($),unitId:Nt()}),j$=zn.extend({type:Ye("cancel_attack"),attackID:Et()}),B$=zn.extend({type:Ye("cancel_boat"),unitID:Nt()}),O$=zn.extend({type:Ye("move_warship"),unitId:Nt(),tile:Nt()}),L$=zn.extend({type:Ye("delete_unit"),unitId:Nt()}),KN=new Set(Object.entries(x$).flatMap(([n,e])=>e.map(t=>`${n}.${t.key}`)));if(KN.size===0)throw new Error("QuickChat.json must contain at least one quickchat entry");const z$=Et().refine(n=>KN.has(n),{message:'Invalid quickchat key. Must be one of the valid keys from QuickChat.json (e.g., "help.troops", "attack.mirv", etc.)'}),U$=zn.extend({type:Ye("quick_chat"),recipient:$t,quickChatKey:z$,target:$t.optional()}),F$=zn.extend({type:Ye("mark_disconnected"),isDisconnected:ka()}),G$=zn.extend({type:Ye("kick_player"),target:$t}),QN=z2("type",[_$,j$,w$,F$,S$,B$,A$,C$,k$,T$,M$,I$,R$,P$,D$,N$,O$,U$,v$,L$,G$]),H$=["abomb","hbomb","mirv","mirvw"],V$=Sr(H$);$.AtomBomb+"",$.HydrogenBomb+"",$.MIRV+"",$.MIRVWarhead+"";const W$=["trade","trans"],Y$=Sr(W$),$$=["city","defp","port","wshp","silo","saml","fact"],q$=Sr($$);$.City+"",$.DefensePost+"",$.MissileSilo+"",$.Port+"",$.SAMLauncher+"",$.Warship+"",$.Factory+"";const hp=OH(n=>typeof n=="string"&&/^-?\d+$/.test(n)?BigInt(n):n,hH()),uh=hp.array().min(1),JN=St({attacks:uh.optional(),betrayals:hp.optional(),killedAt:hp.optional(),conquests:hp.optional(),boats:hb(Y$,uh).optional(),bombs:hb(V$,uh).optional(),gold:uh.optional(),units:hb(q$,uh).optional()}).optional(),Z$=kd([Nt(),Ye(Fo),Ye(Go),Ye(Ho)]),lv=St({gameMap:Sr(Ee),difficulty:Sr(en),donateGold:ka(),donateTroops:ka(),gameType:Sr(qs),gameMode:Sr(qn),gameMapSize:Sr(La),economyMode:Sr(Yr),disableNPCs:ka(),bots:Nt().int().min(0).max(400),infiniteGold:ka(),infiniteTroops:ka(),instantBuild:ka(),maxPlayers:Nt().optional(),disabledUnits:Sr($).array().optional(),playerTeams:Z$.optional()});Et();const X$=wh($t,JN),K$=GM.filter(n=>!n.restricted).map(n=>n.code),mg=St({turnNumber:Nt(),intents:QN.array(),hash:Nt().nullable().optional()}),eI=Et().max(128).optional().refine(n=>n===void 0||n===""||n.startsWith("!")?!0:K$.includes(n),{message:"Invalid flag: must be a valid country code or start with !"}),Q$=St({flag:eI.optional(),color:Et().optional(),patternName:lg.optional(),patternColorPaletteName:Et().optional()}),J$=St({name:lg,patternData:R4,colorPalette:P4.optional()}),eq=St({color:Et()}),tq=St({flag:eI.optional(),pattern:J$.optional(),color:eq.optional()}),tI=St({clientID:$t,username:XN,cosmetics:tq.optional()}),nI=St({gameID:$t,config:lv,players:tI.array()}),rI=kd([sk([Ye("player"),$t]).rest($t),sk([Ye("team"),ZN]).rest($t)]).optional();var iI=(n=>(n.Debug="DEBUG",n.Info="INFO",n.Warn="WARN",n.Error="ERROR",n.Fatal="FATAL",n))(iI||{});const nq=St({type:Ye("winner"),winner:rI,allPlayersStats:X$}),rq=St({type:Ye("hash"),hash:Nt(),turnNumber:Nt()}),iq=St({type:Ye("log"),severity:Sr(iI),log:$t}),sq=St({type:Ye("ping")}),aq=St({type:Ye("intent"),intent:QN}),oq=Et().refine(n=>qN.safeParse(n).success||d$.safeParse(n).success,{message:"Token must be a valid UUID or JWT"}),lq=St({type:Ye("join"),clientID:$t,token:oq,gameID:$t,lastTurn:Nt(),username:XN,cosmetics:Q$.optional()});z2("type",[nq,sq,aq,lq,iq,rq]);const cq=tI.extend({persistentID:qN.nullable(),stats:JN}),uq=nI.extend({players:cq.array(),start:Nt(),end:Nt(),duration:Nt().nonnegative(),num_turns:Nt(),winner:rI}),hq=Et(),sI=St({info:uq,version:Ye("v0.0.2")}),dq=sI.extend({gitCommit:hq,subdomain:Et(),domain:Et()}),fq=dq.extend({turns:mg.array()}),mq=sI.extend({turns:mg.array()}),pq=St({type:Ye("turn"),turn:mg}),gq=St({type:Ye("ping")}),yq=St({type:Ye("prestart"),gameMap:Sr(Ee),gameMapSize:Sr(La)}),bq=St({type:Ye("start"),turns:mg.array(),gameStartInfo:nI}),xq=St({type:Ye("desync"),turn:Nt(),correctHash:Nt().nullable(),clientsWithCorrectHash:Nt(),totalActiveClients:Nt(),yourHash:Nt().optional()}),vq=St({type:Ye("error"),error:Et(),message:Et().optional()}),_q=z2("type",[pq,yq,bq,gq,xq,vq]);lv.or(St({}).strict().transform(n=>{}));lv.partial();function Mm(n){if(!n)return"";if(n.startsWith("http"))try{const e=new URL(n);return e.hash.includes("#game=")?new URLSearchParams(e.hash.substring(1)).get("game")||"":e.searchParams.get("game")||""}catch{if(n.includes("#game="))return n.split("#game=")[1]?.split("?")[0]||""}return n.trim()}function wq({open:n,onClose:e,initialLobbyId:t=""}){const{t:r}=xt(),[i,s]=T.useState(""),[o,c]=T.useState(""),[u,d]=T.useState(!1),[f,p]=T.useState([]),[y,b]=T.useState(!1),_=T.useRef(null),w=T.useRef(!1);T.useEffect(()=>{if(n&&t){const B=Mm(t);s(B),B&&$t.safeParse(B).success&&k(B)}else n||(s(""),c(""),d(!1),p([]),w.current=!1,_.current&&(clearInterval(_.current),_.current=null))},[n,t]);const S=T.useCallback(async()=>{if(!i||!u)return;const B=await Na();try{const G=await fetch(`/${B.workerPath(i)}/api/game/${i}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(G.ok){const R=await G.json();p(R.clients?.map(P=>P.username)??[])}}catch(G){console.error("Error polling players:",G)}},[i,u]);T.useEffect(()=>{if(u&&i)return _.current=setInterval(()=>{S()},1e3),()=>{_.current&&(clearInterval(_.current),_.current=null)}},[u,i,S]);const A=T.useCallback(async B=>{const G=await Na();try{const R=await fetch(`/${G.workerPath(B)}/api/game/${B}/exists`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!R.ok)return!1;if((await R.json()).exists){c(r("private_lobby.joined_waiting")),d(!0);const H={gameID:B};return ae.emit(new Cc(H)),!0}}catch(R){console.error("Error checking active lobby:",R)}return!1},[r]),M=T.useCallback(async B=>{try{const G=gz(),R=await fetch(`${G}/api/game/${B}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(R.status===404)return"not_found";if(R.status!==200)return"error";const P=await R.json();if(!fq.safeParse(P).success)return"invalid_version";const Y={gameID:B};return ae.emit(new Cc(Y)),"success"}catch(G){return console.error("Error checking archived game:",G),"error"}},[]),k=T.useCallback(async B=>{const G=B||Mm(i);if(!G||!$t.safeParse(G).success){c(r("private_lobby.invalid_id"));return}b(!0),c(r("private_lobby.checking"));try{if(await A(G)){b(!1);return}const P=await M(G);switch(b(!1),P){case"success":c(r("private_lobby.joined_waiting")),d(!0);break;case"not_found":c(r("private_lobby.not_found"));break;case"invalid_version":c(r("private_lobby.version_mismatch"));break;case"error":c(r("private_lobby.error"));break}}catch(R){console.error("Error joining lobby:",R),c(r("private_lobby.error")),b(!1)}},[i,A,M,r]),E=async()=>{try{const B=await navigator.clipboard.readText(),G=Mm(B);s(G)}catch(B){console.error("Failed to read from clipboard:",B)}},U=B=>{const G=B.target.value,R=Mm(G);s(R),c("")},I=B=>{B.key==="Enter"&&!y&&k(),B.key==="Escape"&&e()};return g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col h-full max-w-2xl mx-auto",children:[g.jsx("div",{className:"flex items-center justify-center mb-6 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:r("private_lobby.title")})}),g.jsxs("div",{className:"flex-1 flex flex-col gap-6",children:[g.jsxs("div",{className:"w-full flex items-center gap-2",children:[g.jsx("input",{type:"text",value:i,onChange:U,onKeyDown:I,placeholder:r("private_lobby.enter_id"),className:"flex-1 px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-400 text-lg",disabled:y||u}),g.jsx("button",{onClick:E,className:"p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors border border-gray-600 cursor-pointer","aria-label":"Paste from clipboard",disabled:y||u,children:g.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:g.jsx("path",{d:"M 15 3 C 13.742188 3 12.847656 3.890625 12.40625 5 L 5 5 L 5 28 L 13 28 L 13 30 L 27 30 L 27 14 L 25 14 L 25 5 L 17.59375 5 C 17.152344 3.890625 16.257813 3 15 3 Z M 15 5 C 15.554688 5 16 5.445313 16 6 L 16 7 L 19 7 L 19 9 L 11 9 L 11 7 L 14 7 L 14 6 C 14 5.445313 14.445313 5 15 5 Z M 7 7 L 9 7 L 9 11 L 21 11 L 21 7 L 23 7 L 23 14 L 13 14 L 13 26 L 7 26 Z M 15 16 L 25 16 L 25 28 L 15 28 Z"})})})]}),o&&g.jsx("div",{className:"w-full px-4 py-3 bg-blue-900/30 border border-blue-700 rounded-lg text-blue-200 text-center",children:o}),u&&f.length>0&&g.jsxs("div",{className:"w-full",children:[g.jsxs("div",{className:"text-white font-semibold text-lg mb-3 text-center",children:[f.length," ",f.length===1?r("private_lobby.player"):r("private_lobby.players")]}),g.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:f.map((B,G)=>g.jsx("span",{className:"px-3 py-1 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm",children:B},G))})]}),!u&&g.jsx("button",{onClick:()=>k(),disabled:y||!i.trim(),className:`w-full px-6 py-3 rounded-lg font-semibold text-lg transition-colors ${y||!i.trim()?"bg-gray-600 cursor-not-allowed text-gray-400":"bg-blue-500 hover:bg-blue-600 text-white cursor-pointer"}`,children:r(y?"private_lobby.checking":"private_lobby.join_lobby")})]})]})})}function Sq({open:n,onClose:e}){const{t}=xt(),[r,i]=T.useState(Ee.World),[s,o]=T.useState(!1),[c,u]=T.useState(en.Medium),[d,f]=T.useState(qn.FFA),[p,y]=T.useState(Yr.Classic),[b,_]=T.useState(2),[w,S]=T.useState(400),[A,M]=T.useState(!1),[k,E]=T.useState(!1),[U,I]=T.useState(!0),[B,G]=T.useState(!0),[R,P]=T.useState(!1),[H,Y]=T.useState(!1),[L,q]=T.useState(!1),[W,N]=T.useState(new Set(Jm)),[V,J]=T.useState([]);T.useEffect(()=>{if(!n)return;(async()=>{try{const Se=(await dd.getAvailableMaps("/maps")).map(ie=>({dir:ie.dir,type:ie.type,name:E2[ie.dir]||D3(ie.dir),thumbnail:ie.thumbnail}));J(Se)}catch(pe){console.error("Failed to load maps:",pe),J([])}})()},[n]);const se=T.useMemo(()=>{const ee=[],pe=[],Se=[];return V.forEach(ie=>{fc.continental.includes(ie.type)?ee.push(ie):fc.regional.includes(ie.type)?pe.push(ie):fc.fantasy.includes(ie.type)&&Se.push(ie)}),{continental:ee,regional:pe,other:Se}},[V]),O=ee=>{const pe=new Set(W);pe.has(ee)?pe.delete(ee):pe.add(ee),N(pe)},F=()=>{const ee=Object.values(Ee),pe=Math.floor(Math.random()*ee.length);return ee[pe]},X=async()=>{const ee=s?F():r,pe=Pi(),Se=Pi(),ie=et.getUsername(),ve=et.getFlag(),Ce=et.getPattern(),Le=et.getColorPalette(),st=et.getColor();let ft,Ge;if(Ce)try{const _t=await(await fetch("/cosmetics/cosmetics.json")).json(),Xn=_t.patterns?.[Ce];if(Xn&&(ft=Xn.pattern,Le&&_t.colorPalettes)){const Kn=_t.colorPalettes[Le];Kn&&(Ge={name:Le,primary:Kn.primary,secondary:Kn.secondary})}}catch(mt){console.error("[SinglePlayerModal] Failed to load cosmetics:",mt)}const It={gameMap:ee,difficulty:c,gameMode:d,economyMode:p,gameType:qs.Singleplayer,gameMapSize:L?La.Compact:La.Normal,disableNPCs:A,bots:w,infiniteGold:R,infiniteTroops:H,instantBuild:k,donateGold:U,donateTroops:B,disabledUnits:Array.from(Jm).filter(mt=>!W.has(mt)),playerTeams:d===qn.Team?b:void 0},tt={gameID:Se,gameConfig:It,gameStartInfo:{gameID:Se,config:It,players:[{clientID:pe,username:ie||"Player",cosmetics:{flag:ve&&ve!=="xx"?ve:void 0,pattern:Ce&&ft?{name:Ce,patternData:ft,colorPalette:Ge}:void 0,color:st?{color:st}:void 0}}]}};console.log("[SinglePlayerModal] Starting singleplayer game:",tt),ae.emit(new Cc(tt)),e()},D=()=>{Rn.isCrazyGames?Rn.requestMidGameAd(()=>{X()}):X()};return g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col h-full max-w-4xl mx-auto max-h-[90vh]",children:[g.jsx("div",{className:"flex items-center justify-center mb-4 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:t("single_player.title")})}),g.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-200px)] pr-4 space-y-6",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("single_player.map")}),se.continental.length>0&&g.jsxs("div",{className:"mb-6",children:[g.jsx("h4",{className:"text-white font-semibold text-base mb-3 text-center",children:t("map_categories.continental")}),g.jsx("div",{className:"grid grid-cols-4 gap-4 justify-items-center max-w-4xl mx-auto",children:se.continental.map(ee=>g.jsxs("button",{onClick:()=>{i(ee.type),o(!1)},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${r===ee.type&&!s?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("img",{src:ee.thumbnail,alt:ee.name,className:"w-full aspect-video rounded object-cover"}),g.jsx("span",{className:"text-white text-sm text-center break-words line-clamp-2",children:ee.name})]},ee.dir))})]}),se.regional.length>0&&g.jsxs("div",{className:"mb-6",children:[g.jsx("h4",{className:"text-white font-semibold text-base mb-3 text-center",children:t("map_categories.regional")}),g.jsx("div",{className:"grid grid-cols-4 gap-4 justify-items-center max-w-4xl mx-auto",children:se.regional.map(ee=>g.jsxs("button",{onClick:()=>{i(ee.type),o(!1)},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${r===ee.type&&!s?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("img",{src:ee.thumbnail,alt:ee.name,className:"w-full aspect-video rounded object-cover"}),g.jsx("span",{className:"text-white text-sm text-center break-words line-clamp-2",children:ee.name})]},ee.dir))})]}),se.other.length>0&&g.jsxs("div",{className:"mb-6",children:[g.jsx("h4",{className:"text-white font-semibold text-base mb-3 text-center",children:t("map_categories.fantasy")}),g.jsxs("div",{className:"grid grid-cols-4 gap-4 justify-items-center max-w-4xl mx-auto",children:[se.other.map(ee=>g.jsxs("button",{onClick:()=>{i(ee.type),o(!1)},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${r===ee.type&&!s?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("img",{src:ee.thumbnail,alt:ee.name,className:"w-full aspect-video rounded object-cover"}),g.jsx("span",{className:"text-white text-sm text-center break-words line-clamp-2",children:ee.name})]},ee.dir)),g.jsxs("button",{onClick:()=>{o(!0)},className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${s?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("img",{src:"/images/RandomMap.webp",alt:"Random",className:"w-full aspect-video rounded object-cover"}),g.jsx("span",{className:"text-white text-sm text-center break-words line-clamp-2",children:t("map.random")})]})]})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("single_player.difficulty")}),g.jsx("div",{className:"grid grid-cols-4 gap-3 justify-items-center max-w-4xl mx-auto",children:P3.map(ee=>g.jsxs("button",{onClick:()=>u(ee.value),className:`flex flex-col items-center justify-center gap-2 p-4 rounded-lg border transition-colors w-full cursor-pointer min-h-[100px] ${c===ee.value?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:"flex gap-1 shrink-0",children:Array.from({length:4}).map((pe,Se)=>{const ie=Se<ee.skulls,ve=ee.value===en.Impossible&&Se===0;return g.jsxs("div",{className:"relative",children:[g.jsxs("svg",{className:`w-6 h-6 ${ie?ve?"text-red-500":"text-red-600":"text-gray-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12c0 5.52 4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8 0-4.41 3.59-8 8-8s8 3.59 8 8c0 4.41-3.59 8-8 8z"}),g.jsx("circle",{cx:"9",cy:"10",r:"1.5",fill:"currentColor"}),g.jsx("circle",{cx:"15",cy:"10",r:"1.5",fill:"currentColor"}),g.jsx("path",{d:"M12 16c-1.1 0-2-.9-2-2h4c0 1.1-.9 2-2 2z",fill:"currentColor"})]}),ve&&g.jsxs("svg",{className:"absolute top-0 left-0 w-6 h-6 text-orange-500",fill:"currentColor",viewBox:"0 0 24 24",style:{filter:"drop-shadow(0 0 2px rgba(255, 69, 0, 0.8))"},children:[g.jsx("path",{d:"M12 2l-1.5 3h3L12 2zm0 0l1.5 3h-3L12 2z"}),g.jsx("path",{d:"M10 4l-1 2h2l-1-2zm4 0l1 2h-2l1-2z"})]})]},Se)})}),g.jsx("span",{className:"text-white text-sm font-semibold text-center break-words whitespace-normal line-clamp-2",children:t(ee.labelKey)})]},ee.value))})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("single_player.mode")}),g.jsxs("div",{className:"flex justify-center items-center gap-2",children:[g.jsx("button",{onClick:()=>f(qn.FFA),className:`p-3 rounded-lg border transition-colors min-w-[120px] cursor-pointer ${d===qn.FFA?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal",children:t("game_mode.ffa")})}),g.jsx("button",{onClick:()=>f(qn.Team),className:`p-3 rounded-lg border transition-colors min-w-[120px] cursor-pointer ${d===qn.Team?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal",children:t("game_mode.teams")})})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("single_player.economy_mode")}),g.jsxs("div",{className:"flex justify-center items-center gap-2",children:[g.jsx("button",{onClick:()=>y(Yr.Classic),className:`p-3 rounded-lg border transition-colors min-w-[120px] cursor-pointer ${p===Yr.Classic?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal",children:t("economy_mode.classic")})}),g.jsx("button",{onClick:()=>y(Yr.Fast),className:`p-3 rounded-lg border transition-colors min-w-[120px] cursor-pointer ${p===Yr.Fast?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal",children:t("economy_mode.fast")})})]})]}),d===qn.Team&&g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("single_player.number_of_teams")}),g.jsxs("div",{className:"grid grid-cols-5 gap-3 justify-items-center max-w-4xl mx-auto",children:[[2,3,4,5,6,7].map(ee=>g.jsx("button",{onClick:()=>_(ee),className:`p-3 rounded-lg border transition-colors w-full cursor-pointer ${b===ee?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsx("span",{className:"text-white font-semibold break-words whitespace-normal text-center",children:t("public_lobby.teams",{num:ee})})},ee)),g.jsx("button",{onClick:()=>_(Ho),className:`p-3 rounded-lg border transition-colors w-full cursor-pointer ${b===Ho?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsxs("span",{className:"text-white font-semibold block break-words whitespace-normal text-center",children:[g.jsx("span",{className:"block",children:t("single_player.quads")}),g.jsxs("span",{className:"text-xs font-normal",children:["(",t("single_player.teams_of_4"),")"]})]})}),g.jsx("button",{onClick:()=>_(Go),className:`p-3 rounded-lg border transition-colors w-full cursor-pointer ${b===Go?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsxs("span",{className:"text-white font-semibold block break-words whitespace-normal text-center",children:[g.jsx("span",{className:"block",children:t("single_player.trios")}),g.jsxs("span",{className:"text-xs font-normal",children:["(",t("single_player.teams_of_3"),")"]})]})}),g.jsx("button",{onClick:()=>_(Fo),className:`p-3 rounded-lg border transition-colors w-full cursor-pointer ${b===Fo?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:g.jsxs("span",{className:"text-white font-semibold block break-words whitespace-normal text-center",children:[g.jsx("span",{className:"block",children:t("single_player.duos")}),g.jsxs("span",{className:"text-xs font-normal",children:["(",t("single_player.teams_of_2"),")"]})]})})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("single_player.options")}),g.jsxs("div",{className:"space-y-4",children:[g.jsx("div",{className:"bg-gray-800/80 rounded-lg p-4 border border-gray-700/50 max-w-2xl mx-auto",children:g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("label",{className:"text-white font-semibold min-w-[80px]",children:[t("host_modal.bots")," ",w]}),g.jsx("input",{type:"range",min:0,max:400,value:w,onChange:ee=>S(Number(ee.target.value)),className:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-400",style:{background:`linear-gradient(to right, rgb(96 165 250) 0%, rgb(96 165 250) ${w/400*100}%, rgb(55 65 81) ${w/400*100}%, rgb(55 65 81) 100%)`}})]})}),g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 justify-items-center max-w-4xl mx-auto",children:[g.jsxs("button",{onClick:()=>M(!A),className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${A?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${A?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("single_player.disable_nations")})]}),g.jsxs("button",{onClick:()=>E(!k),className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${k?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${k?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("single_player.instant_build")})]}),g.jsxs("button",{onClick:()=>P(!R),className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${R?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${R?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("single_player.infinite_gold")})]}),g.jsxs("button",{onClick:()=>Y(!H),className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${H?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${H?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("single_player.infinite_troops")})]}),g.jsxs("button",{onClick:()=>q(!L),className:`flex items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer min-w-0 ${L?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[g.jsx("div",{className:`w-5 h-5 rounded-full border-2 shrink-0 ${L?"border-blue-400 bg-blue-400":"border-gray-600"}`}),g.jsx("span",{className:"text-white text-sm break-words whitespace-normal min-w-0",children:t("single_player.mini_map")})]})]})]})]}),g.jsxs("div",{className:"pb-4",children:[g.jsx("h3",{className:"text-white font-bold text-lg mb-4 text-center",children:t("single_player.enable_settings")}),g.jsx("div",{className:"grid grid-cols-5 gap-3 justify-items-center max-w-4xl mx-auto",children:Jm.map(ee=>{const pe=W.has(ee);return g.jsxs("button",{onClick:()=>O(ee),className:`flex flex-col items-center gap-2 p-3 rounded-lg border transition-colors w-full cursor-pointer ${pe?"border-blue-400 bg-blue-400/20":"border-gray-700 bg-gray-800/50 hover:bg-gray-700/50"}`,children:[pe?g.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}):g.jsx("div",{className:"w-6 h-6 border-2 border-gray-600 rounded"}),g.jsx("span",{className:"text-white text-xs text-center break-words whitespace-normal",children:t(`unit_type.${R3(ee)}`)})]},ee)})})]})]}),g.jsx("div",{className:"pt-4 border-t border-gray-700 shrink-0 flex justify-center gap-3",children:g.jsx("button",{onClick:D,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors cursor-pointer",children:t("single_player.start_game")})})]})})}function Aq({open:n,onClose:e}){const{t}=xt();return g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col h-full max-w-5xl mx-auto max-h-[90vh]",children:[g.jsx("div",{className:"flex items-center justify-center mb-4 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:t("instructions.title")})}),g.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-200px)] pr-4 space-y-8",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.hotkeys")}),g.jsx("div",{className:"bg-gray-800/50 rounded-lg p-4",children:g.jsxs("table",{className:"w-full text-white",children:[g.jsx("thead",{children:g.jsxs("tr",{className:"border-b border-gray-700",children:[g.jsx("th",{className:"text-left py-2 px-4",children:t("instructions.key")}),g.jsx("th",{className:"text-left py-2 px-4",children:t("instructions.action")})]})}),g.jsxs("tbody",{className:"text-sm",children:[g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsx("td",{className:"py-2 px-4",children:g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"Space"})}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.alternate_view")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsxs("td",{className:"py-2 px-4",children:[g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"Shift"}),g.jsx("span",{className:"mx-1",children:"+"}),g.jsx("span",{className:"instructions-mouse-icon"})]}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.attack_altclick")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsxs("td",{className:"py-2 px-4",children:[g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"Ctrl"}),g.jsx("span",{className:"mx-1",children:"+"}),g.jsx("span",{className:"instructions-mouse-icon-button"})]}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.open_build_menu")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsxs("td",{className:"py-2 px-4",children:[g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"Alt"}),g.jsx("span",{className:"mx-1",children:"+"}),g.jsx("span",{className:"instructions-mouse-icon-button"})]}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.open_emote_menu")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsx("td",{className:"py-2 px-4",children:g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"C"})}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.center_camera")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsxs("td",{className:"py-2 px-4",children:[g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"Q"}),g.jsx("span",{className:"mx-1",children:"/"}),g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"E"})]}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.zoom")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsxs("td",{className:"py-2 px-4",children:[g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"W"}),g.jsx("span",{className:"mx-1",children:" "}),g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"A"}),g.jsx("span",{className:"mx-1",children:" "}),g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"S"}),g.jsx("span",{className:"mx-1",children:" "}),g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"D"})]}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.move_camera")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsxs("td",{className:"py-2 px-4",children:[g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"1"}),g.jsx("span",{className:"mx-1",children:"/"}),g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"2"})]}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.decrease_increase_attack_ratio")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsxs("td",{className:"py-2 px-4",children:[g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"Shift"}),g.jsx("span",{className:"mx-1",children:"+"}),g.jsx("span",{className:"instructions-mouse-scroll-wrapper",children:g.jsx("span",{className:"instructions-mouse-scroll-icon-button"})})]}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.decrease_increase_attack_ratio")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsxs("td",{className:"py-2 px-4",children:[g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"Alt"}),g.jsx("span",{className:"mx-1",children:"+"}),g.jsx("span",{className:"bg-black text-white px-2 py-1 rounded text-xs font-mono",children:"R"})]}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.reset_graphics")})]}),g.jsxs("tr",{className:"border-b border-gray-700/50",children:[g.jsx("td",{className:"py-2 px-4",children:g.jsx("span",{className:"instructions-mouse-scroll-icon-button"})}),g.jsx("td",{className:"py-2 px-4",children:t("instructions.auto_upgrade")})]})]})]})})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.game_ui")}),g.jsx("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:g.jsx("p",{children:t("instructions.leaderboard_desc")})}),g.jsx("h6",{className:"text-white font-bold text-lg mb-4 text-center",children:t("instructions.leaderboard")}),g.jsx("div",{className:"flex justify-center",children:g.jsx("img",{src:"/images/helpModal/leaderboard.png",alt:"Leaderboard",className:"max-w-full h-auto rounded-lg border border-gray-700"})})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.control_panel")}),g.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:[g.jsx("p",{className:"mb-4",children:t("instructions.control_panel_desc")}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("p",{children:g.jsx("strong",{children:t("instructions.pop")})}),g.jsx("p",{children:g.jsx("strong",{children:t("instructions.gold")})}),g.jsx("p",{children:g.jsx("strong",{children:t("instructions.troops_workers")})}),g.jsx("p",{className:"mt-4",children:g.jsx("strong",{children:t("instructions.attack_ratio")})})]})]}),g.jsx("div",{className:"flex justify-center",children:g.jsx("img",{src:"/images/helpModal/controlPanel.png",alt:"Control Panel",className:"max-w-full h-auto rounded-lg border border-gray-700"})})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.event_panel")}),g.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:[g.jsx("p",{className:"mb-4",children:t("instructions.event_panel_desc")}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-2",children:t("instructions.alliance")})}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-2",children:t("instructions.attacks")})}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-2",children:t("instructions.quick_chat")})})]})]}),g.jsx("h6",{className:"text-white font-bold text-lg mb-4 text-center",children:t("instructions.event_panel")}),g.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[g.jsx("img",{src:"/images/helpModal/eventsPanel.png",alt:"Events Panel",className:"max-w-full h-auto rounded-lg border border-gray-700"}),g.jsx("h6",{className:"text-white font-bold text-lg mb-4 text-center",children:t("instructions.attacks")})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.options")}),g.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm",children:[g.jsx("p",{className:"mb-4",children:t("instructions.options_desc")}),g.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[g.jsx("li",{children:t("instructions.pause_unpause")}),g.jsx("li",{children:t("instructions.timer")}),g.jsx("li",{children:t("instructions.exit_button")}),g.jsx("li",{children:t("instructions.settings")})]})]}),g.jsx("div",{className:"flex justify-center mt-4",children:g.jsx("img",{src:"/images/helpModal/options.png",alt:"Options",className:"max-w-full h-auto rounded-lg border border-gray-700"})})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.player_info_overlay")}),g.jsx("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:g.jsx("p",{children:t("instructions.player_info_overlay_desc")})}),g.jsx("div",{className:"flex justify-center",children:g.jsx("img",{src:"/images/helpModal/playerInfoOverlay.png",alt:"Player Info Overlay",className:"max-w-full h-auto rounded-lg border border-gray-700"})})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.radial_menu")}),g.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:[g.jsx("p",{className:"mb-4",children:t("instructions.radial_menu_desc")}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/BuildIconWhite.svg",alt:"Build",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.open_build_menu_radial")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/InfoIconSolidWhite.svg",alt:"Info",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.open_info_menu")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/BoatIconWhite.svg",alt:"Boat",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.send_boat")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/AllianceIconWhite.svg",alt:"Alliance",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.send_alliance_request")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/DonateTroopIconWhite.svg",alt:"Donate Troops",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.donate_troops_radial")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/DonateGoldIconWhite.svg",alt:"Donate Gold",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.donate_gold_radial")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/TraitorIconWhite.svg",alt:"betray",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.betray_ally")})})]})]})]}),g.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[g.jsx("img",{src:"/images/helpModal/circularMenu.png",alt:"Radial Menu",className:"max-w-full h-auto rounded-lg border border-gray-700"}),g.jsx("img",{src:"/images/helpModal/circularMenuAlly.png",alt:"Radial Menu Ally",className:"max-w-full h-auto rounded-lg border border-gray-700"})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.info_menu")}),g.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:[g.jsx("p",{className:"mb-4",children:t("instructions.info_menu_desc")}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-2",children:t("instructions.stopped_trading")})}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-2",children:t("instructions.traitor")})}),g.jsxs("div",{className:"space-y-2 mt-4",children:[g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/ChatIconWhite.svg",alt:"Chat",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.send_quick_chat")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/TargetIconWhite.svg",alt:"Target",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.place_target")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/AllianceIconWhite.svg",alt:"Alliance",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.send_alliance_request")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/EmojiIconWhite.svg",alt:"Emoji",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.send_emoji")})})]})]}),g.jsx("div",{className:"mt-4",children:g.jsx("p",{className:"font-semibold mb-2",children:t("instructions.stop_trading")})})]})]}),g.jsx("div",{className:"flex flex-col gap-4 items-center",children:g.jsx("img",{src:"/images/helpModal/playerInfoModal.png",alt:"Info Menu",className:"max-w-full h-auto rounded-lg border border-gray-700"})})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.when_you_ally")}),g.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:[g.jsx("p",{className:"mb-4",children:t("instructions.when_you_ally_desc")}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/TraitorIconWhite.svg",alt:"Betray",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.betray_ally_desc")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/DonateTroopIconWhite.svg",alt:"Donate Troops",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.donate_troops_ally")})})]}),g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("img",{src:"/images/DonateGoldIconWhite.svg",alt:"Donate Gold",className:"w-5 h-5 mt-0.5 shrink-0"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold",children:t("instructions.donate_gold_ally")})})]})]})]}),g.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[g.jsx("img",{src:"/images/helpModal/ally.png",alt:"Ally Info",className:"max-w-full h-auto rounded-lg border border-gray-700"}),g.jsx("img",{src:"/images/helpModal/traitor.png",alt:"Traitor",className:"max-w-full h-auto rounded-lg border border-gray-700"})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.build_menu")}),g.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:[g.jsx("p",{className:"mb-4",children:t("instructions.build_menu_desc")}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/CityIconWhite.svg",alt:"City",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.city")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.city_desc")})]})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/ShieldIconWhite.svg",alt:"Defense Post",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.defense_post")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.defense_post_desc")})]})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/PortIcon.svg",alt:"Port",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.port")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.port_desc")})]})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/FactoryIconWhite.svg",alt:"Factory",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.factory")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.factory_desc")})]})]})]})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.units")}),g.jsx("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm",children:g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/BattleshipIconWhite.svg",alt:"Warship",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.warship")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.warship_desc")})]})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/MissileSiloIconWhite.svg",alt:"Missile Silo",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.missile_silo")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.missile_silo_desc")})]})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/SamLauncherIconWhite.svg",alt:"SAM Launcher",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.sam_launcher")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.sam_launcher_desc")})]})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/NukeIconWhite.svg",alt:"Atom Bomb",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.atom_bomb")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.atom_bomb_desc")})]})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/MushroomCloudIconWhite.svg",alt:"Hydrogen Bomb",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.hydrogen_bomb")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.hydrogen_bomb_desc")})]})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/MIRVIcon.svg",alt:"MIRV",className:"w-8 h-8 shrink-0"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.mirv")}),g.jsx("p",{className:"text-xs text-gray-300",children:t("instructions.mirv_desc")})]})]})]})})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-white font-bold text-xl mb-4 text-center",children:t("instructions.player_icons")}),g.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 text-white text-sm mb-4",children:[g.jsx("p",{className:"mb-4",children:t("instructions.player_icons_desc")}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/CrownIcon.png",alt:"Crown",className:"w-16 h-16 shrink-0 rounded border border-gray-700"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.crown")})})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/TraitorIconWhite.svg",alt:"Broken Shield",className:"w-16 h-16 shrink-0 rounded border border-gray-700 p-2"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.broken_shield")})})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/AllianceIconWhite.svg",alt:"Handshake",className:"w-16 h-16 shrink-0 rounded border border-gray-700 p-2"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.handshake")})})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/EmbargoWhiteIcon.svg",alt:"Embargo",className:"w-16 h-16 shrink-0 rounded border border-gray-700"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.dollar_stop")})})]}),g.jsxs("div",{className:"flex items-start gap-4",children:[g.jsx("img",{src:"/images/AllianceIconWhite.svg",alt:"Alliance Request",className:"w-16 h-16 shrink-0 rounded border border-gray-700"}),g.jsx("div",{children:g.jsx("p",{className:"font-semibold mb-1",children:t("instructions.envelope")})})]})]})]})]})]})]})})}const aI=[{code:"en",en:"English",native:"English",svg:"gb"},{code:"ar",en:"Arabic",native:"",svg:"sa"},{code:"bg",en:"Bulgarian",native:"",svg:"bg"},{code:"bn",en:"Bengali",native:"",svg:"bd"},{code:"cs",en:"Czech",native:"etina",svg:"cz"},{code:"da",en:"Danish",native:"Dansk",svg:"dk"},{code:"de",en:"German",native:"Deutsch",svg:"de"},{code:"eo",en:"Esperanto",native:"Esperanto",svg:"eo"},{code:"es",en:"Spanish",native:"Espaol",svg:"es"},{code:"fi",en:"Finnish",native:"Suomi",svg:"fi"},{code:"fr",en:"French",native:"Franais",svg:"fr"},{code:"gl",en:"Galician",native:"Galego",svg:"es"},{code:"he",en:"Hebrew",native:"",svg:"il"},{code:"hi",en:"Hindi",native:"",svg:"in"},{code:"hu",en:"Hungarian",native:"Magyar",svg:"hu"},{code:"it",en:"Italian",native:"Italiano",svg:"it"},{code:"ja",en:"Japanese",native:"",svg:"jp"},{code:"ko",en:"Korean",native:"",svg:"kr"},{code:"mk",en:"Macedonian",native:"",svg:"mk"},{code:"nl",en:"Dutch",native:"Nederlands",svg:"nl"},{code:"pl",en:"Polish",native:"Polski",svg:"pl"},{code:"pt-BR",en:"Portuguese (Brazil)",native:"Portugus (Brasil)",svg:"br"},{code:"pt-PT",en:"Portuguese (Portugal)",native:"Portugus (Portugal)",svg:"pt"},{code:"ru",en:"Russian",native:"",svg:"ru"},{code:"sh",en:"Serbo-Croatian",native:"Srpskohrvatski",svg:"rs"},{code:"sk",en:"Slovak",native:"Slovenina",svg:"sk"},{code:"sl",en:"Slovenian",native:"Slovenina",svg:"si"},{code:"sv-SE",en:"Swedish",native:"Svenska",svg:"se"},{code:"tp",en:"Toki Pona",native:"Toki Pona",svg:"tp"},{code:"tr",en:"Turkish",native:"Trke",svg:"tr"},{code:"uk",en:"Ukrainian",native:"",svg:"ua"},{code:"zh-CN",en:"Chinese (Simplified)",native:"",svg:"cn"}],oI=n=>aI.find(e=>e.code===n);function Cq({open:n,onClose:e,onSelectLanguage:t,currentLanguage:r="en"}){const{t:i}=xt(),[s,o]=T.useState([]),[c,u]=T.useState(!0),[d,f]=T.useState(new Set),[p,y]=T.useState("");T.useEffect(()=>{if(!n){o([]),u(!0),f(new Set),y("");return}(async()=>{u(!0),o([]);const A=[...r?[r]:[],...aI.map(M=>M.code).filter(M=>M!==r)];for(const M of A){const k=oI(M);k&&(o(E=>[...E,k]),setTimeout(()=>{f(E=>new Set([...E,k.code]))},10))}u(!1)})()},[n,r]);const b=S=>{t&&t(S),e()},_=S=>S?`/flags/${S}.svg`:null,w=s.filter(S=>{if(!p.trim())return!0;const A=p.toLowerCase();return S.native.toLowerCase().includes(A)||S.en.toLowerCase().includes(A)||S.code.toLowerCase().includes(A)});return g.jsx(vr,{open:n,onClose:e,children:g.jsxs("div",{className:"w-full flex flex-col h-full max-h-[90vh]",children:[g.jsx("div",{className:"flex items-center justify-center mb-4 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:i("language.select_language")})}),g.jsx("div",{className:"mb-4 shrink-0",children:g.jsx("input",{type:"text",value:p,onChange:S=>y(S.target.value),placeholder:i("language.search_placeholder")||"Search languages...",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})}),g.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-150px)] pr-2",children:c&&s.length===0?g.jsx("div",{className:"flex items-center justify-center py-8",children:g.jsx("span",{className:"text-white",children:i("language.loading_languages")})}):w.length===0?g.jsx("div",{className:"flex items-center justify-center py-8",children:g.jsx("span",{className:"text-gray-400",children:i("language.no_results")||"No languages found"})}):g.jsxs("div",{className:"space-y-2",children:[(()=>{const S=w.find(A=>A.code===r);return S?g.jsx(TT,{lang:S,isSelected:!0,isVisible:d.has(S.code),onSelect:b,getFlagPath:_},S.code):null})(),w.filter(S=>S.code!==r).map(S=>g.jsx(TT,{lang:S,isSelected:!1,isVisible:d.has(S.code),onSelect:b,getFlagPath:_},S.code))]})})]})})}function TT({lang:n,isSelected:e,isVisible:t,onSelect:r,getFlagPath:i}){const s=i(n.svg);return g.jsxs("button",{onClick:()=>r(n.code),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg border transition-all duration-300 ease-out text-left cursor-pointer ${e?"bg-gray-700 border-gray-600":"bg-gray-800/50 border-gray-700 hover:bg-gray-700/50"}`,style:{opacity:t?1:0,transform:t?"translateX(0)":"translateX(-10px)",transition:"opacity 0.3s ease-out, transform 0.3s ease-out"},children:[g.jsx("div",{className:"w-8 h-6 shrink-0 flex items-center justify-center rounded overflow-hidden border border-gray-600",children:s?g.jsx("img",{src:s,alt:n.en,className:"w-full h-full object-cover",onError:o=>{o.target.style.display="none"}}):g.jsx("div",{className:"w-full h-full bg-gray-700 flex items-center justify-center",children:g.jsx("span",{className:"text-xs text-gray-400",children:n.code.toUpperCase()})})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"text-white font-medium",children:n.native}),g.jsxs("div",{className:"text-gray-400 text-sm",children:["(",n.en,")"]})]})]})}function kq(){const{t:n}=xt(),[e,t]=T.useState(!1),[r,i]=T.useState(""),[s,o]=T.useState(""),[c,u]=T.useState(!1);T.useEffect(()=>{const p=y=>{i(y.title),o(y.message),t(!0)};return ae.on(f1,p),()=>{ae.off(f1,p)}},[]);const d=()=>{t(!1),u(!0)},f=()=>{t(!1)};return g.jsxs(g.Fragment,{children:[g.jsx(vr,{open:e,onClose:f,width:"500px",children:g.jsxs("div",{className:"flex flex-col gap-4",children:[g.jsx("h2",{className:"text-2xl font-bold text-red-500",children:r}),g.jsx("div",{className:"text-gray-300 whitespace-pre-wrap wrap-break-word",children:s}),g.jsxs("div",{className:"mt-2",children:[g.jsx("p",{className:"text-sm text-gray-400",children:n("errors.try_solutions")}),g.jsxs("ul",{className:"list-disc list-inside mt-2 text-sm text-gray-300 space-y-1",children:[g.jsx("li",{children:n("errors.refresh_page")}),g.jsx("li",{children:n("errors.change_pattern_flag")})]}),g.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mt-3",children:[g.jsx("span",{children:n("errors.if_issue_persists")}),g.jsx("button",{onClick:d,className:"px-3 py-1 text-sm rounded border transition-colors cursor-pointer bg-red-600/20 hover:bg-red-600/30 border-red-600/50 text-red-400 hover:text-red-300 whitespace-nowrap",children:n("errors.reset_settings")})]})]}),g.jsx("div",{className:"pt-4 border-t border-gray-700",children:g.jsx(ic,{onClick:f,variant:"full-width",children:n("common.close")})})]})}),g.jsx(tN,{open:c,onClose:()=>u(!1)})]})}var Wt=(n=>(n[n.Tile=0]="Tile",n[n.Unit=1]="Unit",n[n.Player=2]="Player",n[n.DisplayEvent=3]="DisplayEvent",n[n.DisplayChatEvent=4]="DisplayChatEvent",n[n.AllianceRequest=5]="AllianceRequest",n[n.AllianceRequestReply=6]="AllianceRequestReply",n[n.BrokeAlliance=7]="BrokeAlliance",n[n.AllianceExpired=8]="AllianceExpired",n[n.AllianceExtension=9]="AllianceExtension",n[n.TargetPlayer=10]="TargetPlayer",n[n.Emoji=11]="Emoji",n[n.Win=12]="Win",n[n.Hash=13]="Hash",n[n.UnitIncoming=14]="UnitIncoming",n[n.BonusEvent=15]="BonusEvent",n[n.RailroadEvent=16]="RailroadEvent",n[n.ConquestEvent=17]="ConquestEvent",n[n.EmbargoEvent=18]="EmbargoEvent",n))(Wt||{}),ui=(n=>(n[n.VERTICAL=0]="VERTICAL",n[n.HORIZONTAL=1]="HORIZONTAL",n[n.TOP_LEFT=2]="TOP_LEFT",n[n.TOP_RIGHT=3]="TOP_RIGHT",n[n.BOTTOM_LEFT=4]="BOTTOM_LEFT",n[n.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",n))(ui||{});class Tq{constructor(){}smallID(){return 0}clientID(){return"TERRA_NULLIUS_CLIENT_ID"}id(){return null}isPlayer(){return!1}}class Eq{constructor(e){this.gm=e,this.cellSize=64,this.cellShift=Math.log2(this.cellSize),this.grid=Array(Math.ceil(e.height()/this.cellSize)).fill(null).map(()=>Array(Math.ceil(e.width()/this.cellSize)).fill(null).map(()=>new Map))}getGridCoords(e,t){return[e>>this.cellShift,t>>this.cellShift]}addUnit(e){const t=e.tile(),[r,i]=this.getGridCoords(this.gm.x(t),this.gm.y(t));if(this.isValidCell(r,i)){const s=this.grid[i][r].get(e.type());s!==void 0?s.add(e):this.grid[i][r].set(e.type(),new Set([e]))}}removeUnit(e){const t=e.tile();this.removeUnitByTile(e,t)}removeUnitByTile(e,t){const[r,i]=this.getGridCoords(this.gm.x(t),this.gm.y(t));if(this.isValidCell(r,i)){const s=this.grid[i][r].get(e.type());s!==void 0&&s.delete(e)}}updateUnitCell(e){const t=e.tile(),r=e.lastTile(),[i,s]=this.getGridCoords(this.gm.x(r),this.gm.y(r)),[o,c]=this.getGridCoords(this.gm.x(t),this.gm.y(t));(i!==o||s!==c)&&(this.removeUnitByTile(e,r),this.addUnit(e))}isValidCell(e,t){return e>=0&&e<this.grid[0].length&&t>=0&&t<this.grid.length}getCellsInRange(e,t){const r=this.gm.x(e),i=this.gm.y(e),[s,o]=this.getGridCoords(r,i),c=Math.ceil(t/this.cellSize),u=Math.max(0,s-c),d=Math.min(this.grid[0].length-1,s+c),f=Math.max(0,o-c),p=Math.min(this.grid.length-1,o+c);return{startGridX:u,endGridX:d,startGridY:f,endGridY:p}}squaredDistanceFromTile(e,t){const r=this.gm.x(t),i=this.gm.y(t),s=this.gm.x(e.tile()),o=this.gm.y(e.tile()),c=s-r,u=o-i;return c*c+u*u}nearbyUnits(e,t,r,i){const s=[],{startGridX:o,endGridX:c,startGridY:u,endGridY:d}=this.getCellsInRange(e,t),f=t*t,p=Array.isArray(r)?new Set(r):new Set([r]);for(let y=u;y<=d;y++)for(let b=o;b<=c;b++)for(const _ of p){const w=this.grid[y][b].get(_);if(w!==void 0)for(const S of w){if(!S.isActive())continue;const A=this.squaredDistanceFromTile(S,e);if(A>f)continue;const M={unit:S,distSquared:A};i!==void 0&&!i(M)||s.push(M)}}return s}unitIsInRange(e,t,r,i){return!e.isActive()||i!==void 0&&e.owner().id()!==i?!1:this.squaredDistanceFromTile(e,t)<=r}hasUnitNearby(e,t,r,i){const{startGridX:s,endGridX:o,startGridY:c,endGridY:u}=this.getCellsInRange(e,t),d=t*t;for(let f=c;f<=u;f++)for(let p=s;p<=o;p++){const y=this.grid[f][p].get(r);if(y!==void 0){for(const b of y)if(this.unitIsInRange(b,e,d,i))return!0}}return!1}}const ET=new OM;class Mq{constructor(e,t){this.gameView=e,this.data=t,this._wasUpdated=!0,this.lastPos=[],this.lastPos.push(t.pos),this._createdAt=this.gameView.ticks()}createdAt(){return this._createdAt}wasUpdated(){return this._wasUpdated}lastTiles(){return this.lastPos}lastTile(){return this.lastPos.length===0?this.data.pos:this.lastPos[0]}update(e){this.lastPos.push(e.pos),this._wasUpdated=!0,this.data=e}id(){return this.data.id}targetable(){return this.data.targetable}type(){return this.data.unitType}troops(){return this.data.troops}retreating(){if(this.type()!==$.TransportShip)throw Error("Must be a transport ship");return this.data.retreating}tile(){return this.data.pos}owner(){return this.gameView.playerBySmallID(this.data.ownerID)}isActive(){return this.data.isActive}reachedTarget(){return this.data.reachedTarget}hasHealth(){return this.data.health!==void 0}health(){return this.data.health??0}constructionType(){return this.data.constructionType}targetUnitId(){return this.data.targetUnitId}targetTile(){return this.data.targetTile}missileReadinesss(){const e=this.data.level,t=this.data.missileTimerQueue.length;if(t===0)return 1;const r=e-t;if(r===0&&e>1)return 0;let i=r/e;const s=this.data.unitType===$.SAMLauncher?this.gameView.config().SAMCooldown():this.gameView.config().SiloCooldown();for(const o of this.data.missileTimerQueue){const d=(this.gameView.ticks()-o)/s/e;i+=d}return i}level(){return this.data.level}hasTrainStation(){return this.data.hasTrainStation}trainType(){return this.data.trainType}isLoaded(){return this.data.loaded}}class Op{constructor(e,t,r,i){this.game=e,this.data=t,this.nameData=r,this.cosmetics=i,this.anonymousName=null,t.clientID===e.myClientID()?this.anonymousName=this.data.name:this.anonymousName=p7(this.data.name,this.data.playerType);const s=this.game.config().theme().territoryColor(this),o=this.game.config().theme().borderColor(s),c=this.cosmetics.pattern;c&&(c.colorPalette??={name:"",primary:s.toHex(),secondary:o.toHex()}),this.team()===null?this._territoryColor=j(this.cosmetics.color?.color??this.cosmetics.pattern?.colorPalette?.primary??s.toHex()):this._territoryColor=s;const u=this.game.myClientID()===this.data.clientID?this.game.config().theme().focusedBorderColor():o;this._borderColor=new od(u.toHex()),this._defendedBorderColors=this.game.config().theme().defendedBorderColors(this._borderColor),this.decoder=this.cosmetics.pattern===void 0?void 0:new Ox(this.cosmetics.pattern,eg)}territoryColor(e){return e===void 0||this.decoder===void 0?this._territoryColor:this.decoder.isPrimary(this.game.x(e),this.game.y(e))?this._territoryColor:this._borderColor}borderColor(e,t=!1){if(e===void 0||!t)return this._borderColor;const r=this.game.x(e),i=this.game.y(e);return r%2===0&&i%2===0||i%2===1&&r%2===1?this._defendedBorderColors.light:this._defendedBorderColors.dark}async actions(e){return this.game.worker.playerInteraction(this.id(),e&&this.game.x(e),e&&this.game.y(e))}async borderTiles(){return this.game.worker.playerBorderTiles(this.id())}outgoingAttacks(){return this.data.outgoingAttacks}incomingAttacks(){return this.data.incomingAttacks}async attackAveragePosition(e,t){return this.game.worker.attackAveragePosition(e,t)}units(...e){return this.game.units(...e).filter(t=>t.owner().smallID()===this.smallID())}nameLocation(){return this.nameData}smallID(){return this.data.smallID}name(){return this.anonymousName!==null&&ET.anonymousNames()?this.anonymousName:this.data.name}displayName(){return this.anonymousName!==null&&ET.anonymousNames()?this.anonymousName:this.data.name}clientID(){return this.data.clientID}id(){return this.data.id}team(){return this.data.team??null}type(){return this.data.playerType}isAlive(){return this.data.isAlive}isPlayer(){return!0}numTilesOwned(){return this.data.tilesOwned}allies(){return this.data.allies.map(e=>this.game.playerBySmallID(e))}targets(){return this.data.targets.map(e=>this.game.playerBySmallID(e))}gold(){return this.data.gold}troops(){return this.data.troops}totalUnitLevels(e){return this.units(e).map(t=>t.level()).reduce((t,r)=>t+r,0)}isAlliedWith(e){return this.data.allies.some(t=>e.smallID()===t)}isOnSameTeam(e){return this.data.team!==void 0&&this.data.team===e.data.team}isFriendly(e){return this.isAlliedWith(e)||this.isOnSameTeam(e)}isRequestingAllianceWith(e){return this.data.outgoingAllianceRequests.some(t=>e.id()===t)}alliances(){return this.data.alliances}hasEmbargoAgainst(e){return this.data.embargoes.has(e.id())}hasEmbargo(e){return this.hasEmbargoAgainst(e)||e.hasEmbargoAgainst(this)}profile(){return this.game.worker.playerProfile(this.smallID())}bestTransportShipSpawn(e){return this.game.worker.transportShipSpawn(this.id(),e)}transitiveTargets(){return[...this.targets(),...this.allies().flatMap(e=>e.targets())]}isTraitor(){return this.data.isTraitor}getTraitorRemainingTicks(){return Math.max(0,this.data.traitorRemainingTicks??0)}outgoingEmojis(){return this.data.outgoingEmojis}hasSpawned(){return this.data.hasSpawned}isDisconnected(){return this.data.isDisconnected}canDeleteUnit(){return!0}}class Nq{constructor(e,t,r,i,s,o){this.worker=e,this._config=t,this._mapData=r,this._myClientID=i,this._gameID=s,this.humans=o,this.smallIDToID=new Map,this._players=new Map,this._units=new Map,this.updatedTiles=[],this._myPlayer=null,this._focusedPlayer=null,this.toDelete=new Set,this._cosmetics=new Map,this._map=this._mapData.gameMap,this.lastUpdate=null,this.unitGrid=new Eq(this._map),this._cosmetics=new Map(this.humans.map(c=>[c.clientID,c.cosmetics??{}]));for(const c of this._mapData.nations)this._cosmetics.set(c.name,{flag:c.flag})}isOnEdgeOfMap(e){return this._map.isOnEdgeOfMap(e)}updatesSinceLastTick(){return this.lastUpdate?.updates??null}update(e){if(this.toDelete.forEach(t=>this._units.delete(t)),this.toDelete.clear(),this.lastUpdate=e,this.updatedTiles=[],this.lastUpdate.packedTileUpdates.forEach(t=>{this.updatedTiles.push(this.updateTile(t))}),e.updates===null)throw new Error("lastUpdate.updates not initialized");e.updates[Wt.Player].forEach(t=>{this.smallIDToID.set(t.smallID,t.id);const r=this._players.get(t.id);r!==void 0?(r.data=t,r.nameData=e.playerNameViewData[t.id]):this._players.set(t.id,new Op(this,t,e.playerNameViewData[t.id],this._cosmetics.get(t.clientID??"")??this._cosmetics.get(t.name)??{}))}),this._myPlayer??=this.playerByClientID(this._myClientID);for(const t of this._units.values())t._wasUpdated=!1,t.lastPos=t.lastPos.slice(-1);e.updates[Wt.Unit].forEach(t=>{let r=this._units.get(t.id);r!==void 0?r.update(t):(r=new Mq(this,t),this._units.set(t.id,r),this.unitGrid.addUnit(r)),t.isActive?r.tile()!==r.lastTile()&&this.unitGrid.updateUnitCell(r):this.unitGrid.removeUnit(r),r.isActive()||this.toDelete.add(r.id())})}recentlyUpdatedTiles(){return this.updatedTiles}nearbyUnits(e,t,r,i){return this.unitGrid.nearbyUnits(e,t,r,i)}hasUnitNearby(e,t,r,i){return this.unitGrid.hasUnitNearby(e,t,r,i)}myClientID(){return this._myClientID}myPlayer(){return this._myPlayer}player(e){const t=this._players.get(e);if(t===void 0)throw Error(`player id ${e} not found`);return t}players(){return Array.from(this._players.values())}playerBySmallID(e){if(e===0)return new Tq;const t=this.smallIDToID.get(e);if(t===void 0)throw new Error(`small id ${e} not found`);return this.player(t)}playerByClientID(e){const t=Array.from(this._players.values()).filter(r=>r.clientID()===e)[0]??null;return t===null?null:t}hasPlayer(e){return!1}playerViews(){return Array.from(this._players.values())}owner(e){return this.playerBySmallID(this.ownerID(e))}ticks(){return this.lastUpdate===null?0:this.lastUpdate.tick}inSpawnPhase(){return this.ticks()<=this._config.numSpawnPhaseTurns()}config(){return this._config}units(...e){return e.length===0?Array.from(this._units.values()).filter(t=>t.isActive()):Array.from(this._units.values()).filter(t=>t.isActive()&&e.includes(t.type()))}unit(e){return this._units.get(e)}unitInfo(e){return this._config.unitInfo(e)}ref(e,t){return this._map.ref(e,t)}isValidRef(e){return this._map.isValidRef(e)}x(e){return this._map.x(e)}y(e){return this._map.y(e)}cell(e){return this._map.cell(e)}width(){return this._map.width()}height(){return this._map.height()}numLandTiles(){return this._map.numLandTiles()}isValidCoord(e,t){return this._map.isValidCoord(e,t)}isLand(e){return this._map.isLand(e)}isOceanShore(e){return this._map.isOceanShore(e)}isOcean(e){return this._map.isOcean(e)}isShoreline(e){return this._map.isShoreline(e)}magnitude(e){return this._map.magnitude(e)}ownerID(e){return this._map.ownerID(e)}hasOwner(e){return this._map.hasOwner(e)}setOwnerID(e,t){return this._map.setOwnerID(e,t)}hasFallout(e){return this._map.hasFallout(e)}setFallout(e,t){return this._map.setFallout(e,t)}isBorder(e){return this._map.isBorder(e)}neighbors(e){return this._map.neighbors(e)}isWater(e){return this._map.isWater(e)}isLake(e){return this._map.isLake(e)}isShore(e){return this._map.isShore(e)}cost(e){return this._map.cost(e)}terrainType(e){return this._map.terrainType(e)}forEachTile(e){return this._map.forEachTile(e)}manhattanDist(e,t){return this._map.manhattanDist(e,t)}euclideanDistSquared(e,t){return this._map.euclideanDistSquared(e,t)}bfs(e,t){return this._map.bfs(e,t)}toTileUpdate(e){return this._map.toTileUpdate(e)}updateTile(e){return this._map.updateTile(e)}numTilesWithFallout(){return this._map.numTilesWithFallout()}gameID(){return this._gameID}focusedPlayer(){return this.myPlayer()}setFocusedPlayer(e){this._focusedPlayer=e}}class Iq{constructor(e,t){this.gameStartInfo=e,this.clientID=t,this.isInitialized=!1,this.worker=new Worker(new URL("https://frontwars.io/assets/Worker.worker-DcrgD94F.js",import.meta.url),{type:"module"}),this.messageHandlers=new Map,this.worker.addEventListener("message",this.handleWorkerMessage.bind(this))}handleWorkerMessage(e){const t=e.data;switch(t.type){case"game_update":this.gameUpdateCallback&&t.gameUpdate&&this.gameUpdateCallback(t.gameUpdate);break;case"initialized":default:t.id&&this.messageHandlers.has(t.id)&&(this.messageHandlers.get(t.id)(t),this.messageHandlers.delete(t.id));break}}initialize(){return new Promise((e,t)=>{const r=Pi();this.messageHandlers.set(r,i=>{i.type==="initialized"&&(this.isInitialized=!0,e())}),this.worker.postMessage({type:"init",id:r,gameStartInfo:this.gameStartInfo,clientID:this.clientID}),setTimeout(()=>{this.isInitialized||(this.messageHandlers.delete(r),t(new Error("Worker initialization timeout")))},5e3)})}start(e){if(!this.isInitialized)throw new Error("Failed to initialize pathfinder");this.gameUpdateCallback=e}sendTurn(e){if(!this.isInitialized)throw new Error("Worker not initialized");this.worker.postMessage({type:"turn",turn:e})}sendHeartbeat(){this.worker.postMessage({type:"heartbeat"})}playerProfile(e){return new Promise((t,r)=>{if(!this.isInitialized){r(new Error("Worker not initialized"));return}const i=Pi();this.messageHandlers.set(i,s=>{s.type==="player_profile_result"&&s.result!==void 0&&t(s.result)}),this.worker.postMessage({type:"player_profile",id:i,playerID:e})})}playerBorderTiles(e){return new Promise((t,r)=>{if(!this.isInitialized){r(new Error("Worker not initialized"));return}const i=Pi();this.messageHandlers.set(i,s=>{s.type==="player_border_tiles_result"&&s.result!==void 0&&t(s.result)}),this.worker.postMessage({type:"player_border_tiles",id:i,playerID:e})})}playerInteraction(e,t,r){return new Promise((i,s)=>{if(!this.isInitialized){s(new Error("Worker not initialized"));return}const o=Pi();this.messageHandlers.set(o,c=>{c.type==="player_actions_result"&&c.result!==void 0&&i(c.result)}),this.worker.postMessage({type:"player_actions",id:o,playerID:e,x:t,y:r})})}attackAveragePosition(e,t){return new Promise((r,i)=>{if(!this.isInitialized){i(new Error("Worker not initialized"));return}const s=Pi();this.messageHandlers.set(s,o=>{o.type==="attack_average_position_result"&&o.x!==void 0&&o.y!==void 0&&(o.x===null||o.y===null?r(null):r(new yr(o.x,o.y)))}),this.worker.postMessage({type:"attack_average_position",id:s,playerID:e,attackID:t})})}transportShipSpawn(e,t){return new Promise((r,i)=>{if(!this.isInitialized){i(new Error("Worker not initialized"));return}const s=Pi();this.messageHandlers.set(s,o=>{o.type==="transport_ship_spawn_result"&&o.result!==void 0&&r(o.result)}),this.worker.postMessage({type:"transport_ship_spawn",id:s,playerID:e,targetTile:t})})}cleanup(){this.worker.terminate(),this.messageHandlers.clear(),this.gameUpdateCallback=void 0}}const _n=class _n{constructor(e,t,r,i){if(this.numLandTiles_=i,this._numTilesWithFallout=0,r.length!==e*t)throw new Error(`Terrain data length ${r.length} doesn't match dimensions ${e}x${t}`);this.width_=e,this.height_=t,this.terrain=r,this.state=new Uint16Array(e*t);let s=0;this.refToX=new Array(e*t),this.refToY=new Array(e*t),this.yToRef=new Array(t);for(let o=0;o<t;o++){this.yToRef[o]=s;for(let c=0;c<e;c++)this.refToX[s]=c,this.refToY[s]=o,s++}}numTilesWithFallout(){return this._numTilesWithFallout}ref(e,t){if(!this.isValidCoord(e,t))throw new Error(`Invalid coordinates: ${e},${t}`);return this.yToRef[t]+e}isValidRef(e){return e>=0&&e<this.refToX.length}x(e){return this.refToX[e]}y(e){return this.refToY[e]}cell(e){return new yr(this.x(e),this.y(e))}width(){return this.width_}height(){return this.height_}numLandTiles(){return this.numLandTiles_}isValidCoord(e,t){return e>=0&&e<this.width_&&t>=0&&t<this.height_}isLand(e){return!!(this.terrain[e]&1<<_n.IS_LAND_BIT)}isOceanShore(e){return this.isLand(e)&&this.neighbors(e).some(t=>this.isOcean(t))}isOcean(e){return!!(this.terrain[e]&1<<_n.OCEAN_BIT)}isShoreline(e){return!!(this.terrain[e]&1<<_n.SHORELINE_BIT)}magnitude(e){return this.terrain[e]&_n.MAGNITUDE_MASK}ownerID(e){return this.state[e]&_n.PLAYER_ID_MASK}hasOwner(e){return this.ownerID(e)!==0}setOwnerID(e,t){if(t>_n.PLAYER_ID_MASK)throw new Error(`Player ID ${t} exceeds maximum value ${_n.PLAYER_ID_MASK}`);this.state[e]=this.state[e]&~_n.PLAYER_ID_MASK|t}hasFallout(e){return!!(this.state[e]&1<<_n.FALLOUT_BIT)}setFallout(e,t){const r=this.hasFallout(e);t?r||(this._numTilesWithFallout++,this.state[e]|=1<<_n.FALLOUT_BIT):r&&(this._numTilesWithFallout--,this.state[e]&=~(1<<_n.FALLOUT_BIT))}isOnEdgeOfMap(e){const t=this.x(e),r=this.y(e);return t===0||t===this.width()-1||r===0||r===this.height()-1}isBorder(e){return this.neighbors(e).some(t=>this.ownerID(t)!==this.ownerID(e))}hasDefenseBonus(e){return!!(this.state[e]&1<<_n.DEFENSE_BONUS_BIT)}setDefenseBonus(e,t){t?this.state[e]|=1<<_n.DEFENSE_BONUS_BIT:this.state[e]&=~(1<<_n.DEFENSE_BONUS_BIT)}isWater(e){return!this.isLand(e)}isLake(e){return!this.isLand(e)&&!this.isOcean(e)}isShore(e){return this.isLand(e)&&this.isShoreline(e)}cost(e){return this.magnitude(e)<10?2:1}terrainType(e){if(this.isLand(e)){const t=this.magnitude(e);return t<10?tr.Plains:t<20?tr.Highland:tr.Mountain}return this.isOcean(e)?tr.Ocean:tr.Lake}neighbors(e){const t=[],r=this.width_,i=this.refToX[e];return e>=r&&t.push(e-r),e<(this.height_-1)*r&&t.push(e+r),i!==0&&t.push(e-1),i!==r-1&&t.push(e+1),t}forEachTile(e){for(let t=0;t<this.width_*this.height_;t++)e(t)}manhattanDist(e,t){return Math.abs(this.x(e)-this.x(t))+Math.abs(this.y(e)-this.y(t))}euclideanDistSquared(e,t){const r=this.x(e)-this.x(t),i=this.y(e)-this.y(t);return r*r+i*i}bfs(e,t){const r=new Set,i=[];for(t(this,e)&&(r.add(e),i.push(e));i.length>0;){const s=i.pop();if(s!==void 0)for(const o of this.neighbors(s))!r.has(o)&&t(this,o)&&(r.add(o),i.push(o))}return r}toTileUpdate(e){return BigInt(e)<<16n|BigInt(this.state[e])}updateTile(e){const t=Number(e>>16n),r=Number(e&0xffffn),i=this.hasFallout(t);this.state[t]=r;const s=this.hasFallout(t);return i&&!s&&this._numTilesWithFallout--,!i&&s&&this._numTilesWithFallout++,t}};_n.IS_LAND_BIT=7,_n.SHORELINE_BIT=6,_n.OCEAN_BIT=5,_n.MAGNITUDE_MASK=31,_n.PLAYER_ID_MASK=4095,_n.FALLOUT_BIT=13,_n.DEFENSE_BONUS_BIT=14;let k1=_n;function T1(n,e,t=!1){const r=e*e;return t?(i,s)=>{const o=i.x(n)-.5,c=i.y(n)-.5,u=i.x(s)-o,d=i.y(s)-c;return u*u+d*d<=r}:(i,s)=>i.euclideanDistSquared(n,s)<=r}function Rq(n,e,t,r){const i=Math.abs(e.x-n.x),s=Math.abs(e.y-(n.y+t));return i+s*2<=r+1}function MT(n,e,t=!1){return t?(r,i)=>{const s=r.x(n)-.5,o=r.y(n)-.5;return Rq({x:s,y:o},{x:r.x(i),y:r.y(i)},0,e)}:(r,i)=>r.manhattanDist(n,i)<=e}const NT=new Map;async function Pq(n,e,t){const r=NT.get(n);if(r!==void 0)return t&&t(100),r;t&&t(0);const i=e.getMapData(n),s=await i.manifest();t&&t(10);const o=await IT(s.map,await i.mapBin()),c=await IT(s.mini_map,await i.miniMapBin()),u={gameMap:o,miniGameMap:c,nations:s.nations};return NT.set(n,u),t&&t(100),u}async function IT(n,e){if(e.length!==n.width*n.height)throw new Error(`Invalid data: buffer size ${e.length} incorrect for ${n.width}x${n.height} terrain plus 4 bytes for dimensions.`);return new k1(n.width,n.height,e,n.num_land_tiles)}var nn=(n=>(n.MiniFire="MiniFire",n.MiniSmoke="MiniSmoke",n.MiniBigSmoke="MiniBigSmoke",n.MiniSmokeAndFire="MiniSmokeAndFire",n.MiniExplosion="MiniExplosion",n.UnitExplosion="UnitExplosion",n.SinkingShip="SinkingShip",n.Nuke="Nuke",n.SAMExplosion="SAMExplosion",n.UnderConstruction="UnderConstruction",n.Dust="Dust",n.Conquest="Conquest",n))(nn||{});const Dq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAATElEQVQYV43QwQ0AMAQF0FrJgA4GtFIbki9ID9yqD1U6I1T1igjVdB78chYAB6qAmY+ZpXfYkAMEYCB0qWDCXaf1mybEuLZdXf33Tw8zWzGPW7pyIAAAAABJRU5ErkJggg==",jq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAaElEQVQoU52Syw0AIQhEtSUK5ECBtOQGEwyyjlE5om8YPrWAEJHGzHX1PCXtIxKJAgPaAS7kYIdOgAhCiIiKqv7cWrUlZIBHBjuUrUUAgW+V0CCue0K7svwYxOnYpz258vVFZEu72/sAq69Bk1uhfuQAAAAASUVORK5CYII=",Bq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAv0lEQVQ4T7WUwQ2AMAhFdSyX8WhMvDhBD53Ai4nx6DKOpaEJDcWvpUZ7qUp5fihQV4blvT+cc3XuKDxAzjlHBL/ALCD+kQYmsBIQAkaYBg3rdhvp3LWJjRUGWAmIKQj4L0yGty9TENL0YyWfkToK9aKMYeysYfxOuww1wO7yhZTobzpv/+aM5OuyIEWUN7nMt8lOqNY0RBYvDFPCyJmgckfVHG8TFW6u0aU96QA2fNabb4CPU6MEaJpnKFfWSXsCsoGDmQnVEEIAAAAASUVORK5CYII=",Oq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAALUlEQVQIW2NkgIKmpqb/dXV1jCAumAAJwCRBEowwASMjI4Zz586B5bCrxGYmAGeLFYtg8ygBAAAAAElFTkSuQmCC",Lq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAL0lEQVQIW2NkgIItW7b89/HxYQRxwQRIYNKkSQx5eXkMIAlGmABMB0gCu0psZgIA1/gcIeS5oTQAAAAASUVORK5CYII=",zq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAAXNSR0IB2cksfwAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+kIEwQOIC2n9sAAAAArSURBVAjXY2DAAhgZGBgYtmzZ8h8m4OPjw8gE40yaNAmuEi6Yl5fHgBcAALDQBwYsJM3QAAAAAElFTkSuQmCC",Uq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAAXNSR0IB2cksfwAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+kIEwQONUB6EisAAAArSURBVAjXY2DAAhgZGBgYtmzZ8h8m4OPjw8gE40yaNAmuEi6Yl5fHgBcAALDQBwYsJM3QAAAAAElFTkSuQmCC",Fq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAAXNSR0IB2cksfwAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+kIEwQQJhCFbCoAAAAdSURBVAjXY2DAB9zc3P7D2IzoArt27WLEqhIrAACFEQekqlxBBQAAAABJRU5ErkJggg==",Gq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAL0lEQVQIW2NkgAI3N7f/u3btYgRxwQRIIC8vj2HSpEkMIAlGmABMB0gCu0psZgIAV6Ya16U9ZawAAAAASUVORK5CYII=",Hq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAAYUlEQVQYV5WR0Q0AIQhDdT9mYRhmYT8NJiXYSHLHn/QBBed4hLsvEZksZSIAiGY2VDVZFB6YQVBccMHRkQMF0T3hCgbA7wOHBRaq92rpX+e64GfP3Wjkc8HX+do787m6H9yYOk8nkP833AAAAABJRU5ErkJggg==",bc={Engine:"Engine",Carriage:"Carriage",LoadedCarriage:"LoadedCarriage"},Vq={[$.TransportShip]:Gq,[$.Warship]:Hq,[$.SAMMissile]:Oq,[$.AtomBomb]:Dq,[$.HydrogenBomb]:jq,[$.TradeShip]:Lq,[$.MIRV]:Bq,[bc.Engine]:Fq,[bc.Carriage]:zq,[bc.LoadedCarriage]:Uq},fd=new Map,Wq=async()=>{const n=Object.entries(Vq),e=n.length;let t=0;await Promise.all(n.map(async([r,i])=>{const s=r;if(!i||i===""){console.warn(`No sprite URL for ${s}, skipping...`);return}try{const o=new Image;o.crossOrigin="anonymous",o.src=i,await new Promise((u,d)=>{o.onload=()=>u(),o.onerror=f=>d(f)});const c=await createImageBitmap(o);fd.set(s,c),t++,t===e&&console.log("All sprites loaded.")}catch(o){console.error(`Failed to load sprite for ${s}:`,o)}}))};function lI(n){return n.trainType()===A3.Engine?bc.Engine:n.isLoaded()?bc.LoadedCarriage:bc.Carriage}const Yq=n=>{const e=n.type();if(e===$.Train){const t=lI(n);return fd.get(t)??null}return fd.get(e)??null},cv=n=>{const e=n.type();if(e===$.Train){const t=lI(n);return fd.has(t)}return fd.has(e)},Rb=new Map,cI=(n,e,t,r)=>{const i=document.createElement("canvas");i.width=n.width,i.height=n.height;const s=i.getContext("2d");s.drawImage(n,0,0);const o=s.getImageData(0,0,i.width,i.height),c=o.data,u=e.toRgb(),d=t.toRgb(),f=r.toRgb();for(let p=0;p<c.length;p+=4){const y=c[p],b=c[p+1],_=c[p+2];y===180&&b===180&&_===180?(c[p]=u.r,c[p+1]=u.g,c[p+2]=u.b):y===70&&b===70&&_===70?(c[p]=d.r,c[p+1]=d.g,c[p+2]=d.b):y===130&&b===130&&_===130&&(c[p]=f.r,c[p+1]=f.g,c[p+2]=f.b)}return s.putImageData(o,0,0),i};function $q(n,e,t){const r=n.owner();return`${`${n.type()}-${n.trainType()}-${n.isLoaded()}`}-${r.id()}-${e.toRgbString()}-${t.toRgbString()}`}const Lp=(n,e,t,r)=>{const i=t??n.owner().territoryColor(),s=r??n.owner().borderColor(),o=e.spawnHighlightColor(),c=$q(n,i,s);if(Rb.has(c))return Rb.get(c);const u=Yq(n);if(u===null)throw new Error(`Failed to load sprite for ${n.type()}`);const d=cI(u,i,s,o);return Rb.set(c,d),d},qq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAQCAYAAADdw7vlAAAAAXNSR0IArs4c6QAAAkFJREFUWIXtV0tqKzEQrAm+hyFnSeBlYZibaOsjZNs3EczCA/HmXWRA9whMFpm2O4o+PZImfnm4wDDInqpW9UcycMcdt8Rg7XzrGEoxWPtGRMdbx1EM33y5mZqNDda+teDJaRDRaQvuX4vB2pnNJ6J5+TRNAGtsbf5vTrBsAODaBER09PPRrSC9dOvkHIwxHRHNxhg1xxqdybnRGPPSkvsnMFg7H/q+Az6bAMBojHnhpBz6/rmGXxalxp/VCZ6cY/Kmid0aHP+h77vFeADA435/5uda8/3i5ATL37QoWiI6SZ5U8aiTxKZs1bEB4/nx3Mp44FqgUmdyblyedzVaIv7L9GnVuQrtS9KJ6GiMeQUSCY6Z8hPGs8ayNgJ1lS8LZ+HqvLVRfFfVYf6xNVg7iyPtBOAvm6+F9InHvxYPOUIJafzk3JNvXAkWruxaDaThMrmP+z3v6c8WWsC1SP2xWoKQJ0R04k/ond0awohA8UVL8vnGx/RKwfwtipKR6iypIxOr6V7/vuP7IHTPk3PvqcLJJkZrSM3ZHDl7AVw7YG31x8Y/xxka21pe5gsVoow/pFsat0RAN+rPtw72qycXOFCW3JhOZE01QkOcvvkyQYy15i8Xs+SEKZ0+sakm4f0NAxL+fBsrHLxEpKu+QGOSHMFrDNBwpwpGo6nVKE2ctohKjpAU9+WSxcSxDXDFlm5QM3piyG06F3uJZkjjX0xu7r2dhji3sdwG/NEmkRr9a1Dzbi7+2otZ7iKa4m/lzx3/KT4AEnka0qFrGe4AAAAASUVORK5CYII=",Zq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANIAAAAUCAYAAAD4KGPrAAAAAXNSR0IArs4c6QAAAi1JREFUeJztmD+OozAYxT+P9jZbuRsp3Va5A5eIZBdzhClAmkPAHVKli5TOVc7zttkPOYyZADYiyb6fFAX85+WB/AL+RAgh5FEB8PHTee54Qh4SAEgd544l5KHRBTx10XPBkzUxWxvIwTnXh6Npmm/Xcq9/SwAcjDFfW/sgZfi1tYGlAID3Xuq67pvisDjnoH3eewEAY8xomOL+YQC1LxXMMV0AH8aYz9hPPFdDNBb24fwUY3Nz/kCoWVZzNZxz0E/qfK5W27ZQnHM33wDQtu1s7Xh+7HPYRk1qbsbQWK7JsTAtDRE1qVlSczVSZnNMxhopTcwsMuj4ez6n6gI46PGUa4/HT6H0/aRmec3VSJnN0dvvbDJM+53N0i3tk5r/qWbJ/UysOfYUyfGqYSoRoqFWiYBS87U1R6t2blD1UsaqZFNM/n7/08+31koIQUREqqrSdlwvJzmew6LKyPVyEu+9XC+nJdN7/v0+vPdirZWqqqTrOgkhyFJ/Q029dmq+huZbqjEOUdd1N316Xte1zHmKHM/B6ELXRdk0jQkhSNd1fQCW3ID9zuJ4DkZ/Q49zX+2ul5OEEMQYY/Rm5qKaeu3UfFHNe5WKnFey/c5CH59DTe2b77g8sQ89TrXlaAI4lNZcwyc1F2hOLfctCdNPhnJvACEPQbzJuhciZY0qGSHPSr8f0WKAbrKmFBKcc9DxOUUCQp6dm2JDvMmaMrnkBo+Qpydnj8L9DSGEkCL8BdZVjClkYlfNAAAAAElFTkSuQmCC",Xq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAHCAYAAAD5wDa1AAAAAXNSR0IArs4c6QAAAFpJREFUKJHdj8ENgFAIQ9FNGIdVGKirdJyOgjfyJXr4R+2FpIFHa/YHASgAtXrHLoRkAyJi6/6coBX2JEk9Adz2Z5Ppd7L5ZKYmWZIsM9sHUO6+3bCP39J9ThfoozTyUv32uwAAAABJRU5ErkJggg==",Kq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAMCAYAAAAtUZ4rAAAAAXNSR0IArs4c6QAAAHZJREFUSIljYBgFo4Cq4KKP0P+LPkL/B9odWMH/Nob//9sYqOo4JmoZ9H8Pw///e4h33P82hv8MZgwMDGZQNpmAqNj6DwVEO24PXAtRnsLmAXyeIiWJUS2GGL4IU6SdsYqBEZec/pZ3OOVoBkhNcqNgFIyCwQkAkYk74vcDhiIAAAAASUVORK5CYII=",Qq="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAANCAYAAADfavzVAAAAAXNSR0IArs4c6QAAALpJREFUSIntUrsRgzAMFTkW8QjpGMcFLigzQWagotUOqdJ5jKxBSfVS2ccdsk0cn6HgVT5L7+npQ3QhDWbG0R48Spm5lRCpjtzua6xwM9FQ0RwzzIziq48J5sRSBvfE1znije6dwr+n8kuT3qjWuunGXhR2/yHhFC+Ebuw3mswMieeNfu4tlDXe9DpJWRM1o6wRm3A8KeZ4EmL1aJkHABAnBgDLPIixWrzWPd7PiYgmsYnXoxH/j+CdHl/9dpcuPt8zVQAAAABJRU5ErkJggg==",Jq="https://frontwars.io/assets/nukeExplosion-DNbLY2UB.png",eZ="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAAmCAYAAAClBs7AAAAAAXNSR0IArs4c6QAACNhJREFUeJztnb1OG00Uhs9+coVEKpKeGnILJLiCksIpkKLcAZZyIUjOHUSRKIIiSqiAcAuBmiJVIBWRXFmaryDHOR7Pzs7/j/c8kqVk7Z05s+zOu+/8AjAMwzAMwzBM35hNhmI2GYrccbhwsLcr7ne2xP3OVpXxIwd7u1XH78p/uQNgGKZeUlX8MfLBSn/z5q7ZvLlrQqevyisWZxdXUeNnGIZZ4unxSDw9HiURgdBOKbV76avLYNphB8ZUScqKP1beqeP/+e0X/Pz2K6ib+bj2CmK7F+Ts4qrpi4gd7O2KmsuaKn62nUx10Ir/xctPye/hEPmjE5oebictA4pXKtHJAa04a2taa6v0aytHKtiB9YxSOttdXcxsMhRrJ7cAkEe8AADWTm7nH1dG52KeVko2b+6aj2uvtM1x+PZcowOQY5bLUVLZVLECPIsVfnTn5iyDb96h4mdV7xGzyVCkfuNvw8fFoAgPxpfZyoExjM7F0ttxlwMo2SGoKhVsupOb8HLHTit818owVxl8r2OuvwPeB6WkV9TDw9hjWpmjeAHkcy4U6gTl2FUPp1xBlVJ5yrG0CYDqu5xlkOOvSQBCO4/UAhA6/9CiUhOD3AEwfqAozQAECoGqaW6aOK4uBuPLBkVM9yZdQlOPChqryp1QdMdLqHhKvcYh0bnkHLS91PikFZtS7ldKUcEw9lCxWju5nQuajhIcmO7B/fzl9ULfkFymD+9/AEA5DqaN0/1m3telooTmK19Sl6Er9i6hanPLKcpBX9RipB2zDCnEyyWP7BUZ447vMOycQiZXLLJo6ZgebsOH9z+KE7DTfbNwZFErSQSOpw8A8Dw8Xj4mH6ekdAGqvLHyU42ypNMG6PHUTboxRSCmOJZMrwpbM0+PR0IWnBDziHKJGD5wNsIlg0KQWwC6nJb8W4BFEcvdB9OF3Dx6PH1YErKUDsY3z/udLYFC1tbfGro8pTqY2uFh9JXw4uWnJsYQ+FyTgRGfYeQ6xzObDEWKyc424gXwT7ho7DpRSTXtoWvYNv3u49qrBVdGUQ1bDxqoIh5bNm/u5k5NlU6tE6b7Jl4APIijFSHEwg3cNE32m4OO1uuqmNc3Jgv///N73Ppb2d2p3F5IsHLQCZAsCqbNcwCLlX4J/X0yo3MBp/uNUvxU1wb/1jHKIrspUxGDvV2B59LjKhcTunmLpkPdlA0oYps3d0rh7qMY1Ag7MIK4Hglk6TvkelT0m9n6xmRJvHTHKTmXZ0JG50LpaNqOn+438PR4tDQpcjC+bGJU+DQfW/dFUQmX3AQ0GF82OG8vRFnka6RqCjTl7OKqkSt/VXPc2cVVczx9gOPpA/ism6hyRK7ihcjnmkyudXFmqZr2Yk3SzuFGTfPkt4y/LIjW93fqH735Ov9nTkemEhkqTrrYTARq7eQ2yCRhzAubCWmlLTsq2z4kGdWEYld0ccuxqL6zGSItpxGiDCrHo4pF5aB88kPa0tPN/TNNP4T70qWvykf1e9NrlrpfKvTIypz9aiZ5swMDIl7f3z1/3nxVf/B7WG5ijA26ozYB+vN7DM1fTNJrc2OhxAugvcnr85fXS8dsRvCp3Bg6MYcwl5DjVj1EJu6LLgmkexBtmkd1UIdjUunEEK+2YwDPooUf07R0hFrP0fYa0NGOodNOhem1LjV+JFpwJfYhqRDXIzEXJ+KwtOBvv7+D5u1pknLRlTR0mDY1CSGEql8sVp+R3PSmwrY5Tk4n5jJZpiMPux74tuH3vi4M3c3Pb7+0FXuMN3TfUYm5h4CjkytppRQfSlruKzZRHFhbH1KMvLxB0TIVL9dzPBmMLxvfBWRluvrEUuLSl6Q6J1V7vWvfVyzQ2XS5EhNHaItrPxpyPH3IWtHiNXONobQRi6suWpTgAqYTqtJELMSAjJSDOrBTn7K+MQF5BKFJWqkdcdtD1TY4wwVcoaM22kYi1oxNGUrd2mUVmtlW/V4KKmAmAlWUiIVwUAldmAx1UDhSzbYJLacLCyFcpTghU1dTcmXXR1ahglfRl/uMB3H0HN38sNDEeKjogJDQTWMUk74tk8rQZC2/mMsNhR5m3RZrjJUsYogNTlpW9cOF3jYkVFo2rIKQ6crAAtZTnh6PlIM4AP6tYhEj31gP1PRwO3olYRK7LoaS3vZDxBJLVFJB597FXgg3Vtp9hwWsMkKNsnvx8lMjT27GtGNNAo4B9nuV1v9l6nbkkZS1VHa54gztHlfBoagIdZ1Kvx+DCpjJwICShtOHiCVnedBB+fQrpmxCRErpt3KBVnht0wFUe5qZDJ9Pzf3OlpODwnPa1kNMheuqHrrzS6+wmUWCOzBdhV6SeNVMCHcki15KxxXyrZeKQOq3aVzT0Od8mZhlkNPG4e82/Xf0d77D522QVxU52NsVvvnLW6vEXni4RnHMvbBxV969n8gM4O5gSllOan1jYh0LncgccvUNU2reVBEgTmWUc08t0/xtN5QMTYzJxrZLSYXKp6a9wXIsKWWSZ7GikpL5ahyW5BZlujqHjYihYP/5Pc4iXjI+YlDappa25Fxnru27rnUAXc4LiU4Iuiq93AJM41Dl5SoUq7KKCGJ6HaouZEhsRSyXeM0mQ0EFx1bEqHgB5HFfNtTwYOre4Lsq/BI2IbS5xqUsU+R6X5QgwDSOUHmmWo4r9v1qm35xlUFuupoTczcbqvqqqIiZ9GXhunnTw+3iBawGXCv13GsAyphUHiUILsVlJXmT36XCNX7VC1IJ5XFhFcpQHOJ6JOafklYPUYDztlx27829/9dsMnSKO9T5vvh2/ueeS1XjwAJK7fED2E0wjzEZvWZY7VaE2Lsox+Lp8Uj4uEDqJlOXH/P22YvsYG9X4EjGXANpQmypwm/O/cXWQYV0XAOfk5lyqFG8APzjNtliJhbYBBtyI81Uf8f7nS0BHjsyK9ODchfmZeLhsp9arFgYhklM12alMZhNhsJ3IjAFN9NM1ZwbowmNm+UYhmF6TAoBCym8lFR9SyyUDMMwTBRiCWQqWCAZhmEYpnD+B5UTDO+3SEbCAAAAAElFTkSuQmCC",tZ="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOAAAAAOCAYAAAA2YxATAAAAAXNSR0IArs4c6QAAAYdJREFUaIHtl8uVwzAIRaVZuzTVomKoRaV5r6zwwRh9UJKJT/LuJv4AIoYn7BAAAPeklFJLKfXTeQDwrcTWDS28lFLTdhRjxReAX+BPX+CpR0THNSJyT0NpuzpFMYHBt3OZTFp8kpzzcJqxYIgo5JyDPp6dhpjA4Bc4NWZPfMxIhBAwAPMcjSUblgUkBSDPQ7CbEgK2Y0DAoMXlG3AVbjYp0pzz5VzaWjF6AuZv0VEuHIOITscz4BsY/CeHAHmX1o2nz6XtK4GAr3GsYw8Q8P05TcCUUpQNr+m9AkLAZzv+hYBBD/MVlBtVNnBPmAwEDAEzVeH1lzFWfHUOz647G2dko++bjbzvuxlk27Zh448SiDF2Y6z411prjDHOPmi2lbG8RdJ5fNrfE6NVgzv49+po1U37yjys+rZqL31b93SOVg1H/e2xW0buFs/uYt515Zpy3d6ObNlZsWd2N71GK4de/vq/rOTQizPy13FGebdysPLw0HqOXn+vb6tHZuLM1MeTCwDgjTwAPN8Sn2+MlvEAAAAASUVORK5CYII=",nZ="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAMCAYAAAAZKF83AAAAAXNSR0IArs4c6QAAARNJREFUSIntlD1uwzAMhemgOQcBXcRdOhrQTbj1EN14EwIanaEnMaCTqItpKLT+MgTJ0DcZ0uPT52fBAP8aVxD5eenhzwCwmZeGce0BBJGkz1uMsMXYOzwFkXWQ9cjtAjBz2oGb4Y8CMHNi5t9svlpILfvDwgaRtLd1JaLPFsD+9tccYPH+u3Q4AMDi/ZSvl7w9HcCF6ucgsi7ef9UA9pm5kQHMnHSdmZNDvJUyNVe9tgzVRY0O8W7DId62GE8DGrbFCA4R8jkiOjVmc2uZWoLxz9Z317CaF+8nZk5ENNkBC97y5BA9r/06DvF0hQ5ghc2HauHmOjQ14tFM6y3BAmS/NR0YaXXUm6vlVTi9Yo/kvr3+ACSTzD3ybTsvAAAAAElFTkSuQmCC",rZ="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAAAQCAYAAAD59vZgAAAAAXNSR0IArs4c6QAAAqZJREFUaIHtWD2um0AQHqIX+RBUbty/UyRVitzBhTWyFMkdRcoto1Bs4TOkS/NSuvIZIhd0HMAFBU3mFdGgYVizCwt+P+KTLC+77PcN8w0DNsCCBQveBowxZIwhRKS5NJh7To0FDtzb3DzPn6bg5Lin4FoQAUQk/rC5scXUZ+57MT156QB84ESXZQnW2iTP86eqqj7zcQwnAECWZYksFGttYoyhGH6AdvHF8Lx2PMRsvmVulmWjE6bNlUYaY6iqKojhl8aWZdnMp2na0o81/dZ+RKR7FNS9dAYVkMtcuVZVVVQw2lz5zrDZbP5cLpcofsktYa1tutBUSecuJjV4PIW5ffx8HKMT2hyCyRGR+C5l0r53hDGBu/jSNIXVagUAAHVdw1SPLp382EdOyPsS844pVmmoBufocDhM1vmlHvvOa3LfoALSc9Lcoihaa2OSw9CPFr4Ing/l7ku6DyEaxhiSyXZpcY44P0Pzot/RXIgtoDE/Fvg6nIKcEE7OLQNkZfa10z4NWeE89iUtlN9XONrcqfmlBgAMMjiUX2Kuztmn0xGUgesCkV2A1113nO8ld0xyJHyJCk2Kq4OGmBDz835u/ik15I0t56S/H/Smsixhfz42Y/7sz8fWmiaWe3zQPHLsOw5Jjt4v53T8RVFAURTOPaEarnjTNG0MiOHWc/wt+eV8X374j1JEJBkjj3X80nuG9rdTQAAA69O22fTD/IP9+Qjr07azxmJyPaQ7yPNdenLNpenjHxt/6J0bEj8nf674pbk6nlvgePh85liftvD11/dO/K7r680RIlJ93RERUX3dtcZERIhIjL+PD63j+rrztkTmZz6to/XH8o+N39fWX3v8L5H/RAsAAHz6aDsnfvn5/9zf34DknD72XcDC/375FywYjGfmbfm1XuehqgAAAABJRU5ErkJggg==",iZ="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAATCAYAAAA6T+sJAAAAAXNSR0IArs4c6QAAATRJREFUWIXtlksSwiAQRHtcuzJ38XA5AKfyBLmLK7NvN4kVCZ+ZCiTB8lW5EGECzw4A/Pl96MCj59AEdGBO1s/IpId5vELWsq99hjoutQrPxARZxFkFSA85JGmbU0GSr5tfZkWyhgP50KerNtGExVKhLUySGDvg+tT1bYSgsNQC9lwcHYj7Xk/TsRKmEZJ9jQzpsjx3C6Ve6eqbfknOsI81JewMNCfMkrIaiVwJExHJDcr1ERHB9QmMnXoioZrSQzBMX+7TBzoRdKD0yK7FSjBhKSEaoSYMUgF8SQuJi7WXuswmF++fXFZZn9MSWJ+Yi/Zc3ej1Ygi0TYTSVSJ1xSPr85HuJ2kSqP0T1HeyISyrFNWFzWxNK7DYuxJpqykL2FFYSWJ7lLVGbMxcP/R7k8JKYpX/Bvqc9uZ3g+0ZAAAAAElFTkSuQmCC",Nm={[nn.MiniFire]:{uri:Qq,cellW:7,frames:6,period:100,isCyclic:!0,anchorX:3,anchorY:11},[nn.MiniSmoke]:{uri:nZ,cellW:11,frames:4,period:120,isCyclic:!0,anchorX:2,anchorY:10},[nn.MiniBigSmoke]:{uri:qq,cellW:24,frames:5,period:120,isCyclic:!0,anchorX:9,anchorY:14},[nn.MiniSmokeAndFire]:{uri:rZ,cellW:24,frames:5,period:120,isCyclic:!0,anchorX:9,anchorY:14},[nn.MiniExplosion]:{uri:Kq,cellW:13,frames:4,period:70,isCyclic:!1,anchorX:6,anchorY:6},[nn.Dust]:{uri:Xq,cellW:9,frames:3,period:100,isCyclic:!1,anchorX:4,anchorY:5},[nn.UnitExplosion]:{uri:iZ,cellW:19,frames:4,period:70,isCyclic:!1,anchorX:9,anchorY:9},[nn.SinkingShip]:{uri:tZ,cellW:16,frames:14,period:90,isCyclic:!1,anchorX:7,anchorY:7},[nn.Nuke]:{uri:Jq,cellW:60,frames:9,period:70,isCyclic:!1,anchorX:30,anchorY:30},[nn.SAMExplosion]:{uri:eZ,cellW:48,frames:9,period:70,isCyclic:!1,anchorX:23,anchorY:19},[nn.Conquest]:{uri:Zq,cellW:21,frames:10,period:90,isCyclic:!1,anchorX:10,anchorY:16}};class RT{constructor(e,t,r,i,s=!1,o,c){if(this.image=e,this.frameWidth=t,this.frameCount=r,this.frameDuration=i,this.looping=s,this.originX=o,this.originY=c,this.currentFrame=0,this.elapsedTime=0,this.active=!0,"height"in e)this.frameHeight=e.height;else throw new Error("Image source must have a 'height' property.")}update(e){this.active&&(this.elapsedTime+=e,this.elapsedTime>=this.frameDuration&&(this.elapsedTime-=this.frameDuration,this.currentFrame++,this.currentFrame>=this.frameCount&&(this.looping?this.currentFrame=0:(this.currentFrame=this.frameCount-1,this.active=!1))))}isActive(){return this.active}lifeTime(){if(!this.looping)return this.frameDuration*this.frameCount}draw(e,t,r){const i=t-this.originX,s=r-this.originY;e.drawImage(this.image,this.currentFrame*this.frameWidth,0,this.frameWidth,this.frameHeight,i,s,this.frameWidth,this.frameHeight)}reset(){this.currentFrame=0,this.elapsedTime=0}setOrigin(e,t){this.originX=e,this.originY=t}}class sZ{constructor(){this._masterSheets=new Map,this._tintCache=new Map}async initializeAssets(){const e=Object.entries(Nm);await Promise.all(e.map(async([t,r])=>{const i=t;if(r?.uri)try{const s=new Image;s.crossOrigin="anonymous",s.src=r.uri,await new Promise((c,u)=>{s.onload=()=>c(),s.onerror=d=>u(d)});const o=document.createElement("canvas");o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),this._masterSheets.set(i,o)}catch(s){console.error(`Asset retrieval failed for [${i}]:`,s)}}))}instantiateSprite(e,t,r){return t&&r?this.instantiateTinted(e,t,r):this.instantiateStandard(e)}instantiateStandard(e){const t=Nm[e],r=this._masterSheets.get(e);return!t||!r?null:new RT(r,t.cellW,t.frames,t.period,t.isCyclic??!0,t.anchorX,t.anchorY)}instantiateTinted(e,t,r){const i=Nm[e],s=this.fetchTintedSheet(t,e,r);return!i||!s?null:new RT(s,i.cellW,i.frames,i.period,i.isCyclic??!0,i.anchorX,i.anchorY)}fetchTintedSheet(e,t,r){const i=this._masterSheets.get(t),s=Nm[t];if(!i||!s)return null;const o=e.territoryColor(),c=e.borderColor(),u=r.spawnHighlightColor(),d=`${t}::${e.id()}`;let f=this._tintCache.get(d);return f||(f=cI(i,o,c,u),this._tintCache.set(d,f)),f}}class aZ{constructor(){this._queue=[],this._elapsed=0}plan(e,t){return this._queue.push({waitTime:e,execute:t,hasRun:!1}),this}tick(e){this._elapsed+=e;for(const t of this._queue)!t.hasRun&&this._elapsed>=t.waitTime&&(t.execute(),t.hasRun=!0)}isDone(){return this._queue.every(e=>e.hasRun)}}class Im{constructor(e){this._children=[],this._scheduler=null,e&&(this._children=e)}addChild(e){this._children.push(e)}getScheduler(){return this._scheduler||(this._scheduler=new aZ),this._scheduler}hasActiveScheduler(){return this._scheduler!==null&&!this._scheduler.isDone()}drawFrame(e,t){this._scheduler&&this._scheduler.tick(e);let r=!1;for(let i=this._children.length-1;i>=0;i--)this._children[i].drawFrame(e,t)?r=!0:this._children.splice(i,1);return r||this.hasActiveScheduler()}getChildCount(){return this._children.length}}function oZ(n,e=.3,t=.7){if(n<e){const r=n/e;return r*r}else{if(n<t)return 1;{const r=(n-t)/(1-t);return 1-r*r}}}class PT{constructor(e,t,r){this._target=e,this._inPoint=t,this._outPoint=r}drawFrame(e,t){const r=this._target.getAge()/this._target.getLifespan();t.save(),t.globalAlpha=oZ(r,this._inPoint,this._outPoint);const i=this._target.drawFrame(e,t);return t.restore(),i}}class Ql{constructor(e,t,r,i,s,o,c){this._x=t,this._y=r,this._age=0,this._persist=!1,this._sprite=e.instantiateSprite(i,o,c),this._sprite?(this._persist=!!s,this._totalDuration=s??this._sprite.lifeTime()??1e3):console.error("Asset load failure:",i)}drawFrame(e,t){return!this._sprite||(this._age+=e,this._age>=this._totalDuration)||!this._sprite.isActive()&&!this._persist?!1:(this._sprite.update(e),this._sprite.draw(t,this._x,this._y),!0)}getAge(){return this._age}getLifespan(){return this._totalDuration}}class DT{constructor(e,t,r,i,s=30,o="11px sans-serif",c={r:255,g:255,b:255}){this._content=e,this._posX=t,this._posY=r,this._lifespan=i,this._elevation=s,this._typeface=o,this._tint=c,this._age=0}drawFrame(e,t){if(this._age+=e,this._age>=this._lifespan)return!1;const r=this._age/this._lifespan,i=this._posY-r*this._elevation,s=1-r;return t.save(),t.font=this._typeface,t.fillStyle=`rgba(${this._tint.r}, ${this._tint.g}, ${this._tint.b}, ${s})`,t.textAlign="center",t.fillText(this._content,this._posX,i),t.restore(),!0}}class Pb{constructor(e,t,r){this._x=e,this._y=t,this._config=r,this._elapsed=0,this._isTerminated=!1,this._dashShift=0}terminate(){this._config.isPersistent&&(this._isTerminated=!0,this._elapsed=0)}drawFrame(e,t){return this._elapsed+=e,this._config.type==="blastWave"?this.drawBlastWave(e,t):this.drawDestinationMarker(e,t)}drawBlastWave(e,t){const r=this._config.lifespan??1500;if(this._elapsed>=r)return!1;const i=this._elapsed/r,s=i*(this._config.limitRadius??100);return t.beginPath(),t.arc(this._x,this._y,s,0,Math.PI*2),t.strokeStyle=`rgba(255, 255, 255, ${1-i})`,t.lineWidth=.5,t.stroke(),!0}drawDestinationMarker(e,t){const r=this._config.isPersistent??!1,i=this._config.lifespan??0,s=this._config.fadeDuration??300,o=this._config.spinVelocity??14,c=this._config.markerRadius??4;if(r){if(this._isTerminated&&this._elapsed>=s)return!1}else if(this._elapsed>=i)return!1;const u=r?this._elapsed%1e3/1e3:this._elapsed/i,d=r?.9:1-u,f=r&&this._isTerminated?1-this._elapsed/s:1,p=Math.max(0,Math.min(1,d*f));return this._dashShift+=o*(e/1e3),t.save(),t.globalAlpha=p,t.lineWidth=1,t.strokeStyle=`rgba(255,0,0,${p})`,t.beginPath(),t.lineWidth=1,t.lineDashOffset=this._dashShift,t.setLineDash([3,3]),t.arc(this._x,this._y,c,0,Math.PI*2),t.stroke(),t.beginPath(),t.strokeStyle=`rgba(255,0,0,${p})`,t.lineWidth=2,t.lineDashOffset=-this._dashShift/2,t.setLineDash([19,3]),t.arc(this._x,this._y,7,0,Math.PI*2),t.stroke(),t.restore(),!0}}var uI=(n=>(n.CONQUEST="coin",n))(uI||{}),dp=(n=>(n.FRONTWARS="frontwars",n.ES_EPIC="es_epic",n.ES_END="es_end",n))(dp||{});const lZ={coin:"/sounds/effects/coin.mp3"},cZ={frontwars:"/sounds/music/frontwars.mp3",es_epic:"/sounds/music/es_epic.mp3",es_end:"/sounds/music/es_end.mp3"},To=class To{constructor(){this.backgroundMusicPlaylist=[],this.currentMusicIndex=0,this.currentMusic=null,this.isMusicPlaying=!1,this.musicVolume=0,this.effectsVolume=1,this.soundEffects=new Map,this.consecutiveFailures=0,this.isPlayingNextTrack=!1,this.loadVolumes()}static getInstance(){return To.instance||(To.instance=new To),To.instance}loadVolumes(){this.musicVolume=Re.backgroundMusicVolume(),this.effectsVolume=Re.soundEffectsVolume()}setBackgroundMusicPlaylist(e){this.backgroundMusicPlaylist=e,this.currentMusicIndex=0,this.consecutiveFailures=0,this.isMusicPlaying&&(this.stopBackgroundMusic(),this.startBackgroundMusic())}startBackgroundMusic(){if(this.backgroundMusicPlaylist.length===0){console.warn("[SoundManager] No background music playlist set");return}this.isMusicPlaying||(this.isMusicPlaying=!0,this.playNextTrack())}stopBackgroundMusic(){this.isMusicPlaying=!1,this.isPlayingNextTrack=!1,this.consecutiveFailures=0,this.currentMusic&&(this.currentMusic.pause(),this.currentMusic.currentTime=0,this.currentMusic=null)}pauseBackgroundMusic(){this.currentMusic&&this.currentMusic.pause()}resumeBackgroundMusic(){this.currentMusic&&this.isMusicPlaying&&this.currentMusic.play().catch(e=>{console.error("[SoundManager] Failed to resume music:",e)})}setBackgroundMusicVolume(e){this.musicVolume=Math.max(0,Math.min(1,e)),Re.setBackgroundMusicVolume(this.musicVolume),this.currentMusic&&(this.currentMusic.volume=this.musicVolume)}getBackgroundMusicVolume(){return this.musicVolume}setSoundEffectsVolume(e){this.effectsVolume=Math.max(0,Math.min(1,e)),Re.setSoundEffectsVolume(this.effectsVolume),this.soundEffects.forEach(t=>{t.volume=this.effectsVolume})}getSoundEffectsVolume(){return this.effectsVolume}playSoundEffect(e,t){const r=this.getOrLoadSoundEffect(e);if(!r){console.warn(`[SoundManager] Sound effect not found: ${e}`);return}const i=r.cloneNode();i.volume=t?.volume!==void 0?Math.max(0,Math.min(1,t.volume))*this.effectsVolume:this.effectsVolume,i.loop=t?.loop||!1,i.play().catch(s=>{console.error(`[SoundManager] Failed to play sound effect ${e}:`,s)})}getOrLoadSoundEffect(e){if(this.soundEffects.has(e))return this.soundEffects.get(e);const t=lZ[e];if(!t)return console.error(`[SoundManager] No file path defined for sound effect: ${e}`),null;const r=new Audio(t);return r.volume=this.effectsVolume,r.preload="auto",r.addEventListener("error",()=>{console.error(`[SoundManager] Failed to load sound effect: ${e} from ${t}`),this.soundEffects.delete(e)}),this.soundEffects.set(e,r),r}playNextTrack(){if(!this.isMusicPlaying||this.backgroundMusicPlaylist.length===0||this.isPlayingNextTrack)return;if(this.consecutiveFailures>=this.backgroundMusicPlaylist.length){console.warn("[SoundManager] All tracks in playlist failed to play. Stopping music playback."),this.isMusicPlaying=!1;return}this.isPlayingNextTrack=!0,this.currentMusic&&(this.currentMusic.pause(),this.currentMusic=null);const e=this.backgroundMusicPlaylist[this.currentMusicIndex],t=cZ[e];if(!t){console.error(`[SoundManager] No file path defined for background music: ${e}`),this.consecutiveFailures++,this.currentMusicIndex=(this.currentMusicIndex+1)%this.backgroundMusicPlaylist.length,this.isPlayingNextTrack=!1,setTimeout(()=>{this.isMusicPlaying&&this.playNextTrack()},0);return}this.currentMusic=new Audio(t),this.currentMusic.volume=this.musicVolume,this.currentMusic.loop=!1,this.currentMusic.addEventListener("ended",()=>{this.isMusicPlaying&&(this.consecutiveFailures=0,this.currentMusicIndex=(this.currentMusicIndex+1)%this.backgroundMusicPlaylist.length,this.isPlayingNextTrack=!1,this.playNextTrack())}),this.currentMusic.addEventListener("error",r=>{console.error(`[SoundManager] Failed to load music track: ${e} from ${t}`,r),this.consecutiveFailures++,this.currentMusicIndex=(this.currentMusicIndex+1)%this.backgroundMusicPlaylist.length,this.isPlayingNextTrack=!1,setTimeout(()=>{this.isMusicPlaying&&this.playNextTrack()},0)}),this.currentMusic.play().then(()=>{this.consecutiveFailures=0,this.isPlayingNextTrack=!1}).catch(r=>{console.error(`[SoundManager] Failed to play music track: ${e} from ${t}`,r),this.consecutiveFailures++,this.currentMusicIndex=(this.currentMusicIndex+1)%this.backgroundMusicPlaylist.length,this.isPlayingNextTrack=!1,setTimeout(()=>{this.isMusicPlaying&&this.playNextTrack()},0)})}reloadVolumes(){this.loadVolumes(),this.currentMusic&&(this.currentMusic.volume=this.musicVolume),this.soundEffects.forEach(e=>{e.volume=this.effectsVolume})}cleanup(){this.stopBackgroundMusic(),this.soundEffects.clear()}};To.instance=null;let E1=To;const xc=E1.getInstance();class rs{static createNuke(e,t,r,i,s){const o=[];o.push(new Ql(e,t,r,nn.Nuke)),o.push(new Pb(t,r,{type:"blastWave",lifespan:1500,limitRadius:i*1.5}));const c=[{kind:nn.MiniFire,radMult:1,popMult:1/25},{kind:nn.MiniSmoke,radMult:1,popMult:1/28},{kind:nn.MiniBigSmoke,radMult:.9,popMult:1/70},{kind:nn.MiniSmokeAndFire,radMult:.9,popMult:1/70}];for(const{kind:u,radMult:d,popMult:f}of c){const p=Math.max(0,Math.floor(i*f));for(let y=0;y<p;y++){const b=Math.random()*2*Math.PI,_=Math.random()*(i*d/2),w=Math.floor(t+Math.cos(b)*_),S=Math.floor(r+Math.sin(b)*_);if(s.isValidCoord(w,S)&&s.isLand(s.ref(w,S))){const A=new Ql(e,w,S,u,6e3);o.push(new PT(A,.1,.8))}}}return new Im(o)}static createExplosion(e,t,r,i){const s=new Im,o=s.getScheduler(),c=[{dx:0,dy:0,wait:0,kind:nn.UnitExplosion},{dx:4,dy:-6,wait:80,kind:nn.UnitExplosion},{dx:-6,dy:4,wait:160,kind:nn.UnitExplosion}];for(const u of c)o.plan(u.wait,()=>{i.isValidCoord(t+u.dx,r+u.dy)&&s.addChild(new Ql(e,t+u.dx,r+u.dy,u.kind))});return s}static createConquest(e,t,r){const i=[],s=r.player(t.conqueredId),o=s.nameLocation().x,c=s.nameLocation().y,u=new Ql(e,o,c,nn.Conquest,2500);i.push(new PT(u,.1,.6));const d=pn(t.gold);return i.push(new DT(`+ ${d}`,o,c+8,2500,0,"11px sans-serif")),xc.playSoundEffect(uI.CONQUEST),new Im(i)}static createSAMExplosion(e,t,r){const i=[];return i.push(new Ql(e,t,r,nn.SAMExplosion)),i.push(new Pb(t,r,{type:"blastWave",lifespan:800,limitRadius:40})),new Im(i)}static createDestinationMarker(e,t,r=!0){return new Pb(e,t,{type:"destinationMarker",isPersistent:r,fadeDuration:300,spinVelocity:14,markerRadius:4})}static createSprite(e,t,r,i,s,o,c){return new Ql(e,t,r,i,s,o,c)}static createLabel(e,t,r,i=1e3,s=30){return new DT(e,t,r,i,s)}}class uZ{constructor(e){this._game=e,this._lastFrameTime=0,this._refreshInterval=10,this._assetLoader=new sZ,this._activeEffects=[],this._destinationMarkers=new Map,this._globalTheme=this._game.config().theme()}isWorldSpace(){return!0}tick(){this.handleDestinationMarkers(),this._game.updatesSinceLastTick()?.[Wt.Unit]?.map(e=>this._game.unit(e.id))?.forEach(e=>{e!==void 0&&this.handleUnit(e)}),this._game.updatesSinceLastTick()?.[Wt.BonusEvent]?.forEach(e=>{e!==void 0&&this.handleBonus(e)}),this._game.updatesSinceLastTick()?.[Wt.RailroadEvent]?.forEach(e=>{e!==void 0&&this.handleRailActivity(e)}),this._game.updatesSinceLastTick()?.[Wt.ConquestEvent]?.forEach(e=>{e!==void 0&&this.handleDomination(e)})}handleDestinationMarkers(){for(const[e,t]of Array.from(this._destinationMarkers.entries())){const r=this._game.unit(e);(!r||!r.isActive()||r.reachedTarget()||r.retreating())&&(t.terminate(),this._destinationMarkers.delete(e))}}handleBonus(e){if(this._game.player(e.player)!==this._game.myPlayer())return;const t=e.tile,r=this._game.x(t);let i=this._game.y(t);const s=e.gold,o=e.troops;if(s>0){const c=pn(s,0);this.addLabel(`+ ${c}`,r,i),i+=10}if(o>0){const c=pn(o,0);this.addLabel(`+ ${c} troops`,r,i),i+=10}}addLabel(e,t,r){const i=rs.createLabel(e,t,r,1e3,20);this._activeEffects.push(i)}handleUnit(e){switch(e.type()){case $.TransportShip:{const t=this._game.myPlayer();if(!t||e.owner()!==t||!e.isActive()||e.retreating()||this._destinationMarkers.has(e.id()))return;const r=e.targetTile();if(r!==void 0){const i=this._game.x(r),s=this._game.y(r),o=rs.createDestinationMarker(i,s,!0);this._activeEffects.push(o),this._destinationMarkers.set(e.id(),o)}break}case $.AtomBomb:case $.MIRVWarhead:this.handleNuclearEvent(e,70);break;case $.HydrogenBomb:this.handleNuclearEvent(e,160);break;case $.Warship:this.handleWarshipDestruction(e);break;case $.Shell:this.handleProjectile(e);break;case $.Train:this.handleTrain(e);break}}handleProjectile(e){if(!e.isActive()&&e.reachedTarget()){const t=this._game.x(e.lastTile()),r=this._game.y(e.lastTile()),i=rs.createSprite(this._assetLoader,t,r,nn.MiniExplosion);this._activeEffects.push(i)}}handleTrain(e){if(!e.isActive()&&!e.reachedTarget()){const t=this._game.x(e.lastTile()),r=this._game.y(e.lastTile()),i=rs.createSprite(this._assetLoader,t,r,nn.MiniExplosion);this._activeEffects.push(i)}}handleRailActivity(e){const t=e.railTiles;for(const r of t)if(Math.floor(Math.random()*3)===0){const s=this._game.x(r.tile),o=this._game.y(r.tile),c=rs.createSprite(this._assetLoader,s,o,nn.Dust);this._activeEffects.push(c)}}handleDomination(e){if(this._game.player(e.conquerorId)!==this._game.myPlayer())return;const r=rs.createConquest(this._assetLoader,e,this._game);this._activeEffects.push(r)}handleWarshipDestruction(e){if(!e.isActive()){const t=this._game.x(e.lastTile()),r=this._game.y(e.lastTile()),i=rs.createExplosion(this._assetLoader,t,r,this._game);this._activeEffects.push(i);const s=rs.createSprite(this._assetLoader,t,r,nn.SinkingShip,void 0,e.owner(),this._globalTheme);this._activeEffects.push(s)}}handleNuclearEvent(e,t){e.isActive()||(e.reachedTarget()?this.triggerNukeBlast(e,t):this.handleInterceptor(e))}triggerNukeBlast(e,t){const r=this._game.x(e.lastTile()),i=this._game.y(e.lastTile()),s=rs.createNuke(this._assetLoader,r,i,t,this._game);this._activeEffects.push(s)}handleInterceptor(e){const t=this._game.x(e.lastTile()),r=this._game.y(e.lastTile()),i=rs.createSAMExplosion(this._assetLoader,t,r);this._activeEffects.push(i)}async init(){this.rebuildCanvas();try{await this._assetLoader.initializeAssets(),console.log("VFX assets initialized")}catch(e){console.error("VFX asset error:",e)}}rebuildCanvas(){this._sceneCanvas=document.createElement("canvas");const e=this._sceneCanvas.getContext("2d");if(e===null)throw new Error("Context unavailable");this._sceneContext=e,this._sceneContext.imageSmoothingEnabled=!1,this._sceneCanvas.width=this._game.width(),this._sceneCanvas.height=this._game.height()}paint(e){const t=Date.now();if(this._game.config().userSettings()?.fxLayer()){if(t>this._lastFrameTime+this._refreshInterval){const r=t-this._lastFrameTime;this.paintEffects(e,r),this._lastFrameTime=t}e.drawImage(this._sceneCanvas,-this._game.width()/2,-this._game.height()/2,this._game.width(),this._game.height())}}paintEffects(e,t){this._activeEffects.length>0&&(this._sceneContext.clearRect(0,0,this._sceneCanvas.width,this._sceneCanvas.height),this.processEffects(t))}processEffects(e){for(let t=this._activeEffects.length-1;t>=0;t--)this._activeEffects[t].drawFrame(e,this._sceneContext)||this._activeEffects.splice(t,1)}}class hZ{constructor(e){this.game=e,this.previousInSpawnPhase=null,this.eventEmitted=!1,this.gameView=e.gameView}tick(){if(!this.gameView)return;const e=this.gameView.inSpawnPhase();this.previousInSpawnPhase===!0&&e===!1&&!this.eventEmitted&&(ae.emit(new Np(this.game)),this.eventEmitted=!0),this.previousInSpawnPhase=e}}const dZ="https://frontwars.io/assets/AllianceIcon-CZxsr-9O.svg",fZ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%23000000'%20height='800px'%20width='800px'%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%2075.294%2075.294'%20xml:space='preserve'%3e%3cg%3e%3cpath%20d='M66.097,12.089h-56.9C4.126,12.089,0,16.215,0,21.286v32.722c0,5.071,4.126,9.197,9.197,9.197h56.9%20c5.071,0,9.197-4.126,9.197-9.197V21.287C75.295,16.215,71.169,12.089,66.097,12.089z%20M61.603,18.089L37.647,33.523L13.691,18.089%20H61.603z%20M66.097,57.206h-56.9C7.434,57.206,6,55.771,6,54.009V21.457l29.796,19.16c0.04,0.025,0.083,0.042,0.124,0.065%20c0.043,0.024,0.087,0.047,0.131,0.069c0.231,0.119,0.469,0.215,0.712,0.278c0.025,0.007,0.05,0.01,0.075,0.016%20c0.267,0.063,0.537,0.102,0.807,0.102c0.001,0,0.002,0,0.002,0c0.002,0,0.003,0,0.004,0c0.27,0,0.54-0.038,0.807-0.102%20c0.025-0.006,0.05-0.009,0.075-0.016c0.243-0.063,0.48-0.159,0.712-0.278c0.044-0.022,0.088-0.045,0.131-0.069%20c0.041-0.023,0.084-0.04,0.124-0.065l29.796-19.16v32.551C69.295,55.771,67.86,57.206,66.097,57.206z'/%3e%3c/g%3e%3c/svg%3e",mZ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%23ffffff'%20height='800px'%20width='800px'%20version='1.1'%20id='Capa_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%2075.294%2075.294'%20xml:space='preserve'%3e%3cg%3e%3cpath%20d='M66.097,12.089h-56.9C4.126,12.089,0,16.215,0,21.286v32.722c0,5.071,4.126,9.197,9.197,9.197h56.9%20c5.071,0,9.197-4.126,9.197-9.197V21.287C75.295,16.215,71.169,12.089,66.097,12.089z%20M61.603,18.089L37.647,33.523L13.691,18.089%20H61.603z%20M66.097,57.206h-56.9C7.434,57.206,6,55.771,6,54.009V21.457l29.796,19.16c0.04,0.025,0.083,0.042,0.124,0.065%20c0.043,0.024,0.087,0.047,0.131,0.069c0.231,0.119,0.469,0.215,0.712,0.278c0.025,0.007,0.05,0.01,0.075,0.016%20c0.267,0.063,0.537,0.102,0.807,0.102c0.001,0,0.002,0,0.002,0c0.002,0,0.003,0,0.004,0c0.27,0,0.54-0.038,0.807-0.102%20c0.025-0.006,0.05-0.009,0.075-0.016c0.243-0.063,0.48-0.159,0.712-0.278c0.044-0.022,0.088-0.045,0.131-0.069%20c0.041-0.023,0.084-0.04,0.124-0.065l29.796-19.16v32.551C69.295,55.771,67.86,57.206,66.097,57.206z'/%3e%3c/g%3e%3c/svg%3e",pZ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%20width='512px'%20height='450px'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%3e%3cpath%20fill='%23feea4f'%20d='M%20248.5,-0.5%20C%20252.167,-0.5%20255.833,-0.5%20259.5,-0.5C%20278.819,5.4526%20286.319,18.4526%20282,38.5C%20279.284,45.8812%20274.451,51.3812%20267.5,55C%20266.941,55.7247%20266.608,56.5581%20266.5,57.5C%20273.333,88.8333%20280.167,120.167%20287,151.5C%20289.807,165.255%20296.307,176.755%20306.5,186C%20316.671,191.131%20326.004,189.798%20334.5,182C%20345.222,172.37%20353.888,161.204%20360.5,148.5C%20347.194,133.298%20347.194,118.131%20360.5,103C%20376.565,92.8493%20391.065,94.6826%20404,108.5C%20413.587,127.733%20409.087,142.566%20390.5,153C%20385.077,153.627%20379.911,154.794%20375,156.5C%20373.24,167.82%20371.573,179.154%20370,190.5C%20368.693,201.412%20369.693,212.079%20373,222.5C%20376.407,231.455%20382.907,235.788%20392.5,235.5C%20404.426,234.039%20415.092,229.539%20424.5,222C%20435.833,212.667%20447.167,203.333%20458.5,194C%20451.529,181.867%20452.029,170.034%20460,158.5C%20471.782,147.376%20484.948,145.543%20499.5,153C%20505.328,157.305%20509.328,162.805%20511.5,169.5C%20511.5,174.833%20511.5,180.167%20511.5,185.5C%20504.523,202.241%20492.023,209.241%20474,206.5C%20456.963,254.069%20439.796,301.569%20422.5,349C%20310.5,349.5%20198.5,349.667%2086.5,349.5C%2070.6411,301.757%2054.4744,254.09%2038,206.5C%2019.5189,211.509%206.68559,205.176%20-0.5,187.5C%20-0.5,182.167%20-0.5,176.833%20-0.5,171.5C%207.69791,152.574%2021.6979,146.407%2041.5,153C%2057.7565,164.191%2061.4231,178.691%2052.5,196.5C%2068.4555,208.943%2085.1222,220.443%20102.5,231C%20111.912,235.038%20121.246,235.038%20130.5,231C%20136.151,226.533%20139.317,220.699%20140,213.5C%20140.668,193.676%20139.168,174.009%20135.5,154.5C%20114.743,156.249%20103.077,146.749%20100.5,126C%20104.608,102.566%20118.275,93.5665%20141.5,99C%20158.634,108.45%20163.467,122.284%20156,140.5C%20153.486,143.678%20150.986,146.844%20148.5,150C%20155.392,160.231%20163.058,169.898%20171.5,179C%20177.581,185.207%20184.915,189.041%20193.5,190.5C%20198.804,190.264%20203.304,188.264%20207,184.5C%20214.423,174.592%20219.757,163.592%20223,151.5C%20230.341,120.468%20237.841,89.4681%20245.5,58.5C%20239.652,55.167%20234.485,50.8337%20230,45.5C%20219.901,23.3887%20226.068,8.05541%20248.5,-0.5%20Z'/%3e%3c/g%3e%3cg%3e%3cpath%20fill='%23feea4f'%20d='M%20423.5,449.5%20C%20311.167,449.5%20198.833,449.5%2086.5,449.5C%2086.5,429.167%2086.5,408.833%2086.5,388.5C%20198.833,388.5%20311.167,388.5%20423.5,388.5C%20423.5,408.833%20423.5,429.167%20423.5,449.5%20Z'/%3e%3c/g%3e%3c/svg%3e",gZ="https://frontwars.io/assets/DisconnectedIcon-0LTzkaTb.svg",yZ="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%2020010904//EN'%20'http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd'%3e%3csvg%20version='1.0'%20xmlns='http://www.w3.org/2000/svg'%20width='512.000000pt'%20height='512.000000pt'%20viewBox='0%200%20512.000000%20512.000000'%20preserveAspectRatio='xMidYMid%20meet'%3e%3cg%20transform='translate(0.000000,512.000000)%20scale(0.100000,-0.100000)'%20fill='%23000000'%20stroke='none'%3e%3cpath%20d='M2285%204675%20c-640%20-84%20-1211%20-457%20-1551%20-1015%20-278%20-456%20-372%20-1020%20-258%20-1550%2086%20-400%20284%20-760%20579%20-1055%20351%20-352%20787%20-560%201284%20-615%20171%20-19%20442%20-8%20615%2024%20423%2080%20802%20282%201111%20591%20407%20407%20625%20931%20625%201505%200%20574%20-218%201098%20-625%201505%20-348%20349%20-786%20561%20-1270%20615%20-122%2013%20-387%2011%20-510%20-5z%20m574%20-436%20c375%20-64%20738%20-269%20989%20-560%20504%20-583%20557%20-1420%20129%20-2067%20-33%20-50%20-63%20-92%20-67%20-92%20-3%200%20-68%2063%20-145%20140%20-77%2077%20-144%20140%20-150%20140%20-13%200%20-295%20-282%20-295%20-295%200%20-6%2063%20-73%20140%20-150%2077%20-77%20140%20-142%20140%20-145%200%20-12%20-195%20-134%20-289%20-181%20-399%20-198%20-882%20-229%20-1302%20-83%20-595%20206%20-1020%20703%20-1130%201320%20-30%20166%20-30%20422%20-1%20585%2048%20265%20145%20487%20324%20744%204%206%2068%20-50%20152%20-134%20l145%20-145%2022%2020%20c57%2049%20279%20272%20279%20280%200%205%20-64%2073%20-142%20152%20-83%2083%20-139%20146%20-133%20150%20297%20207%20556%20308%20878%20342%20113%2012%20320%202%20456%20-21z'/%3e%3cpath%20d='M2350%203715%20l0%20-126%20-45%20-19%20c-128%20-55%20-251%20-173%20-315%20-303%20-143%20-291%20-60%20-569%20230%20-764%2025%20-17%20132%20-76%20238%20-131%20195%20-102%20284%20-159%20302%20-192%2028%20-52%201%20-148%20-57%20-202%20-58%20-55%20-77%20-58%20-388%20-58%20l-285%200%200%20-215%200%20-215%20160%200%20160%200%200%20-105%200%20-105%20210%200%20210%200%200%20125%200%20126%2045%2019%20c232%20100%20398%20365%20382%20610%20-12%20179%20-112%20332%20-299%20458%20-25%2018%20-132%2076%20-237%20131%20-193%20100%20-283%20158%20-301%20191%20-28%2052%20-1%20148%2057%20202%2058%2055%2077%2058%20388%2058%20l285%200%200%20215%200%20215%20-160%200%20-160%200%200%20105%200%20105%20-210%200%20-210%200%200%20-125z'/%3e%3c/g%3e%3c/svg%3e",bZ="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%2020010904//EN'%20'http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd'%3e%3csvg%20version='1.0'%20xmlns='http://www.w3.org/2000/svg'%20width='512.000000pt'%20height='512.000000pt'%20viewBox='0%200%20512.000000%20512.000000'%20preserveAspectRatio='xMidYMid%20meet'%3e%3cg%20transform='translate(0.000000,512.000000)%20scale(0.100000,-0.100000)'%20fill='%23ffffff'%20stroke='none'%3e%3cpath%20d='M2285%204675%20c-640%20-84%20-1211%20-457%20-1551%20-1015%20-278%20-456%20-372%20-1020%20-258%20-1550%2086%20-400%20284%20-760%20579%20-1055%20351%20-352%20787%20-560%201284%20-615%20171%20-19%20442%20-8%20615%2024%20423%2080%20802%20282%201111%20591%20407%20407%20625%20931%20625%201505%200%20574%20-218%201098%20-625%201505%20-348%20349%20-786%20561%20-1270%20615%20-122%2013%20-387%2011%20-510%20-5z%20m574%20-436%20c375%20-64%20738%20-269%20989%20-560%20504%20-583%20557%20-1420%20129%20-2067%20-33%20-50%20-63%20-92%20-67%20-92%20-3%200%20-68%2063%20-145%20140%20-77%2077%20-144%20140%20-150%20140%20-13%200%20-295%20-282%20-295%20-295%200%20-6%2063%20-73%20140%20-150%2077%20-77%20140%20-142%20140%20-145%200%20-12%20-195%20-134%20-289%20-181%20-399%20-198%20-882%20-229%20-1302%20-83%20-595%20206%20-1020%20703%20-1130%201320%20-30%20166%20-30%20422%20-1%20585%2048%20265%20145%20487%20324%20744%204%206%2068%20-50%20152%20-134%20l145%20-145%2022%2020%20c57%2049%20279%20272%20279%20280%200%205%20-64%2073%20-142%20152%20-83%2083%20-139%20146%20-133%20150%20297%20207%20556%20308%20878%20342%20113%2012%20320%202%20456%20-21z'/%3e%3cpath%20d='M2350%203715%20l0%20-126%20-45%20-19%20c-128%20-55%20-251%20-173%20-315%20-303%20-143%20-291%20-60%20-569%20230%20-764%2025%20-17%20132%20-76%20238%20-131%20195%20-102%20284%20-159%20302%20-192%2028%20-52%201%20-148%20-57%20-202%20-58%20-55%20-77%20-58%20-388%20-58%20l-285%200%200%20-215%200%20-215%20160%200%20160%200%200%20-105%200%20-105%20210%200%20210%200%200%20125%200%20126%2045%2019%20c232%20100%20398%20365%20382%20610%20-12%20179%20-112%20332%20-299%20458%20-25%2018%20-132%2076%20-237%20131%20-193%20100%20-283%20158%20-301%20191%20-28%2052%20-1%20148%2057%20202%2058%2055%2077%2058%20388%2058%20l285%200%200%20215%200%20215%20-160%200%20-160%200%200%20105%200%20105%20-210%200%20-210%200%200%20-125z'/%3e%3c/g%3e%3c/svg%3e",xZ="https://frontwars.io/assets/NukeIconRed-BS1fg40f.svg",vZ="https://frontwars.io/assets/NukeIconWhite-RG3lMwtm.svg",_Z="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%20width='2486px'%20height='2486px'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%3e%3cpath%20style='opacity:0.998'%20fill='%23ec1b2d'%20d='M%201211.5,-0.5%20C%201232.17,-0.5%201252.83,-0.5%201273.5,-0.5C%201588.52,11.386%201861.52,123.219%202092.5,335C%202290.11,522.982%202414.61,751.815%202466,1021.5C%202476.93,1083.86%202483.43,1146.53%202485.5,1209.5C%202485.5,1231.5%202485.5,1253.5%202485.5,1275.5C%202473.18,1590.32%202361.01,1862.99%202149,2093.5C%201927.26,2324.93%201655.76,2454.43%201334.5,2482C%201313.35,2483.33%201292.35,2484.5%201271.5,2485.5C%201252.17,2485.5%201232.83,2485.5%201213.5,2485.5C%20909.24,2475.11%20643.24,2370.28%20415.5,2171C%20184.306,1961.15%2048.4731,1700.32%208,1388.5C%203.8089,1351.11%200.975569,1313.78%20-0.5,1276.5C%20-0.5,1253.83%20-0.5,1231.17%20-0.5,1208.5C%2013.2705,874.898%20137.271,590.398%20371.5,355C%20605.561,130.536%20885.561,12.0356%201211.5,-0.5%20Z%20M%201227.5,417.5%20C%201472.71,417.901%201679.54,506.234%201848,682.5C%202011.78,865.164%202083.44,1079.5%202063,1325.5C%202038.21,1541.6%201945.04,1721.44%201783.5,1865C%201628.2,1997.23%201447.87,2064.73%201242.5,2067.5C%201027.53,2064.38%20840.864,1991.22%20682.5,1848C%20510.155,1683.73%20421.822,1481.9%20417.5,1242.5C%20422.049,997.3%20514.049,792.133%20693.5,627C%20845.992,493.75%201023.99,423.917%201227.5,417.5%20Z'/%3e%3c/g%3e%3cg%3e%3cpath%20style='opacity:0.998'%20fill='%23ec1b2d'%20d='M%201221.5,805.5%20C%201373.25,802.47%201495.42,860.47%201588,979.5C%201667.19,1092.15%201689.86,1215.48%201656,1349.5C%201622.81,1462.33%201555.65,1548.5%201454.5,1608C%201351.93,1663.95%201243.93,1677.62%201130.5,1649C%201004.57,1612.06%20912.399,1534.89%20854,1417.5C%20806.01,1310.63%20800.676,1201.63%20838,1090.5C%20879.271,979.559%20953.105,898.059%201059.5,846C%201111.02,822.134%201165.02,808.634%201221.5,805.5%20Z'/%3e%3c/g%3e%3c/svg%3e",wZ="https://frontwars.io/assets/TraitorIcon-BMZydE8p.svg";class SZ{constructor(e,t,r){this._gameInstance=e,this._bus=t,this._camera=r,this._isVisible=!0,this._topPlayer=null,this._iconRegistry=new Map,this._flagCache=new Map,this._lastLogicTick=0,this._cachedSortedPlayers=[],this._theme=e.gameView.config().theme(),this.preloadAssets()}preloadAssets(){const e={[dZ]:"icon_alliance",[fZ]:"icon_req_black",[mZ]:"icon_req_white",[pZ]:"icon_crown",[gZ]:"icon_disconnect",[yZ]:"icon_ban_black",[bZ]:"icon_ban_white",[xZ]:"icon_nuke_red",[vZ]:"icon_nuke_white",[_Z]:"icon_target",[wZ]:"icon_traitor"};Object.entries(e).forEach(([t,r])=>{const i=new Image;i.src=t,this._iconRegistry.set(r,i)})}isWorldSpace(){return!1}async init(){this._bus.on(sd,e=>{this._isVisible=!e.alternateView}),this.constructSurface()}tick(){this._gameInstance.gameView.ticks()%10===0&&(this._cachedSortedPlayers=this._gameInstance.gameView.playerViews().filter(e=>e.isAlive()).sort((e,t)=>t.numTilesOwned()-e.numTilesOwned()),this._topPlayer=this._cachedSortedPlayers.length>0?this._cachedSortedPlayers[0]:null)}constructSurface(){this._overlayCanvas=document.createElement("canvas"),this._overlayCtx=this._overlayCanvas.getContext("2d"),this.resizeSurface(),window.addEventListener("resize",()=>this.resizeSurface())}resizeSurface(){this._overlayCanvas.width=window.innerWidth,this._overlayCanvas.height=window.innerHeight}paint(e){if(this._isVisible){this._overlayCtx.clearRect(0,0,this._overlayCanvas.width,this._overlayCanvas.height);for(const t of this._cachedSortedPlayers)this.processPlayerLabel(t);e.drawImage(this._overlayCanvas,0,0)}}processPlayerLabel(e){const t=e.nameLocation();if(!t)return;const r=Math.max(1,Math.floor(t.size)),i=this._camera.zoomLevel,s=i*r;if(s<7||i>17&&s>100)return;const o=new yr(t.x,t.y);if(!this._camera.isCellVisible(o))return;const c=this._camera.toScreenSpace(o),u={position:new yr(c.x,c.y),fontSize:Math.max(4,Math.floor(r*i)),color:this._theme.textColor(e),isVisible:!0};this.drawLabel(this._overlayCtx,e,u)}drawLabel(e,t,r){const{x:i,y:s}=r.position,o=r.fontSize;e.save();const c=this._theme.font();e.font=`${o}px ${c}`,e.textAlign="center",e.textBaseline="middle";const u=Math.min(o*1.5,48),d=o*.2,f=t.name(),p=Hs(t.troops()),y=e.measureText(f).width,b=4/3,_=o,w=_*b,S=w+d+y,A=this.gatherActiveIcons(t);(A.length>0||this.hasEmoji(t))&&this.drawIconsRow(e,A,t,i,s-o*1.2,u);const M=i-S/2;this.drawFlag(e,t,M,s-_/2,w,_),e.fillStyle=r.color,e.textAlign="left",e.fillText(f,M+w+d,s),e.textAlign="center",e.fillText(p,i,s+o*1.1),e.restore()}drawIconsRow(e,t,r,i,s,o){const c=this.getEmoji(r),u=t.length+(c?1:0);if(u===0)return;const d=4,f=u*o+(u-1)*d;let p=i-f/2;const y=s-o/2;if(c){e.save(),e.font=`${o}px sans-serif`,e.textAlign="center",e.textBaseline="middle",e.fillText(c,i,s+o/2),e.restore();return}const b=Re.darkMode();for(const _ of t){let w;switch(_){case"crown":w=this._iconRegistry.get("icon_crown");break;case"traitor":w=this._iconRegistry.get("icon_traitor");break;case"disconnect":w=this._iconRegistry.get("icon_disconnect");break;case"alliance":w=this._iconRegistry.get("icon_alliance");break;case"target":w=this._iconRegistry.get("icon_target");break;case"request":w=b?this._iconRegistry.get("icon_req_white"):this._iconRegistry.get("icon_req_black");break;case"embargo":w=b?this._iconRegistry.get("icon_ban_white"):this._iconRegistry.get("icon_ban_black");break}_==="nuke"&&(w=this.isPlayerTargetedByNuke(r)?this._iconRegistry.get("icon_nuke_red"):this._iconRegistry.get("icon_nuke_white")),w&&(e.globalAlpha=.8,e.drawImage(w,p,y,o,o),e.globalAlpha=1,p+=o+d)}}drawFlag(e,t,r,i,s,o){const c=t.cosmetics.flag;if(!c)return;if(c.startsWith("!")){e.fillStyle="#444",e.fillRect(r,i,s,o);return}let u=this._flagCache.get(c);u||(u=new Image,u.src=`/flags/${c}.svg`,this._flagCache.set(c,u)),u.complete&&u.naturalWidth>0&&(e.save(),e.globalAlpha=.8,e.drawImage(u,r,i,s,o),e.restore())}gatherActiveIcons(e){const t=[],r=this._gameInstance.gameView.myPlayer();return e===this._topPlayer&&t.push("crown"),e.isTraitor()&&t.push("traitor"),e.isDisconnected()&&t.push("disconnect"),r&&(r.isAlliedWith(e)&&t.push("alliance"),e.isRequestingAllianceWith(r)&&t.push("request"),new Set(r.transitiveTargets()).has(e)&&t.push("target"),r.hasEmbargo(e)&&t.push("embargo")),this.checkForNukeActivity(e,r)&&t.push("nuke"),t}getEmoji(e){if(!this._gameInstance.gameView.config().userSettings()?.emojis())return null;const t=this._gameInstance.gameView.myPlayer()?.smallID(),r=e.outgoingEmojis().filter(i=>i.recipientID===fs||i.recipientID===t);return r.length>0?r[0].message:null}hasEmoji(e){return this.getEmoji(e)!==null}checkForNukeActivity(e,t){return this._gameInstance.gameView.units().filter(i=>{const s=e.id()===i.owner().id(),o=!t||i.owner().id()!==t.id();return Y5.includes(i.type())&&s&&o&&i.isActive()}).length>0}isPlayerTargetedByNuke(e){const t=this._gameInstance.gameView.myPlayer();return t?this._gameInstance.gameView.units().filter(i=>{const s=i.owner().id()===e.id();return Y5.includes(i.type())&&s&&i.isActive()}).some(i=>{const s=i.targetTile();return s===void 0?!1:this._gameInstance.gameView.owner(s).id()===t.id()}):!1}}function hI(n){return n.map(e=>{const t=(e>>12&15)-4,r=(e>>8&15)-4,i=e>>4&15,s=e&15;return[t,r,i,s]})}const AZ={[ui.HORIZONTAL]:[13089,13601,13329],[ui.VERTICAL]:[12818,21010,17169],[ui.TOP_RIGHT]:[12818,17170,21012],[ui.TOP_LEFT]:[12820,17170,21010],[ui.BOTTOM_RIGHT]:[13586,17426,21268],[ui.BOTTOM_LEFT]:[13076,17426,21778]},CZ={[ui.HORIZONTAL]:[12849,13873,14097,22289],[ui.VERTICAL]:[8723,25107],[ui.TOP_RIGHT]:[8722,13329,17681,22049,25105],[ui.BOTTOM_LEFT]:[8737,17169,21521,25874,9745],[ui.TOP_LEFT]:[8721,9761,17681,21521,25106],[ui.BOTTOM_RIGHT]:[9490,13329,17169,21025,26129]};function kZ(n){const e=AZ[n];if(!e)throw new Error(`[G-ERR] Missing track def: ${n}`);return hI(e)}function TZ(n){const e=CZ[n];if(!e)throw new Error(`[G-ERR] Missing support def: ${n}`);return hI(e)}class EZ{#e;#t;constructor(){this.#e=document.createElement("canvas");const e=this.#e.getContext("2d",{alpha:!0});if(!e)throw new Error("Canvas Context Failure");this.#t=e,this.#t.imageSmoothingEnabled=!0,this.#t.imageSmoothingQuality="high"}rebuildBuffer(e,t){this.#e.width=e*2,this.#e.height=t*2,this.#t.imageSmoothingEnabled=!0,this.#t.imageSmoothingQuality="high"}get canvas(){return this.#e}clearSegment(e,t){const r=e.x(t)*2,i=e.y(t)*2;e.isWater(t)?this.#t.clearRect(r-2,i-2,5,6):this.#t.clearRect(r-1,i-1,3,3)}paintSegment(e,t,r,i){const s=e.x(t),o=e.y(t);e.isWater(t)&&this.drawSupportStructure(s,o,r),this.drawTrackGeometry(s,o,r,i)}drawTrackGeometry(e,t,r,i){const s=kZ(r),o=e*2,c=t*2,u=i.darken(.3),d=i.lighten(.2);for(const[f,p,y,b]of s){const _=o+f,w=c+p;this.#t.save(),this.#t.fillStyle="rgba(0, 0, 0, 0.15)",this.#t.fillRect(_,w,y,b),this.#t.restore(),this.#t.save();const S=this.#t.createLinearGradient(_,w,_,w+b);S.addColorStop(0,u.toRgbString()),S.addColorStop(.5,i.toRgbString()),S.addColorStop(1,u.toRgbString()),this.#t.fillStyle=S,this.#t.fillRect(_,w,y,b),b>.5&&(this.#t.fillStyle=d.alpha(.4).toRgbString(),this.#t.fillRect(_,w,y,Math.max(.5,b*.3))),this.#t.restore()}}drawSupportStructure(e,t,r){this.#t.save();const i=e*2,s=t*2,o={r:197,g:69,b:72},c={r:150,g:50,b:55},u={r:220,g:90,b:95},d=TZ(r);for(const[f,p,y,b]of d){const _=i+f,w=s+p;this.#t.fillStyle="rgba(0, 0, 0, 0.2)",this.#t.fillRect(_,w,y,b);const S=this.#t.createLinearGradient(_,w,_+y,w+b);S.addColorStop(0,`rgb(${c.r}, ${c.g}, ${c.b})`),S.addColorStop(.5,`rgb(${o.r}, ${o.g}, ${o.b})`),S.addColorStop(1,`rgb(${c.r}, ${c.g}, ${c.b})`),this.#t.fillStyle=S,this.#t.fillRect(_,w,y,b),this.#t.fillStyle=`rgba(${u.r}, ${u.g}, ${u.b}, 0.3)`,this.#t.fillRect(_,w,y*.4,b)}this.#t.restore()}}class MZ{#e=new Map;#t=[];#n=0;constructor(){}registerTrack(e,t){const r=this.#e.get(e.tile);return r?(r.stackCount++,r.ref=e,r.lastKnownOwner=t,!1):(this.#e.set(e.tile,{ref:e,stackCount:1,lastKnownOwner:t}),this.#t.push(e.tile),!0)}removeTrack(e){const t=this.#e.get(e.tile);return t&&t.stackCount--,!t||t.stackCount<=0?(this.#e.delete(e.tile),this.#t=this.#t.filter(r=>r!==e.tile),this.#n>=this.#t.length&&(this.#n=0),!0):!1}getSegment(e){return this.#e.get(e)}getAllSegments(){return this.#e.values()}processColorUpdates(e,t){const r=this.#t.length/60;let i=0;for(;i<r&&this.#t.length>0;){const s=this.#t[this.#n],o=this.#e.get(s);if(o){const c=e.owner(s)?.id()??null;o.lastKnownOwner!==c&&(o.lastKnownOwner=c,t(o))}this.#n++,this.#n>=this.#t.length&&(this.#n=0),i++}}}class NZ{constructor(e,t){this._view=e,this._camera=t,this.state=new MZ,this.painter=new EZ}isWorldSpace(){return!0}tick(){const e=this._view.updatesSinceLastTick(),t=e!==null?e[Wt.RailroadEvent]:[];for(const r of t)this.processTrackEvents(r)}async init(){this.rebuildBuffer()}rebuildBuffer(){this.painter.rebuildBuffer(this._view.width(),this._view.height());for(const e of this.state.getAllSegments())this.renderTrackSegment(e.ref)}paint(e){this.state.processColorUpdates(this._view,s=>{this.renderTrackSegment(s.ref)});const t=this._camera.zoomLevel;if(t<=1)return;const r=(t-1)/1,i=Math.max(0,Math.min(1,r));e.save(),e.globalAlpha=i,e.drawImage(this.painter.canvas,-this._view.width()/2,-this._view.height()/2,this._view.width(),this._view.height()),e.restore()}processTrackEvents(e){for(const t of e.railTiles)e.isActive?this.registerTrack(t):this.removeTrack(t)}registerTrack(e){const t=this._view.owner(e.tile)?.id()??null;this.state.registerTrack(e,t)&&this.renderTrackSegment(e)}removeTrack(e){this.state.removeTrack(e)&&this.painter.clearSegment(this._view,e.tile)}renderTrackSegment(e){const t=this._view.owner(e.tile),r=t.isPlayer()?t:null,i=r?r.borderColor():new od({r:255,g:255,b:255,a:1});this.painter.paintSegment(this._view,e.tile,e.railType,i)}}var Db=function(n){var e=n/255;return e<.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},jb=function(n){return .2126*Db(n.r)+.7152*Db(n.g)+.0722*Db(n.b)};function IZ(n){n.prototype.luminance=function(){return e=jb(this.rgba),(t=2)===void 0&&(t=0),r===void 0&&(r=Math.pow(10,t)),Math.round(r*e)/r+0;var e,t,r},n.prototype.contrast=function(e){e===void 0&&(e="#FFF");var t,r,i,s,o,c,u,d=e instanceof n?e:new n(e);return s=this.rgba,o=d.toRgb(),c=jb(s),u=jb(o),t=c>u?(c+.05)/(u+.05):(u+.05)/(c+.05),(r=2)===void 0&&(r=0),i===void 0&&(i=Math.pow(10,r)),Math.floor(i*t)/i+0},n.prototype.isReadable=function(e,t){return e===void 0&&(e="#FFF"),t===void 0&&(t={}),this.contrast(e)>=(c=(o=(r=t).size)===void 0?"normal":o,(s=(i=r.level)===void 0?"AA":i)==="AAA"&&c==="normal"?7:s==="AA"&&c==="large"?3:4.5);var r,i,s,o,c}}var me=(n=>(n.Application="application",n.WebGLPipes="webgl-pipes",n.WebGLPipesAdaptor="webgl-pipes-adaptor",n.WebGLSystem="webgl-system",n.WebGPUPipes="webgpu-pipes",n.WebGPUPipesAdaptor="webgpu-pipes-adaptor",n.WebGPUSystem="webgpu-system",n.CanvasSystem="canvas-system",n.CanvasPipesAdaptor="canvas-pipes-adaptor",n.CanvasPipes="canvas-pipes",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n.MaskEffect="mask-effect",n.BlendMode="blend-mode",n.TextureSource="texture-source",n.Environment="environment",n.ShapeBuilder="shape-builder",n.Batcher="batcher",n))(me||{});const M1=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},Rm=(n,e)=>M1(n).priority??e,Pn={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(M1).forEach(e=>{e.type.forEach(t=>this._removeHandlers[t]?.(e))}),this},add(...n){return n.map(M1).forEach(e=>{e.type.forEach(t=>{const r=this._addHandlers,i=this._queue;r[t]?r[t]?.(e):(i[t]=i[t]||[],i[t]?.push(e))})}),this},handle(n,e,t){const r=this._addHandlers,i=this._removeHandlers;if(r[n]||i[n])throw new Error(`Extension type ${n} already has a handler`);r[n]=e,i[n]=t;const s=this._queue;return s[n]&&(s[n]?.forEach(o=>e(o)),delete s[n]),this},handleByMap(n,e){return this.handle(n,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByNamedList(n,e,t=-1){return this.handle(n,r=>{e.findIndex(s=>s.name===r.name)>=0||(e.push({name:r.name,value:r.ref}),e.sort((s,o)=>Rm(o.value,t)-Rm(s.value,t)))},r=>{const i=e.findIndex(s=>s.name===r.name);i!==-1&&e.splice(i,1)})},handleByList(n,e,t=-1){return this.handle(n,r=>{e.includes(r.ref)||(e.push(r.ref),e.sort((i,s)=>Rm(s,t)-Rm(i,t)))},r=>{const i=e.indexOf(r.ref);i!==-1&&e.splice(i,1)})},mixin(n,...e){for(const t of e)Object.defineProperties(n.prototype,Object.getOwnPropertyDescriptors(t))}},RZ={extension:{type:me.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await k2(()=>import("https://frontwars.io/assets/browserAll-CdxFVCIO.js"),__vite__mapDeps([0,1]))}},PZ={extension:{type:me.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await k2(()=>import("https://frontwars.io/assets/webworkerAll-DDGql2Zg.js"),[])}};class gr{constructor(e,t,r){this._x=t||0,this._y=r||0,this._observer=e}clone(e){return new gr(e??this._observer,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var Bb={exports:{}},jT;function DZ(){return jT||(jT=1,(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function s(u,d,f,p,y){if(typeof f!="function")throw new TypeError("The listener must be a function");var b=new i(f,p||u,y),_=t?t+d:d;return u._events[_]?u._events[_].fn?u._events[_]=[u._events[_],b]:u._events[_].push(b):(u._events[_]=b,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function c(){this._events=new r,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],f,p;if(this._eventsCount===0)return d;for(p in f=this._events)e.call(f,p)&&d.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},c.prototype.listeners=function(d){var f=t?t+d:d,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var y=0,b=p.length,_=new Array(b);y<b;y++)_[y]=p[y].fn;return _},c.prototype.listenerCount=function(d){var f=t?t+d:d,p=this._events[f];return p?p.fn?1:p.length:0},c.prototype.emit=function(d,f,p,y,b,_){var w=t?t+d:d;if(!this._events[w])return!1;var S=this._events[w],A=arguments.length,M,k;if(S.fn){switch(S.once&&this.removeListener(d,S.fn,void 0,!0),A){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,f),!0;case 3:return S.fn.call(S.context,f,p),!0;case 4:return S.fn.call(S.context,f,p,y),!0;case 5:return S.fn.call(S.context,f,p,y,b),!0;case 6:return S.fn.call(S.context,f,p,y,b,_),!0}for(k=1,M=new Array(A-1);k<A;k++)M[k-1]=arguments[k];S.fn.apply(S.context,M)}else{var E=S.length,U;for(k=0;k<E;k++)switch(S[k].once&&this.removeListener(d,S[k].fn,void 0,!0),A){case 1:S[k].fn.call(S[k].context);break;case 2:S[k].fn.call(S[k].context,f);break;case 3:S[k].fn.call(S[k].context,f,p);break;case 4:S[k].fn.call(S[k].context,f,p,y);break;default:if(!M)for(U=1,M=new Array(A-1);U<A;U++)M[U-1]=arguments[U];S[k].fn.apply(S[k].context,M)}}return!0},c.prototype.on=function(d,f,p){return s(this,d,f,p,!1)},c.prototype.once=function(d,f,p){return s(this,d,f,p,!0)},c.prototype.removeListener=function(d,f,p,y){var b=t?t+d:d;if(!this._events[b])return this;if(!f)return o(this,b),this;var _=this._events[b];if(_.fn)_.fn===f&&(!y||_.once)&&(!p||_.context===p)&&o(this,b);else{for(var w=0,S=[],A=_.length;w<A;w++)(_[w].fn!==f||y&&!_[w].once||p&&_[w].context!==p)&&S.push(_[w]);S.length?this._events[b]=S.length===1?S[0]:S:o(this,b)}return this},c.prototype.removeAllListeners=function(d){var f;return d?(f=t?t+d:d,this._events[f]&&o(this,f)):(this._events=new r,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,n.exports=c})(Bb)),Bb.exports}var jZ=DZ();const zi=Zo(jZ),BZ=Math.PI*2,OZ=180/Math.PI,LZ=Math.PI/180;class br{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new br(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Ob.x=0,Ob.y=0,Ob}}const Ob=new br;class We{constructor(e=1,t=0,r=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=t,this.c=r,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,r,i,s,o){return this.a=e,this.b=t,this.c=r,this.d=i,this.tx=s,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,t){t=t||new br;const r=e.x,i=e.y;return t.x=this.a*r+this.c*i+this.tx,t.y=this.b*r+this.d*i+this.ty,t}applyInverse(e,t){t=t||new br;const r=this.a,i=this.b,s=this.c,o=this.d,c=this.tx,u=this.ty,d=1/(r*o+s*-i),f=e.x,p=e.y;return t.x=o*d*f+-s*d*p+(u*s-c*o)*d,t.y=r*d*p+-i*d*f+(-u*r+c*i)*d,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*t-this.b*r,this.b=i*r+this.b*t,this.c=s*t-this.d*r,this.d=s*r+this.d*t,this.tx=o*t-this.ty*r,this.ty=o*r+this.ty*t,this}append(e){const t=this.a,r=this.b,i=this.c,s=this.d;return this.a=e.a*t+e.b*i,this.b=e.a*r+e.b*s,this.c=e.c*t+e.d*i,this.d=e.c*r+e.d*s,this.tx=e.tx*t+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*s+this.ty,this}appendFrom(e,t){const r=e.a,i=e.b,s=e.c,o=e.d,c=e.tx,u=e.ty,d=t.a,f=t.b,p=t.c,y=t.d;return this.a=r*d+i*p,this.b=r*f+i*y,this.c=s*d+o*p,this.d=s*f+o*y,this.tx=c*d+u*p+t.tx,this.ty=c*f+u*y+t.ty,this}setTransform(e,t,r,i,s,o,c,u,d){return this.a=Math.cos(c+d)*s,this.b=Math.sin(c+d)*s,this.c=-Math.sin(c-u)*o,this.d=Math.cos(c-u)*o,this.tx=e-(r*this.a+i*this.c),this.ty=t-(r*this.b+i*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const r=this.a,i=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,r=this.b,i=this.c,s=this.d,o=e.pivot,c=-Math.atan2(-i,s),u=Math.atan2(r,t),d=Math.abs(c+u);return d<1e-5||Math.abs(BZ-d)<1e-5?(e.rotation=u,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=c,e.skew.y=u),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*t+o.y*i),e.position.y=this.ty+(o.x*r+o.y*s),e}invert(){const e=this.a,t=this.b,r=this.c,i=this.d,s=this.tx,o=e*i-t*r;return this.a=i/o,this.b=-t/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-i*s)/o,this.ty=-(e*this.ty-t*s)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new We;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return UZ.identity()}static get shared(){return zZ.identity()}}const zZ=new We,UZ=new We,vo=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],_o=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],wo=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],So=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],N1=[],dI=[],Pm=Math.sign;function FZ(){for(let n=0;n<16;n++){const e=[];N1.push(e);for(let t=0;t<16;t++){const r=Pm(vo[n]*vo[t]+wo[n]*_o[t]),i=Pm(_o[n]*vo[t]+So[n]*_o[t]),s=Pm(vo[n]*wo[t]+wo[n]*So[t]),o=Pm(_o[n]*wo[t]+So[n]*So[t]);for(let c=0;c<16;c++)if(vo[c]===r&&_o[c]===i&&wo[c]===s&&So[c]===o){e.push(c);break}}}for(let n=0;n<16;n++){const e=new We;e.set(vo[n],_o[n],wo[n],So[n],0,0),dI.push(e)}}FZ();const Vt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>vo[n],uY:n=>_o[n],vX:n=>wo[n],vY:n=>So[n],inv:n=>n&8?n&15:-n&7,add:(n,e)=>N1[n][e],sub:(n,e)=>N1[n][Vt.inv(e)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,e)=>Math.abs(n)*2<=Math.abs(e)?e>=0?Vt.S:Vt.N:Math.abs(e)*2<=Math.abs(n)?n>0?Vt.E:Vt.W:e>0?n>0?Vt.SE:Vt.SW:n>0?Vt.NE:Vt.NW,matrixAppendRotationInv:(n,e,t=0,r=0)=>{const i=dI[Vt.inv(e)];i.tx=t,i.ty=r,n.append(i)},transformRectCoords:(n,e,t,r)=>{const{x:i,y:s,width:o,height:c}=n,{x:u,y:d,width:f,height:p}=e;return t===Vt.E?(r.set(i+u,s+d,o,c),r):t===Vt.S?r.set(f-s-c+u,i+d,c,o):t===Vt.W?r.set(f-i-o+u,p-s-c+d,o,c):t===Vt.N?r.set(s+u,p-i-o+d,c,o):r.set(i+u,s+d,o,c)}},Dm=[new br,new br,new br,new br];class Qt{constructor(e=0,t=0,r=0,i=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Qt(0,0,0,0)}clone(){return new Qt(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}strokeContains(e,t,r,i=.5){const{width:s,height:o}=this;if(s<=0||o<=0)return!1;const c=this.x,u=this.y,d=r*(1-i),f=r-d,p=c-d,y=c+s+d,b=u-d,_=u+o+d,w=c+f,S=c+s-f,A=u+f,M=u+o-f;return e>=p&&e<=y&&t>=b&&t<=_&&!(e>w&&e<S&&t>A&&t<M)}intersects(e,t){if(!t){const G=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=G)return!1;const P=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>P}const r=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=r||o<=s)return!1;const c=Dm[0].set(e.left,e.top),u=Dm[1].set(e.left,e.bottom),d=Dm[2].set(e.right,e.top),f=Dm[3].set(e.right,e.bottom);if(d.x<=c.x||u.y<=c.y)return!1;const p=Math.sign(t.a*t.d-t.b*t.c);if(p===0||(t.apply(c,c),t.apply(u,u),t.apply(d,d),t.apply(f,f),Math.max(c.x,u.x,d.x,f.x)<=r||Math.min(c.x,u.x,d.x,f.x)>=i||Math.max(c.y,u.y,d.y,f.y)<=s||Math.min(c.y,u.y,d.y,f.y)>=o))return!1;const y=p*(u.y-c.y),b=p*(c.x-u.x),_=y*r+b*s,w=y*i+b*s,S=y*r+b*o,A=y*i+b*o;if(Math.max(_,w,S,A)<=y*c.x+b*c.y||Math.min(_,w,S,A)>=y*f.x+b*f.y)return!1;const M=p*(c.y-d.y),k=p*(d.x-c.x),E=M*r+k*s,U=M*i+k*s,I=M*r+k*o,B=M*i+k*o;return!(Math.max(E,U,I,B)<=M*c.x+k*c.y||Math.min(E,U,I,B)>=M*f.x+k*f.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,t=.001){const r=Math.ceil((this.x+this.width-t)*e)/e,i=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=i-this.y,this}scale(e,t=e){return this.x*=e,this.y*=t,this.width*=e,this.height*=t,this}enlarge(e){const t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=i,this.height=s-i,this}getBounds(e){return e||(e=new Qt),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const t=e.x,r=e.y,i=e.x+e.width,s=e.y+e.height;return t>=this.x&&t<this.x+this.width&&r>=this.y&&r<this.y+this.height&&i>=this.x&&i<this.x+this.width&&s>=this.y&&s<this.y+this.height}set(e,t,r,i){return this.x=e,this.y=t,this.width=r,this.height=i,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Lb={default:-1};function an(n="default"){return Lb[n]===void 0&&(Lb[n]=-1),++Lb[n]}const BT=new Set,Yt="8.0.0",GZ="8.3.4",cc={quiet:!1,noColor:!1},it=(n,e,t=3)=>{if(cc.quiet||BT.has(e))return;let r=new Error().stack;const i=`${e}
Deprecated since v${n}`,s=typeof console.groupCollapsed=="function"&&!cc.noColor;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",i):(r=r.split(`
`).splice(t).join(`
`),s?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",i),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",i),console.warn(r))),BT.add(e)};Object.defineProperties(it,{quiet:{get:()=>cc.quiet,set:n=>{cc.quiet=n},enumerable:!0,configurable:!1},noColor:{get:()=>cc.noColor,set:n=>{cc.noColor=n},enumerable:!0,configurable:!1}});const fI=()=>{};function zp(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function OT(n){return!(n&n-1)&&!!n}function mI(n){const e={};for(const t in n)n[t]!==void 0&&(e[t]=n[t]);return e}const LT=Object.create(null);function HZ(n){const e=LT[n];return e===void 0&&(LT[n]=an("resource")),e}const pI=class gI extends zi{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...gI.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){it(Yt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=HZ(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};pI.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let md=pI;const yI=class bI extends zi{constructor(e={}){super(),this.options=e,this.uid=an("textureSource"),this._resourceType="textureSource",this._resourceId=an("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...bI.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new md(mI(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(e){this._style.maxAnisotropy=e}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=an("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,t,r){r||(r=this._resolution),e||(e=this.width),t||(t=this.height);const i=Math.round(e*r),s=Math.round(t*r);return this.width=i/r,this.height=s/r,this._resolution=r,this.pixelWidth===i&&this.pixelHeight===s?!1:(this._refreshPOT(),this.pixelWidth=i,this.pixelHeight=s,this.emit("resize",this),this._resourceId=an("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=OT(this.pixelWidth)&&OT(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};yI.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let ur=yI;class uv extends ur{constructor(e){const t=e.resource||new Float32Array(e.width*e.height*4);let r=e.format;r||(t instanceof Float32Array?r="rgba32float":t instanceof Int32Array||t instanceof Uint32Array?r="rgba32uint":t instanceof Int16Array||t instanceof Uint16Array?r="rgba16uint":(t instanceof Int8Array,r="bgra8unorm")),super({...e,resource:t,format:r}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}uv.extension=me.TextureSource;const zT=new We;class xI{constructor(e,t){this.mapCoord=new We,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof t>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){t===void 0&&(t=e);const r=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];t[i]=s*r.a+o*r.c+r.tx,t[i+1]=s*r.b+o*r.d+r.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const r=e.orig,i=e.trim;i&&(zT.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(zT));const s=e.source,o=this.uClampFrame,c=this.clampMargin/s._resolution,u=this.clampOffset/s._resolution;return o[0]=(e.frame.x+c+u)/s.width,o[1]=(e.frame.y+c+u)/s.height,o[2]=(e.frame.x+e.frame.width-c+u)/s.width,o[3]=(e.frame.y+e.frame.height-c+u)/s.height,this.uClampOffset[0]=this.clampOffset/s.pixelWidth,this.uClampOffset[1]=this.clampOffset/s.pixelHeight,this.isSimple=e.frame.width===s.width&&e.frame.height===s.height&&e.rotate===0,!0}}class Ue extends zi{constructor({source:e,label:t,frame:r,orig:i,trim:s,defaultAnchor:o,defaultBorders:c,rotate:u,dynamic:d}={}){if(super(),this.uid=an("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Qt,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=e?.source??new ur,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:f,height:p}=this._source;this.frame.width=f,this.frame.height=p}this.orig=i||this.frame,this.trim=s,this.rotate=u??0,this.defaultAnchor=o,this.defaultBorders=c,this.destroyed=!1,this.dynamic=d||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new xI(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:r,height:i}=this._source,s=t.x/r,o=t.y/i,c=t.width/r,u=t.height/i;let d=this.rotate;if(d){const f=c/2,p=u/2,y=s+f,b=o+p;d=Vt.add(d,Vt.NW),e.x0=y+f*Vt.uX(d),e.y0=b+p*Vt.uY(d),d=Vt.add(d,2),e.x1=y+f*Vt.uX(d),e.y1=b+p*Vt.uY(d),d=Vt.add(d,2),e.x2=y+f*Vt.uX(d),e.y2=b+p*Vt.uY(d),d=Vt.add(d,2),e.x3=y+f*Vt.uX(d),e.y3=b+p*Vt.uY(d)}else e.x0=s,e.y0=o,e.x1=s+c,e.y1=o,e.x2=s+c,e.y2=o+u,e.x3=s,e.y3=o+u}destroy(e=!1){this._source&&(this._source.off("resize",this.update,this),e&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return it(Yt,"Texture.baseTexture is now Texture.source"),this._source}}Ue.EMPTY=new Ue({label:"EMPTY",source:new ur({label:"EMPTY"})});Ue.EMPTY.destroy=fI;Ue.WHITE=new Ue({source:new uv({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});Ue.WHITE.destroy=fI;function VZ(n,e,t){const{width:r,height:i}=t.orig,s=t.trim;if(s){const o=s.width,c=s.height;n.minX=s.x-e._x*r,n.maxX=n.minX+o,n.minY=s.y-e._y*i,n.maxY=n.minY+c}else n.minX=-e._x*r,n.maxX=n.minX+r,n.minY=-e._y*i,n.maxY=n.minY+i}const UT=new We;class qr{constructor(e=1/0,t=1/0,r=-1/0,i=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=UT,this.minX=e,this.minY=t,this.maxX=r,this.maxY=i}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Qt);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=UT,this}set(e,t,r,i){this.minX=e,this.minY=t,this.maxX=r,this.maxY=i}addFrame(e,t,r,i,s){s||(s=this.matrix);const o=s.a,c=s.b,u=s.c,d=s.d,f=s.tx,p=s.ty;let y=this.minX,b=this.minY,_=this.maxX,w=this.maxY,S=o*e+u*t+f,A=c*e+d*t+p;S<y&&(y=S),A<b&&(b=A),S>_&&(_=S),A>w&&(w=A),S=o*r+u*t+f,A=c*r+d*t+p,S<y&&(y=S),A<b&&(b=A),S>_&&(_=S),A>w&&(w=A),S=o*e+u*i+f,A=c*e+d*i+p,S<y&&(y=S),A<b&&(b=A),S>_&&(_=S),A>w&&(w=A),S=o*r+u*i+f,A=c*r+d*i+p,S<y&&(y=S),A<b&&(b=A),S>_&&(_=S),A>w&&(w=A),this.minX=y,this.minY=b,this.maxX=_,this.maxY=w}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,r=this.minY,i=this.maxX,s=this.maxY,{a:o,b:c,c:u,d,tx:f,ty:p}=e;let y=o*t+u*r+f,b=c*t+d*r+p;this.minX=y,this.minY=b,this.maxX=y,this.maxY=b,y=o*i+u*r+f,b=c*i+d*r+p,this.minX=y<this.minX?y:this.minX,this.minY=b<this.minY?b:this.minY,this.maxX=y>this.maxX?y:this.maxX,this.maxY=b>this.maxY?b:this.maxY,y=o*t+u*s+f,b=c*t+d*s+p,this.minX=y<this.minX?y:this.minX,this.minY=b<this.minY?b:this.minY,this.maxX=y>this.maxX?y:this.maxX,this.maxY=b>this.maxY?b:this.maxY,y=o*i+u*s+f,b=c*i+d*s+p,this.minX=y<this.minX?y:this.minX,this.minY=b<this.minY?b:this.minY,this.maxX=y>this.maxX?y:this.maxX,this.maxY=b>this.maxY?b:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,r,i){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<r&&(this.minY=r),this.maxY>i&&(this.maxY=i),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new qr(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,r,i){let s=this.minX,o=this.minY,c=this.maxX,u=this.maxY;i||(i=this.matrix);const d=i.a,f=i.b,p=i.c,y=i.d,b=i.tx,_=i.ty;for(let w=t;w<r;w+=2){const S=e[w],A=e[w+1],M=d*S+p*A+b,k=f*S+y*A+_;s=M<s?M:s,o=k<o?k:o,c=M>c?M:c,u=k>u?k:u}this.minX=s,this.minY=o,this.maxX=c,this.maxY=u}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var WZ={grad:.9,turn:360,rad:360/(2*Math.PI)},Fs=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},ar=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},Bi=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},vI=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},FT=function(n){return{r:Bi(n.r,0,255),g:Bi(n.g,0,255),b:Bi(n.b,0,255),a:Bi(n.a)}},zb=function(n){return{r:ar(n.r),g:ar(n.g),b:ar(n.b),a:ar(n.a,3)}},YZ=/^#([0-9a-f]{3,8})$/i,jm=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},_I=function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=Math.max(e,t,r),o=s-Math.min(e,t,r),c=o?s===e?(t-r)/o:s===t?2+(r-e)/o:4+(e-t)/o:0;return{h:60*(c<0?c+6:c),s:s?o/s*100:0,v:s/255*100,a:i}},wI=function(n){var e=n.h,t=n.s,r=n.v,i=n.a;e=e/360*6,t/=100,r/=100;var s=Math.floor(e),o=r*(1-t),c=r*(1-(e-s)*t),u=r*(1-(1-e+s)*t),d=s%6;return{r:255*[r,c,o,o,u,r][d],g:255*[u,r,r,c,o,o][d],b:255*[o,o,u,r,r,c][d],a:i}},GT=function(n){return{h:vI(n.h),s:Bi(n.s,0,100),l:Bi(n.l,0,100),a:Bi(n.a)}},HT=function(n){return{h:ar(n.h),s:ar(n.s),l:ar(n.l),a:ar(n.a,3)}},VT=function(n){return wI((t=(e=n).s,{h:e.h,s:(t*=((r=e.l)<50?r:100-r)/100)>0?2*t/(r+t)*100:0,v:r+t,a:e.a}));var e,t,r},Hh=function(n){return{h:(e=_I(n)).h,s:(i=(200-(t=e.s))*(r=e.v)/100)>0&&i<200?t*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,t,r,i},$Z=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,qZ=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ZZ=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,XZ=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,I1={string:[[function(n){var e=YZ.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?ar(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?ar(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=ZZ.exec(n)||XZ.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:FT({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=$Z.exec(n)||qZ.exec(n);if(!e)return null;var t,r,i=GT({h:(t=e[1],r=e[2],r===void 0&&(r="deg"),Number(t)*(WZ[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return VT(i)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,r=n.b,i=n.a,s=i===void 0?1:i;return Fs(e)&&Fs(t)&&Fs(r)?FT({r:Number(e),g:Number(t),b:Number(r),a:Number(s)}):null},"rgb"],[function(n){var e=n.h,t=n.s,r=n.l,i=n.a,s=i===void 0?1:i;if(!Fs(e)||!Fs(t)||!Fs(r))return null;var o=GT({h:Number(e),s:Number(t),l:Number(r),a:Number(s)});return VT(o)},"hsl"],[function(n){var e=n.h,t=n.s,r=n.v,i=n.a,s=i===void 0?1:i;if(!Fs(e)||!Fs(t)||!Fs(r))return null;var o=(function(c){return{h:vI(c.h),s:Bi(c.s,0,100),v:Bi(c.v,0,100),a:Bi(c.a)}})({h:Number(e),s:Number(t),v:Number(r),a:Number(s)});return wI(o)},"hsv"]]},WT=function(n,e){for(var t=0;t<e.length;t++){var r=e[t][0](n);if(r)return[r,e[t][1]]}return[null,void 0]},KZ=function(n){return typeof n=="string"?WT(n.trim(),I1.string):typeof n=="object"&&n!==null?WT(n,I1.object):[null,void 0]},Ub=function(n,e){var t=Hh(n);return{h:t.h,s:Bi(t.s+100*e,0,100),l:t.l,a:t.a}},Fb=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},YT=function(n,e){var t=Hh(n);return{h:t.h,s:t.s,l:Bi(t.l+100*e,0,100),a:t.a}},R1=(function(){function n(e){this.parsed=KZ(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return ar(Fb(this.rgba),2)},n.prototype.isDark=function(){return Fb(this.rgba)<.5},n.prototype.isLight=function(){return Fb(this.rgba)>=.5},n.prototype.toHex=function(){return e=zb(this.rgba),t=e.r,r=e.g,i=e.b,o=(s=e.a)<1?jm(ar(255*s)):"","#"+jm(t)+jm(r)+jm(i)+o;var e,t,r,i,s,o},n.prototype.toRgb=function(){return zb(this.rgba)},n.prototype.toRgbString=function(){return e=zb(this.rgba),t=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+t+", "+r+", "+i+", "+s+")":"rgb("+t+", "+r+", "+i+")";var e,t,r,i,s},n.prototype.toHsl=function(){return HT(Hh(this.rgba))},n.prototype.toHslString=function(){return e=HT(Hh(this.rgba)),t=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+t+", "+r+"%, "+i+"%, "+s+")":"hsl("+t+", "+r+"%, "+i+"%)";var e,t,r,i,s},n.prototype.toHsv=function(){return e=_I(this.rgba),{h:ar(e.h),s:ar(e.s),v:ar(e.v),a:ar(e.a,3)};var e},n.prototype.invert=function(){return is({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),is(Ub(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),is(Ub(this.rgba,-e))},n.prototype.grayscale=function(){return is(Ub(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),is(YT(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),is(YT(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?is({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):ar(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=Hh(this.rgba);return typeof e=="number"?is({h:e,s:t.s,l:t.l,a:t.a}):ar(t.h)},n.prototype.isEqual=function(e){return this.toHex()===is(e).toHex()},n})(),is=function(n){return n instanceof R1?n:new R1(n)},$T=[],QZ=function(n){n.forEach(function(e){$T.indexOf(e)<0&&(e(R1,I1),$T.push(e))})};function JZ(n,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in t)r[t[i]]=i;var s={};n.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var c,u,d=r[this.toHex()];if(d)return d;if(o?.closest){var f=this.toRgb(),p=1/0,y="black";if(!s.length)for(var b in t)s[b]=new n(t[b]).toRgb();for(var _ in t){var w=(c=f,u=s[_],Math.pow(c.r-u.r,2)+Math.pow(c.g-u.g,2)+Math.pow(c.b-u.b,2));w<p&&(p=w,y=_)}return y}},e.string.push([function(o){var c=o.toLowerCase(),u=c==="transparent"?"#0000":t[c];return u?new n(u).toRgb():null},"name"])}QZ([JZ]);const Ic=class Ah{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Ah)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,t){const r=typeof e;if(r!==typeof t)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((s,o)=>s===t[o]);if(e!==null&&t!==null){const s=Object.keys(e),o=Object.keys(t);return s.length!==o.length?!1:s.every(c=>e[c]===t[c])}return e===t}toRgba(){const[e,t,r,i]=this._components;return{r:e,g:t,b:r,a:i}}toRgb(){const[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){const[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){const[t,r,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(t*255),e[1]=Math.round(r*255),e[2]=Math.round(i*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[t,r,i,s]=this._components;return e[0]=t,e[1]=r,e[2]=i,e[3]=s,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[t,r,i]=this._components;return e[0]=t,e[1]=r,e[2]=i,e}toNumber(){return this._int}toBgrNumber(){const[e,t,r]=this.toUint8RgbArray();return(r<<16)+(t<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,r,i,s]=Ah._temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=r,this._components[2]*=i,this._components[3]*=s,this._refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return t&&(r=r*e+.5|0,i=i*e+.5|0,s=s*e+.5|0),(e*255<<24)+(r<<16)+(i<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let t,r,i,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;t=(o>>16&255)/255,r=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,r,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,r,i,s=255]=e,t/=255,r/=255,i/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const c=Ah.HEX_PATTERN.exec(e);c&&(e=`#${c[2]}`)}const o=is(e);o.isValid()&&({r:t,g:r,b:i,a:s}=o.rgba,t/=255,r/=255,i/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=r,this._components[2]=i,this._components[3]=s,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,t,r]=this._components;this._int=(e*255<<16)+(t*255<<8)+(r*255|0)}_clamp(e,t=0,r=1){return typeof e=="number"?Math.min(Math.max(e,t),r):(e.forEach((i,s)=>{e[s]=Math.min(Math.max(i,t),r)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof Ah||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Ic.shared=new Ic;Ic._temp=new Ic;Ic.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let An=Ic;const eX={cullArea:null,cullable:!1,cullableChildren:!0};let Gb=0;const qT=500;function ct(...n){Gb!==qT&&(Gb++,Gb===qT?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...n))}const Oc={_registeredResources:new Set,register(n){this._registeredResources.add(n)},unregister(n){this._registeredResources.delete(n)},release(){this._registeredResources.forEach(n=>n.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(n){return this._registeredResources.has(n)},reset(){this._registeredResources.clear()}};class tX{constructor(e,t){this._pool=[],this._count=0,this._index=0,this._classType=e,t&&this.prepopulate(t)}prepopulate(e){for(let t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let t;return this._index>0?t=this._pool[--this._index]:(t=new this._classType,this._count++),t.init?.(e),t}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let e=0;e<this._index;e++)this._pool[e].destroy();this._pool.length=0,this._count=0,this._index=0}}class nX{constructor(){this._poolsByClass=new Map}prepopulate(e,t){this.getPool(e).prepopulate(t)}get(e,t){return this.getPool(e).get(t)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new tX(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(t=>{const r=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[r]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}clear(){this._poolsByClass.forEach(e=>e.clear()),this._poolsByClass.clear()}}const Ar=new nX;Oc.register(Ar);const rX={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(n){typeof n=="boolean"&&n===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(n===!0?{}:n))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(n){it("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(n)}};function iX(n,e,t){const r=n.length;let i;if(e>=r||t===0)return;t=e+t>r?r-e:t;const s=r-t;for(i=e;i<s;++i)n[i]=n[i+t];n.length=s}const sX={allowChildren:!0,removeChildren(n=0,e){const t=e??this.children.length,r=t-n,i=[];if(r>0&&r<=t){for(let o=t-1;o>=n;o--){const c=this.children[o];c&&(i.push(c),c.parent=null)}iX(this.children,n,t);const s=this.renderGroup||this.parentRenderGroup;s&&s.removeChildren(i);for(let o=0;o<i.length;++o){const c=i[o];c.parentRenderLayer?.detach(c),this.emit("childRemoved",c,this,o),i[o].emit("removed",this)}return i.length>0&&this._didViewChangeTick++,i}else if(r===0&&this.children.length===0)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(n){const e=this.getChildAt(n);return this.removeChild(e)},getChildAt(n){if(n<0||n>=this.children.length)throw new Error(`getChildAt: Index (${n}) does not exist.`);return this.children[n]},setChildIndex(n,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(n),this.addChildAt(n,e)},getChildIndex(n){const e=this.children.indexOf(n);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(n,e){this.allowChildren||it(Yt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:t}=this;if(e<0||e>t.length)throw new Error(`${n}addChildAt: The index ${e} supplied is out of bounds ${t.length}`);if(n.parent){const i=n.parent.children.indexOf(n);if(n.parent===this&&i===e)return n;i!==-1&&n.parent.children.splice(i,1)}e===t.length?t.push(n):t.splice(e,0,n),n.parent=this,n.didChange=!0,n._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(n),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",n,this,e),n.emit("added",this),n},swapChildren(n,e){if(n===e)return;const t=this.getChildIndex(n),r=this.getChildIndex(e);this.children[t]=e,this.children[r]=n;const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...n){return n.length===1?this.reparentChildAt(n[0],this.children.length):(n.forEach(e=>this.reparentChildAt(e,this.children.length)),n[0])},reparentChildAt(n,e){if(n.parent===this)return this.setChildIndex(n,e),n;const t=n.worldTransform.clone();n.removeFromParent(),this.addChildAt(n,e);const r=this.worldTransform.clone();return r.invert(),t.prepend(r),n.setFromMatrix(t),n},replaceChild(n,e){n.updateLocalTransform(),this.addChildAt(e,this.getChildIndex(n)),e.setFromMatrix(n.localTransform),e.updateLocalTransform(),this.removeChild(n)}},aX={collectRenderables(n,e,t){this.parentRenderLayer&&this.parentRenderLayer!==t||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(n,e,t):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,n):this.collectRenderablesWithEffects(n,e,t))},collectRenderablesSimple(n,e,t){const r=this.children,i=r.length;for(let s=0;s<i;s++)r[s].collectRenderables(n,e,t)},collectRenderablesWithEffects(n,e,t){const{renderPipes:r}=e;for(let i=0;i<this.effects.length;i++){const s=this.effects[i];r[s.pipe].push(s,this,n)}this.collectRenderablesSimple(n,e,t);for(let i=this.effects.length-1;i>=0;i--){const s=this.effects[i];r[s.pipe].pop(s,this,n)}}};class Up{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class oX{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let t=0;t<this._tests.length;t++){const r=this._tests[t];if(r.test(e))return Ar.get(r.maskClass,e)}return e}returnMaskEffect(e){Ar.return(e)}}const P1=new oX;Pn.handleByList(me.MaskEffect,P1._effectClasses);const lX={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0)},addEffect(n){this.effects.indexOf(n)===-1&&(this.effects.push(n),this.effects.sort((t,r)=>t.priority-r.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(n){const e=this.effects.indexOf(n);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(n){const e=this._maskEffect;e?.mask!==n&&(e&&(this.removeEffect(e),P1.returnMaskEffect(e),this._maskEffect=null),n!=null&&(this._maskEffect=P1.getMaskEffect(n),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(n){this._maskOptions={...this._maskOptions,...n},n.mask&&(this.mask=n.mask),this._markStructureAsChanged()},set filters(n){!Array.isArray(n)&&n&&(n=[n]);const e=this._filterEffect||(this._filterEffect=new Up);n=n;const t=n?.length>0,r=e.filters?.length>0,i=t!==r;n=Array.isArray(n)?n.slice(0):n,e.filters=Object.freeze(n),i&&(t?this.addEffect(e):(this.removeEffect(e),e.filters=n??null))},get filters(){return this._filterEffect?.filters},set filterArea(n){this._filterEffect||(this._filterEffect=new Up),this._filterEffect.filterArea=n},get filterArea(){return this._filterEffect?.filterArea}},cX={label:null,get name(){return it(Yt,"Container.name property has been removed, use Container.label instead"),this.label},set name(n){it(Yt,"Container.name property has been removed, use Container.label instead"),this.label=n},getChildByName(n,e=!1){return this.getChildByLabel(n,e)},getChildByLabel(n,e=!1){const t=this.children;for(let r=0;r<t.length;r++){const i=t[r];if(i.label===n||n instanceof RegExp&&n.test(i.label))return i}if(e)for(let r=0;r<t.length;r++){const s=t[r].getChildByLabel(n,!0);if(s)return s}return null},getChildrenByLabel(n,e=!1,t=[]){const r=this.children;for(let i=0;i<r.length;i++){const s=r[i];(s.label===n||n instanceof RegExp&&n.test(s.label))&&t.push(s)}if(e)for(let i=0;i<r.length;i++)r[i].getChildrenByLabel(n,!0,t);return t}},Ir=Ar.getPool(We),Ws=Ar.getPool(qr),uX=new We,hX={getFastGlobalBounds(n,e){e||(e=new qr),e.clear(),this._getGlobalBoundsRecursive(!!n,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const t=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(t.worldTransform),e},_getGlobalBoundsRecursive(n,e,t){let r=e;if(n&&this.parentRenderLayer&&this.parentRenderLayer!==t||this.localDisplayStatus!==7||!this.measurable)return;const i=!!this.effects.length;if((this.renderGroup||i)&&(r=Ws.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;r.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const s=this.children;for(let o=0;o<s.length;o++)s[o]._getGlobalBoundsRecursive(n,r,t)}if(i){let s=!1;const o=this.renderGroup||this.parentRenderGroup;for(let c=0;c<this.effects.length;c++)this.effects[c].addBounds&&(s||(s=!0,r.applyMatrix(o.worldTransform)),this.effects[c].addBounds(r,!0));s&&r.applyMatrix(o.worldTransform.copyTo(uX).invert()),e.addBounds(r),Ws.return(r)}else this.renderGroup&&(e.addBounds(r,this.relativeGroupTransform),Ws.return(r))}};function hv(n,e,t){t.clear();let r,i;return n.parent?e?r=n.parent.worldTransform:(i=Ir.get().identity(),r=dv(n,i)):r=We.IDENTITY,SI(n,t,r,e),i&&Ir.return(i),t.isValid||t.set(0,0,0,0),t}function SI(n,e,t,r){if(!n.visible||!n.measurable)return;let i;r?i=n.worldTransform:(n.updateLocalTransform(),i=Ir.get(),i.appendFrom(n.localTransform,t));const s=e,o=!!n.effects.length;if(o&&(e=Ws.get().clear()),n.boundsArea)e.addRect(n.boundsArea,i);else{const c=n.bounds;c&&!c.isEmpty()&&(e.matrix=i,e.addBounds(c));for(let u=0;u<n.children.length;u++)SI(n.children[u],e,i,r)}if(o){for(let c=0;c<n.effects.length;c++)n.effects[c].addBounds?.(e);s.addBounds(e,We.IDENTITY),Ws.return(e)}r||Ir.return(i)}function dv(n,e){const t=n.parent;return t&&(dv(t,e),t.updateLocalTransform(),e.append(t.localTransform)),e}function AI(n,e){if(n===16777215||!e)return e;if(e===16777215||!n)return n;const t=n>>16&255,r=n>>8&255,i=n&255,s=e>>16&255,o=e>>8&255,c=e&255,u=t*s/255|0,d=r*o/255|0,f=i*c/255|0;return(u<<16)+(d<<8)+f}const ZT=16777215;function Fp(n,e){return n===ZT?e:e===ZT?n:AI(n,e)}function fp(n){return((n&255)<<16)+(n&65280)+(n>>16&255)}const dX={getGlobalAlpha(n){if(n)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,t=this.parent;for(;t;)e*=t.alpha,t=t.parent;return e},getGlobalTransform(n=new We,e){if(e)return n.copyFrom(this.worldTransform);this.updateLocalTransform();const t=dv(this,Ir.get().identity());return n.appendFrom(this.localTransform,t),Ir.return(t),n},getGlobalTint(n){if(n)return this.renderGroup?fp(this.renderGroup.worldColor):this.parentRenderGroup?fp(Fp(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,t=this.parent;for(;t;)e=Fp(e,t.localColor),t=t.parent;return fp(e)}};function fv(n,e,t){return e.clear(),t||(t=We.IDENTITY),CI(n,e,t,n,!0),e.isValid||e.set(0,0,0,0),e}function CI(n,e,t,r,i){let s;if(i)s=Ir.get(),s=t.copyTo(s);else{if(!n.visible||!n.measurable)return;n.updateLocalTransform();const u=n.localTransform;s=Ir.get(),s.appendFrom(u,t)}const o=e,c=!!n.effects.length;if(c&&(e=Ws.get().clear()),n.boundsArea)e.addRect(n.boundsArea,s);else{n.renderPipeId&&(e.matrix=s,e.addBounds(n.bounds));const u=n.children;for(let d=0;d<u.length;d++)CI(u[d],e,s,r,!1)}if(c){for(let u=0;u<n.effects.length;u++)n.effects[u].addLocalBounds?.(e,r);o.addBounds(e,We.IDENTITY),Ws.return(e)}Ir.return(s)}function kI(n,e){const t=n.children;for(let r=0;r<t.length;r++){const i=t[r],s=i.uid,o=(i._didViewChangeTick&65535)<<16|i._didContainerChangeTick&65535,c=e.index;(e.data[c]!==s||e.data[c+1]!==o)&&(e.data[e.index]=s,e.data[e.index+1]=o,e.didChange=!0),e.index=c+2,i.children.length&&kI(i,e)}return e.didChange}const fX=new We,mX={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(n,e){const t=Math.sign(this.scale.x)||1;e!==0?this.scale.x=n/e*t:this.scale.x=t},_setHeight(n,e){const t=Math.sign(this.scale.y)||1;e!==0?this.scale.y=n/e*t:this.scale.y=t},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new qr});const n=this._localBoundsCacheData;return n.index=1,n.didChange=!1,n.data[0]!==this._didViewChangeTick&&(n.didChange=!0,n.data[0]=this._didViewChangeTick),kI(this,n),n.didChange&&fv(this,n.localBounds,fX),n.localBounds},getBounds(n,e){return hv(this,n,e||new qr)}},pX={_onRender:null,set onRender(n){const e=this.renderGroup||this.parentRenderGroup;if(!n){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=n},get onRender(){return this._onRender}},gX={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(n){this._zIndex!==n&&(this._zIndex=n,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(yX))}};function yX(n,e){return n._zIndex-e._zIndex}const bX={getGlobalPosition(n=new br,e=!1){return this.parent?this.parent.toGlobal(this._position,n,e):(n.x=this._position.x,n.y=this._position.y),n},toGlobal(n,e,t=!1){const r=this.getGlobalTransform(Ir.get(),t);return e=r.apply(n,e),Ir.return(r),e},toLocal(n,e,t,r){e&&(n=e.toGlobal(n,t,r));const i=this.getGlobalTransform(Ir.get(),r);return t=i.applyInverse(n,t),Ir.return(i),t}};class TI{constructor(){this.uid=an("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let xX=0;class vX{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this.textureStyle=new md(this.textureOptions)}createTexture(e,t,r){const i=new ur({...this.textureOptions,width:e,height:t,resolution:1,antialias:r,autoGarbageCollect:!1});return new Ue({source:i,label:`texturePool_${xX++}`})}getOptimalTexture(e,t,r=1,i){let s=Math.ceil(e*r-1e-6),o=Math.ceil(t*r-1e-6);s=zp(s),o=zp(o);const c=(s<<17)+(o<<1)+(i?1:0);this._texturePool[c]||(this._texturePool[c]=[]);let u=this._texturePool[c].pop();return u||(u=this.createTexture(s,o,i)),u.source._resolution=r,u.source.width=s/r,u.source.height=o/r,u.source.pixelWidth=s,u.source.pixelHeight=o,u.frame.x=0,u.frame.y=0,u.frame.width=e,u.frame.height=t,u.updateUvs(),this._poolKeyHash[u.uid]=c,u}getSameSizeTexture(e,t=!1){const r=e.source;return this.getOptimalTexture(e.width,e.height,r._resolution,t)}returnTexture(e,t=!1){const r=this._poolKeyHash[e.uid];t&&(e.source.style=this.textureStyle),this._texturePool[r].push(e)}clear(e){if(e=e!==!1,e)for(const t in this._texturePool){const r=this._texturePool[t];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0)}this._texturePool={}}}const zo=new vX;Oc.register(zo);class D1{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new We,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new TI,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const t=e.children;for(let r=0;r<t.length;r++){const i=t[r];i._updateFlags=15,this.addChild(i)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(zo.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const e=this._parentCacheAsTextureRenderGroup;e&&!e.textureNeedsUpdate&&e.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const t=e.children;for(let r=0;r<t.length;r++)this.addChild(t[r])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const t=e.children;for(let r=0;r<t.length;r++)this.removeChild(t[r])}removeChildren(e){for(let t=0;t<e.length;t++)this.removeChild(e[t])}onChildUpdate(e){let t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const t=this.root.children;for(let r=0;r<t.length;r++)this._getChildren(t[r],e);return e}_getChildren(e,t=[]){if(t.push(e),e.renderGroup)return t;const r=e.children;for(let i=0;i<r.length;i++)this._getChildren(r[i],t);return t}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new We),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new We),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new We),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function _X(n,e,t={}){for(const r in e)!t[r]&&e[r]!==void 0&&(n[r]=e[r])}const Hb=new gr(null),Bm=new gr(null),Vb=new gr(null,1,1),Om=new gr(null),Gp=1,mv=2,Vh=4;class cr extends zi{constructor(e={}){super(),this.uid=an("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new We,this.relativeGroupTransform=new We,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new gr(this,0,0),this._scale=Vb,this._pivot=Bm,this._origin=Om,this._skew=Hb,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],_X(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(t=>this.addChild(t)),e.parent?.addChild(this)}static mixin(e){it("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Pn.mixin(cr,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||it(Yt,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let i=0;i<e.length;i++)this.addChild(e[i]);return e[0]}const t=e[0],r=this.renderGroup||this.parentRenderGroup;return t.parent===this?(this.children.splice(this.children.indexOf(t),1),this.children.push(t),r&&(r.structureDidChange=!0),t):(t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t._updateFlags=15,r&&r.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,t._zIndex!==0&&t.depthOfChildModified(),t)}removeChild(...e){if(e.length>1){for(let i=0;i<e.length;i++)this.removeChild(e[i]);return e[0]}const t=e[0],r=this.children.indexOf(t);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parentRenderLayer&&t.parentRenderLayer.detach(t),t.parent=null,this.emit("childRemoved",t,this,r),t.emit("removed",this)),t}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=Ar.get(D1,this),this.groupTransform=We.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),Ar.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new We),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*OZ}set angle(e){this.rotation=e*LZ}get pivot(){return this._pivot===Bm&&(this._pivot=new gr(this,0,0)),this._pivot}set pivot(e){this._pivot===Bm&&(this._pivot=new gr(this,0,0),this._origin!==Om&&ct("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===Hb&&(this._skew=new gr(this,0,0)),this._skew}set skew(e){this._skew===Hb&&(this._skew=new gr(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===Vb&&(this._scale=new gr(this,1,1)),this._scale}set scale(e){this._scale===Vb&&(this._scale=new gr(this,0,0)),typeof e=="string"&&(e=parseFloat(e)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get origin(){return this._origin===Om&&(this._origin=new gr(this,0,0)),this._origin}set origin(e){this._origin===Om&&(this._origin=new gr(this,0,0),this._pivot!==Bm&&ct("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._origin.set(e):this._origin.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const r=this.getLocalBounds();typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,r.width),t!==void 0&&this._setHeight(t,r.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this.origin.set(typeof e.originX=="number"?e.originX:this.origin.x,typeof e.originY=="number"?e.originY:this.origin.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const t=this.localTransform,r=this._scale,i=this._pivot,s=this._origin,o=this._position,c=r._x,u=r._y,d=i._x,f=i._y,p=-s._x,y=-s._y;t.a=this._cx*c,t.b=this._sx*c,t.c=this._cy*u,t.d=this._sy*u,t.tx=o._x-(d*t.a+f*t.c)+(p*t.a+y*t.c)-p,t.ty=o._y-(d*t.b+f*t.d)+(p*t.b+y*t.d)-y}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Gp,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const r=An.shared.setValue(e??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=Gp,this._onUpdate())}get tint(){return fp(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=mv,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const t=e?2:0;(this.localDisplayStatus&2)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Vh,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const t=e?0:4;(this.localDisplayStatus&4)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Vh,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const t=e?1:0;(this.localDisplayStatus&1)!==t&&(this._updateFlags|=Vh,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let t;if(this.children.length&&(t=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&t)for(let i=0;i<t.length;++i)t[i].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}Pn.mixin(cr,sX,hX,bX,pX,mX,lX,cX,gX,eX,rX,dX,aX);class pv extends cr{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new qr(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const t=this.bounds,{x:r,y:i}=e;return r>=t.minX&&r<=t.maxX&&i>=t.minY&&i<=t.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null;for(const t in this._gpuData)this._gpuData[t].destroy?.();this._gpuData=null}collectRenderablesSimple(e,t,r){const{renderPipes:i}=t;i.blendMode.pushBlendMode(this,this.groupBlendMode,e),i[this.renderPipeId].addRenderable(this,e),this.didViewUpdate=!1;const o=this.children,c=o.length;for(let u=0;u<c;u++)o[u].collectRenderables(e,t,r);i.blendMode.popBlendMode(e)}}class Ya extends pv{constructor(e=Ue.EMPTY){e instanceof Ue&&(e={texture:e});const{texture:t=Ue.EMPTY,anchor:r,roundPixels:i,width:s,height:o,...c}=e;super({label:"Sprite",...c}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new gr({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=i??!1,s!==void 0&&(this.width=s),o!==void 0&&(this.height=o)}static from(e,t=!1){return e instanceof Ue?new Ya(e):new Ya(Ue.from(e,t))}set texture(e){e||(e=Ue.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return VZ(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return it("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,t=this._texture,r=this._bounds,{width:i,height:s}=t.orig;r.minX=-e._x*i,r.maxX=r.minX+i,r.minY=-e._y*s,r.maxY=r.minY+s}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(r)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),t!==void 0&&this._setHeight(t,this._texture.orig.height)}}const wX=new qr;function EI(n,e,t){const r=wX;n.measurable=!0,hv(n,t,r),e.addBoundsMask(r),n.measurable=!1}function MI(n,e,t){const r=Ws.get();n.measurable=!0;const i=Ir.get().identity(),s=NI(n,t,i);fv(n,r,s),n.measurable=!1,e.addBoundsMask(r),Ir.return(i),Ws.return(r)}function NI(n,e,t){return n?(n!==e&&(NI(n.parent,e,t),n.updateLocalTransform(),t.append(n.localTransform)),t):(ct("Mask bounds, renderable is not inside the root container"),t)}class II{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Ya),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(e,t){this.inverse||EI(this.mask,e,t)}addLocalBounds(e,t){MI(this.mask,e,t)}containsPoint(e,t){const r=this.mask;return t(r,e)}destroy(){this.reset()}static test(e){return e instanceof Ya}}II.extension=me.MaskEffect;class RI{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}RI.extension=me.MaskEffect;class PI{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(e,t){EI(this.mask,e,t)}addLocalBounds(e,t){MI(this.mask,e,t)}containsPoint(e,t){const r=this.mask;return t(r,e)}destroy(){this.reset()}static test(e){return e instanceof cr}}PI.extension=me.MaskEffect;const SX={createCanvas:(n,e)=>{const t=document.createElement("canvas");return t.width=n,t.height=e,t},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,e)=>fetch(n,e),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")};let XT=SX;const Dt={get(){return XT},set(n){XT=n}};class ja extends ur{constructor(e){e.resource||(e.resource=Dt.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,r=this._resolution){const i=super.resize(e,t,r);return i&&this.resizeCanvas(),i}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}ja.extension=me.TextureSource;class Wo extends ur{constructor(e){super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Wo.extension=me.TextureSource;var j1=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(j1||{});class Wb{constructor(e,t=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=t,this.priority=r,this._once=i}match(e,t=null){return this._fn===e&&this._context===t}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const DI=class ci{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Wb(null,null,1/0),this.deltaMS=1/ci.targetFPMS,this.elapsedMS=1/ci.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=j1.NORMAL){return this._addListener(new Wb(e,t,r))}addOnce(e,t,r=j1.NORMAL){return this._addListener(new Wb(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*ci.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,ci.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!ci._shared){const e=ci._shared=new ci;e.autoStart=!0,e._protected=!0}return ci._shared}static get system(){if(!ci._system){const e=ci._system=new ci;e.autoStart=!0,e._protected=!0}return ci._system}};DI.targetFPMS=.06;let uc=DI,Yb;async function jI(){return Yb??(Yb=(async()=>{const e=Dt.get().createCanvas(1,1).getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(o=>{const c=document.createElement("video");c.onloadeddata=()=>o(c),c.onerror=()=>o(null),c.autoplay=!1,c.crossOrigin="anonymous",c.preload="auto",c.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",c.load()});if(!t)return"premultiply-alpha-on-upload";const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const s=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,s),e.deleteFramebuffer(i),e.deleteTexture(r),e.getExtension("WEBGL_lose_context")?.loseContext(),s[0]<=s[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Yb}const pg=class BI extends ur{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...BI.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=uc.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,t=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(t.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await jI(),this._load=new Promise((r,i)=>{this.isValid?r(this):(this._resolve=r,this._reject=i,t.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${t.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(uc.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(uc.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(uc.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};pg.extension=me.TextureSource;pg.defaultOptions={...ur.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};pg.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Wh=pg;const Yi=(n,e,t=!1)=>(Array.isArray(n)||(n=[n]),e?n.map(r=>typeof r=="string"||t?e(r):r):n);class AX{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||ct(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const r=Yi(e);let i;for(let u=0;u<this.parsers.length;u++){const d=this.parsers[u];if(d.test(t)){i=d.getCacheableAssets(r,t);break}}const s=new Map(Object.entries(i||{}));i||r.forEach(u=>{s.set(u,t)});const o=[...s.keys()],c={cacheKeys:o,keys:r};r.forEach(u=>{this._cacheMap.set(u,c)}),o.forEach(u=>{const d=i?i[u]:t;this._cache.has(u)&&this._cache.get(u)!==d&&ct("[Cache] already has key:",u),this._cache.set(u,s.get(u))})}remove(e){if(!this._cacheMap.has(e)){ct(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(i=>{this._cache.delete(i)}),t.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const un=new AX,B1=[];Pn.handleByList(me.TextureSource,B1);function OI(n={}){const e=n&&n.resource,t=e?n.resource:n,r=e?n:{resource:n};for(let i=0;i<B1.length;i++){const s=B1[i];if(s.test(t))return new s(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function CX(n={},e=!1){const t=n&&n.resource,r=t?n.resource:n,i=t?n:{resource:n};if(!e&&un.has(r))return un.get(r);const s=new Ue({source:OI(i)});return s.on("destroy",()=>{un.has(r)&&un.remove(r)}),e||un.set(r,s),s}function kX(n,e=!1){return typeof n=="string"?un.get(n):n instanceof ur?new Ue({source:n}):CX(n,e)}Ue.from=kX;ur.from=OI;Pn.add(II,RI,PI,Wh,Wo,ja,uv);var Za=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(Za||{});function Vi(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function hh(n){return n.split("?")[0].split("#")[0]}function TX(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function EX(n,e,t){return n.replace(new RegExp(TX(e),"g"),t)}function MX(n,e){let t="",r=0,i=-1,s=0,o=-1;for(let c=0;c<=n.length;++c){if(c<n.length)o=n.charCodeAt(c);else{if(o===47)break;o=47}if(o===47){if(!(i===c-1||s===1))if(i!==c-1&&s===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const u=t.lastIndexOf("/");if(u!==t.length-1){u===-1?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),i=c,s=0;continue}}else if(t.length===2||t.length===1){t="",r=0,i=c,s=0;continue}}}else t.length>0?t+=`/${n.slice(i+1,c)}`:t=n.slice(i+1,c),r=c-i-1;i=c,s=0}else o===46&&s!==-1?++s:s=-1}return t}const mi={toPosix(n){return EX(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},isBlobUrl(n){return n.startsWith("blob:")},hasProtocol(n){return/^[^/:]+:/.test(this.toPosix(n))},getProtocol(n){Vi(n),n=this.toPosix(n);const e=/^file:\/\/\//.exec(n);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(n);return t?t[0]:""},toAbsolute(n,e,t){if(Vi(n),this.isDataUrl(n)||this.isBlobUrl(n))return n;const r=hh(this.toPosix(e??Dt.get().getBaseUrl())),i=hh(this.toPosix(t??this.rootname(r)));return n=this.toPosix(n),n.startsWith("/")?mi.join(i,n.slice(1)):this.isAbsolute(n)?n:this.join(r,n)},normalize(n){if(Vi(n),n.length===0)return".";if(this.isDataUrl(n)||this.isBlobUrl(n))return n;n=this.toPosix(n);let e="";const t=n.startsWith("/");this.hasProtocol(n)&&(e=this.rootname(n),n=n.slice(e.length));const r=n.endsWith("/");return n=MX(n),n.length>0&&r&&(n+="/"),t?`/${n}`:e+n},isAbsolute(n){return Vi(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const r=n[t];if(Vi(r),r.length>0)if(e===void 0)e=r;else{const i=n[t-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${r}`:e+=`/${r}`}}return e===void 0?".":this.normalize(e)},dirname(n){if(Vi(n),n.length===0)return".";n=this.toPosix(n);let e=n.charCodeAt(0);const t=e===47;let r=-1,i=!0;const s=this.getProtocol(n),o=n;n=n.slice(s.length);for(let c=n.length-1;c>=1;--c)if(e=n.charCodeAt(c),e===47){if(!i){r=c;break}}else i=!1;return r===-1?t?"/":this.isUrl(o)?s+n:s:t&&r===1?"//":s+n.slice(0,r)},rootname(n){Vi(n),n=this.toPosix(n);let e="";if(n.startsWith("/")?e="/":e=this.getProtocol(n),this.isUrl(n)){const t=n.indexOf("/",e.length);t!==-1?e=n.slice(0,t):e=n,e.endsWith("/")||(e+="/")}return e},basename(n,e){Vi(n),e&&Vi(e),n=hh(this.toPosix(n));let t=0,r=-1,i=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e.length===n.length&&e===n)return"";let o=e.length-1,c=-1;for(s=n.length-1;s>=0;--s){const u=n.charCodeAt(s);if(u===47){if(!i){t=s+1;break}}else c===-1&&(i=!1,c=s+1),o>=0&&(u===e.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=c))}return t===r?r=c:r===-1&&(r=n.length),n.slice(t,r)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===47){if(!i){t=s+1;break}}else r===-1&&(i=!1,r=s+1);return r===-1?"":n.slice(t,r)},extname(n){Vi(n),n=hh(this.toPosix(n));let e=-1,t=0,r=-1,i=!0,s=0;for(let o=n.length-1;o>=0;--o){const c=n.charCodeAt(o);if(c===47){if(!i){t=o+1;break}continue}r===-1&&(i=!1,r=o+1),c===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||r===-1||s===0||s===1&&e===r-1&&e===t+1?"":n.slice(e,r)},parse(n){Vi(n);const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;n=hh(this.toPosix(n));let t=n.charCodeAt(0);const r=this.isAbsolute(n);let i;e.root=this.rootname(n),r||this.hasProtocol(n)?i=1:i=0;let s=-1,o=0,c=-1,u=!0,d=n.length-1,f=0;for(;d>=i;--d){if(t=n.charCodeAt(d),t===47){if(!u){o=d+1;break}continue}c===-1&&(u=!1,c=d+1),t===46?s===-1?s=d:f!==1&&(f=1):s!==-1&&(f=-1)}return s===-1||c===-1||f===0||f===1&&s===c-1&&s===o+1?c!==-1&&(o===0&&r?e.base=e.name=n.slice(1,c):e.base=e.name=n.slice(o,c)):(o===0&&r?(e.name=n.slice(1,s),e.base=n.slice(1,c)):(e.name=n.slice(o,s),e.base=n.slice(o,c)),e.ext=n.slice(s,c)),e.dir=this.dirname(n),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function LI(n,e,t,r,i){const s=e[t];for(let o=0;o<s.length;o++){const c=s[o];t<e.length-1?LI(n.replace(r[t],c),e,t+1,r,i):i.push(n.replace(r[t],c))}}function NX(n){const e=/\{(.*?)\}/g,t=n.match(e),r=[];if(t){const i=[];t.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),LI(n,i,0,t,r)}else r.push(n);return r}const Hp=n=>!Array.isArray(n);class Lc{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(t[r])}`).join("&")}}getAlias(e){const{alias:t,src:r}=e;return Yi(t||r,s=>typeof s=="string"?s:Array.isArray(s)?s.map(o=>o?.src??o):s?.src?s.src:s,!0)}addManifest(e){this._manifest&&ct("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const r=[];let i=t;Array.isArray(t)||(i=Object.entries(t).map(([s,o])=>typeof o=="string"||Array.isArray(o)?{alias:s,src:o}:{alias:s,...o})),i.forEach(s=>{const o=s.src,c=s.alias;let u;if(typeof c=="string"){const d=this._createBundleAssetId(e,c);r.push(d),u=[c,d]}else{const d=c.map(f=>this._createBundleAssetId(e,f));r.push(...d),u=[...c,...d]}this.add({...s,alias:u,src:o})}),this._bundles[e]=r}add(e){const t=[];Array.isArray(e)?t.push(...e):t.push(e);let r;r=s=>{this.hasKey(s)&&ct(`[Resolver] already has key: ${s} overwriting`)},Yi(t).forEach(s=>{const{src:o}=s;let{data:c,format:u,loadParser:d,parser:f}=s;const p=Yi(o).map(w=>typeof w=="string"?NX(w):Array.isArray(w)?w:[w]),y=this.getAlias(s);Array.isArray(y)?y.forEach(r):r(y);const b=[],_=w=>({...this._parsers.find(A=>A.test(w))?.parse(w),src:w});p.forEach(w=>{w.forEach(S=>{let A={};if(typeof S!="object"?A=_(S):(c=S.data??c,u=S.format??u,(S.loadParser||S.parser)&&(d=S.loadParser??d,f=S.parser??f),A={..._(S.src),...S}),!y)throw new Error(`[Resolver] alias is undefined for this asset: ${A.src}`);A=this._buildResolvedAsset(A,{aliases:y,data:c,format:u,loadParser:d,parser:f,progressSize:s.progressSize}),b.push(A)})}),y.forEach(w=>{this._assetMap[w]=b})})}resolveBundle(e){const t=Hp(e);e=Yi(e);const r={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),c={};for(const u in o){const d=o[u];c[this._extractAssetIdFromBundle(i,u)]=d}r[i]=c}}),t?r[e[0]]:r}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const r={};for(const i in t)r[i]=t[i].src;return r}return t.src}resolve(e){const t=Hp(e);e=Yi(e);const r={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=this._getPreferredOrder(s);o?.priority.forEach(c=>{o.params[c].forEach(u=>{const d=s.filter(f=>f[c]?f[c]===u:!1);d.length&&(s=d)})}),this._resolverHash[i]=s[0]}else this._resolverHash[i]=this._buildResolvedAsset({alias:[i],src:i},{});r[i]=this._resolverHash[i]}),t?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const r=e[t],i=this._preferredOrder.find(s=>s.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}_buildResolvedAsset(e,t){const{aliases:r,data:i,loadParser:s,parser:o,format:c,progressSize:u}=t;return(this._basePath||this._rootPath)&&(e.src=mi.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=s??e.loadParser,e.parser=o??e.parser,e.format=c??e.format??IX(e.src),u!==void 0&&(e.progressSize=u),e}}Lc.RETINA_PREFIX=/@([0-9\.]+)x/;function IX(n){return n.split(".").pop().split("?").shift().split("#").shift()}const O1=(n,e)=>{const t=e.split("?")[1];return t&&(n+=`?${t}`),n},zI=class Ch{constructor(e,t){this.linkedSheets=[];let r=e;e?.source instanceof ur&&(r={texture:e,data:t});const{texture:i,data:s,cachePrefix:o=""}=r;this.cachePrefix=o,this._texture=i instanceof Ue?i:null,this.textureSource=i.source,this.textures={},this.animations={},this.data=s;const c=parseFloat(s.meta.scale);c?(this.resolution=c,i.source.resolution=this.resolution):this.resolution=i.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Ch.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const r=Ch.BATCH_SIZE;for(;t-e<r&&t<this._frameKeys.length;){const i=this._frameKeys[t],s=this._frames[i],o=s.frame;if(o){let c=null,u=null;const d=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,f=new Qt(0,0,Math.floor(d.w)/this.resolution,Math.floor(d.h)/this.resolution);s.rotated?c=new Qt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):c=new Qt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(u=new Qt(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new Ue({source:this.textureSource,frame:c,orig:f,trim:u,rotate:s.rotated?2:0,defaultAnchor:s.anchor,defaultBorders:s.borders,label:i.toString()})}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){const i=e[t][r];this.animations[t].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Ch.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Ch.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};zI.BATCH_SIZE=1e3;let KT=zI;const RX=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function UI(n,e,t){const r={};if(n.forEach(i=>{r[i]=e}),Object.keys(e.textures).forEach(i=>{r[`${e.cachePrefix}${i}`]=e.textures[i]}),!t){const i=mi.dirname(n[0]);e.linkedSheets.forEach((s,o)=>{const c=UI([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(r,c)})}return r}const PX={extension:me.Asset,cache:{test:n=>n instanceof KT,getCacheableAssets:(n,e)=>UI(n,e,!1)},resolver:{extension:{type:me.ResolveParser,name:"resolveSpritesheet"},test:n=>{const t=n.split("?")[0].split("."),r=t.pop(),i=t.pop();return r==="json"&&RX.includes(i)},parse:n=>{const e=n.split(".");return{resolution:parseFloat(Lc.RETINA_PREFIX.exec(n)?.[1]??"1"),format:e[e.length-2],src:n}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:me.LoadParser,priority:Za.Normal,name:"spritesheetLoader"},async testParse(n,e){return mi.extname(e.src).toLowerCase()===".json"&&!!n.frames},async parse(n,e,t){const{texture:r,imageFilename:i,textureOptions:s,cachePrefix:o}=e?.data??{};let c=mi.dirname(e.src);c&&c.lastIndexOf("/")!==c.length-1&&(c+="/");let u;if(r instanceof Ue)u=r;else{const p=O1(c+(i??n.meta.image),e.src);u=(await t.load([{src:p,data:s}]))[p]}const d=new KT({texture:u.source,data:n,cachePrefix:o});await d.parse();const f=n?.meta?.related_multi_packs;if(Array.isArray(f)){const p=[];for(const b of f){if(typeof b!="string")continue;let _=c+b;e.data?.ignoreMultiPack||(_=O1(_,e.src),p.push(t.load({src:_,data:{textureOptions:s,ignoreMultiPack:!0}})))}const y=await Promise.all(p);d.linkedSheets=y,y.forEach(b=>{b.linkedSheets=[d].concat(d.linkedSheets.filter(_=>_!==b))})}return d},async unload(n,e,t){await t.unload(n.textureSource._sourceOrigin),n.destroy(!1)}}};Pn.add(PX);const $b=Object.create(null),QT=Object.create(null);function gv(n,e){let t=QT[n];return t===void 0&&($b[e]===void 0&&($b[e]=1),QT[n]=t=$b[e]++),t}let Lm;function FI(){return(!Lm||Lm?.isContextLost())&&(Lm=Dt.get().createCanvas().getContext("webgl",{})),Lm}let zm;function DX(){if(!zm){zm="mediump";const n=FI();n&&n.getShaderPrecisionFormat&&(zm=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision?"highp":"mediump")}return zm}function jX(n,e,t){return e?n:t?(n=n.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${n}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${n}
        `}function BX(n,e,t){const r=t?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(n.substring(0,9)!=="precision"){let i=t?e.requestedFragmentPrecision:e.requestedVertexPrecision;return i==="highp"&&r!=="highp"&&(i="mediump"),`precision ${i} float;
${n}`}else if(r!=="highp"&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}function OX(n,e){return e?`#version 300 es
${n}`:n}const LX={},zX={};function UX(n,{name:e="pixi-program"},t=!0){e=e.replace(/\s+/g,"-"),e+=t?"-fragment":"-vertex";const r=t?LX:zX;return r[e]?(r[e]++,e+=`-${r[e]}`):r[e]=1,n.indexOf("#define SHADER_NAME")!==-1?n:`${`#define SHADER_NAME ${e}`}
${n}`}function FX(n,e){return e?n.replace("#version 300 es",""):n}const qb={stripVersion:FX,ensurePrecision:BX,addProgramDefines:jX,setProgramName:UX,insertVersion:OX},dh=Object.create(null),GI=class L1{constructor(e){e={...L1.defaultOptions,...e};const t=e.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:t,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:DX()},setProgramName:{name:e.name},addProgramDefines:t,insertVersion:t};let i=e.fragment,s=e.vertex;Object.keys(qb).forEach(o=>{const c=r[o];i=qb[o](i,c,!0),s=qb[o](s,c,!1)}),this.fragment=i,this.vertex=s,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=gv(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,dh[this._cacheKey]=null}static from(e){const t=`${e.vertex}:${e.fragment}`;return dh[t]||(dh[t]=new L1(e),dh[t]._cacheKey=t),dh[t]}};GI.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let zc=GI;const JT={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function pd(n){return JT[n]??JT.float32}const GX={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function HX({source:n,entryPoint:e}){const t={},r=n.indexOf(`fn ${e}`);if(r!==-1){const i=n.indexOf("->",r);if(i!==-1){const s=n.substring(r,i),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let c;for(;(c=o.exec(s))!==null;){const u=GX[c[3]]??"float32";t[c[2]]={location:parseInt(c[1],10),format:u,stride:pd(u).stride,offset:0,instance:!1,start:0}}}}return t}function Zb(n){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,t=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,s=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,c=/(\w+)\s*:\s*([\w\<\>]+)/g,u=/struct\s+(\w+)/,d=n.match(e)?.map(p=>({group:parseInt(p.match(t)[1],10),binding:parseInt(p.match(r)[1],10),name:p.match(i)[2],isUniform:p.match(i)[1]==="<uniform>",type:p.match(s)[1]}));if(!d)return{groups:[],structs:[]};const f=n.match(o)?.map(p=>{const y=p.match(u)[1],b=p.match(c).reduce((_,w)=>{const[S,A]=w.split(":");return _[S.trim()]=A.trim(),_},{});return b?{name:y,members:b}:null}).filter(({name:p})=>d.some(y=>y.type===p))??[];return{groups:d,structs:f}}var kh=(n=>(n[n.VERTEX=1]="VERTEX",n[n.FRAGMENT=2]="FRAGMENT",n[n.COMPUTE=4]="COMPUTE",n))(kh||{});function VX({groups:n}){const e=[];for(let t=0;t<n.length;t++){const r=n[t];e[r.group]||(e[r.group]=[]),r.isUniform?e[r.group].push({binding:r.binding,visibility:kh.VERTEX|kh.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?e[r.group].push({binding:r.binding,visibility:kh.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"&&e[r.group].push({binding:r.binding,visibility:kh.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function WX({groups:n}){const e=[];for(let t=0;t<n.length;t++){const r=n[t];e[r.group]||(e[r.group]={}),e[r.group][r.name]=r.binding}return e}function YX(n,e){const t=new Set,r=new Set,i=[...n.structs,...e.structs].filter(o=>t.has(o.name)?!1:(t.add(o.name),!0)),s=[...n.groups,...e.groups].filter(o=>{const c=`${o.name}-${o.binding}`;return r.has(c)?!1:(r.add(c),!0)});return{structs:i,groups:s}}const fh=Object.create(null);class el{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:t,vertex:r,layout:i,gpuLayout:s,name:o}=e;if(this.name=o,this.fragment=t,this.vertex=r,t.source===r.source){const c=Zb(t.source);this.structsAndGroups=c}else{const c=Zb(r.source),u=Zb(t.source);this.structsAndGroups=YX(c,u)}this.layout=i??WX(this.structsAndGroups),this.gpuLayout=s??VX(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:t}=this,r=e.source+t.source+e.entryPoint+t.entryPoint;this._layoutKey=gv(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=HX(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,fh[this._cacheKey]=null}static from(e){const t=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return fh[t]||(fh[t]=new el(e),fh[t]._cacheKey=t),fh[t]}}const HI=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],$X=HI.reduce((n,e)=>(n[e]=!0,n),{});function qX(n,e){switch(n){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const VI=class WI{constructor(e,t){this._touched=0,this.uid=an("uniform"),this._resourceType="uniformGroup",this._resourceId=an("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,t={...WI.defaultOptions,...t},this.uniformStructures=e;const r={};for(const i in e){const s=e[i];if(s.name=i,s.size=s.size??1,!$X[s.type]){const o=s.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(o){const[,c,u]=o;throw new Error(`Uniform type ${s.type} is not supported. Use type: '${c}', size: ${u} instead.`)}throw new Error(`Uniform type ${s.type} is not supported. Supported uniform types are: ${HI.join(", ")}`)}s.value??(s.value=qX(s.type,s.size)),r[i]=s.value}this.uniforms=r,this._dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this._signature=gv(Object.keys(r).map(i=>`${i}-${e[i].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};VI.defaultOptions={ubo:!1,isStatic:!1};let tl=VI;class Yh{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const r in e){const i=e[r];this.setResource(i,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const r in this.resources)e[t++]=this.resources[r]._resourceId;this._key=e.join("|")}setResource(e,t){const r=this.resources[t];e!==r&&(r&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const r in t)t[r]._touched=e}destroy(){const e=this.resources;for(const t in e)e[t]?.off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const r in t)t[r]===e&&(t[r]=null)}else this._updateKey()}}var Yo=(n=>(n[n.WEBGL=1]="WEBGL",n[n.WEBGPU=2]="WEBGPU",n[n.BOTH=3]="BOTH",n))(Yo||{});class nl extends zi{constructor(e){super(),this.uid=an("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:t,glProgram:r,groups:i,resources:s,compatibleRenderers:o,groupMap:c}=e;this.gpuProgram=t,this.glProgram=r,o===void 0&&(o=0,t&&(o|=Yo.WEBGPU),r&&(o|=Yo.WEBGL)),this.compatibleRenderers=o;const u={};if(!s&&!i&&(s={}),s&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!t&&i&&!c)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&i&&c)for(const d in c)for(const f in c[d]){const p=c[d][f];u[p]={group:d,binding:f,name:p}}else if(t&&i&&!c){const d=t.structsAndGroups.groups;c={},d.forEach(f=>{c[f.group]=c[f.group]||{},c[f.group][f.binding]=f.name,u[f.name]=f})}else if(s){i={},c={},t&&t.structsAndGroups.groups.forEach(p=>{c[p.group]=c[p.group]||{},c[p.group][p.binding]=p.name,u[p.name]=p});let d=0;for(const f in s)u[f]||(i[99]||(i[99]=new Yh,this._ownedBindGroups.push(i[99])),u[f]={group:99,binding:d,name:f},c[99]=c[99]||{},c[99][d]=f,d++);for(const f in s){const p=f;let y=s[f];!y.source&&!y._resourceType&&(y=new tl(y));const b=u[p];b&&(i[b.group]||(i[b.group]=new Yh,this._ownedBindGroups.push(i[b.group])),i[b.group].setResource(y,b.binding))}}this.groups=i,this._uniformBindMap=c,this.resources=this._buildResourceAccessor(i,u)}addResource(e,t,r){var i,s;(i=this._uniformBindMap)[t]||(i[t]={}),(s=this._uniformBindMap[t])[r]||(s[r]=e),this.groups[t]||(this.groups[t]=new Yh,this._ownedBindGroups.push(this.groups[t]))}_buildResourceAccessor(e,t){const r={};for(const i in t){const s=t[i];Object.defineProperty(r,s.name,{get(){return e[s.group].getResource(s.binding)},set(o){e[s.group].setResource(o,s.binding)}})}return r}destroy(e=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(t=>{t.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(e){const{gpu:t,gl:r,...i}=e;let s,o;return t&&(s=el.from(t)),r&&(o=zc.from(r)),new nl({gpuProgram:s,glProgram:o,...i})}}const ZX={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},Xb=0,Kb=1,Qb=2,Jb=3,ex=4,tx=5,z1=class YI{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Xb)}set blend(e){!!(this.data&1<<Xb)!==e&&(this.data^=1<<Xb)}get offsets(){return!!(this.data&1<<Kb)}set offsets(e){!!(this.data&1<<Kb)!==e&&(this.data^=1<<Kb)}set cullMode(e){if(e==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=e==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Qb)}set culling(e){!!(this.data&1<<Qb)!==e&&(this.data^=1<<Qb)}get depthTest(){return!!(this.data&1<<Jb)}set depthTest(e){!!(this.data&1<<Jb)!==e&&(this.data^=1<<Jb)}get depthMask(){return!!(this.data&1<<tx)}set depthMask(e){!!(this.data&1<<tx)!==e&&(this.data^=1<<tx)}get clockwiseFrontFace(){return!!(this.data&1<<ex)}set clockwiseFrontFace(e){!!(this.data&1<<ex)!==e&&(this.data^=1<<ex)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!=="none",this._blendMode=e,this._blendModeId=ZX[e]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new YI;return e.depthTest=!1,e.blend=!0,e}};z1.default2d=z1.for2d();let Rd=z1;const $I=class U1 extends nl{constructor(e){e={...U1.defaultOptions,...e},super(e),this.enabled=!0,this._state=Rd.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.clipToViewport=e.clipToViewport,this.addResource("uTexture",0,1),e.blendRequired&&this.addResource("uBackTexture",0,3)}apply(e,t,r,i){e.applyFilter(this,t,r,i)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:t,gl:r,...i}=e;let s,o;return t&&(s=el.from(t)),r&&(o=zc.from(r)),new U1({gpuProgram:s,glProgram:o,...i})}};$I.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let qI=$I;const F1=[];Pn.handleByNamedList(me.Environment,F1);async function XX(n){if(!n)for(let e=0;e<F1.length;e++){const t=F1[e];if(t.value.test()){await t.value.load();return}}}let mh;function ZI(){if(typeof mh=="boolean")return mh;try{mh=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{mh=!1}return mh}function eE(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=XI(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let c,u,d;if(r&&(s=tK(n,e,s,t)),n.length>80*t){c=n[0],u=n[1];let f=c,p=u;for(let y=t;y<i;y+=t){const b=n[y],_=n[y+1];b<c&&(c=b),_<u&&(u=_),b>f&&(f=b),_>p&&(p=_)}d=Math.max(f-c,p-u),d=d!==0?32767/d:0}return gd(s,o,t,c,u,d,0),o}function XI(n,e,t,r,i){let s;if(i===dK(n,e,t,r)>0)for(let o=e;o<t;o+=r)s=tE(o/r|0,n[o],n[o+1],s);else for(let o=t-r;o>=e;o-=r)s=tE(o/r|0,n[o],n[o+1],s);return s&&Rc(s,s.next)&&(bd(s),s=s.next),s}function $o(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(Rc(t,t.next)||Sn(t.prev,t,t.next)===0)){if(bd(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function gd(n,e,t,r,i,s,o){if(!n)return;!o&&s&&aK(n,r,i,s);let c=n;for(;n.prev!==n.next;){const u=n.prev,d=n.next;if(s?QX(n,r,i,s):KX(n)){e.push(u.i,n.i,d.i),bd(n),n=d.next,c=d.next;continue}if(n=d,n===c){o?o===1?(n=JX($o(n),e),gd(n,e,t,r,i,s,2)):o===2&&eK(n,e,t,r,i,s):gd($o(n),e,t,r,i,s,1);break}}}function KX(n){const e=n.prev,t=n,r=n.next;if(Sn(e,t,r)>=0)return!1;const i=e.x,s=t.x,o=r.x,c=e.y,u=t.y,d=r.y,f=Math.min(i,s,o),p=Math.min(c,u,d),y=Math.max(i,s,o),b=Math.max(c,u,d);let _=r.next;for(;_!==e;){if(_.x>=f&&_.x<=y&&_.y>=p&&_.y<=b&&Th(i,c,s,u,o,d,_.x,_.y)&&Sn(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function QX(n,e,t,r){const i=n.prev,s=n,o=n.next;if(Sn(i,s,o)>=0)return!1;const c=i.x,u=s.x,d=o.x,f=i.y,p=s.y,y=o.y,b=Math.min(c,u,d),_=Math.min(f,p,y),w=Math.max(c,u,d),S=Math.max(f,p,y),A=G1(b,_,e,t,r),M=G1(w,S,e,t,r);let k=n.prevZ,E=n.nextZ;for(;k&&k.z>=A&&E&&E.z<=M;){if(k.x>=b&&k.x<=w&&k.y>=_&&k.y<=S&&k!==i&&k!==o&&Th(c,f,u,p,d,y,k.x,k.y)&&Sn(k.prev,k,k.next)>=0||(k=k.prevZ,E.x>=b&&E.x<=w&&E.y>=_&&E.y<=S&&E!==i&&E!==o&&Th(c,f,u,p,d,y,E.x,E.y)&&Sn(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;k&&k.z>=A;){if(k.x>=b&&k.x<=w&&k.y>=_&&k.y<=S&&k!==i&&k!==o&&Th(c,f,u,p,d,y,k.x,k.y)&&Sn(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;E&&E.z<=M;){if(E.x>=b&&E.x<=w&&E.y>=_&&E.y<=S&&E!==i&&E!==o&&Th(c,f,u,p,d,y,E.x,E.y)&&Sn(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function JX(n,e){let t=n;do{const r=t.prev,i=t.next.next;!Rc(r,i)&&QI(r,t,t.next,i)&&yd(r,i)&&yd(i,r)&&(e.push(r.i,t.i,i.i),bd(t),bd(t.next),t=n=i),t=t.next}while(t!==n);return $o(t)}function eK(n,e,t,r,i,s){let o=n;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&cK(o,c)){let u=JI(o,c);o=$o(o,o.next),u=$o(u,u.next),gd(o,e,t,r,i,s,0),gd(u,e,t,r,i,s,0);return}c=c.next}o=o.next}while(o!==n)}function tK(n,e,t,r){const i=[];for(let s=0,o=e.length;s<o;s++){const c=e[s]*r,u=s<o-1?e[s+1]*r:n.length,d=XI(n,c,u,r,!1);d===d.next&&(d.steiner=!0),i.push(lK(d))}i.sort(nK);for(let s=0;s<i.length;s++)t=rK(i[s],t);return t}function nK(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const r=(n.next.y-n.y)/(n.next.x-n.x),i=(e.next.y-e.y)/(e.next.x-e.x);t=r-i}return t}function rK(n,e){const t=iK(n,e);if(!t)return e;const r=JI(t,n);return $o(r,r.next),$o(t,t.next)}function iK(n,e){let t=e;const r=n.x,i=n.y;let s=-1/0,o;if(Rc(n,t))return t;do{if(Rc(n,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const p=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=r&&p>s&&(s=p,o=t.x<t.next.x?t:t.next,p===r))return o}t=t.next}while(t!==e);if(!o)return null;const c=o,u=o.x,d=o.y;let f=1/0;t=o;do{if(r>=t.x&&t.x>=u&&r!==t.x&&KI(i<d?r:s,i,u,d,i<d?s:r,i,t.x,t.y)){const p=Math.abs(i-t.y)/(r-t.x);yd(t,n)&&(p<f||p===f&&(t.x>o.x||t.x===o.x&&sK(o,t)))&&(o=t,f=p)}t=t.next}while(t!==c);return o}function sK(n,e){return Sn(n.prev,n,e.prev)<0&&Sn(e.next,n,n.next)<0}function aK(n,e,t,r){let i=n;do i.z===0&&(i.z=G1(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,oK(i)}function oK(n){let e,t=1;do{let r=n,i;n=null;let s=null;for(e=0;r;){e++;let o=r,c=0;for(let d=0;d<t&&(c++,o=o.nextZ,!!o);d++);let u=t;for(;c>0||u>0&&o;)c!==0&&(u===0||!o||r.z<=o.z)?(i=r,r=r.nextZ,c--):(i=o,o=o.nextZ,u--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;r=o}s.nextZ=null,t*=2}while(e>1);return n}function G1(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function lK(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function KI(n,e,t,r,i,s,o,c){return(i-o)*(e-c)>=(n-o)*(s-c)&&(n-o)*(r-c)>=(t-o)*(e-c)&&(t-o)*(s-c)>=(i-o)*(r-c)}function Th(n,e,t,r,i,s,o,c){return!(n===o&&e===c)&&KI(n,e,t,r,i,s,o,c)}function cK(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!uK(n,e)&&(yd(n,e)&&yd(e,n)&&hK(n,e)&&(Sn(n.prev,n,e.prev)||Sn(n,e.prev,e))||Rc(n,e)&&Sn(n.prev,n,n.next)>0&&Sn(e.prev,e,e.next)>0)}function Sn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Rc(n,e){return n.x===e.x&&n.y===e.y}function QI(n,e,t,r){const i=Fm(Sn(n,e,t)),s=Fm(Sn(n,e,r)),o=Fm(Sn(t,r,n)),c=Fm(Sn(t,r,e));return!!(i!==s&&o!==c||i===0&&Um(n,t,e)||s===0&&Um(n,r,e)||o===0&&Um(t,n,r)||c===0&&Um(t,e,r))}function Um(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Fm(n){return n>0?1:n<0?-1:0}function uK(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&QI(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function yd(n,e){return Sn(n.prev,n,n.next)<0?Sn(n,e,n.next)>=0&&Sn(n,n.prev,e)>=0:Sn(n,e,n.prev)<0||Sn(n,n.next,e)<0}function hK(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function JI(n,e){const t=H1(n.i,n.x,n.y),r=H1(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function tE(n,e,t,r){const i=H1(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function bd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function H1(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function dK(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}const fK=eE.default||eE;var Ba=(n=>(n[n.NONE=0]="NONE",n[n.COLOR=16384]="COLOR",n[n.STENCIL=1024]="STENCIL",n[n.DEPTH=256]="DEPTH",n[n.COLOR_DEPTH=16640]="COLOR_DEPTH",n[n.COLOR_STENCIL=17408]="COLOR_STENCIL",n[n.DEPTH_STENCIL=1280]="DEPTH_STENCIL",n[n.ALL=17664]="ALL",n))(Ba||{});class eR{constructor(e){this.items=[],this._name=e}emit(e,t,r,i,s,o,c,u){const{name:d,items:f}=this;for(let p=0,y=f.length;p<y;p++)f[p][d](e,t,r,i,s,o,c,u);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&this.items.splice(t,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const mK=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],tR=class nR extends zi{constructor(e){super(),this.uid=an("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const t=[...mK,...this.config.runners??[]];this._addRunners(...t),this._unsafeEvalCheck()}async init(e={}){const t=e.skipExtensionImports===!0?!0:e.manageImports===!1;await XX(t),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const r in this._systemsHash)e={...this._systemsHash[r].constructor.defaultOptions,...e};e={...nR.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let r=0;r<this.runners.init.items.length;r++)await this.runners.init.items[r].init(e);this._initOptions=e}render(e,t){let r=e;if(r instanceof cr&&(r={container:r},t&&(it(Yt,"passing a second argument is deprecated, please use render options instead"),r.target=t.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor??(r.clearColor=this.background.colorRgba),r.clear??(r.clear=this.background.clearBeforeRender)),r.clearColor){const i=Array.isArray(r.clearColor)&&r.clearColor.length===4;r.clearColor=i?r.clearColor:An.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),r.container.visible&&(r.container.enableRenderGroup(),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r))}resize(e,t,r){const i=this.view.resolution;this.view.resize(e,t,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),r!==void 0&&r!==i&&this.runners.resolutionChange.emit(r)}clear(e={}){const t=this;e.target||(e.target=t.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Ba.ALL);const{clear:r,clearColor:i,target:s}=e;An.shared.setValue(i??this.background.colorRgba),t.renderTarget.clear(s,r,An.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(t=>{this.runners[t]=new eR(t)})}_addSystems(e){let t;for(t in e){const r=e[t];this._addSystem(r.value,r.name)}}_addSystem(e,t){const r=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=r,this._systemsHash[t]=r;for(const i in this.runners)this.runners[i].add(r);return this}_addPipes(e,t){const r=t.reduce((i,s)=>(i[s.name]=s.value,i),{});e.forEach(i=>{const s=i.value,o=i.name,c=r[o];this.renderPipes[o]=new s(this,c?new c:null),this.runners.destroy.add(this.renderPipes[o])})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),(e===!0||typeof e=="object"&&e.releaseGlobalResources)&&Oc.release(),Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!ZI())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};tR.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let pK=tR;const V1="8.14.2";me.Application;class rR{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,V1)}destroy(){this._renderer=null}}rR.extension={type:[me.WebGLSystem,me.WebGPUSystem],name:"initHook",priority:-10};class iR extends zi{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return it(Yt,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return it(Yt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return it(Yt,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return it(Yt,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return it(Yt,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture?.destroy();this.chars=null,e&&(this.pages.forEach(t=>t.texture.destroy(!0)),this.pages=null)}}class gK{constructor(e=0,t=0,r=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=r,this.size=0,this.ttl=t}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const t=this.items[e];delete this.items[e],this.size--,t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}return this}entries(e=this.keys()){return e.map(t=>[t,this.get(t)])}evict(e=!1){if(e||this.size>0){const t=this.first;delete this.items[t.key],--this.size===0?(this.first=null,this.last=null):(this.first=t.next,this.first.prev=null)}return this}expiresAt(e){let t;return this.has(e)&&(t=this.items[e].expiry),t}get(e){const t=this.items[e];if(t!==void 0){if(this.ttl>0&&t.expiry<=Date.now()){this.delete(e);return}return this.moveToEnd(t),t.value}}has(e){return e in this.items}moveToEnd(e){this.last!==e&&(e.prev!==null&&(e.prev.next=e.next),e.next!==null&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),e.prev=this.last,e.next=null,this.last!==null&&(this.last.next=e),this.last=e,this.first===null&&(this.first=e))}keys(){const e=[];let t=this.first;for(;t!==null;)e.push(t.key),t=t.next;return e}setWithEvicted(e,t,r=this.resetTtl){let i=null;if(this.has(e))this.set(e,t,!0,r);else{this.max>0&&this.size===this.max&&(i={...this.first},this.evict(!0));let s=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};++this.size===1?this.first=s:this.last.next=s,this.last=s}return i}set(e,t,r=!1,i=this.resetTtl){let s=this.items[e];return r||s!==void 0?(s.value=t,r===!1&&i&&(s.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(s)):(this.max>0&&this.size===this.max&&this.evict(!0),s=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t},++this.size===1?this.first=s:this.last.next=s,this.last=s),this}values(e=this.keys()){return e.map(t=>this.get(t))}}function sR(n=1e3,e=0,t=!1){if(isNaN(n)||n<0)throw new TypeError("Invalid max value");if(isNaN(e)||e<0)throw new TypeError("Invalid ttl value");if(typeof t!="boolean")throw new TypeError("Invalid resetTtl value");return new gK(n,e,t)}const yK=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function W1(n){const e=typeof n.fontSize=="number"?`${n.fontSize}px`:n.fontSize;let t=n.fontFamily;Array.isArray(n.fontFamily)||(t=n.fontFamily.split(","));for(let r=t.length-1;r>=0;r--){let i=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!yK.includes(i)&&(i=`"${i}"`),t[r]=i}return`${n.fontStyle} ${n.fontVariant} ${n.fontWeight} ${e} ${t.join(",")}`}const nx={willReadFrequently:!0},Zi=class Be{static get experimentalLetterSpacingSupported(){let e=Be._experimentalLetterSpacingSupported;if(e===void 0){const t=Dt.get().getCanvasRenderingContext2D().prototype;e=Be._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,r,i,s,o,c,u,d){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=s,this.lineWidths=o,this.lineHeight=c,this.maxLineWidth=u,this.fontProperties=d}static measureText(e=" ",t,r=Be._canvas,i=t.wordWrap){const s=`${e}-${t.styleKey}-wordWrap-${i}`;if(Be._measurementCache.has(s))return Be._measurementCache.get(s);const o=W1(t),c=Be.measureFont(o);c.fontSize===0&&(c.fontSize=t.fontSize,c.ascent=t.fontSize);const u=Be.__context;u.font=o;const f=(i?Be._wordWrap(e,t,r):e).split(/(?:\r\n|\r|\n)/),p=new Array(f.length);let y=0;for(let M=0;M<f.length;M++){const k=Be._measureText(f[M],t.letterSpacing,u);p[M]=k,y=Math.max(y,k)}const b=t._stroke?.width||0;let _=y+b;t.dropShadow&&(_+=t.dropShadow.distance);const w=t.lineHeight||c.fontSize;let S=Math.max(w,c.fontSize+b)+(f.length-1)*(w+t.leading);t.dropShadow&&(S+=t.dropShadow.distance);const A=new Be(e,t,_,S,f,p,w+t.leading,y,c);return Be._measurementCache.set(s,A),A}static _measureText(e,t,r){let i=!1;Be.experimentalLetterSpacingSupported&&(Be.experimentalLetterSpacing?(r.letterSpacing=`${t}px`,r.textLetterSpacing=`${t}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));const s=r.measureText(e);let o=s.width;const c=-s.actualBoundingBoxLeft;let d=s.actualBoundingBoxRight-c;if(o>0)if(i)o-=t,d-=t;else{const f=(Be.graphemeSegmenter(e).length-1)*t;o+=f,d+=f}return Math.max(o,d)}static _wordWrap(e,t,r=Be._canvas){const i=r.getContext("2d",nx);let s=0,o="",c="";const u=Object.create(null),{letterSpacing:d,whiteSpace:f}=t,p=Be._collapseSpaces(f),y=Be._collapseNewlines(f);let b=!p;const _=t.wordWrapWidth+d,w=Be._tokenize(e);for(let S=0;S<w.length;S++){let A=w[S];if(Be._isNewline(A)){if(!y){c+=Be._addLine(o),b=!p,o="",s=0;continue}A=" "}if(p){const k=Be.isBreakingSpace(A),E=Be.isBreakingSpace(o[o.length-1]);if(k&&E)continue}const M=Be._getFromCache(A,d,u,i);if(M>_)if(o!==""&&(c+=Be._addLine(o),o="",s=0),Be.canBreakWords(A,t.breakWords)){const k=Be.wordWrapSplit(A);for(let E=0;E<k.length;E++){let U=k[E],I=U,B=1;for(;k[E+B];){const R=k[E+B];if(!Be.canBreakChars(I,R,A,E,t.breakWords))U+=R;else break;I=R,B++}E+=B-1;const G=Be._getFromCache(U,d,u,i);G+s>_&&(c+=Be._addLine(o),b=!1,o="",s=0),o+=U,s+=G}}else{o.length>0&&(c+=Be._addLine(o),o="",s=0);const k=S===w.length-1;c+=Be._addLine(A,!k),b=!1,o="",s=0}else M+s>_&&(b=!1,c+=Be._addLine(o),o="",s=0),(o.length>0||!Be.isBreakingSpace(A)||b)&&(o+=A,s+=M)}return c+=Be._addLine(o,!1),c}static _addLine(e,t=!0){return e=Be._trimRight(e),e=t?`${e}
`:e,e}static _getFromCache(e,t,r,i){let s=r[e];return typeof s!="number"&&(s=Be._measureText(e,t,i)+t,r[e]=s),s}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const r=e[t];if(!Be.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:Be._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:Be._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const t=[];let r="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];if(Be.isBreakingSpace(s,o)||Be._isNewline(s)){r!==""&&(t.push(r),r=""),s==="\r"&&o===`
`?(t.push(`\r
`),i++):t.push(s);continue}r+=s}return r!==""&&t.push(r),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,s){return!0}static wordWrapSplit(e){return Be.graphemeSegmenter(e)}static measureFont(e){if(Be._fonts[e])return Be._fonts[e];const t=Be._context;t.font=e;const r=t.measureText(Be.METRICS_STRING+Be.BASELINE_SYMBOL),i={ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,fontSize:r.actualBoundingBoxAscent+r.actualBoundingBoxDescent};return Be._fonts[e]=i,i}static clearMetrics(e=""){e?delete Be._fonts[e]:Be._fonts={}}static get _canvas(){if(!Be.__canvas){let e;try{const t=new OffscreenCanvas(0,0);if(t.getContext("2d",nx)?.measureText)return Be.__canvas=t,t;e=Dt.get().createCanvas()}catch{e=Dt.get().createCanvas()}e.width=e.height=10,Be.__canvas=e}return Be.__canvas}static get _context(){return Be.__context||(Be.__context=Be._canvas.getContext("2d",nx)),Be.__context}};Zi.METRICS_STRING="|q";Zi.BASELINE_SYMBOL="M";Zi.BASELINE_MULTIPLIER=1.4;Zi.HEIGHT_MULTIPLIER=2;Zi.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const n=new Intl.Segmenter;return e=>{const t=n.segment(e),r=[];let i=0;for(const s of t)r[i++]=s.segment;return r}}return n=>[...n]})();Zi.experimentalLetterSpacing=!1;Zi._fonts={};Zi._newlines=[10,13];Zi._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Zi._measurementCache=sR(1e3);let mp=Zi;const nE=[{offset:0,color:"white"},{offset:1,color:"black"}],yv=class Y1{constructor(...e){this.uid=an("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let t=bK(e);t={...t.type==="radial"?Y1.defaultRadialOptions:Y1.defaultLinearOptions,...mI(t)},this._textureSize=t.textureSize,this._wrapMode=t.wrapMode,t.type==="radial"?(this.center=t.center,this.outerCenter=t.outerCenter??this.center,this.innerRadius=t.innerRadius,this.outerRadius=t.outerRadius,this.scale=t.scale,this.rotation=t.rotation):(this.start=t.start,this.end=t.end),this.textureSpace=t.textureSpace,this.type=t.type,t.colorStops.forEach(i=>{this.addColorStop(i.offset,i.color)})}addColorStop(e,t){return this.colorStops.push({offset:e,color:An.shared.setValue(t).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:e,y:t}=this.start,{x:r,y:i}=this.end,s=r-e,o=i-t;const c=s<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(s<0){const S=e;e=r,r=S,s*=-1}if(o<0){const S=t;t=i,i=S,o*=-1}}const u=this.colorStops.length?this.colorStops:nE,d=this._textureSize,{canvas:f,context:p}=iE(d,1),y=c?p.createLinearGradient(this._textureSize,0,0,0):p.createLinearGradient(0,0,this._textureSize,0);rE(y,u),p.fillStyle=y,p.fillRect(0,0,d,1),this.texture=new Ue({source:new Wo({resource:f,addressMode:this._wrapMode})});const b=Math.sqrt(s*s+o*o),_=Math.atan2(o,s),w=new We;w.scale(b/d,1),w.rotate(_),w.translate(e,t),this.textureSpace==="local"&&w.scale(d,d),this.transform=w}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:nE,t=this._textureSize,{canvas:r,context:i}=iE(t,t),{x:s,y:o}=this.center,{x:c,y:u}=this.outerCenter,d=this.innerRadius,f=this.outerRadius,p=c-f,y=u-f,b=t/(f*2),_=(s-p)*b,w=(o-y)*b,S=i.createRadialGradient(_,w,d*b,(c-p)*b,(u-y)*b,f*b);rE(S,e),i.fillStyle=e[e.length-1].color,i.fillRect(0,0,t,t),i.fillStyle=S,i.translate(_,w),i.rotate(this.rotation),i.scale(1,this.scale),i.translate(-_,-w),i.fillRect(0,0,t,t),this.texture=new Ue({source:new Wo({resource:r,addressMode:this._wrapMode})});const A=new We;A.scale(1/b,1/b),A.translate(p,y),this.textureSpace==="local"&&A.scale(t,t),this.transform=A}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};yv.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};yv.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Xs=yv;function rE(n,e){for(let t=0;t<e.length;t++){const r=e[t];n.addColorStop(r.offset,r.color)}}function iE(n,e){const t=Dt.get().createCanvas(n,e),r=t.getContext("2d");return{canvas:t,context:r}}function bK(n){let e=n[0]??{};return(typeof e=="number"||n[1])&&(it("8.5.2","use options object instead"),e={type:"linear",start:{x:n[0],y:n[1]},end:{x:n[2],y:n[3]},textureSpace:n[4],textureSize:n[5]??Xs.defaultLinearOptions.textureSize}),e}const sE={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class gg{constructor(e,t){this.uid=an("fillPattern"),this._tick=0,this.transform=new We,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=sE[t].addressModeU,e.source.style.addressModeV=sE[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._tick++}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var rx,aE;function xK(){if(aE)return rx;aE=1,rx=t;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function t(s){var o=[];return s.replace(e,function(c,u,d){var f=u.toLowerCase();for(d=i(d),f=="m"&&d.length>2&&(o.push([u].concat(d.splice(0,2))),f="l",u=u=="m"?"l":"L");;){if(d.length==n[f])return d.unshift(u),o.push(d);if(d.length<n[f])throw new Error("malformed path data");o.push([u].concat(d.splice(0,n[f])))}}),o}var r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function i(s){var o=s.match(r);return o?o.map(Number):[]}return rx}var vK=xK();const _K=Zo(vK);function wK(n,e){const t=_K(n),r=[];let i=null,s=0,o=0;for(let c=0;c<t.length;c++){const u=t[c],d=u[0],f=u;switch(d){case"M":s=f[1],o=f[2],e.moveTo(s,o);break;case"m":s+=f[1],o+=f[2],e.moveTo(s,o);break;case"H":s=f[1],e.lineTo(s,o);break;case"h":s+=f[1],e.lineTo(s,o);break;case"V":o=f[1],e.lineTo(s,o);break;case"v":o+=f[1],e.lineTo(s,o);break;case"L":s=f[1],o=f[2],e.lineTo(s,o);break;case"l":s+=f[1],o+=f[2],e.lineTo(s,o);break;case"C":s=f[5],o=f[6],e.bezierCurveTo(f[1],f[2],f[3],f[4],s,o);break;case"c":e.bezierCurveTo(s+f[1],o+f[2],s+f[3],o+f[4],s+f[5],o+f[6]),s+=f[5],o+=f[6];break;case"S":s=f[3],o=f[4],e.bezierCurveToShort(f[1],f[2],s,o);break;case"s":e.bezierCurveToShort(s+f[1],o+f[2],s+f[3],o+f[4]),s+=f[3],o+=f[4];break;case"Q":s=f[3],o=f[4],e.quadraticCurveTo(f[1],f[2],s,o);break;case"q":e.quadraticCurveTo(s+f[1],o+f[2],s+f[3],o+f[4]),s+=f[3],o+=f[4];break;case"T":s=f[1],o=f[2],e.quadraticCurveToShort(s,o);break;case"t":s+=f[1],o+=f[2],e.quadraticCurveToShort(s,o);break;case"A":s=f[6],o=f[7],e.arcToSvg(f[1],f[2],f[3],f[4],f[5],s,o);break;case"a":s+=f[6],o+=f[7],e.arcToSvg(f[1],f[2],f[3],f[4],f[5],s,o);break;case"Z":case"z":e.closePath(),r.length>0&&(i=r.pop(),i?(s=i.startX,o=i.startY):(s=0,o=0)),i=null;break;default:ct(`Unknown SVG path command: ${d}`)}d!=="Z"&&d!=="z"&&i===null&&(i={startX:s,startY:o},r.push(i))}return e}class bv{constructor(e=0,t=0,r=0){this.type="circle",this.x=e,this.y=t,this.radius=r}clone(){return new bv(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const r=this.radius*this.radius;let i=this.x-e,s=this.y-t;return i*=i,s*=s,i+s<=r}strokeContains(e,t,r,i=.5){if(this.radius===0)return!1;const s=this.x-e,o=this.y-t,c=this.radius,u=(1-i)*r,d=Math.sqrt(s*s+o*o);return d<=c+u&&d>c-(r-u)}getBounds(e){return e||(e=new Qt),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class xv{constructor(e=0,t=0,r=0,i=0){this.type="ellipse",this.x=e,this.y=t,this.halfWidth=r,this.halfHeight=i}clone(){return new xv(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(e-this.x)/this.halfWidth,i=(t-this.y)/this.halfHeight;return r*=r,i*=i,r+i<=1}strokeContains(e,t,r,i=.5){const{halfWidth:s,halfHeight:o}=this;if(s<=0||o<=0)return!1;const c=r*(1-i),u=r-c,d=s-u,f=o-u,p=s+c,y=o+c,b=e-this.x,_=t-this.y,w=b*b/(d*d)+_*_/(f*f),S=b*b/(p*p)+_*_/(y*y);return w>1&&S<=1}getBounds(e){return e||(e=new Qt),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function SK(n,e,t,r,i,s){const o=n-t,c=e-r,u=i-t,d=s-r,f=o*u+c*d,p=u*u+d*d;let y=-1;p!==0&&(y=f/p);let b,_;y<0?(b=t,_=r):y>1?(b=i,_=s):(b=t+y*u,_=r+y*d);const w=n-b,S=e-_;return w*w+S*S}let AK,CK;class $h{constructor(...e){this.type="polygon";let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const r=[];for(let i=0,s=t.length;i<s;i++)r.push(t[i].x,t[i].y);t=r}this.points=t,this.closePath=!0}isClockwise(){let e=0;const t=this.points,r=t.length;for(let i=0;i<r;i+=2){const s=t[i],o=t[i+1],c=t[(i+2)%r],u=t[(i+3)%r];e+=(c-s)*(u+o)}return e<0}containsPolygon(e){const t=this.getBounds(AK),r=e.getBounds(CK);if(!t.containsRect(r))return!1;const i=e.points;for(let s=0;s<i.length;s+=2){const o=i[s],c=i[s+1];if(!this.contains(o,c))return!1}return!0}clone(){const e=this.points.slice(),t=new $h(e);return t.closePath=this.closePath,t}contains(e,t){let r=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const c=this.points[s*2],u=this.points[s*2+1],d=this.points[o*2],f=this.points[o*2+1];u>t!=f>t&&e<(d-c)*((t-u)/(f-u))+c&&(r=!r)}return r}strokeContains(e,t,r,i=.5){const s=r*r,o=s*(1-i),c=s-o,{points:u}=this,d=u.length-(this.closePath?0:2);for(let f=0;f<d;f+=2){const p=u[f],y=u[f+1],b=u[(f+2)%u.length],_=u[(f+3)%u.length],w=SK(e,t,p,y,b,_),S=Math.sign((b-p)*(t-y)-(_-y)*(e-p));if(w<=(S<0?c:o))return!0}return!1}getBounds(e){e||(e=new Qt);const t=this.points;let r=1/0,i=-1/0,s=1/0,o=-1/0;for(let c=0,u=t.length;c<u;c+=2){const d=t[c],f=t[c+1];r=d<r?d:r,i=d>i?d:i,s=f<s?f:s,o=f>o?f:o}return e.x=r,e.width=i-r,e.y=s,e.height=o-s,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return it("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return it("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const Gm=(n,e,t,r,i,s,o)=>{const c=n-t,u=e-r,d=Math.sqrt(c*c+u*u);return d>=i-s&&d<=i+o};class vv{constructor(e=0,t=0,r=0,i=0,s=20){this.type="roundedRectangle",this.x=e,this.y=t,this.width=r,this.height=i,this.radius=s}getBounds(e){return e||(e=new Qt),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new vv(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+r&&t<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let i=e-(this.x+r),s=t-(this.y+r);const o=r*r;if(i*i+s*s<=o||(i=e-(this.x+this.width-r),i*i+s*s<=o)||(s=t-(this.y+this.height-r),i*i+s*s<=o)||(i=e-(this.x+r),i*i+s*s<=o))return!0}return!1}strokeContains(e,t,r,i=.5){const{x:s,y:o,width:c,height:u,radius:d}=this,f=r*(1-i),p=r-f,y=s+d,b=o+d,_=c-d*2,w=u-d*2,S=s+c,A=o+u;return(e>=s-f&&e<=s+p||e>=S-p&&e<=S+f)&&t>=b&&t<=b+w||(t>=o-f&&t<=o+p||t>=A-p&&t<=A+f)&&e>=y&&e<=y+_?!0:e<y&&t<b&&Gm(e,t,y,b,d,p,f)||e>S-d&&t<b&&Gm(e,t,S-d,b,d,p,f)||e>S-d&&t>A-d&&Gm(e,t,S-d,A-d,d,p,f)||e<y&&t>A-d&&Gm(e,t,y,A-d,d,p,f)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const aR={};function kK(n,e,t){let r=2166136261;for(let i=0;i<e;i++)r^=n[i].uid,r=Math.imul(r,16777619),r>>>=0;return aR[r]||TK(n,e,r,t)}function TK(n,e,t,r){const i={};let s=0;for(let c=0;c<r;c++){const u=c<e?n[c]:Ue.EMPTY.source;i[s++]=u.source,i[s++]=u.style}const o=new Yh(i);return aR[t]=o,o}class oE{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function lE(n,e){const t=n.byteLength/8|0,r=new Float64Array(n,0,t);new Float64Array(e,0,t).set(r);const s=n.byteLength-t*8;if(s>0){const o=new Uint8Array(n,t*8,s);new Uint8Array(e,t*8,s).set(o)}}const EK={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var or=(n=>(n[n.DISABLED=0]="DISABLED",n[n.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",n[n.MASK_ACTIVE=2]="MASK_ACTIVE",n[n.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",n[n.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",n[n.NONE=5]="NONE",n))(or||{});function cE(n,e){return e.alphaMode==="no-premultiply-alpha"&&EK[n]||n}const MK=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function NK(n){let e="";for(let t=0;t<n;++t)t>0&&(e+=`
else `),t<n-1&&(e+=`if(test == ${t}.0){}`);return e}function oR(n,e){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const r=MK.replace(/%forloop%/gi,NK(n));if(e.shaderSource(t,r),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))n=n/2|0;else break}}finally{e.deleteShader(t)}return n}let Jl=null;function IK(){if(Jl)return Jl;const n=FI();return Jl=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),Jl=oR(Jl,n),n.getExtension("WEBGL_lose_context")?.loseContext(),Jl}class RK{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}class PK{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new RK,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const qh=[];let Vp=0;Oc.register({clear:()=>{if(qh.length>0)for(const n of qh)n&&n.destroy();qh.length=0,Vp=0}});function uE(){return Vp>0?qh[--Vp]:new PK}function hE(n){qh[Vp++]=n}let ph=0;const lR=class cR{constructor(e){this.uid=an("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],e={...cR.defaultOptions,...e},e.maxTextures||(it("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),e.maxTextures=IK());const{maxTextures:t,attributesInitialSize:r,indicesInitialSize:i}=e;this.attributeBuffer=new oE(r*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=t}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)hE(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,t){const r=e._batch.textures.ids[t._source.uid];return!r&&r!==0?!1:(e._textureId=r,e.texture=t,!0)}updateElement(e){this.dirty=!0;const t=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId)}break(e){const t=this._elements;if(!t[this.elementStart])return;let r=uE(),i=r.textures;i.clear();const s=t[this.elementStart];let o=cE(s.blendMode,s.texture._source),c=s.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const u=this.attributeBuffer.float32View,d=this.attributeBuffer.uint32View,f=this.indexBuffer;let p=this._batchIndexSize,y=this._batchIndexStart,b="startBatch";const _=this.maxTextures;for(let w=this.elementStart;w<this.elementSize;++w){const S=t[w];t[w]=null;const M=S.texture._source,k=cE(S.blendMode,M),E=o!==k||c!==S.topology;if(M._batchTick===ph&&!E){S._textureId=M._textureBindLocation,p+=S.indexSize,S.packAsQuad?(this.packQuadAttributes(S,u,d,S._attributeStart,S._textureId),this.packQuadIndex(f,S._indexStart,S._attributeStart/this.vertexSize)):(this.packAttributes(S,u,d,S._attributeStart,S._textureId),this.packIndex(S,f,S._indexStart,S._attributeStart/this.vertexSize)),S._batch=r;continue}M._batchTick=ph,(i.count>=_||E)&&(this._finishBatch(r,y,p-y,i,o,c,e,b),b="renderBatch",y=p,o=k,c=S.topology,r=uE(),i=r.textures,i.clear(),++ph),S._textureId=M._textureBindLocation=i.count,i.ids[M.uid]=i.count,i.textures[i.count++]=M,S._batch=r,p+=S.indexSize,S.packAsQuad?(this.packQuadAttributes(S,u,d,S._attributeStart,S._textureId),this.packQuadIndex(f,S._indexStart,S._attributeStart/this.vertexSize)):(this.packAttributes(S,u,d,S._attributeStart,S._textureId),this.packIndex(S,f,S._indexStart,S._attributeStart/this.vertexSize))}i.count>0&&(this._finishBatch(r,y,p-y,i,o,c,e,b),y=p,++ph),this.elementStart=this.elementSize,this._batchIndexStart=y,this._batchIndexSize=p}_finishBatch(e,t,r,i,s,o,c,u){e.gpuBindGroup=null,e.bindGroup=null,e.action=u,e.batcher=this,e.textures=i,e.blendMode=s,e.topology=o,e.start=t,e.size=r,++ph,this.batches[this.batchIndex++]=e,c.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const t=Math.max(e,this.attributeBuffer.size*2),r=new oE(t);lE(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(e){const t=this.indexBuffer;let r=Math.max(e,t.length*1.5);r+=r%2;const i=r>65535?new Uint32Array(r):new Uint16Array(r);if(i.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(let s=0;s<t.length;s++)i[s]=t[s];else lE(t.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(e,t,r){e[t]=r+0,e[t+1]=r+1,e[t+2]=r+2,e[t+3]=r+0,e[t+4]=r+2,e[t+5]=r+3}packIndex(e,t,r,i){const s=e.indices,o=e.indexSize,c=e.indexOffset,u=e.attributeOffset;for(let d=0;d<o;d++)t[r++]=i+s[d+c]-u}destroy(e={}){if(this.batches!==null){for(let t=0;t<this.batches.length;t++)hE(this.batches[t]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,e.shader&&(this.shader?.destroy(),this.shader=null);for(let t=0;t<this._elements.length;t++)this._elements[t]&&(this._elements[t]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};lR.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let DK=lR;var Bn=(n=>(n[n.MAP_READ=1]="MAP_READ",n[n.MAP_WRITE=2]="MAP_WRITE",n[n.COPY_SRC=4]="COPY_SRC",n[n.COPY_DST=8]="COPY_DST",n[n.INDEX=16]="INDEX",n[n.VERTEX=32]="VERTEX",n[n.UNIFORM=64]="UNIFORM",n[n.STORAGE=128]="STORAGE",n[n.INDIRECT=256]="INDIRECT",n[n.QUERY_RESOLVE=512]="QUERY_RESOLVE",n[n.STATIC=1024]="STATIC",n))(Bn||{});let qo=class extends zi{constructor(e){let{data:t,size:r}=e;const{usage:i,label:s,shrinkToFit:o}=e;super(),this.uid=an("buffer"),this._resourceType="buffer",this._resourceId=an("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,r??(r=t?.byteLength);const c=!!t;this.descriptor={size:r,usage:i,mappedAtCreation:c,label:s},this.shrinkToFit=o??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&Bn.STATIC)}set static(e){e?this.descriptor.usage|=Bn.STATIC:this.descriptor.usage&=~Bn.STATIC}setDataWithSize(e,t,r){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e){r&&this.emit("update",this);return}const i=this._data;if(this._data=e,this._dataInt32=null,!i||i.length!==e.length){!this.shrinkToFit&&i&&e.byteLength<i.byteLength?r&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=an("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function uR(n,e){if(!(n instanceof qo)){let t=e?Bn.INDEX:Bn.VERTEX;n instanceof Array&&(e?(n=new Uint32Array(n),t=Bn.INDEX|Bn.COPY_DST):(n=new Float32Array(n),t=Bn.VERTEX|Bn.COPY_DST)),n=new qo({data:n,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:t})}return n}function jK(n,e,t){const r=n.getAttribute(e);if(!r)return t.minX=0,t.minY=0,t.maxX=0,t.maxY=0,t;const i=r.buffer.data;let s=1/0,o=1/0,c=-1/0,u=-1/0;const d=i.BYTES_PER_ELEMENT,f=(r.offset||0)/d,p=(r.stride||8)/d;for(let y=f;y<i.length;y+=p){const b=i[y],_=i[y+1];b>c&&(c=b),_>u&&(u=_),b<s&&(s=b),_<o&&(o=_)}return t.minX=s,t.minY=o,t.maxX=c,t.maxY=u,t}function BK(n){return(n instanceof qo||Array.isArray(n)||n.BYTES_PER_ELEMENT)&&(n={buffer:n}),n.buffer=uR(n.buffer,!1),n}class hR extends zi{constructor(e={}){super(),this.uid=an("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new qr,this._boundsDirty=!0;const{attributes:t,indexBuffer:r,topology:i}=e;if(this.buffers=[],this.attributes={},t)for(const s in t)this.addAttribute(s,t[s]);this.instanceCount=e.instanceCount??1,r&&this.addIndex(r),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}addAttribute(e,t){const r=BK(t);this.buffers.indexOf(r.buffer)===-1&&(this.buffers.push(r.buffer),r.buffer.on("update",this.onBufferUpdate,this),r.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=r}addIndex(e){this.indexBuffer=uR(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,jK(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(t=>t.destroy()),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const OK=new Float32Array(1),LK=new Uint32Array(1);class zK extends hR{constructor(){const t=new qo({data:OK,label:"attribute-batch-buffer",usage:Bn.VERTEX|Bn.COPY_DST,shrinkToFit:!1}),r=new qo({data:LK,label:"index-batch-buffer",usage:Bn.INDEX|Bn.COPY_DST,shrinkToFit:!1}),i=24;super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:i,offset:0},aUV:{buffer:t,format:"float32x2",stride:i,offset:8},aColor:{buffer:t,format:"unorm8x4",stride:i,offset:16},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:i,offset:20}},indexBuffer:r})}}function dE(n,e,t){if(n)for(const r in n){const i=r.toLocaleLowerCase(),s=e[i];if(s){let o=n[r];r==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),t&&s.push(`//----${t}----//`),s.push(o)}else ct(`${r} placement hook does not exist in shader`)}}const UK=/\{\{(.*?)\}\}/g;function fE(n){const e={};return(n.match(UK)?.map(r=>r.replace(/[{()}]/g,""))??[]).forEach(r=>{e[r]=[]}),e}function mE(n,e){let t;const r=/@in\s+([^;]+);/g;for(;(t=r.exec(n))!==null;)e.push(t[1])}function pE(n,e,t=!1){const r=[];mE(e,r),n.forEach(c=>{c.header&&mE(c.header,r)});const i=r;t&&i.sort();const s=i.map((c,u)=>`       @location(${u}) ${c},`).join(`
`);let o=e.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${s}
`),o}function gE(n,e){let t;const r=/@out\s+([^;]+);/g;for(;(t=r.exec(n))!==null;)e.push(t[1])}function FK(n){const t=/\b(\w+)\s*:/g.exec(n);return t?t[1]:""}function GK(n){const e=/@.*?\s+/g;return n.replace(e,"")}function HK(n,e){const t=[];gE(e,t),n.forEach(u=>{u.header&&gE(u.header,t)});let r=0;const i=t.sort().map(u=>u.indexOf("builtin")>-1?u:`@location(${r++}) ${u}`).join(`,
`),s=t.sort().map(u=>`       var ${GK(u)};`).join(`
`),o=`return VSOutput(
            ${t.sort().map(u=>` ${FK(u)}`).join(`,
`)});`;let c=e.replace(/@out\s+[^;]+;\s*/g,"");return c=c.replace("{{struct}}",`
${i}
`),c=c.replace("{{start}}",`
${s}
`),c=c.replace("{{return}}",`
${o}
`),c}function yE(n,e){let t=n;for(const r in e){const i=e[r];i.join(`
`).length?t=t.replace(`{{${r}}}`,`//-----${r} START-----//
${i.join(`
`)}
//----${r} FINISH----//`):t=t.replace(`{{${r}}}`,"")}return t}const Ia=Object.create(null),ix=new Map;let VK=0;function WK({template:n,bits:e}){const t=dR(n,e);if(Ia[t])return Ia[t];const{vertex:r,fragment:i}=$K(n,e);return Ia[t]=fR(r,i,e),Ia[t]}function YK({template:n,bits:e}){const t=dR(n,e);return Ia[t]||(Ia[t]=fR(n.vertex,n.fragment,e)),Ia[t]}function $K(n,e){const t=e.map(o=>o.vertex).filter(o=>!!o),r=e.map(o=>o.fragment).filter(o=>!!o);let i=pE(t,n.vertex,!0);i=HK(t,i);const s=pE(r,n.fragment,!0);return{vertex:i,fragment:s}}function dR(n,e){return e.map(t=>(ix.has(t)||ix.set(t,VK++),ix.get(t))).sort((t,r)=>t-r).join("-")+n.vertex+n.fragment}function fR(n,e,t){const r=fE(n),i=fE(e);return t.forEach(s=>{dE(s.vertex,r,s.name),dE(s.fragment,i,s.name)}),{vertex:yE(n,r),fragment:yE(e,i)}}const qK=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,ZK=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,XK=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,KK=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,QK={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},JK={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function eQ({bits:n,name:e}){const t=WK({template:{fragment:ZK,vertex:qK},bits:[QK,...n]});return el.from({name:e,vertex:{source:t.vertex,entryPoint:"main"},fragment:{source:t.fragment,entryPoint:"main"}})}function _v({bits:n,name:e}){return new zc({name:e,...YK({template:{vertex:XK,fragment:KK},bits:[JK,...n]})})}const tQ={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},mR={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},sx={};function nQ(n){const e=[];if(n===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let t=0;for(let r=0;r<n;r++)e.push(`@group(1) @binding(${t++}) var textureSource${r+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${t++}) var textureSampler${r+1}: sampler;`)}return e.join(`
`)}function rQ(n){const e=[];if(n===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let t=0;t<n;t++)t===n-1?e.push("  default:{"):e.push(`  case ${t}:{`),e.push(`      outColor = textureSampleGrad(textureSource${t+1}, textureSampler${t+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function iQ(n){return sx[n]||(sx[n]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${nQ(n)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${rQ(n)}
            `}}),sx[n]}const ax={};function sQ(n){const e=[];for(let t=0;t<n;t++)t>0&&e.push("else"),t<n-1&&e.push(`if(vTextureId < ${t}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${t}], vUV);`),e.push("}");return e.join(`
`)}function pR(n){return ax[n]||(ax[n]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${n}];

            `,main:`

                ${sQ(n)}
            `}}),ax[n]}const aQ={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},wv={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},bE={};function gR(n){let e=bE[n];if(e)return e;const t=new Int32Array(n);for(let r=0;r<n;r++)t[r]=r;return e=bE[n]=new tl({uTextures:{value:t,type:"i32",size:n}},{isStatic:!0}),e}class xE extends nl{constructor(e){const t=_v({name:"batch",bits:[mR,pR(e),wv]}),r=eQ({name:"batch",bits:[tQ,iQ(e),aQ]});super({glProgram:t,gpuProgram:r,resources:{batchSamplers:gR(e)}}),this.maxTextures=e}}let gh=null;const yR=class bR extends DK{constructor(e){super(e),this.geometry=new zK,this.name=bR.extension.name,this.vertexSize=6,gh??(gh=new xE(e.maxTextures)),this.shader=gh}packAttributes(e,t,r,i,s){const o=s<<16|e.roundPixels&65535,c=e.transform,u=c.a,d=c.b,f=c.c,p=c.d,y=c.tx,b=c.ty,{positions:_,uvs:w}=e,S=e.color,A=e.attributeOffset,M=A+e.attributeSize;for(let k=A;k<M;k++){const E=k*2,U=_[E],I=_[E+1];t[i++]=u*U+f*I+y,t[i++]=p*I+d*U+b,t[i++]=w[E],t[i++]=w[E+1],r[i++]=S,r[i++]=o}}packQuadAttributes(e,t,r,i,s){const o=e.texture,c=e.transform,u=c.a,d=c.b,f=c.c,p=c.d,y=c.tx,b=c.ty,_=e.bounds,w=_.maxX,S=_.minX,A=_.maxY,M=_.minY,k=o.uvs,E=e.color,U=s<<16|e.roundPixels&65535;t[i+0]=u*S+f*M+y,t[i+1]=p*M+d*S+b,t[i+2]=k.x0,t[i+3]=k.y0,r[i+4]=E,r[i+5]=U,t[i+6]=u*w+f*M+y,t[i+7]=p*M+d*w+b,t[i+8]=k.x1,t[i+9]=k.y1,r[i+10]=E,r[i+11]=U,t[i+12]=u*w+f*A+y,t[i+13]=p*A+d*w+b,t[i+14]=k.x2,t[i+15]=k.y2,r[i+16]=E,r[i+17]=U,t[i+18]=u*S+f*A+y,t[i+19]=p*A+d*S+b,t[i+20]=k.x3,t[i+21]=k.y3,r[i+22]=E,r[i+23]=U}_updateMaxTextures(e){this.shader.maxTextures!==e&&(gh=new xE(e),this.shader=gh)}destroy(){this.shader=null,super.destroy()}};yR.extension={type:[me.Batcher],name:"default"};let Sv=yR;function oQ(n,e,t,r,i,s,o,c=null){let u=0;t*=e,i*=s;const d=c.a,f=c.b,p=c.c,y=c.d,b=c.tx,_=c.ty;for(;u<o;){const w=n[t],S=n[t+1];r[i]=d*w+p*S+b,r[i+1]=f*w+y*S+_,i+=s,t+=e,u++}}function lQ(n,e,t,r){let i=0;for(e*=t;i<r;)n[e]=0,n[e+1]=0,e+=t,i++}function xR(n,e,t,r,i){const s=e.a,o=e.b,c=e.c,u=e.d,d=e.tx,f=e.ty;t||(t=0),r||(r=2),i||(i=n.length/r-t);let p=t*r;for(let y=0;y<i;y++){const b=n[p],_=n[p+1];n[p]=s*b+c*_+d,n[p+1]=o*b+u*_+f,p+=r}}const cQ=new We;class vR{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,t=e>>16|e&65280|(e&255)<<16,r=this.renderable;return r?AI(t,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):t+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||cQ}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const xd={extension:{type:me.ShapeBuilder,name:"circle"},build(n,e){let t,r,i,s,o,c;if(n.type==="circle"){const E=n;if(o=c=E.radius,o<=0)return!1;t=E.x,r=E.y,i=s=0}else if(n.type==="ellipse"){const E=n;if(o=E.halfWidth,c=E.halfHeight,o<=0||c<=0)return!1;t=E.x,r=E.y,i=s=0}else{const E=n,U=E.width/2,I=E.height/2;t=E.x+U,r=E.y+I,o=c=Math.max(0,Math.min(E.radius,Math.min(U,I))),i=U-o,s=I-c}if(i<0||s<0)return!1;const u=Math.ceil(2.3*Math.sqrt(o+c)),d=u*8+(i?4:0)+(s?4:0);if(d===0)return!1;if(u===0)return e[0]=e[6]=t+i,e[1]=e[3]=r+s,e[2]=e[4]=t-i,e[5]=e[7]=r-s,!0;let f=0,p=u*4+(i?2:0)+2,y=p,b=d,_=i+o,w=s,S=t+_,A=t-_,M=r+w;if(e[f++]=S,e[f++]=M,e[--p]=M,e[--p]=A,s){const E=r-w;e[y++]=A,e[y++]=E,e[--b]=E,e[--b]=S}for(let E=1;E<u;E++){const U=Math.PI/2*(E/u),I=i+Math.cos(U)*o,B=s+Math.sin(U)*c,G=t+I,R=t-I,P=r+B,H=r-B;e[f++]=G,e[f++]=P,e[--p]=P,e[--p]=R,e[y++]=R,e[y++]=H,e[--b]=H,e[--b]=G}_=i,w=s+c,S=t+_,A=t-_,M=r+w;const k=r-w;return e[f++]=S,e[f++]=M,e[--b]=k,e[--b]=S,i&&(e[f++]=A,e[f++]=M,e[--b]=k,e[--b]=A),!0},triangulate(n,e,t,r,i,s){if(n.length===0)return;let o=0,c=0;for(let f=0;f<n.length;f+=2)o+=n[f],c+=n[f+1];o/=n.length/2,c/=n.length/2;let u=r;e[u*t]=o,e[u*t+1]=c;const d=u++;for(let f=0;f<n.length;f+=2)e[u*t]=n[f],e[u*t+1]=n[f+1],f>0&&(i[s++]=u,i[s++]=d,i[s++]=u-1),u++;i[s++]=d+1,i[s++]=d,i[s++]=u-1}},uQ={...xd,extension:{...xd.extension,name:"ellipse"}},hQ={...xd,extension:{...xd.extension,name:"roundedRectangle"}},_R=1e-4,vE=1e-4;function dQ(n){const e=n.length;if(e<6)return 1;let t=0;for(let r=0,i=n[e-2],s=n[e-1];r<e;r+=2){const o=n[r],c=n[r+1];t+=(o-i)*(c+s),i=o,s=c}return t<0?-1:1}function _E(n,e,t,r,i,s,o,c){const u=n-t*i,d=e-r*i,f=n+t*s,p=e+r*s;let y,b;o?(y=r,b=-t):(y=-r,b=t);const _=u+y,w=d+b,S=f+y,A=p+b;return c.push(_,w),c.push(S,A),2}function go(n,e,t,r,i,s,o,c){const u=t-n,d=r-e;let f=Math.atan2(u,d),p=Math.atan2(i-n,s-e);c&&f<p?f+=Math.PI*2:!c&&f>p&&(p+=Math.PI*2);let y=f;const b=p-f,_=Math.abs(b),w=Math.sqrt(u*u+d*d),S=(15*_*Math.sqrt(w)/Math.PI>>0)+1,A=b/S;if(y+=A,c){o.push(n,e),o.push(t,r);for(let M=1,k=y;M<S;M++,k+=A)o.push(n,e),o.push(n+Math.sin(k)*w,e+Math.cos(k)*w);o.push(n,e),o.push(i,s)}else{o.push(t,r),o.push(n,e);for(let M=1,k=y;M<S;M++,k+=A)o.push(n+Math.sin(k)*w,e+Math.cos(k)*w),o.push(n,e);o.push(i,s),o.push(n,e)}return S*2}function fQ(n,e,t,r,i,s){const o=_R;if(n.length===0)return;const c=e;let u=c.alignment;if(e.alignment!==.5){let se=dQ(n);u=(u-.5)*se+.5}const d=new br(n[0],n[1]),f=new br(n[n.length-2],n[n.length-1]),p=r,y=Math.abs(d.x-f.x)<o&&Math.abs(d.y-f.y)<o;if(p){n=n.slice(),y&&(n.pop(),n.pop(),f.set(n[n.length-2],n[n.length-1]));const se=(d.x+f.x)*.5,O=(f.y+d.y)*.5;n.unshift(se,O),n.push(se,O)}const b=i,_=n.length/2;let w=n.length;const S=b.length/2,A=c.width/2,M=A*A,k=c.miterLimit*c.miterLimit;let E=n[0],U=n[1],I=n[2],B=n[3],G=0,R=0,P=-(U-B),H=E-I,Y=0,L=0,q=Math.sqrt(P*P+H*H);P/=q,H/=q,P*=A,H*=A;const W=u,N=(1-W)*2,V=W*2;p||(c.cap==="round"?w+=go(E-P*(N-V)*.5,U-H*(N-V)*.5,E-P*N,U-H*N,E+P*V,U+H*V,b,!0)+2:c.cap==="square"&&(w+=_E(E,U,P,H,N,V,!0,b))),b.push(E-P*N,U-H*N),b.push(E+P*V,U+H*V);for(let se=1;se<_-1;++se){E=n[(se-1)*2],U=n[(se-1)*2+1],I=n[se*2],B=n[se*2+1],G=n[(se+1)*2],R=n[(se+1)*2+1],P=-(U-B),H=E-I,q=Math.sqrt(P*P+H*H),P/=q,H/=q,P*=A,H*=A,Y=-(B-R),L=I-G,q=Math.sqrt(Y*Y+L*L),Y/=q,L/=q,Y*=A,L*=A;const O=I-E,F=U-B,X=I-G,D=R-B,ee=O*X+F*D,pe=F*X-D*O,Se=pe<0;if(Math.abs(pe)<.001*Math.abs(ee)){b.push(I-P*N,B-H*N),b.push(I+P*V,B+H*V),ee>=0&&(c.join==="round"?w+=go(I,B,I-P*N,B-H*N,I-Y*N,B-L*N,b,!1)+4:w+=2,b.push(I-Y*V,B-L*V),b.push(I+Y*N,B+L*N));continue}const ie=(-P+E)*(-H+B)-(-P+I)*(-H+U),ve=(-Y+G)*(-L+B)-(-Y+I)*(-L+R),Ce=(O*ve-X*ie)/pe,Le=(D*ie-F*ve)/pe,st=(Ce-I)*(Ce-I)+(Le-B)*(Le-B),ft=I+(Ce-I)*N,Ge=B+(Le-B)*N,It=I-(Ce-I)*V,zt=B-(Le-B)*V,tt=Math.min(O*O+F*F,X*X+D*D),mt=Se?N:V,_t=tt+mt*mt*M;st<=_t?c.join==="bevel"||st/M>k?(Se?(b.push(ft,Ge),b.push(I+P*V,B+H*V),b.push(ft,Ge),b.push(I+Y*V,B+L*V)):(b.push(I-P*N,B-H*N),b.push(It,zt),b.push(I-Y*N,B-L*N),b.push(It,zt)),w+=2):c.join==="round"?Se?(b.push(ft,Ge),b.push(I+P*V,B+H*V),w+=go(I,B,I+P*V,B+H*V,I+Y*V,B+L*V,b,!0)+4,b.push(ft,Ge),b.push(I+Y*V,B+L*V)):(b.push(I-P*N,B-H*N),b.push(It,zt),w+=go(I,B,I-P*N,B-H*N,I-Y*N,B-L*N,b,!1)+4,b.push(I-Y*N,B-L*N),b.push(It,zt)):(b.push(ft,Ge),b.push(It,zt)):(b.push(I-P*N,B-H*N),b.push(I+P*V,B+H*V),c.join==="round"?Se?w+=go(I,B,I+P*V,B+H*V,I+Y*V,B+L*V,b,!0)+2:w+=go(I,B,I-P*N,B-H*N,I-Y*N,B-L*N,b,!1)+2:c.join==="miter"&&st/M<=k&&(Se?(b.push(It,zt),b.push(It,zt)):(b.push(ft,Ge),b.push(ft,Ge)),w+=2),b.push(I-Y*N,B-L*N),b.push(I+Y*V,B+L*V),w+=2)}E=n[(_-2)*2],U=n[(_-2)*2+1],I=n[(_-1)*2],B=n[(_-1)*2+1],P=-(U-B),H=E-I,q=Math.sqrt(P*P+H*H),P/=q,H/=q,P*=A,H*=A,b.push(I-P*N,B-H*N),b.push(I+P*V,B+H*V),p||(c.cap==="round"?w+=go(I-P*(N-V)*.5,B-H*(N-V)*.5,I-P*N,B-H*N,I+P*V,B+H*V,b,!1)+2:c.cap==="square"&&(w+=_E(I,B,P,H,N,V,!1,b)));const J=vE*vE;for(let se=S;se<w+S-2;++se)E=b[se*2],U=b[se*2+1],I=b[(se+1)*2],B=b[(se+1)*2+1],G=b[(se+2)*2],R=b[(se+2)*2+1],!(Math.abs(E*(B-R)+I*(R-U)+G*(U-B))<J)&&s.push(se,se+1,se+2)}function mQ(n,e,t,r){const i=_R;if(n.length===0)return;const s=n[0],o=n[1],c=n[n.length-2],u=n[n.length-1],d=e||Math.abs(s-c)<i&&Math.abs(o-u)<i,f=t,p=n.length/2,y=f.length/2;for(let b=0;b<p;b++)f.push(n[b*2]),f.push(n[b*2+1]);for(let b=0;b<p-1;b++)r.push(y+b,y+b+1);d&&r.push(y+p-1,y)}function wR(n,e,t,r,i,s,o){const c=fK(n,e,2);if(!c)return;for(let d=0;d<c.length;d+=3)s[o++]=c[d]+i,s[o++]=c[d+1]+i,s[o++]=c[d+2]+i;let u=i*r;for(let d=0;d<n.length;d+=2)t[u]=n[d],t[u+1]=n[d+1],u+=r}const pQ=[],gQ={extension:{type:me.ShapeBuilder,name:"polygon"},build(n,e){for(let t=0;t<n.points.length;t++)e[t]=n.points[t];return!0},triangulate(n,e,t,r,i,s){wR(n,pQ,e,t,r,i,s)}},yQ={extension:{type:me.ShapeBuilder,name:"rectangle"},build(n,e){const t=n,r=t.x,i=t.y,s=t.width,o=t.height;return s>0&&o>0?(e[0]=r,e[1]=i,e[2]=r+s,e[3]=i,e[4]=r+s,e[5]=i+o,e[6]=r,e[7]=i+o,!0):!1},triangulate(n,e,t,r,i,s){let o=0;r*=t,e[r+o]=n[0],e[r+o+1]=n[1],o+=t,e[r+o]=n[2],e[r+o+1]=n[3],o+=t,e[r+o]=n[6],e[r+o+1]=n[7],o+=t,e[r+o]=n[4],e[r+o+1]=n[5],o+=t;const c=r/t;i[s++]=c,i[s++]=c+1,i[s++]=c+2,i[s++]=c+1,i[s++]=c+3,i[s++]=c+2}},bQ={extension:{type:me.ShapeBuilder,name:"triangle"},build(n,e){return e[0]=n.x,e[1]=n.y,e[2]=n.x2,e[3]=n.y2,e[4]=n.x3,e[5]=n.y3,!0},triangulate(n,e,t,r,i,s){let o=0;r*=t,e[r+o]=n[0],e[r+o+1]=n[1],o+=t,e[r+o]=n[2],e[r+o+1]=n[3],o+=t,e[r+o]=n[4],e[r+o+1]=n[5];const c=r/t;i[s++]=c,i[s++]=c+1,i[s++]=c+2}},xQ=new We,vQ=new Qt;function _Q(n,e,t,r){const i=e.matrix?n.copyFrom(e.matrix).invert():n.identity();if(e.textureSpace==="local"){const o=t.getBounds(vQ);e.width&&o.pad(e.width);const{x:c,y:u}=o,d=1/o.width,f=1/o.height,p=-c*d,y=-u*f,b=i.a,_=i.b,w=i.c,S=i.d;i.a*=d,i.b*=d,i.c*=f,i.d*=f,i.tx=p*b+y*w+i.tx,i.ty=p*_+y*S+i.ty}else i.translate(e.texture.frame.x,e.texture.frame.y),i.scale(1/e.texture.source.width,1/e.texture.source.height);const s=e.texture.source.style;return!(e.fill instanceof Xs)&&s.addressMode==="clamp-to-edge"&&(s.addressMode="repeat",s.update()),r&&i.append(xQ.copyFrom(r).invert()),i}const yg={};Pn.handleByMap(me.ShapeBuilder,yg);Pn.add(yQ,gQ,bQ,xd,uQ,hQ);const wQ=new Qt,SQ=new We;function AQ(n,e){const{geometryData:t,batches:r}=e;r.length=0,t.indices.length=0,t.vertices.length=0,t.uvs.length=0;for(let i=0;i<n.instructions.length;i++){const s=n.instructions[i];if(s.action==="texture")CQ(s.data,r,t);else if(s.action==="fill"||s.action==="stroke"){const o=s.action==="stroke",c=s.data.path.shapePath,u=s.data.style,d=s.data.hole;o&&d&&wE(d.shapePath,u,!0,r,t),d&&(c.shapePrimitives[c.shapePrimitives.length-1].holes=d.shapePath.shapePrimitives),wE(c,u,o,r,t)}}}function CQ(n,e,t){const r=[],i=yg.rectangle,s=wQ;s.x=n.dx,s.y=n.dy,s.width=n.dw,s.height=n.dh;const o=n.transform;if(!i.build(s,r))return;const{vertices:c,uvs:u,indices:d}=t,f=d.length,p=c.length/2;o&&xR(r,o),i.triangulate(r,c,2,p,d,f);const y=n.image,b=y.uvs;u.push(b.x0,b.y0,b.x1,b.y1,b.x3,b.y3,b.x2,b.y2);const _=Ar.get(vR);_.indexOffset=f,_.indexSize=d.length-f,_.attributeOffset=p,_.attributeSize=c.length/2-p,_.baseColor=n.style,_.alpha=n.alpha,_.texture=y,_.geometryData=t,e.push(_)}function wE(n,e,t,r,i){const{vertices:s,uvs:o,indices:c}=i;n.shapePrimitives.forEach(({shape:u,transform:d,holes:f})=>{const p=[],y=yg[u.type];if(!y.build(u,p))return;const b=c.length,_=s.length/2;let w="triangle-list";if(d&&xR(p,d),t){const k=u.closePath??!0,E=e;E.pixelLine?(mQ(p,k,s,c),w="line-list"):fQ(p,E,!1,k,s,c)}else if(f){const k=[],E=p.slice();kQ(f).forEach(I=>{k.push(E.length/2),E.push(...I)}),wR(E,k,s,2,_,c,b)}else y.triangulate(p,s,2,_,c,b);const S=o.length/2,A=e.texture;if(A!==Ue.WHITE){const k=_Q(SQ,e,u,d);oQ(s,2,_,o,S,2,s.length/2-_,k)}else lQ(o,S,2,s.length/2-_);const M=Ar.get(vR);M.indexOffset=b,M.indexSize=c.length-b,M.attributeOffset=_,M.attributeSize=s.length/2-_,M.baseColor=e.color,M.alpha=e.alpha,M.texture=A,M.geometryData=i,M.topology=w,r.push(M)})}function kQ(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t].shape,i=[];yg[r.type].build(r,i)&&e.push(i)}return e}class TQ{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class EQ{constructor(){this.instructions=new TI}init(e){const t=e.maxTextures;this.batcher?this.batcher._updateMaxTextures(t):this.batcher=new Sv({maxTextures:t}),this.instructions.reset()}get geometry(){return it(GZ,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const Av=class $1{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){$1.defaultOptions.bezierSmoothness=e?.bezierSmoothness??$1.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),AQ(e,t);const r=e.batchMode;e.customShader||r==="no-batch"?t.isBatchable=!1:r==="auto"?t.isBatchable=t.geometryData.vertices.length<400:t.isBatchable=!0,e.dirty=!1}return t}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const t=Ar.get(EQ,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:r,geometryData:i}=this._gpuContextHash[e.uid],s=i.vertices.length,o=i.indices.length;for(let f=0;f<r.length;f++)r[f].applyTransform=!1;const c=t.batcher;c.ensureAttributeBuffer(s),c.ensureIndexBuffer(o),c.begin();for(let f=0;f<r.length;f++){const p=r[f];c.add(p)}c.finish(t.instructions);const u=c.geometry;u.indexBuffer.setDataWithSize(c.indexBuffer,c.indexSize,!0),u.buffers[0].setDataWithSize(c.attributeBuffer.float32View,c.attributeSize,!0);const d=c.batches;for(let f=0;f<d.length;f++){const p=d[f];p.bindGroup=kK(p.textures.textures,p.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[e.uid]=t,t}_initContext(e){const t=new TQ;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(Ar.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(r=>{Ar.return(r)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};Av.extension={type:[me.WebGLSystem,me.WebGPUSystem,me.CanvasSystem],name:"graphicsContext"};Av.defaultOptions={bezierSmoothness:.5};let SR=Av;const MQ=8,Hm=11920929e-14,NQ=1;function AR(n,e,t,r,i,s,o,c,u,d){const p=Math.min(.99,Math.max(0,d??SR.defaultOptions.bezierSmoothness));let y=(NQ-p)/1;return y*=y,IQ(e,t,r,i,s,o,c,u,n,y),n}function IQ(n,e,t,r,i,s,o,c,u,d){q1(n,e,t,r,i,s,o,c,u,d,0),u.push(o,c)}function q1(n,e,t,r,i,s,o,c,u,d,f){if(f>MQ)return;const p=(n+t)/2,y=(e+r)/2,b=(t+i)/2,_=(r+s)/2,w=(i+o)/2,S=(s+c)/2,A=(p+b)/2,M=(y+_)/2,k=(b+w)/2,E=(_+S)/2,U=(A+k)/2,I=(M+E)/2;if(f>0){let B=o-n,G=c-e;const R=Math.abs((t-o)*G-(r-c)*B),P=Math.abs((i-o)*G-(s-c)*B);if(R>Hm&&P>Hm){if((R+P)*(R+P)<=d*(B*B+G*G)){u.push(U,I);return}}else if(R>Hm){if(R*R<=d*(B*B+G*G)){u.push(U,I);return}}else if(P>Hm){if(P*P<=d*(B*B+G*G)){u.push(U,I);return}}else if(B=U-(n+o)/2,G=I-(e+c)/2,B*B+G*G<=d){u.push(U,I);return}}q1(n,e,p,y,A,M,U,I,u,d,f+1),q1(U,I,k,E,w,S,o,c,u,d,f+1)}const RQ=8,PQ=11920929e-14,DQ=1;function jQ(n,e,t,r,i,s,o,c){const d=Math.min(.99,Math.max(0,c??SR.defaultOptions.bezierSmoothness));let f=(DQ-d)/1;return f*=f,BQ(e,t,r,i,s,o,n,f),n}function BQ(n,e,t,r,i,s,o,c){Z1(o,n,e,t,r,i,s,c,0),o.push(i,s)}function Z1(n,e,t,r,i,s,o,c,u){if(u>RQ)return;const d=(e+r)/2,f=(t+i)/2,p=(r+s)/2,y=(i+o)/2,b=(d+p)/2,_=(f+y)/2;let w=s-e,S=o-t;const A=Math.abs((r-s)*S-(i-o)*w);if(A>PQ){if(A*A<=c*(w*w+S*S)){n.push(b,_);return}}else if(w=b-(e+s)/2,S=_-(t+o)/2,w*w+S*S<=c){n.push(b,_);return}Z1(n,e,t,d,f,b,_,c,u+1),Z1(n,b,_,p,y,s,o,c,u+1)}function CR(n,e,t,r,i,s,o,c){let u=Math.abs(i-s);(!o&&i>s||o&&s>i)&&(u=2*Math.PI-u),c||(c=Math.max(6,Math.floor(6*Math.pow(r,1/3)*(u/Math.PI)))),c=Math.max(c,3);let d=u/c,f=i;d*=o?-1:1;for(let p=0;p<c+1;p++){const y=Math.cos(f),b=Math.sin(f),_=e+y*r,w=t+b*r;n.push(_,w),f+=d}}function OQ(n,e,t,r,i,s){const o=n[n.length-2],u=n[n.length-1]-t,d=o-e,f=i-t,p=r-e,y=Math.abs(u*p-d*f);if(y<1e-8||s===0){(n[n.length-2]!==e||n[n.length-1]!==t)&&n.push(e,t);return}const b=u*u+d*d,_=f*f+p*p,w=u*f+d*p,S=s*Math.sqrt(b)/y,A=s*Math.sqrt(_)/y,M=S*w/b,k=A*w/_,E=S*p+A*d,U=S*f+A*u,I=d*(A+M),B=u*(A+M),G=p*(S+k),R=f*(S+k),P=Math.atan2(B-U,I-E),H=Math.atan2(R-U,G-E);CR(n,E+e,U+t,s,P,H,d*f>p*u)}const Zh=Math.PI*2,ox={centerX:0,centerY:0,ang1:0,ang2:0},lx=({x:n,y:e},t,r,i,s,o,c,u)=>{n*=t,e*=r;const d=i*n-s*e,f=s*n+i*e;return u.x=d+o,u.y=f+c,u};function LQ(n,e){const t=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),r=e===1.5707963267948966?.551915024494:t,i=Math.cos(n),s=Math.sin(n),o=Math.cos(n+e),c=Math.sin(n+e);return[{x:i-s*r,y:s+i*r},{x:o+c*r,y:c-o*r},{x:o,y:c}]}const SE=(n,e,t,r)=>{const i=n*r-e*t<0?-1:1;let s=n*t+e*r;return s>1&&(s=1),s<-1&&(s=-1),i*Math.acos(s)},zQ=(n,e,t,r,i,s,o,c,u,d,f,p,y)=>{const b=Math.pow(i,2),_=Math.pow(s,2),w=Math.pow(f,2),S=Math.pow(p,2);let A=b*_-b*S-_*w;A<0&&(A=0),A/=b*S+_*w,A=Math.sqrt(A)*(o===c?-1:1);const M=A*i/s*p,k=A*-s/i*f,E=d*M-u*k+(n+t)/2,U=u*M+d*k+(e+r)/2,I=(f-M)/i,B=(p-k)/s,G=(-f-M)/i,R=(-p-k)/s,P=SE(1,0,I,B);let H=SE(I,B,G,R);c===0&&H>0&&(H-=Zh),c===1&&H<0&&(H+=Zh),y.centerX=E,y.centerY=U,y.ang1=P,y.ang2=H};function UQ(n,e,t,r,i,s,o,c=0,u=0,d=0){if(s===0||o===0)return;const f=Math.sin(c*Zh/360),p=Math.cos(c*Zh/360),y=p*(e-r)/2+f*(t-i)/2,b=-f*(e-r)/2+p*(t-i)/2;if(y===0&&b===0)return;s=Math.abs(s),o=Math.abs(o);const _=Math.pow(y,2)/Math.pow(s,2)+Math.pow(b,2)/Math.pow(o,2);_>1&&(s*=Math.sqrt(_),o*=Math.sqrt(_)),zQ(e,t,r,i,s,o,u,d,f,p,y,b,ox);let{ang1:w,ang2:S}=ox;const{centerX:A,centerY:M}=ox;let k=Math.abs(S)/(Zh/4);Math.abs(1-k)<1e-7&&(k=1);const E=Math.max(Math.ceil(k),1);S/=E;let U=n[n.length-2],I=n[n.length-1];const B={x:0,y:0};for(let G=0;G<E;G++){const R=LQ(w,S),{x:P,y:H}=lx(R[0],s,o,p,f,A,M,B),{x:Y,y:L}=lx(R[1],s,o,p,f,A,M,B),{x:q,y:W}=lx(R[2],s,o,p,f,A,M,B);AR(n,U,I,P,H,Y,L,q,W),U=q,I=W,w+=S}}function FQ(n,e,t){const r=(o,c)=>{const u=c.x-o.x,d=c.y-o.y,f=Math.sqrt(u*u+d*d),p=u/f,y=d/f;return{len:f,nx:p,ny:y}},i=(o,c)=>{o===0?n.moveTo(c.x,c.y):n.lineTo(c.x,c.y)};let s=e[e.length-1];for(let o=0;o<e.length;o++){const c=e[o%e.length],u=c.radius??t;if(u<=0){i(o,c),s=c;continue}const d=e[(o+1)%e.length],f=r(c,s),p=r(c,d);if(f.len<1e-4||p.len<1e-4){i(o,c),s=c;continue}let y=Math.asin(f.nx*p.ny-f.ny*p.nx),b=1,_=!1;f.nx*p.nx-f.ny*-p.ny<0?y<0?y=Math.PI+y:(y=Math.PI-y,b=-1,_=!0):y>0&&(b=-1,_=!0);const w=y/2;let S,A=Math.abs(Math.cos(w)*u/Math.sin(w));A>Math.min(f.len/2,p.len/2)?(A=Math.min(f.len/2,p.len/2),S=Math.abs(A*Math.sin(w)/Math.cos(w))):S=u;const M=c.x+p.nx*A+-p.ny*S*b,k=c.y+p.ny*A+p.nx*S*b,E=Math.atan2(f.ny,f.nx)+Math.PI/2*b,U=Math.atan2(p.ny,p.nx)-Math.PI/2*b;o===0&&n.moveTo(M+Math.cos(E)*S,k+Math.sin(E)*S),n.arc(M,k,S,E,U,_),s=c}}function GQ(n,e,t,r){const i=(c,u)=>Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2),s=(c,u,d)=>({x:c.x+(u.x-c.x)*d,y:c.y+(u.y-c.y)*d}),o=e.length;for(let c=0;c<o;c++){const u=e[(c+1)%o],d=u.radius??t;if(d<=0){c===0?n.moveTo(u.x,u.y):n.lineTo(u.x,u.y);continue}const f=e[c],p=e[(c+2)%o],y=i(f,u);let b;if(y<1e-4)b=u;else{const S=Math.min(y/2,d);b=s(u,f,S/y)}const _=i(p,u);let w;if(_<1e-4)w=u;else{const S=Math.min(_/2,d);w=s(u,p,S/_)}c===0?n.moveTo(b.x,b.y):n.lineTo(b.x,b.y),n.quadraticCurveTo(u.x,u.y,w.x,w.y,r)}}const HQ=new Qt;class VQ{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new qr,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,t){return this.startPoly(e,t),this}lineTo(e,t){this._ensurePoly();const r=this._currentPoly.points,i=r[r.length-2],s=r[r.length-1];return(i!==e||s!==t)&&r.push(e,t),this}arc(e,t,r,i,s,o){this._ensurePoly(!1);const c=this._currentPoly.points;return CR(c,e,t,r,i,s,o),this}arcTo(e,t,r,i,s){this._ensurePoly();const o=this._currentPoly.points;return OQ(o,e,t,r,i,s),this}arcToSvg(e,t,r,i,s,o,c){const u=this._currentPoly.points;return UQ(u,this._currentPoly.lastX,this._currentPoly.lastY,o,c,e,t,r,i,s),this}bezierCurveTo(e,t,r,i,s,o,c){this._ensurePoly();const u=this._currentPoly;return AR(this._currentPoly.points,u.lastX,u.lastY,e,t,r,i,s,o,c),this}quadraticCurveTo(e,t,r,i,s){this._ensurePoly();const o=this._currentPoly;return jQ(this._currentPoly.points,o.lastX,o.lastY,e,t,r,i,s),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0),e.transform(t));const r=this.shapePrimitives,i=r.length;for(let s=0;s<e.instructions.length;s++){const o=e.instructions[s];this[o.action](...o.data)}if(e.checkForHoles&&r.length-i>1){let s=null;for(let o=i;o<r.length;o++){const c=r[o];if(c.shape.type==="polygon"){const u=c.shape,d=s?.shape;d&&d.containsPolygon(u)?(s.holes||(s.holes=[]),s.holes.push(c),r.copyWithin(o,o+1),r.length--,o--):s=c}}}return this}finish(e=!1){this.endPoly(e)}rect(e,t,r,i,s){return this.drawShape(new Qt(e,t,r,i),s),this}circle(e,t,r,i){return this.drawShape(new bv(e,t,r),i),this}poly(e,t,r){const i=new $h(e);return i.closePath=t,this.drawShape(i,r),this}regularPoly(e,t,r,i,s=0,o){i=Math.max(i|0,3);const c=-1*Math.PI/2+s,u=Math.PI*2/i,d=[];for(let f=0;f<i;f++){const p=c-f*u;d.push(e+r*Math.cos(p),t+r*Math.sin(p))}return this.poly(d,!0,o),this}roundPoly(e,t,r,i,s,o=0,c){if(i=Math.max(i|0,3),s<=0)return this.regularPoly(e,t,r,i,o);const u=r*Math.sin(Math.PI/i)-.001;s=Math.min(s,u);const d=-1*Math.PI/2+o,f=Math.PI*2/i,p=(i-2)*Math.PI/i/2;for(let y=0;y<i;y++){const b=y*f+d,_=e+r*Math.cos(b),w=t+r*Math.sin(b),S=b+Math.PI+p,A=b-Math.PI-p,M=_+s*Math.cos(S),k=w+s*Math.sin(S),E=_+s*Math.cos(A),U=w+s*Math.sin(A);y===0?this.moveTo(M,k):this.lineTo(M,k),this.quadraticCurveTo(_,w,E,U,c)}return this.closePath()}roundShape(e,t,r=!1,i){return e.length<3?this:(r?GQ(this,e,t,i):FQ(this,e,t),this.closePath())}filletRect(e,t,r,i,s){if(s===0)return this.rect(e,t,r,i);const o=Math.min(r,i)/2,c=Math.min(o,Math.max(-o,s)),u=e+r,d=t+i,f=c<0?-c:0,p=Math.abs(c);return this.moveTo(e,t+p).arcTo(e+f,t+f,e+p,t,p).lineTo(u-p,t).arcTo(u-f,t+f,u,t+p,p).lineTo(u,d-p).arcTo(u-f,d-f,e+r-p,d,p).lineTo(e+p,d).arcTo(e+f,d-f,e,d-p,p).closePath()}chamferRect(e,t,r,i,s,o){if(s<=0)return this.rect(e,t,r,i);const c=Math.min(s,Math.min(r,i)/2),u=e+r,d=t+i,f=[e+c,t,u-c,t,u,t+c,u,d-c,u-c,d,e+c,d,e,d-c,e,t+c];for(let p=f.length-1;p>=2;p-=2)f[p]===f[p-2]&&f[p-1]===f[p-3]&&f.splice(p-1,2);return this.poly(f,!0,o)}ellipse(e,t,r,i,s){return this.drawShape(new xv(e,t,r,i),s),this}roundRect(e,t,r,i,s,o){return this.drawShape(new vv(e,t,r,i,s),o),this}drawShape(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}startPoly(e,t){let r=this._currentPoly;return r&&this.endPoly(),r=new $h,r.points.push(e,t),this._currentPoly=r,this}endPoly(e=!1){const t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new $h,e)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let r=t.shape.x,i=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const s=t.transform,o=r;r=s.a*r+s.c*i+s.tx,i=s.b*o+s.d*i+s.ty}this._currentPoly.points.push(r,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){const r=e.instructions[t];this[r.action](...r.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const t=this.shapePrimitives;for(let r=0;r<t.length;r++){const i=t[r],s=i.shape.getBounds(HQ);i.transform?e.addRect(s,i.transform):e.addRect(s)}return e}}class Ys{constructor(e,t=!1){this.instructions=[],this.uid=an("graphicsPath"),this._dirty=!0,this.checkForHoles=t,typeof e=="string"?wK(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new VQ(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,t,r,i,s){const o=this.instructions[this.instructions.length-1],c=this.getLastPoint(br.shared);let u=0,d=0;if(!o||o.action!=="bezierCurveTo")u=c.x,d=c.y;else{u=o.data[2],d=o.data[3];const f=c.x,p=c.y;u=f+(f-u),d=p+(p-d)}return this.instructions.push({action:"bezierCurveTo",data:[u,d,e,t,r,i,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,t,r){const i=this.instructions[this.instructions.length-1],s=this.getLastPoint(br.shared);let o=0,c=0;if(!i||i.action!=="quadraticCurveTo")o=s.x,c=s.y;else{o=i.data[0],c=i.data[1];const u=s.x,d=s.y;o=u+(u-o),c=d+(d-c)}return this.instructions.push({action:"quadraticCurveTo",data:[o,c,e,t,r]}),this._dirty=!0,this}rect(e,t,r,i,s){return this.instructions.push({action:"rect",data:[e,t,r,i,s]}),this._dirty=!0,this}circle(e,t,r,i){return this.instructions.push({action:"circle",data:[e,t,r,i]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,t,r,i,s,o,c){s||(s=i/2);const u=-1*Math.PI/2+o,d=r*2,f=Math.PI*2/d,p=[];for(let y=0;y<d;y++){const b=y%2?s:i,_=y*f+u;p.push(e+b*Math.cos(_),t+b*Math.sin(_))}return this.poly(p,!0,c),this}clone(e=!1){const t=new Ys;if(t.checkForHoles=this.checkForHoles,!e)t.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const i=this.instructions[r];t.instructions.push({action:i.action,data:i.data.slice()})}return t}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const t=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,c=e.ty;let u=0,d=0,f=0,p=0,y=0,b=0,_=0,w=0;for(let S=0;S<this.instructions.length;S++){const A=this.instructions[S],M=A.data;switch(A.action){case"moveTo":case"lineTo":u=M[0],d=M[1],M[0]=t*u+i*d+o,M[1]=r*u+s*d+c;break;case"bezierCurveTo":f=M[0],p=M[1],y=M[2],b=M[3],u=M[4],d=M[5],M[0]=t*f+i*p+o,M[1]=r*f+s*p+c,M[2]=t*y+i*b+o,M[3]=r*y+s*b+c,M[4]=t*u+i*d+o,M[5]=r*u+s*d+c;break;case"quadraticCurveTo":f=M[0],p=M[1],u=M[2],d=M[3],M[0]=t*f+i*p+o,M[1]=r*f+s*p+c,M[2]=t*u+i*d+o,M[3]=r*u+s*d+c;break;case"arcToSvg":u=M[5],d=M[6],_=M[0],w=M[1],M[0]=t*_+i*w,M[1]=r*_+s*w,M[5]=t*u+i*d+o,M[6]=r*u+s*d+c;break;case"circle":M[4]=yh(M[3],e);break;case"rect":M[4]=yh(M[4],e);break;case"ellipse":M[8]=yh(M[8],e);break;case"roundRect":M[5]=yh(M[5],e);break;case"addPath":M[0].transform(e);break;case"poly":M[2]=yh(M[2],e);break;default:ct("unknown transform action",A.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let t=this.instructions.length-1,r=this.instructions[t];if(!r)return e.x=0,e.y=0,e;for(;r.action==="closePath";){if(t--,t<0)return e.x=0,e.y=0,e;r=this.instructions[t]}switch(r.action){case"moveTo":case"lineTo":e.x=r.data[0],e.y=r.data[1];break;case"quadraticCurveTo":e.x=r.data[2],e.y=r.data[3];break;case"bezierCurveTo":e.x=r.data[4],e.y=r.data[5];break;case"arc":case"arcToSvg":e.x=r.data[5],e.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(e);break}return e}}function yh(n,e){return n?n.prepend(e):e.clone()}function In(n,e,t){const r=n.getAttribute(e);return r?Number(r):t}function WQ(n,e){const t=n.querySelectorAll("defs");for(let r=0;r<t.length;r++){const i=t[r];for(let s=0;s<i.children.length;s++){const o=i.children[s];switch(o.nodeName.toLowerCase()){case"lineargradient":e.defs[o.id]=YQ(o);break;case"radialgradient":e.defs[o.id]=$Q();break}}}}function YQ(n){const e=In(n,"x1",0),t=In(n,"y1",0),r=In(n,"x2",1),i=In(n,"y2",0),s=n.getAttribute("gradientUnits")||"objectBoundingBox",o=new Xs(e,t,r,i,s==="objectBoundingBox"?"local":"global");for(let c=0;c<n.children.length;c++){const u=n.children[c],d=In(u,"offset",0),f=An.shared.setValue(u.getAttribute("stop-color")).toNumber();o.addColorStop(d,f)}return o}function $Q(n){return ct("[SVG Parser] Radial gradients are not yet supported"),new Xs(0,0,1,0)}function AE(n){const e=n.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const CE={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function kR(n,e){const t=n.getAttribute("style"),r={},i={},s={strokeStyle:r,fillStyle:i,useFill:!1,useStroke:!1};for(const o in CE){const c=n.getAttribute(o);c&&kE(e,s,o,c.trim())}if(t){const o=t.split(";");for(let c=0;c<o.length;c++){const u=o[c].trim(),[d,f]=u.split(":");CE[d]&&kE(e,s,d,f.trim())}}return{strokeStyle:s.useStroke?r:null,fillStyle:s.useFill?i:null,useFill:s.useFill,useStroke:s.useStroke}}function kE(n,e,t,r){switch(t){case"stroke":if(r!=="none"){if(r.startsWith("url(")){const i=AE(r);e.strokeStyle.fill=n.defs[i]}else e.strokeStyle.color=An.shared.setValue(r).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(r);break;case"fill":if(r!=="none"){if(r.startsWith("url(")){const i=AE(r);e.fillStyle.fill=n.defs[i]}else e.fillStyle.color=An.shared.setValue(r).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(r);break;case"stroke-opacity":e.strokeStyle.alpha=Number(r);break;case"opacity":e.fillStyle.alpha=Number(r),e.strokeStyle.alpha=Number(r);break}}function qQ(n){if(n.length<=2)return!0;const e=n.map(c=>c.area).sort((c,u)=>u-c),[t,r]=e,i=e[e.length-1],s=t/r,o=r/i;return!(s>3&&o<2)}function ZQ(n){return n.split(/(?=[Mm])/).filter(r=>r.trim().length>0)}function XQ(n){const e=n.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!e||e.length<4)return 0;const t=e.map(Number),r=[],i=[];for(let f=0;f<t.length;f+=2)f+1<t.length&&(r.push(t[f]),i.push(t[f+1]));if(r.length===0||i.length===0)return 0;const s=Math.min(...r),o=Math.max(...r),c=Math.min(...i),u=Math.max(...i);return(o-s)*(u-c)}function TE(n,e){const t=new Ys(n,!1);for(const r of t.instructions)e.instructions.push(r)}function KQ(n,e){if(typeof n=="string"){const o=document.createElement("div");o.innerHTML=n.trim(),n=o.querySelector("svg")}const t={context:e,defs:{},path:new Ys};WQ(n,t);const r=n.children,{fillStyle:i,strokeStyle:s}=kR(n,t);for(let o=0;o<r.length;o++){const c=r[o];c.nodeName.toLowerCase()!=="defs"&&TR(c,t,i,s)}return e}function TR(n,e,t,r){const i=n.children,{fillStyle:s,strokeStyle:o}=kR(n,e);s&&t?t={...t,...s}:s&&(t=s),o&&r?r={...r,...o}:o&&(r=o);const c=!t&&!r;c&&(t={color:0});let u,d,f,p,y,b,_,w,S,A,M,k,E,U,I,B,G;switch(n.nodeName.toLowerCase()){case"path":{U=n.getAttribute("d");const R=n.getAttribute("fill-rule"),P=ZQ(U),H=R==="evenodd",Y=P.length>1;if(H&&Y){const q=P.map(N=>({path:N,area:XQ(N)}));if(q.sort((N,V)=>V.area-N.area),P.length>3||!qQ(q))for(let N=0;N<q.length;N++){const V=q[N],J=N===0;e.context.beginPath();const se=new Ys(void 0,!0);TE(V.path,se),e.context.path(se),J?(t&&e.context.fill(t),r&&e.context.stroke(r)):e.context.cut()}else for(let N=0;N<q.length;N++){const V=q[N],J=N%2===1;e.context.beginPath();const se=new Ys(void 0,!0);TE(V.path,se),e.context.path(se),J?e.context.cut():(t&&e.context.fill(t),r&&e.context.stroke(r))}}else{const q=R?R==="evenodd":!0;I=new Ys(U,q),e.context.path(I),t&&e.context.fill(t),r&&e.context.stroke(r)}break}case"circle":_=In(n,"cx",0),w=In(n,"cy",0),S=In(n,"r",0),e.context.ellipse(_,w,S,S),t&&e.context.fill(t),r&&e.context.stroke(r);break;case"rect":u=In(n,"x",0),d=In(n,"y",0),B=In(n,"width",0),G=In(n,"height",0),A=In(n,"rx",0),M=In(n,"ry",0),A||M?e.context.roundRect(u,d,B,G,A||M):e.context.rect(u,d,B,G),t&&e.context.fill(t),r&&e.context.stroke(r);break;case"ellipse":_=In(n,"cx",0),w=In(n,"cy",0),A=In(n,"rx",0),M=In(n,"ry",0),e.context.beginPath(),e.context.ellipse(_,w,A,M),t&&e.context.fill(t),r&&e.context.stroke(r);break;case"line":f=In(n,"x1",0),p=In(n,"y1",0),y=In(n,"x2",0),b=In(n,"y2",0),e.context.beginPath(),e.context.moveTo(f,p),e.context.lineTo(y,b),r&&e.context.stroke(r);break;case"polygon":E=n.getAttribute("points"),k=E.match(/\d+/g).map(R=>parseInt(R,10)),e.context.poly(k,!0),t&&e.context.fill(t),r&&e.context.stroke(r);break;case"polyline":E=n.getAttribute("points"),k=E.match(/\d+/g).map(R=>parseInt(R,10)),e.context.poly(k,!1),r&&e.context.stroke(r);break;case"g":case"svg":break;default:{ct(`[SVG parser] <${n.nodeName}> elements unsupported`);break}}c&&(t=null);for(let R=0;R<i.length;R++)TR(i[R],e,t,r)}function QQ(n){return An.isColorLike(n)}function EE(n){return n instanceof gg}function ME(n){return n instanceof Xs}function JQ(n){return n instanceof Ue}function eJ(n,e,t){const r=An.shared.setValue(e??0);return n.color=r.toNumber(),n.alpha=r.alpha===1?t.alpha:r.alpha,n.texture=Ue.WHITE,{...t,...n}}function tJ(n,e,t){return n.texture=e,{...t,...n}}function NE(n,e,t){return n.fill=e,n.color=16777215,n.texture=e.texture,n.matrix=e.transform,{...t,...n}}function IE(n,e,t){return e.buildGradient(),n.fill=e,n.color=16777215,n.texture=e.texture,n.matrix=e.transform,n.textureSpace=e.textureSpace,{...t,...n}}function nJ(n,e){const t={...e,...n},r=An.shared.setValue(t.color);return t.alpha*=r.alpha,t.color=r.toNumber(),t}function Io(n,e){if(n==null)return null;const t={},r=n;return QQ(n)?eJ(t,n,e):JQ(n)?tJ(t,n,e):EE(n)?NE(t,n,e):ME(n)?IE(t,n,e):r.fill&&EE(r.fill)?NE(r,r.fill,e):r.fill&&ME(r.fill)?IE(r,r.fill,e):nJ(r,e)}function Wp(n,e){const{width:t,alignment:r,miterLimit:i,cap:s,join:o,pixelLine:c,...u}=e,d=Io(n,u);return d?{width:t,alignment:r,miterLimit:i,cap:s,join:o,pixelLine:c,...d}:null}const rJ=new br,RE=new We,Cv=class ss extends zi{constructor(){super(...arguments),this.uid=an("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Ys,this._transform=new We,this._fillStyle={...ss.defaultFillStyle},this._strokeStyle={...ss.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new qr,this._boundsDirty=!0}clone(){const e=new ss;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Io(e,ss.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Wp(e,ss.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Io(e,ss.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Io(e,ss.defaultStrokeStyle),this}texture(e,t,r,i,s,o){return this.instructions.push({action:"texture",data:{image:e,dx:r||0,dy:i||0,dw:s||e.frame.width,dh:o||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?An.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Ys,this}fill(e,t){let r;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i?.action==="stroke"?r=i.data.path:r=this._activePath.clone(),r?(e!=null&&(t!==void 0&&typeof e=="number"&&(it(Yt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:t}),this._fillStyle=Io(e,ss.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:t}=this._activePath.getLastPoint(br.shared);this._activePath.clear(),this._activePath.moveTo(e,t)}stroke(e){let t;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r?.action==="fill"?t=r.data.path:t=this._activePath.clone(),t?(e!=null&&(this._strokeStyle=Wp(e,ss.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:t}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const t=this.instructions[this.instructions.length-1-e],r=this._activePath.clone();if(t&&(t.action==="stroke"||t.action==="fill"))if(t.data.hole)t.data.hole.addPath(r);else{t.data.hole=r;break}}return this._initNextPathLocation(),this}arc(e,t,r,i,s,o){this._tick++;const c=this._transform;return this._activePath.arc(c.a*e+c.c*t+c.tx,c.b*e+c.d*t+c.ty,r,i,s,o),this}arcTo(e,t,r,i,s){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,s),this}arcToSvg(e,t,r,i,s,o,c){this._tick++;const u=this._transform;return this._activePath.arcToSvg(e,t,r,i,s,u.a*o+u.c*c+u.tx,u.b*o+u.d*c+u.ty),this}bezierCurveTo(e,t,r,i,s,o,c){this._tick++;const u=this._transform;return this._activePath.bezierCurveTo(u.a*e+u.c*t+u.tx,u.b*e+u.d*t+u.ty,u.a*r+u.c*i+u.tx,u.b*r+u.d*i+u.ty,u.a*s+u.c*o+u.tx,u.b*s+u.d*o+u.ty,c),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,t,r,i){return this._tick++,this._activePath.ellipse(e,t,r,i,this._transform.clone()),this}circle(e,t,r){return this._tick++,this._activePath.circle(e,t,r,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,t){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*e+r.c*t+r.tx,r.b*e+r.d*t+r.ty),this}moveTo(e,t){this._tick++;const r=this._transform,i=this._activePath.instructions,s=r.a*e+r.c*t+r.tx,o=r.b*e+r.d*t+r.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=s,i[0].data[1]=o,this):(this._activePath.moveTo(s,o),this)}quadraticCurveTo(e,t,r,i,s){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,s),this}rect(e,t,r,i){return this._tick++,this._activePath.rect(e,t,r,i,this._transform.clone()),this}roundRect(e,t,r,i,s){return this._tick++,this._activePath.roundRect(e,t,r,i,s,this._transform.clone()),this}poly(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}regularPoly(e,t,r,i,s=0,o){return this._tick++,this._activePath.regularPoly(e,t,r,i,s,o),this}roundPoly(e,t,r,i,s,o){return this._tick++,this._activePath.roundPoly(e,t,r,i,s,o),this}roundShape(e,t,r,i){return this._tick++,this._activePath.roundShape(e,t,r,i),this}filletRect(e,t,r,i,s){return this._tick++,this._activePath.filletRect(e,t,r,i,s),this}chamferRect(e,t,r,i,s,o){return this._tick++,this._activePath.chamferRect(e,t,r,i,s,o),this}star(e,t,r,i,s=0,o=0){return this._tick++,this._activePath.star(e,t,r,i,s,o,this._transform.clone()),this}svg(e){return this._tick++,KQ(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,t=e){return this._transform.scale(e,t),this}setTransform(e,t,r,i,s,o){return e instanceof We?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,r,i,s,o),this)}transform(e,t,r,i,s,o){return e instanceof We?(this._transform.append(e),this):(RE.set(e,t,r,i,s,o),this._transform.append(RE),this)}translate(e,t=e){return this._transform.translate(e,t),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){const r=this.instructions[t],i=r.action;if(i==="fill"){const s=r.data;e.addBounds(s.path.bounds)}else if(i==="texture"){const s=r.data;e.addFrame(s.dx,s.dy,s.dx+s.dw,s.dy+s.dh,s.transform)}if(i==="stroke"){const s=r.data,o=s.style.alignment,c=s.style.width*(1-o),u=s.path.bounds;e.addFrame(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const t=this.instructions;let r=!1;for(let i=0;i<t.length;i++){const s=t[i],o=s.data,c=o.path;if(!s.action||!c)continue;const u=o.style,d=c.shapePath.shapePrimitives;for(let f=0;f<d.length;f++){const p=d[f].shape;if(!u||!p)continue;const y=d[f].transform,b=y?y.applyInverse(e,rJ):e;if(s.action==="fill")r=p.contains(b.x,b.y);else{const w=u;r=p.strokeContains(b.x,b.y,w.width,w.alignment)}const _=o.hole;if(_){const w=_.shapePath?.shapePrimitives;if(w)for(let S=0;S<w.length;S++)w[S].shape.contains(b.x,b.y)&&(r=!1)}if(r)return!0}}return r}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(r)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(r))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Cv.defaultFillStyle={color:16777215,alpha:1,texture:Ue.WHITE,matrix:null,fill:null,textureSpace:"local"};Cv.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Ue.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Di=Cv;const kv=class sc extends zi{constructor(e={}){super(),this.uid=an("textStyle"),this._tick=0,iJ(e);const t={...sc.defaultTextStyle,...e};for(const r in t){const i=r;this[i]=t[r]}this.update(),this._tick=0}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.update())}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...sc.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...sc.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.update())}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.update())}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.update())}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.update())}get filters(){return this._filters}set filters(e){this._filters!==e&&(this._filters=Object.freeze(e),this.update())}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.update())}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...Di.defaultFillStyle,...e},()=>{this._fill=Io({...this._originalFill},Di.defaultFillStyle)})),this._fill=Io(e===0?"black":e,Di.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...Di.defaultStrokeStyle,...e},()=>{this._stroke=Wp({...this._originalStroke},Di.defaultStrokeStyle)})),this._stroke=Wp(e,Di.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const e=sc.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new sc({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let e=0;if(this._filters)for(let t=0;t<this._filters.length;t++)e+=this._filters[t].padding;return Math.max(this._padding,e)}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const r=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(r),this._originalFill?.texture&&this._originalFill.texture.destroy(r),this._stroke?.texture&&this._stroke.texture.destroy(r),this._originalStroke?.texture&&this._originalStroke.texture.destroy(r)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,t){return new Proxy(e,{set:(r,i,s)=>(r[i]===s||(r[i]=s,t?.(i,s),this.update()),!0)})}_isFillStyle(e){return(e??null)!==null&&!(An.isColorLike(e)||e instanceof Xs||e instanceof gg)}};kv.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};kv.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let vd=kv;function iJ(n){const e=n;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const t=vd.defaultDropShadow;n.dropShadow={alpha:e.dropShadowAlpha??t.alpha,angle:e.dropShadowAngle??t.angle,blur:e.dropShadowBlur??t.blur,color:e.dropShadowColor??t.color,distance:e.dropShadowDistance??t.distance}}if(e.strokeThickness!==void 0){it(Yt,"strokeThickness is now a part of stroke");const t=e.stroke;let r={};if(An.isColorLike(t))r.color=t;else if(t instanceof Xs||t instanceof gg)r.fill=t;else if(Object.hasOwnProperty.call(t,"color")||Object.hasOwnProperty.call(t,"fill"))r=t;else throw new Error("Invalid stroke value.");n.stroke={...r,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){if(it(Yt,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(e.fill)||e.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");e.fill.length!==e.fillGradientStops.length&&ct("The number of fill colors must match the number of fill gradient stops.");const t=new Xs({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),r=e.fillGradientStops.slice(),i=e.fill.map(s=>An.shared.setValue(s).toNumber());r.forEach((s,o)=>{t.addColorStop(s,i[o])}),n.fill={fill:t}}}class sJ{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const r=Dt.get().createCanvas();r.width=e,r.height=t;const i=r.getContext("2d");return{canvas:r,context:i}}getOptimalCanvasAndContext(e,t,r=1){e=Math.ceil(e*r-1e-6),t=Math.ceil(t*r-1e-6),e=zp(e),t=zp(t);const i=(e<<17)+(t<<1);this._canvasPool[i]||(this._canvasPool[i]=[]);let s=this._canvasPool[i].pop();return s||(s=this._createCanvasAndContext(e,t)),s}returnCanvasAndContext(e){const t=e.canvas,{width:r,height:i}=t,s=(r<<17)+(i<<1);e.context.resetTransform(),e.context.clearRect(0,0,r,i),this._canvasPool[s].push(e)}clear(){this._canvasPool={}}}const X1=new sJ;Oc.register(X1);const PE=1e5;function DE(n,e,t,r=0){if(n.texture===Ue.WHITE&&!n.fill)return An.shared.setValue(n.color).setAlpha(n.alpha??1).toHexa();if(n.fill){if(n.fill instanceof gg){const i=n.fill,s=e.createPattern(i.texture.source.resource,"repeat"),o=i.transform.copyTo(We.shared);return o.scale(i.texture.frame.width,i.texture.frame.height),s.setTransform(o),s}else if(n.fill instanceof Xs){const i=n.fill,s=i.type==="linear",o=i.textureSpace==="local";let c=1,u=1;o&&t&&(c=t.width+r,u=t.height+r);let d,f=!1;if(s){const{start:p,end:y}=i;d=e.createLinearGradient(p.x*c,p.y*u,y.x*c,y.y*u),f=Math.abs(y.x-p.x)<Math.abs((y.y-p.y)*.1)}else{const{center:p,innerRadius:y,outerCenter:b,outerRadius:_}=i;d=e.createRadialGradient(p.x*c,p.y*u,y*c,b.x*c,b.y*u,_*c)}if(f&&o&&t){const p=t.lineHeight/u;for(let y=0;y<t.lines.length;y++){const b=(y*t.lineHeight+r/2)/u;i.colorStops.forEach(_=>{const w=b+_.offset*p;d.addColorStop(Math.floor(w*PE)/PE,An.shared.setValue(_.color).toHex())})}}else i.colorStops.forEach(p=>{d.addColorStop(p.offset,An.shared.setValue(p.color).toHex())});return d}}else{const i=e.createPattern(n.texture.source.resource,"repeat"),s=n.matrix.copyTo(We.shared);return s.scale(n.texture.frame.width,n.texture.frame.height),i.setTransform(s),i}return ct("FillStyle not recognised",n),"red"}const ER=class MR extends iR{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const t={...MR.defaultOptions,...e};this._textureSize=t.textureSize,this._mipmap=t.mipmap;const r=t.style.clone();t.overrideFill&&(r._fill.color=16777215,r._fill.alpha=1,r._fill.texture=Ue.WHITE,r._fill.fill=null),this.applyFillAsTint=t.overrideFill;const i=r.fontSize;r.fontSize=this.baseMeasurementFontSize;const s=W1(r);t.overrideSize?r._stroke&&(r._stroke.width*=this.baseRenderedFontSize/i):r.fontSize=this.baseRenderedFontSize=i,this._style=r,this._skipKerning=t.skipKerning??!1,this.resolution=t.resolution??1,this._padding=t.padding??4,t.textureStyle&&(this._textureStyle=t.textureStyle instanceof md?t.textureStyle:new md(t.textureStyle)),this.fontMetrics=mp.measureFont(s),this.lineHeight=r.lineHeight||this.fontMetrics.fontSize||r.fontSize}ensureCharacters(e){const t=mp.graphemeSegmenter(e).filter(S=>!this._currentChars.includes(S)).filter((S,A,M)=>M.indexOf(S)===A);if(!t.length)return;this._currentChars=[...this._currentChars,...t];let r;this._currentPageIndex===-1?r=this._nextPage():r=this.pages[this._currentPageIndex];let{canvas:i,context:s}=r.canvasAndContext,o=r.texture.source;const c=this._style;let u=this._currentX,d=this._currentY,f=this._currentMaxCharHeight;const p=this.baseRenderedFontSize/this.baseMeasurementFontSize,y=this._padding*p;let b=!1;const _=i.width/this.resolution,w=i.height/this.resolution;for(let S=0;S<t.length;S++){const A=t[S],M=mp.measureText(A,c,i,!1);M.lineHeight=M.height;const k=M.width*p,E=Math.ceil((c.fontStyle==="italic"?2:1)*k),U=M.height*p,I=E+y*2,B=U+y*2;if(b=!1,A!==`
`&&A!=="\r"&&A!=="	"&&A!==" "&&(b=!0,f=Math.ceil(Math.max(B,f))),u+I>_&&(d+=f,f=B,u=0,d+f>w)){o.update();const R=this._nextPage();i=R.canvasAndContext.canvas,s=R.canvasAndContext.context,o=R.texture.source,u=0,d=0,f=0}const G=k/p-(c.dropShadow?.distance??0)-(c._stroke?.width??0);if(this.chars[A]={id:A.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:G,kerning:{}},b){this._drawGlyph(s,M,u+y,d+y,p,c);const R=o.width*p,P=o.height*p,H=new Qt(u/R*o.width,d/P*o.height,I/R*o.width,B/P*o.height);this.chars[A].texture=new Ue({source:o,frame:H}),u+=Math.ceil(I)}}o.update(),this._currentX=u,this._currentY=d,this._currentMaxCharHeight=f,this._skipKerning&&this._applyKerning(t,s)}get pageTextures(){return it(Yt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,t){const r=this._measureCache;for(let i=0;i<e.length;i++){const s=e[i];for(let o=0;o<this._currentChars.length;o++){const c=this._currentChars[o];let u=r[s];u||(u=r[s]=t.measureText(s).width);let d=r[c];d||(d=r[c]=t.measureText(c).width);let f=t.measureText(s+c).width,p=f-(u+d);p&&(this.chars[s].kerning[c]=p),f=t.measureText(s+c).width,p=f-(u+d),p&&(this.chars[c].kerning[s]=p)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,t=X1.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(t.context,this._style,e);const r=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),i=new Ue({source:new Wo({resource:t.canvas,resolution:r,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(i.source.style=this._textureStyle);const s={canvasAndContext:t,texture:i};return this.pages[this._currentPageIndex]=s,s}_setupContext(e,t,r){t.fontSize=this.baseRenderedFontSize,e.scale(r,r),e.font=W1(t),t.fontSize=this.baseMeasurementFontSize,e.textBaseline=t.textBaseline;const i=t._stroke,s=i?.width??0;if(i&&(e.lineWidth=s,e.lineJoin=i.join,e.miterLimit=i.miterLimit,e.strokeStyle=DE(i,e)),t._fill&&(e.fillStyle=DE(t._fill,e)),t.dropShadow){const o=t.dropShadow,c=An.shared.setValue(o.color).toArray(),u=o.blur*r,d=o.distance*r;e.shadowColor=`rgba(${c[0]*255},${c[1]*255},${c[2]*255},${o.alpha})`,e.shadowBlur=u,e.shadowOffsetX=Math.cos(o.angle)*d,e.shadowOffsetY=Math.sin(o.angle)*d}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,t,r,i,s,o){const c=t.text,u=t.fontProperties,f=(o._stroke?.width??0)*s,p=r+f/2,y=i-f/2,b=u.descent*s,_=t.lineHeight*s;let w=!1;o.stroke&&f&&(w=!0,e.strokeText(c,p,y+_-b));const{shadowBlur:S,shadowOffsetX:A,shadowOffsetY:M}=e;o._fill&&(w&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillText(c,p,y+_-b)),w&&(e.shadowBlur=S,e.shadowOffsetX=A,e.shadowOffsetY=M)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:t,texture:r}=this.pages[e];X1.returnCanvasAndContext(t),r.destroy(!0)}this.pages=null}};ER.defaultOptions={textureSize:512,style:new vd,mipmap:!0};let jE=ER;function aJ(n,e,t,r){const i={width:0,height:0,offsetY:0,scale:e.fontSize/t.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=t.baseLineOffset;let s=i.lines[0],o=null,c=!0;const u={width:0,start:0,index:0,positions:[],chars:[]},d=t.baseMeasurementFontSize/e.fontSize,f=e.letterSpacing*d,p=e.wordWrapWidth*d,y=e.lineHeight?e.lineHeight*d:t.lineHeight,b=e.wordWrap&&e.breakWords,_=A=>{const M=s.width;for(let k=0;k<u.index;k++){const E=A.positions[k];s.chars.push(A.chars[k]),s.charPositions.push(E+M)}s.width+=A.width,c=!1,u.width=0,u.index=0,u.chars.length=0},w=()=>{let A=s.chars.length-1;if(r){let M=s.chars[A];for(;M===" ";)s.width-=t.chars[M].xAdvance,M=s.chars[--A]}i.width=Math.max(i.width,s.width),s={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},c=!0,i.lines.push(s),i.height+=y},S=A=>A-f>p;for(let A=0;A<n.length+1;A++){let M;const k=A===n.length;k||(M=n[A]);const E=t.chars[M]||t.chars[" "];if(/(?:\s)/.test(M)||M==="\r"||M===`
`||k){if(!c&&e.wordWrap&&S(s.width+u.width)?(w(),_(u),k||s.charPositions.push(0)):(u.start=s.width,_(u),k||s.charPositions.push(0)),M==="\r"||M===`
`)w();else if(!k){const G=E.xAdvance+(E.kerning[o]||0)+f;s.width+=G,s.spaceWidth=G,s.spacesIndex.push(s.charPositions.length),s.chars.push(M)}}else{const B=E.kerning[o]||0,G=E.xAdvance+B+f;b&&S(s.width+u.width+G)&&(_(u),w()),u.positions[u.index++]=u.width+B,u.chars.push(M),u.width+=G}o=M}return w(),e.align==="center"?oJ(i):e.align==="right"?lJ(i):e.align==="justify"&&cJ(i),i}function oJ(n){for(let e=0;e<n.lines.length;e++){const t=n.lines[e],r=n.width/2-t.width/2;for(let i=0;i<t.charPositions.length;i++)t.charPositions[i]+=r}}function lJ(n){for(let e=0;e<n.lines.length;e++){const t=n.lines[e],r=n.width-t.width;for(let i=0;i<t.charPositions.length;i++)t.charPositions[i]+=r}}function cJ(n){const e=n.width;for(let t=0;t<n.lines.length;t++){const r=n.lines[t];let i=0,s=r.spacesIndex[i++],o=0;const c=r.spacesIndex.length,d=(e-r.width)/c;for(let f=0;f<r.charPositions.length;f++)f===s&&(s=r.spacesIndex[i++],o+=d),r.charPositions[f]+=o}}function uJ(n){if(n==="")return[];typeof n=="string"&&(n=[n]);const e=[];for(let t=0,r=n.length;t<r;t++){const i=n[t];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);if(i[0].length===0||i[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let c=s,u=o;c<=u;c++)e.push(String.fromCharCode(c))}else e.push(...Array.from(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}let Vm=0;class hJ{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=sR(1e3)}getFont(e,t){let r=`${t.fontFamily}-bitmap`,i=!0;if(t._fill.fill&&!t._stroke?(r+=t._fill.fill.styleKey,i=!1):(t._stroke||t.dropShadow)&&(r=`${t.styleKey}-bitmap`,i=!1),!un.has(r)){const o=Object.create(t);o.lineHeight=0;const c=new jE({style:o,overrideFill:i,overrideSize:!0,...this.defaultOptions});Vm++,Vm>50&&ct("BitmapText",`You have dynamically created ${Vm} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),c.once("destroy",()=>{Vm--,un.remove(r)}),un.set(r,c)}const s=un.get(r);return s.ensureCharacters?.(e),s}getLayout(e,t,r=!0){const i=this.getFont(e,t),s=`${e}-${t.styleKey}-${r}`;if(this.measureCache.has(s))return this.measureCache.get(s);const o=mp.graphemeSegmenter(e),c=aJ(o,t,i,r);return this.measureCache.set(s,c),c}measureText(e,t,r=!0){return this.getLayout(e,t,r)}install(...e){let t=e[0];typeof t=="string"&&(t={name:t,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},it(Yt,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const r=t?.name;if(!r)throw new Error("[BitmapFontManager] Property `name` is required.");t={...this.defaultOptions,...t};const i=t.style,s=i instanceof vd?i:new vd(i),o=t.dynamicFill??this._canUseTintForStyle(s),c=new jE({style:s,overrideFill:o,skipKerning:t.skipKerning,padding:t.padding,resolution:t.resolution,overrideSize:!1,textureStyle:t.textureStyle}),u=uJ(t.chars);return c.ensureCharacters(u.join("")),un.set(`${r}-bitmap`,c),c.once("destroy",()=>un.remove(`${r}-bitmap`)),c}uninstall(e){const t=`${e}-bitmap`,r=un.get(t);r&&r.destroy()}_canUseTintForStyle(e){return!e._stroke&&(!e.dropShadow||e.dropShadow.color===0)&&!e._fill.fill&&e._fill.color===16777215}}const K1=new hJ;class NR extends iR{constructor(e,t){super();const{textures:r,data:i}=e;Object.keys(i.pages).forEach(s=>{const o=i.pages[parseInt(s,10)],c=r[o.id];this.pages.push({texture:c})}),Object.keys(i.chars).forEach(s=>{const o=i.chars[s],{frame:c,source:u,rotate:d}=r[o.page],f=Vt.transformRectCoords(o,c,d,new Qt),p=new Ue({frame:f,orig:new Qt(0,0,o.width,o.height),source:u,rotate:d});this.chars[s]={id:s.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:p}}),this.baseRenderedFontSize=i.fontSize,this.baseMeasurementFontSize=i.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:i.fontSize},this.baseLineOffset=i.baseLineOffset,this.lineHeight=i.lineHeight,this.fontFamily=i.fontFamily,this.distanceField=i.distanceField??{type:"none",range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){K1.install(e)}static uninstall(e){K1.uninstall(e)}}const cx={test(n){return typeof n=="string"&&n.startsWith("info face=")},parse(n){const e=n.match(/^[a-z]+\s+.+$/gm),t={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const p in e){const y=e[p].match(/^[a-z]+/gm)[0],b=e[p].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),_={};for(const w in b){const S=b[w].split("="),A=S[0],M=S[1].replace(/"/gm,""),k=parseFloat(M),E=isNaN(k)?M:k;_[A]=E}t[y].push(_)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[i]=t.info,[s]=t.common,[o]=t.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(i.size,10),r.fontFamily=i.face,r.lineHeight=parseInt(s.lineHeight,10);const c=t.page;for(let p=0;p<c.length;p++)r.pages.push({id:parseInt(c[p].id,10)||0,file:c[p].file});const u={};r.baseLineOffset=r.lineHeight-parseInt(s.base,10);const d=t.char;for(let p=0;p<d.length;p++){const y=d[p],b=parseInt(y.id,10);let _=y.letter??y.char??String.fromCharCode(b);_==="space"&&(_=" "),u[b]=_,r.chars[_]={id:b,page:parseInt(y.page,10)||0,x:parseInt(y.x,10),y:parseInt(y.y,10),width:parseInt(y.width,10),height:parseInt(y.height,10),xOffset:parseInt(y.xoffset,10),yOffset:parseInt(y.yoffset,10),xAdvance:parseInt(y.xadvance,10),kerning:{}}}const f=t.kerning||[];for(let p=0;p<f.length;p++){const y=parseInt(f[p].first,10),b=parseInt(f[p].second,10),_=parseInt(f[p].amount,10);r.chars[u[b]].kerning[u[y]]=_}return r}},BE={test(n){const e=n;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(n){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},t=n.getElementsByTagName("info")[0],r=n.getElementsByTagName("common")[0],i=n.getElementsByTagName("distanceField")[0];i&&(e.distanceField={type:i.getAttribute("fieldType"),range:parseInt(i.getAttribute("distanceRange"),10)});const s=n.getElementsByTagName("page"),o=n.getElementsByTagName("char"),c=n.getElementsByTagName("kerning");e.fontSize=parseInt(t.getAttribute("size"),10),e.fontFamily=t.getAttribute("face"),e.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let d=0;d<s.length;d++)e.pages.push({id:parseInt(s[d].getAttribute("id"),10)||0,file:s[d].getAttribute("file")});const u={};e.baseLineOffset=e.lineHeight-parseInt(r.getAttribute("base"),10);for(let d=0;d<o.length;d++){const f=o[d],p=parseInt(f.getAttribute("id"),10);let y=f.getAttribute("letter")??f.getAttribute("char")??String.fromCharCode(p);y==="space"&&(y=" "),u[p]=y,e.chars[y]={id:p,page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xOffset:parseInt(f.getAttribute("xoffset"),10),yOffset:parseInt(f.getAttribute("yoffset"),10),xAdvance:parseInt(f.getAttribute("xadvance"),10),kerning:{}}}for(let d=0;d<c.length;d++){const f=parseInt(c[d].getAttribute("first"),10),p=parseInt(c[d].getAttribute("second"),10),y=parseInt(c[d].getAttribute("amount"),10);e.chars[u[p]].kerning[u[f]]=y}return e}},OE={test(n){return typeof n=="string"&&n.match(/<font(\s|>)/)?BE.test(Dt.get().parseXML(n)):!1},parse(n){return BE.parse(Dt.get().parseXML(n))}},dJ=[".xml",".fnt"],fJ={extension:{type:me.CacheParser,name:"cacheBitmapFont"},test:n=>n instanceof NR,getCacheableAssets(n,e){const t={};return n.forEach(r=>{t[r]=e,t[`${r}-bitmap`]=e}),t[`${e.fontFamily}-bitmap`]=e,t}},mJ={extension:{type:me.LoadParser,priority:Za.Normal},name:"loadBitmapFont",id:"bitmap-font",test(n){return dJ.includes(mi.extname(n).toLowerCase())},async testParse(n){return cx.test(n)||OE.test(n)},async parse(n,e,t){const r=cx.test(n)?cx.parse(n):OE.parse(n),{src:i}=e,{pages:s}=r,o=[],c=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let p=0;p<s.length;++p){const y=s[p].file;let b=mi.join(mi.dirname(i),y);b=O1(b,i),o.push({src:b,data:c})}const u=await t.load(o),d=o.map(p=>u[p.src]);return new NR({data:r,textures:d},i)},async load(n,e){return await(await Dt.get().fetch(n)).text()},async unload(n,e,t){await Promise.all(n.pages.map(r=>t.unload(r.texture.source._sourceOrigin))),n.destroy()}};class pJ{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<t;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const gJ={extension:{type:me.CacheParser,name:"cacheTextureArray"},test:n=>Array.isArray(n)&&n.every(e=>e instanceof Ue),getCacheableAssets:(n,e)=>{const t={};return n.forEach(r=>{e.forEach((i,s)=>{t[r+(s===0?"":s+1)]=i})}),t}};async function IR(n){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=n});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(n)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const yJ={extension:{type:me.DetectionParser,priority:1},test:async()=>IR("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async n=>[...n,"avif"],remove:async n=>n.filter(e=>e!=="avif")},LE=["png","jpg","jpeg"],bJ={extension:{type:me.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...LE],remove:async n=>n.filter(e=>!LE.includes(e))},xJ="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function bg(n){return xJ?!1:document.createElement("video").canPlayType(n)!==""}const vJ={extension:{type:me.DetectionParser,priority:0},test:async()=>bg("video/mp4"),add:async n=>[...n,"mp4","m4v"],remove:async n=>n.filter(e=>e!=="mp4"&&e!=="m4v")},_J={extension:{type:me.DetectionParser,priority:0},test:async()=>bg("video/ogg"),add:async n=>[...n,"ogv"],remove:async n=>n.filter(e=>e!=="ogv")},wJ={extension:{type:me.DetectionParser,priority:0},test:async()=>bg("video/webm"),add:async n=>[...n,"webm"],remove:async n=>n.filter(e=>e!=="webm")},SJ={extension:{type:me.DetectionParser,priority:0},test:async()=>IR("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async n=>[...n,"webp"],remove:async n=>n.filter(e=>e!=="webp")},RR=class pp{constructor(){this.loadOptions={...pp.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,r)=>(this._parsersValidated=!1,e[t]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const r={promise:null,parser:null};return r.promise=(async()=>{let i=null,s=null;if((t.parser||t.loadParser)&&(s=this._parserHash[t.parser||t.loadParser],t.loadParser&&ct(`[Assets] "loadParser" is deprecated, use "parser" instead for ${e}`),s||ct(`[Assets] specified load parser "${t.parser||t.loadParser}" not found while loading ${e}`)),!s){for(let o=0;o<this.parsers.length;o++){const c=this.parsers[o];if(c.load&&c.test?.(e,t,this)){s=c;break}}if(!s)return ct(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(e,t,this),r.parser=s;for(let o=0;o<this.parsers.length;o++){const c=this.parsers[o];c.parse&&c.parse&&await c.testParse?.(i,t,this)&&(i=await c.parse(i,t,this)||i,r.parser=c)}return i})(),r}async load(e,t){this._parsersValidated||this._validateParsers();const r=typeof t=="function"?{...pp.defaultOptions,...this.loadOptions,onProgress:t}:{...pp.defaultOptions,...this.loadOptions,...t||{}},{onProgress:i,onError:s,strategy:o,retryCount:c,retryDelay:u}=r;let d=0;const f={},p=Hp(e),y=Yi(e,w=>({alias:[w],src:w,data:{}})),b=y.reduce((w,S)=>w+(S.progressSize||1),0),_=y.map(async w=>{const S=mi.toAbsolute(w.src);f[w.src]||(await this._loadAssetWithRetry(S,w,{onProgress:i,onError:s,strategy:o,retryCount:c,retryDelay:u},f),d+=w.progressSize||1,i&&i(d/b))});return await Promise.all(_),p?f[y[0].src]:f}async unload(e){const r=Yi(e,i=>({alias:[i],src:i})).map(async i=>{const s=mi.toAbsolute(i.src),o=this.promiseCache[s];if(o){const c=await o.promise;delete this.promiseCache[s],await o.parser?.unload?.(c,i,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name||e.id).reduce((e,t)=>(!t.name&&!t.id?ct("[Assets] parser should have an id"):(e[t.name]||e[t.id])&&ct(`[Assets] parser id conflict "${t.id}"`),e[t.name]=t,t.id&&(e[t.id]=t),e),{})}async _loadAssetWithRetry(e,t,r,i){let s=0;const{onError:o,strategy:c,retryCount:u,retryDelay:d}=r,f=p=>new Promise(y=>setTimeout(y,p));for(;;)try{this.promiseCache[e]||(this.promiseCache[e]=this._getLoadPromiseAndParser(e,t)),i[t.src]=await this.promiseCache[e].promise;return}catch(p){delete this.promiseCache[e],delete i[t.src],s++;const y=c!=="retry"||s>u;if(c==="retry"&&!y){o&&o(p,t),await f(d);continue}if(c==="skip"){o&&o(p,t);return}throw o&&o(p,t),new Error(`[Loader.load] Failed to load ${e}.
${p}`)}}};RR.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let AJ=RR;function Uc(n,e){if(Array.isArray(e)){for(const t of e)if(n.startsWith(`data:${t}`))return!0;return!1}return n.startsWith(`data:${e}`)}function Fc(n,e){const t=n.split("?")[0],r=mi.extname(t).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const CJ=".json",kJ="application/json",TJ={extension:{type:me.LoadParser,priority:Za.Low},name:"loadJson",id:"json",test(n){return Uc(n,kJ)||Fc(n,CJ)},async load(n){return await(await Dt.get().fetch(n)).json()}},EJ=".txt",MJ="text/plain",NJ={name:"loadTxt",id:"text",extension:{type:me.LoadParser,priority:Za.Low,name:"loadTxt"},test(n){return Uc(n,MJ)||Fc(n,EJ)},async load(n){return await(await Dt.get().fetch(n)).text()}},IJ=["normal","bold","100","200","300","400","500","600","700","800","900"],RJ=[".ttf",".otf",".woff",".woff2"],PJ=["font/ttf","font/otf","font/woff","font/woff2"],DJ=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function jJ(n){const e=mi.extname(n),i=mi.basename(n,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1));let s=i.length>0;for(const c of i)if(!c.match(DJ)){s=!1;break}let o=i.join(" ");return s||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const BJ=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function OJ(n){return BJ.test(n)?n:encodeURI(n)}const LJ={extension:{type:me.LoadParser,priority:Za.Low},name:"loadWebFont",id:"web-font",test(n){return Uc(n,PJ)||Fc(n,RJ)},async load(n,e){const t=Dt.get().getFontFaceSet();if(t){const r=[],i=e.data?.family??jJ(n),s=e.data?.weights?.filter(c=>IJ.includes(c))??["normal"],o=e.data??{};for(let c=0;c<s.length;c++){const u=s[c],d=new FontFace(i,`url(${OJ(n)})`,{...o,weight:u});await d.load(),t.add(d),r.push(d)}return un.has(`${i}-and-url`)?un.get(`${i}-and-url`).entries.push({url:n,faces:r}):un.set(`${i}-and-url`,{entries:[{url:n,faces:r}]}),r.length===1?r[0]:r}return ct("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){const e=Array.isArray(n)?n:[n],t=e[0].family,r=un.get(`${t}-and-url`),i=r.entries.find(s=>s.faces.some(o=>e.indexOf(o)!==-1));i.faces=i.faces.filter(s=>e.indexOf(s)===-1),i.faces.length===0&&(r.entries=r.entries.filter(s=>s!==i)),e.forEach(s=>{Dt.get().getFontFaceSet().delete(s)}),r.entries.length===0&&un.remove(`${t}-and-url`)}};function Tv(n,e=1){const t=Lc.RETINA_PREFIX?.exec(n);return t?parseFloat(t[1]):e}function Ev(n,e,t){n.label=t,n._sourceOrigin=t;const r=new Ue({source:n,label:t}),i=()=>{delete e.promiseCache[t],un.has(t)&&un.remove(t)};return r.source.once("destroy",()=>{e.promiseCache[t]&&(ct("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),r.once("destroy",()=>{n.destroyed||(ct("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),r}const zJ=".svg",UJ="image/svg+xml",FJ={extension:{type:me.LoadParser,priority:Za.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(n){return Uc(n,UJ)||Fc(n,zJ)},async load(n,e,t){return e.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?HJ(n):GJ(n,e,t,this.config.crossOrigin)},unload(n){n.destroy(!0)}};async function GJ(n,e,t,r){const i=await Dt.get().fetch(n),s=Dt.get().createImage();s.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await i.text())}`,s.crossOrigin=r,await s.decode();const o=e.data?.width??s.width,c=e.data?.height??s.height,u=e.data?.resolution||Tv(n),d=Math.ceil(o*u),f=Math.ceil(c*u),p=Dt.get().createCanvas(d,f),y=p.getContext("2d");y.imageSmoothingEnabled=!0,y.imageSmoothingQuality="high",y.drawImage(s,0,0,o*u,c*u);const{parseAsGraphicsContext:b,..._}=e.data??{},w=new Wo({resource:p,alphaMode:"premultiply-alpha-on-upload",resolution:u,..._});return Ev(w,t,n)}async function HJ(n){const t=await(await Dt.get().fetch(n)).text(),r=new Di;return r.svg(t),r}const VJ=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let vc=null,Q1=class{constructor(){vc||(vc=URL.createObjectURL(new Blob([VJ],{type:"application/javascript"}))),this.worker=new Worker(vc)}};Q1.revokeObjectURL=function(){vc&&(URL.revokeObjectURL(vc),vc=null)};const WJ=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let _c=null;class PR{constructor(){_c||(_c=URL.createObjectURL(new Blob([WJ],{type:"application/javascript"}))),this.worker=new Worker(_c)}}PR.revokeObjectURL=function(){_c&&(URL.revokeObjectURL(_c),_c=null)};let zE=0,ux;class YJ{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new Q1;t.addEventListener("message",r=>{t.terminate(),Q1.revokeObjectURL(),e(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,t){return this._run("loadImageBitmap",[e,t?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){ux===void 0&&(ux=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<ux&&(this._createdWorkers++,e=new PR().worker,e.addEventListener("message",t=>{this._complete(t.data),this._returnWorker(t.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){this._resolveHash[e.uuid]&&(e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),delete this._resolveHash[e.uuid])}async _run(e,t){await this._initWorkers();const r=new Promise((i,s)=>{this._queue.push({id:e,arguments:t,resolve:i,reject:s})});return this._next(),r}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const t=this._queue.pop(),r=t.id;this._resolveHash[zE]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:zE++,id:r})}reset(){this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:e})=>{e?.(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const UE=new YJ,$J=[".jpeg",".jpg",".png",".webp",".avif"],qJ=["image/jpeg","image/png","image/webp","image/avif"];async function ZJ(n,e){const t=await Dt.get().fetch(n);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${t.status} ${t.statusText}`);const r=await t.blob();return e?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const DR={name:"loadTextures",id:"texture",extension:{type:me.LoadParser,priority:Za.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(n){return Uc(n,qJ)||Fc(n,$J)},async load(n,e,t){let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await UE.isImageBitmapSupported()?r=await UE.loadImageBitmap(n,e):r=await ZJ(n,e):r=await new Promise((s,o)=>{r=Dt.get().createImage(),r.crossOrigin=this.config.crossOrigin,r.src=n,r.complete?s(r):(r.onload=()=>{s(r)},r.onerror=o)});const i=new Wo({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:e.data?.resolution||Tv(n),...e.data});return Ev(i,t,n)},unload(n){n.destroy(!0)}},XJ=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let hx,dx;function KJ(n,e,t){t===void 0&&!e.startsWith("data:")?n.crossOrigin=JJ(e):t!==!1&&(n.crossOrigin=typeof t=="string"?t:"anonymous")}function QJ(n){return new Promise((e,t)=>{n.addEventListener("canplaythrough",r),n.addEventListener("error",i),n.load();function r(){s(),e()}function i(o){s(),t(o)}function s(){n.removeEventListener("canplaythrough",r),n.removeEventListener("error",i)}})}function JJ(n,e=globalThis.location){if(n.startsWith("data:"))return"";e||(e=globalThis.location);const t=new URL(n,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}function eee(){const n=[],e=[];for(const t of XJ){const r=Wh.MIME_TYPES[t.substring(1)]||`video/${t.substring(1)}`;bg(r)&&(n.push(t),e.includes(r)||e.push(r))}return{validVideoExtensions:n,validVideoMime:e}}const tee={name:"loadVideo",id:"video",extension:{type:me.LoadParser,name:"loadVideo"},test(n){if(!hx||!dx){const{validVideoExtensions:r,validVideoMime:i}=eee();hx=r,dx=i}const e=Uc(n,dx),t=Fc(n,hx);return e||t},async load(n,e,t){const r={...Wh.defaultOptions,resolution:e.data?.resolution||Tv(n),alphaMode:e.data?.alphaMode||await jI(),...e.data},i=document.createElement("video"),s={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(s).forEach(u=>{const d=s[u];d!==void 0&&i.setAttribute(u,d)}),r.muted===!0&&(i.muted=!0),KJ(i,n,r.crossorigin);const o=document.createElement("source");let c;if(r.mime)c=r.mime;else if(n.startsWith("data:"))c=n.slice(5,n.indexOf(";"));else if(!n.startsWith("blob:")){const u=n.split("?")[0].slice(n.lastIndexOf(".")+1).toLowerCase();c=Wh.MIME_TYPES[u]||`video/${u}`}return o.src=n,c&&(o.type=c),new Promise(u=>{const d=async()=>{const f=new Wh({...r,resource:i});i.removeEventListener("canplay",d),e.data.preload&&await QJ(i),u(Ev(f,t,n))};r.preload&&!r.autoPlay&&i.load(),i.addEventListener("canplay",d),i.appendChild(o)})},unload(n){n.destroy(!0)}},jR={extension:{type:me.ResolveParser,name:"resolveTexture"},test:DR.test,parse:n=>({resolution:parseFloat(Lc.RETINA_PREFIX.exec(n)?.[1]??"1"),format:n.split(".").pop(),src:n})},nee={extension:{type:me.ResolveParser,priority:-2,name:"resolveJson"},test:n=>Lc.RETINA_PREFIX.test(n)&&n.endsWith(".json"),parse:jR.parse};class ree{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Lc,this.loader=new AJ,this.cache=un,this._backgroundLoader=new pJ(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){ct("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let s=e.manifest;typeof s=="string"&&(s=await this.load(s)),this.resolver.addManifest(s)}const t=e.texturePreference?.resolution??1,r=typeof t=="number"?[t]:t,i=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:r}}),e.preferences&&this.setPreferences(e.preferences),e.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...e.loadOptions})}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();const r=Hp(e),i=Yi(e).map(c=>{if(typeof c!="string"){const u=this.resolver.getAlias(c);return u.some(d=>!this.resolver.hasKey(d))&&this.add(c),Array.isArray(u)?u[0]:u}return this.resolver.hasKey(c)||this.add({alias:c,src:c}),c}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,t);return r?o[i[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let r=!1;typeof e=="string"&&(r=!0,e=[e]);const i=this.resolver.resolveBundle(e),s={},o=Object.keys(i);let c=0;const u=[],d=()=>{t?.(u.reduce((p,y)=>p+y,0)/c)},f=o.map((p,y)=>{const b=i[p],_=Object.values(b),S=[...new Set(_.flat())].reduce((A,M)=>A+(M.progressSize||1),0);return u.push(0),c+=S,this._mapLoadToResolve(b,A=>{u[y]=A*S,d()}).then(A=>{s[p]=A})});return await Promise.all(f),r?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return un.get(e);const t={};for(let r=0;r<e.length;r++)t[r]=un.get(e[r]);return t}async _mapLoadToResolve(e,t){const r=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const i=await this.loader.load(r,t);this._backgroundLoader.active=!0;const s={};return r.forEach(o=>{const c=i[o.src],u=[o.src];o.alias&&u.push(...o.alias),u.forEach(d=>{s[d]=c}),un.set(u,c)}),s}async unload(e){this._initialized||await this.init();const t=Yi(e).map(i=>typeof i!="string"?i.src:i),r=this.resolver.resolve(t);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=Yi(e);const t=this.resolver.resolveBundle(e),r=Object.keys(t).map(i=>this._unloadFromResolved(t[i]));await Promise.all(r)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(r=>{un.remove(r.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const r of e.detections)e.skipDetections||await r.test()?t=await r.add(t):e.skipDetections||(t=await r.remove(t));return t=t.filter((r,i)=>t.indexOf(r)===i),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(r=>r in e).forEach(r=>{t.config[r]=e[r]})})}}const Eh=new ree;Pn.handleByList(me.LoadParser,Eh.loader.parsers).handleByList(me.ResolveParser,Eh.resolver.parsers).handleByList(me.CacheParser,Eh.cache.parsers).handleByList(me.DetectionParser,Eh.detections);Pn.add(gJ,bJ,yJ,SJ,vJ,_J,wJ,TJ,NJ,LJ,FJ,DR,tee,mJ,fJ,jR,nee);const FE={loader:me.LoadParser,resolver:me.ResolveParser,cache:me.CacheParser,detection:me.DetectionParser};Pn.handle(me.Asset,n=>{const e=n.ref;Object.entries(FE).filter(([t])=>!!e[t]).forEach(([t,r])=>Pn.add(Object.assign(e[t],{extension:e[t].extension??r})))},n=>{const e=n.ref;Object.keys(FE).filter(t=>!!e[t]).forEach(t=>Pn.remove(e[t]))});var iee=`in vec2 vMaskCoord;
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform sampler2D uMaskTexture;

uniform float uAlpha;
uniform vec4 uMaskClamp;
uniform float uInverse;

out vec4 finalColor;

void main(void)
{
    float clip = step(3.5,
        step(uMaskClamp.x, vMaskCoord.x) +
        step(uMaskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, uMaskClamp.z) +
        step(vMaskCoord.y, uMaskClamp.w));

    // TODO look into why this is needed
    float npmAlpha = uAlpha;
    vec4 original = texture(uTexture, vTextureCoord);
    vec4 masky = texture(uMaskTexture, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    float a = alphaMul * masky.r * npmAlpha * clip;

    if (uInverse == 1.0) {
        a = 1.0 - a;
    }

    finalColor = original * a;
}
`,see=`in vec2 aPosition;

out vec2 vTextureCoord;
out vec2 vMaskCoord;


uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;
uniform mat3 uFilterMatrix;

vec4 filterVertexPosition(  vec2 aPosition )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
       
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord(  vec2 aPosition )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

vec2 getFilterCoord( vec2 aPosition )
{
    return  ( uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}   

void main(void)
{
    gl_Position = filterVertexPosition(aPosition);
    vTextureCoord = filterTextureCoord(aPosition);
    vMaskCoord = getFilterCoord(aPosition);
}
`,GE=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct MaskUniforms {
  uFilterMatrix:mat3x3<f32>,
  uMaskClamp:vec4<f32>,
  uAlpha:f32,
  uInverse:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> filterUniforms : MaskUniforms;
@group(1) @binding(1) var uMaskTexture: texture_2d<f32>;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) filterUv : vec2<f32>,
};

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);
}

fn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>
{
  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}

@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>,
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
   getFilterCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) filterUv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var maskClamp = filterUniforms.uMaskClamp;
    var uAlpha = filterUniforms.uAlpha;

    var clip = step(3.5,
      step(maskClamp.x, filterUv.x) +
      step(maskClamp.y, filterUv.y) +
      step(filterUv.x, maskClamp.z) +
      step(filterUv.y, maskClamp.w));

    var mask = textureSample(uMaskTexture, uSampler, filterUv);
    var source = textureSample(uTexture, uSampler, uv);
    var alphaMul = 1.0 - uAlpha * (1.0 - mask.a);

    var a: f32 = alphaMul * mask.r * uAlpha * clip;

    if (filterUniforms.uInverse == 1.0) {
        a = 1.0 - a;
    }

    return source * a;
}
`;class aee extends qI{constructor(e){const{sprite:t,...r}=e,i=new xI(t.texture),s=new tl({uFilterMatrix:{value:new We,type:"mat3x3<f32>"},uMaskClamp:{value:i.uClampFrame,type:"vec4<f32>"},uAlpha:{value:1,type:"f32"},uInverse:{value:e.inverse?1:0,type:"f32"}}),o=el.from({vertex:{source:GE,entryPoint:"mainVertex"},fragment:{source:GE,entryPoint:"mainFragment"}}),c=zc.from({vertex:see,fragment:iee,name:"mask-filter"});super({...r,gpuProgram:o,glProgram:c,clipToViewport:!1,resources:{filterUniforms:s,uMaskTexture:t.texture.source}}),this.sprite=t,this._textureMatrix=i}set inverse(e){this.resources.filterUniforms.uniforms.uInverse=e?1:0}get inverse(){return this.resources.filterUniforms.uniforms.uInverse===1}apply(e,t,r,i){this._textureMatrix.texture=this.sprite.texture,e.calculateSpriteMatrix(this.resources.filterUniforms.uniforms.uFilterMatrix,this.sprite).prepend(this._textureMatrix.mapCoord),this.resources.uMaskTexture=this.sprite.texture.source,e.applyFilter(this,t,r,i)}}class Yp extends pv{constructor(e){e instanceof Di&&(e={context:e});const{context:t,roundPixels:r,...i}=e||{};super({label:"Graphics",...i}),this.renderPipeId="graphics",t?this._context=t:this._context=this._ownedContext=new Di,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=r??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(e){return this._context.containsPoint(e)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||e?.context===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new Yp(this._context.clone()):(this._ownedContext=null,new Yp(this._context))}lineStyle(e,t,r){it(Yt,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return e&&(i.width=e),t&&(i.color=t),r&&(i.alpha=r),this.context.strokeStyle=i,this}beginFill(e,t){it(Yt,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const r={};return e!==void 0&&(r.color=e),t!==void 0&&(r.alpha=t),this.context.fillStyle=r,this}endFill(){it(Yt,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==Di.defaultStrokeStyle.width||e.color!==Di.defaultStrokeStyle.color||e.alpha!==Di.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return it(Yt,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return it(Yt,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return it(Yt,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return it(Yt,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return it(Yt,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return it(Yt,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}class oee extends pv{constructor(e,t){const{text:r,resolution:i,style:s,anchor:o,width:c,height:u,roundPixels:d,...f}=e;super({...f}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=r??"",this.style=s,this.resolution=i??null,this.allowChildren=!1,this._anchor=new gr({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=d??!1,c!==void 0&&(this.width=c),u!==void 0&&(this.height=u)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e||(e={}),this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this.bounds.width),t!==void 0&&this._setHeight(t,this.bounds.height)}containsPoint(e){const t=this.bounds.width,r=this.bounds.height,i=-t*this.anchor.x;let s=0;return e.x>=i&&e.x<=i+t&&(s=-r*this.anchor.y,e.y>=s&&e.y<=s+r)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function lee(n,e){let t=n[0]??{};return(typeof t=="string"||n[1])&&(it(Yt,`use new ${e}({ text: "hi!", style }) instead`),t={text:t,style:n[1]}),t}class cee extends oee{constructor(...e){var t;const r=lee(e,"BitmapText");r.style??(r.style=r.style||{}),(t=r.style).fill??(t.fill=16777215),super(r,vd),this.renderPipeId="bitmapText"}updateBounds(){const e=this._bounds,t=this._anchor,r=K1.measureText(this.text,this._style),i=r.scale,s=r.offsetY*i;let o=r.width*i,c=r.height*i;const u=this._style._stroke;u&&(o+=u.width,c+=u.width),e.minX=-t._x*o,e.maxX=e.minX+o,e.minY=-t._y*(c+s),e.maxY=e.minY+c}set resolution(e){e!==null&&ct("[BitmapText] dynamically updating the resolution is not supported. Resolution should be managed by the BitmapFont.")}get resolution(){return this._resolution}}class BR{constructor(){this._tempState=Rd.for2d(),this._didUploadHash={}}init(e){e.renderer.runners.contextChange.add(this)}contextChange(){this._didUploadHash={}}start(e,t,r){const i=e.renderer,s=this._didUploadHash[r.uid];i.shader.bind(r,s),s||(this._didUploadHash[r.uid]=!0),i.shader.updateUniformGroup(i.globalUniforms.uniformGroup),i.geometry.bind(t,r.glProgram)}execute(e,t){const r=e.renderer;this._tempState.blendMode=t.blendMode,r.state.set(this._tempState);const i=t.textures.textures;for(let s=0;s<t.textures.count;s++)r.texture.bind(i[s],s);r.geometry.draw(t.topology,t.size,t.start)}}BR.extension={type:[me.WebGLPipesAdaptor],name:"batch"};const Mv=class OR{constructor(e,t){this.state=Rd.for2d(),this._batchersByInstructionSet=Object.create(null),this._activeBatches=Object.create(null),this.renderer=e,this._adaptor=t,this._adaptor.init?.(this)}static getBatcher(e){return new this._availableBatchers[e]}buildStart(e){let t=this._batchersByInstructionSet[e.uid];t||(t=this._batchersByInstructionSet[e.uid]=Object.create(null),t.default||(t.default=new Sv({maxTextures:this.renderer.limits.maxBatchableTextures}))),this._activeBatches=t,this._activeBatch=this._activeBatches.default;for(const r in this._activeBatches)this._activeBatches[r].begin()}addToBatch(e,t){if(this._activeBatch.name!==e.batcherName){this._activeBatch.break(t);let r=this._activeBatches[e.batcherName];r||(r=this._activeBatches[e.batcherName]=OR.getBatcher(e.batcherName),r.begin()),this._activeBatch=r}this._activeBatch.add(e)}break(e){this._activeBatch.break(e)}buildEnd(e){this._activeBatch.break(e);const t=this._activeBatches;for(const r in t){const i=t[r],s=i.geometry;s.indexBuffer.setDataWithSize(i.indexBuffer,i.indexSize,!0),s.buffers[0].setDataWithSize(i.attributeBuffer.float32View,i.attributeSize,!1)}}upload(e){const t=this._batchersByInstructionSet[e.uid];for(const r in t){const i=t[r],s=i.geometry;i.dirty&&(i.dirty=!1,s.buffers[0].update(i.attributeSize*4))}}execute(e){if(e.action==="startBatch"){const t=e.batcher,r=t.geometry,i=t.shader;this._adaptor.start(this,r,i)}this._adaptor.execute(this,e)}destroy(){this.state=null,this.renderer=null,this._adaptor=null;for(const e in this._activeBatches)this._activeBatches[e].destroy();this._activeBatches=null}};Mv.extension={type:[me.WebGLPipes,me.WebGPUPipes,me.CanvasPipes],name:"batch"};Mv._availableBatchers=Object.create(null);let LR=Mv;Pn.handleByMap(me.Batcher,LR._availableBatchers);Pn.add(Sv);const fx={name:"local-uniform-bit",vertex:{header:`

            struct LocalUniforms {
                uTransformMatrix:mat3x3<f32>,
                uColor:vec4<f32>,
                uRound:f32,
            }

            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `}};({...fx,vertex:{...fx.vertex,header:fx.vertex.header.replace("group(1)","group(2)")}});const zR={name:"local-uniform-bit",vertex:{header:`

            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix = uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `}},uee={name:"texture-bit",vertex:{header:`
            uniform mat3 uTextureMatrix;
        `,main:`
            uv = (uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
        uniform sampler2D uTexture;


        `,main:`
            outColor = texture(uTexture, vUV);
        `}},hee=new qr;class dee extends Up{constructor(){super(),this.filters=[new aee({sprite:new Ya(Ue.EMPTY),inverse:!1,resolution:"inherit",antialias:"inherit"})]}get sprite(){return this.filters[0].sprite}set sprite(e){this.filters[0].sprite=e}get inverse(){return this.filters[0].inverse}set inverse(e){this.filters[0].inverse=e}}class UR{constructor(e){this._activeMaskStage=[],this._renderer=e}push(e,t,r){const i=this._renderer;if(i.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"pushMaskBegin",mask:e,inverse:t._maskOptions.inverse,canBundle:!1,maskedContainer:t}),e.inverse=t._maskOptions.inverse,e.renderMaskToTexture){const s=e.mask;s.includeInBuild=!0,s.collectRenderables(r,i,null),s.includeInBuild=!1}i.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"pushMaskEnd",mask:e,maskedContainer:t,inverse:t._maskOptions.inverse,canBundle:!1})}pop(e,t,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"popMaskEnd",mask:e,inverse:t._maskOptions.inverse,canBundle:!1})}execute(e){const t=this._renderer,r=e.mask.renderMaskToTexture;if(e.action==="pushMaskBegin"){const i=Ar.get(dee);if(i.inverse=e.inverse,r){e.mask.mask.measurable=!0;const s=hv(e.mask.mask,!0,hee);e.mask.mask.measurable=!1,s.ceil();const o=t.renderTarget.renderTarget.colorTexture.source,c=zo.getOptimalTexture(s.width,s.height,o._resolution,o.antialias);t.renderTarget.push(c,!0),t.globalUniforms.push({offset:s,worldColor:4294967295});const u=i.sprite;u.texture=c,u.worldTransform.tx=s.minX,u.worldTransform.ty=s.minY,this._activeMaskStage.push({filterEffect:i,maskedContainer:e.maskedContainer,filterTexture:c})}else i.sprite=e.mask.mask,this._activeMaskStage.push({filterEffect:i,maskedContainer:e.maskedContainer})}else if(e.action==="pushMaskEnd"){const i=this._activeMaskStage[this._activeMaskStage.length-1];r&&(t.type===Yo.WEBGL&&t.renderTarget.finishRenderPass(),t.renderTarget.pop(),t.globalUniforms.pop()),t.filter.push({renderPipeId:"filter",action:"pushFilter",container:i.maskedContainer,filterEffect:i.filterEffect,canBundle:!1})}else if(e.action==="popMaskEnd"){t.filter.pop();const i=this._activeMaskStage.pop();r&&zo.returnTexture(i.filterTexture),Ar.return(i.filterEffect)}}destroy(){this._renderer=null,this._activeMaskStage=null}}UR.extension={type:[me.WebGLPipes,me.WebGPUPipes,me.CanvasPipes],name:"alphaMask"};class FR{constructor(e){this._colorStack=[],this._colorStackIndex=0,this._currentColor=0,this._renderer=e}buildStart(){this._colorStack[0]=15,this._colorStackIndex=1,this._currentColor=15}push(e,t,r){this._renderer.renderPipes.batch.break(r);const s=this._colorStack;s[this._colorStackIndex]=s[this._colorStackIndex-1]&e.mask;const o=this._colorStack[this._colorStackIndex];o!==this._currentColor&&(this._currentColor=o,r.add({renderPipeId:"colorMask",colorMask:o,canBundle:!1})),this._colorStackIndex++}pop(e,t,r){this._renderer.renderPipes.batch.break(r);const s=this._colorStack;this._colorStackIndex--;const o=s[this._colorStackIndex-1];o!==this._currentColor&&(this._currentColor=o,r.add({renderPipeId:"colorMask",colorMask:o,canBundle:!1}))}execute(e){this._renderer.colorMask.setMask(e.colorMask)}destroy(){this._renderer=null,this._colorStack=null}}FR.extension={type:[me.WebGLPipes,me.WebGPUPipes,me.CanvasPipes],name:"colorMask"};class GR{constructor(e){this._maskStackHash={},this._maskHash=new WeakMap,this._renderer=e}push(e,t,r){var i;const s=e,o=this._renderer;o.renderPipes.batch.break(r),o.renderPipes.blendMode.setBlendMode(s.mask,"none",r),r.add({renderPipeId:"stencilMask",action:"pushMaskBegin",mask:e,inverse:t._maskOptions.inverse,canBundle:!1});const c=s.mask;c.includeInBuild=!0,this._maskHash.has(s)||this._maskHash.set(s,{instructionsStart:0,instructionsLength:0});const u=this._maskHash.get(s);u.instructionsStart=r.instructionSize,c.collectRenderables(r,o,null),c.includeInBuild=!1,o.renderPipes.batch.break(r),r.add({renderPipeId:"stencilMask",action:"pushMaskEnd",mask:e,inverse:t._maskOptions.inverse,canBundle:!1});const d=r.instructionSize-u.instructionsStart-1;u.instructionsLength=d;const f=o.renderTarget.renderTarget.uid;(i=this._maskStackHash)[f]??(i[f]=0)}pop(e,t,r){const i=e,s=this._renderer;s.renderPipes.batch.break(r),s.renderPipes.blendMode.setBlendMode(i.mask,"none",r),r.add({renderPipeId:"stencilMask",action:"popMaskBegin",inverse:t._maskOptions.inverse,canBundle:!1});const o=this._maskHash.get(e);for(let c=0;c<o.instructionsLength;c++)r.instructions[r.instructionSize++]=r.instructions[o.instructionsStart++];r.add({renderPipeId:"stencilMask",action:"popMaskEnd",canBundle:!1})}execute(e){var t;const r=this._renderer,i=r.renderTarget.renderTarget.uid;let s=(t=this._maskStackHash)[i]??(t[i]=0);e.action==="pushMaskBegin"?(r.renderTarget.ensureDepthStencil(),r.stencil.setStencilMode(or.RENDERING_MASK_ADD,s),s++,r.colorMask.setMask(0)):e.action==="pushMaskEnd"?(e.inverse?r.stencil.setStencilMode(or.INVERSE_MASK_ACTIVE,s):r.stencil.setStencilMode(or.MASK_ACTIVE,s),r.colorMask.setMask(15)):e.action==="popMaskBegin"?(r.colorMask.setMask(0),s!==0?r.stencil.setStencilMode(or.RENDERING_MASK_REMOVE,s):(r.renderTarget.clear(null,Ba.STENCIL),r.stencil.setStencilMode(or.DISABLED,s)),s--):e.action==="popMaskEnd"&&(e.inverse?r.stencil.setStencilMode(or.INVERSE_MASK_ACTIVE,s):r.stencil.setStencilMode(or.MASK_ACTIVE,s),r.colorMask.setMask(15)),this._maskStackHash[i]=s}destroy(){this._renderer=null,this._maskStackHash=null,this._maskHash=null}}GR.extension={type:[me.WebGLPipes,me.WebGPUPipes,me.CanvasPipes],name:"stencilMask"};var gp=(n=>(n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n))(gp||{});class fee{constructor(e,t){this._lastBindBaseLocation=-1,this._lastBindCallId=-1,this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.type=t}}class HR{constructor(e){this._gpuBuffers=Object.create(null),this._boundBufferBases=Object.create(null),this._minBaseLocation=0,this._nextBindBaseIndex=this._minBaseLocation,this._bindCallId=0,this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_gpuBuffers")}destroy(){this.destroyAll(),this._renderer=null,this._gl=null,this._gpuBuffers={},this._boundBufferBases={}}contextChange(){this._gl=this._renderer.gl,this._gpuBuffers=Object.create(null),this._maxBindings=this._renderer.limits.maxUniformBindings}getGlBuffer(e){return this._gpuBuffers[e.uid]||this.createGLBuffer(e)}bind(e){const{_gl:t}=this,r=this.getGlBuffer(e);t.bindBuffer(r.type,r.buffer)}bindBufferBase(e,t){const{_gl:r}=this;this._boundBufferBases[t]!==e&&(this._boundBufferBases[t]=e,e._lastBindBaseLocation=t,r.bindBufferBase(r.UNIFORM_BUFFER,t,e.buffer))}nextBindBase(e){this._bindCallId++,this._minBaseLocation=0,e&&(this._boundBufferBases[0]=null,this._minBaseLocation=1,this._nextBindBaseIndex<1&&(this._nextBindBaseIndex=1))}freeLocationForBufferBase(e){let t=this.getLastBindBaseLocation(e);if(t>=this._minBaseLocation)return e._lastBindCallId=this._bindCallId,t;let r=0,i=this._nextBindBaseIndex;for(;r<2;){i>=this._maxBindings&&(i=this._minBaseLocation,r++);const s=this._boundBufferBases[i];if(s&&s._lastBindCallId===this._bindCallId){i++;continue}break}return t=i,this._nextBindBaseIndex=i+1,r>=2?-1:(e._lastBindCallId=this._bindCallId,this._boundBufferBases[t]=null,t)}getLastBindBaseLocation(e){const t=e._lastBindBaseLocation;return this._boundBufferBases[t]===e?t:-1}bindBufferRange(e,t,r,i){const{_gl:s}=this;r||(r=0),t||(t=0),this._boundBufferBases[t]=null,s.bindBufferRange(s.UNIFORM_BUFFER,t||0,e.buffer,r*256,i||256)}updateBuffer(e){const{_gl:t}=this,r=this.getGlBuffer(e);if(e._updateID===r.updateID)return r;r.updateID=e._updateID,t.bindBuffer(r.type,r.buffer);const i=e.data,s=e.descriptor.usage&Bn.STATIC?t.STATIC_DRAW:t.DYNAMIC_DRAW;return i?r.byteLength>=i.byteLength?t.bufferSubData(r.type,0,i,0,e._updateSize/i.BYTES_PER_ELEMENT):(r.byteLength=i.byteLength,t.bufferData(r.type,i,s)):(r.byteLength=e.descriptor.size,t.bufferData(r.type,r.byteLength,s)),r}destroyAll(){const e=this._gl;for(const t in this._gpuBuffers)this._gpuBuffers[t]&&e.deleteBuffer(this._gpuBuffers[t].buffer);this._gpuBuffers=Object.create(null)}onBufferDestroy(e,t){if(!this._gpuBuffers[e.uid])return;const r=this._gpuBuffers[e.uid],i=this._gl;t||i.deleteBuffer(r.buffer),e.off("destroy",this.onBufferDestroy,this),this._gpuBuffers[e.uid]=null}createGLBuffer(e){const{_gl:t}=this;let r=gp.ARRAY_BUFFER;e.descriptor.usage&Bn.INDEX?r=gp.ELEMENT_ARRAY_BUFFER:e.descriptor.usage&Bn.UNIFORM&&(r=gp.UNIFORM_BUFFER);const i=new fee(t.createBuffer(),r);return this._gpuBuffers[e.uid]=i,e.on("destroy",this.onBufferDestroy,this),i}resetState(){this._boundBufferBases=Object.create(null)}}HR.extension={type:[me.WebGLSystem],name:"buffer"};const Nv=class VR{constructor(e){this.supports={uint32Indices:!0,uniformBufferObject:!0,vertexArrayObject:!0,srgbTextures:!0,nonPowOf2wrapping:!0,msaa:!0,nonPowOf2mipmaps:!0},this._renderer=e,this.extensions=Object.create(null),this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this._renderer.gl=e}init(e){e={...VR.defaultOptions,...e};let t=this.multiView=e.multiView;if(e.context&&t&&(ct("Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together."),t=!1),t?this.canvas=Dt.get().createCanvas(this._renderer.canvas.width,this._renderer.canvas.height):this.canvas=this._renderer.view.canvas,e.context)this.initFromContext(e.context);else{const r=this._renderer.background.alpha<1,i=e.premultipliedAlpha??!0,s=e.antialias&&!this._renderer.backBuffer.useBackBuffer;this.createContext(e.preferWebGLVersion,{alpha:r,premultipliedAlpha:i,antialias:s,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference??"default"})}}ensureCanvasSize(e){if(!this.multiView){e!==this.canvas&&ct("multiView is disabled, but targetCanvas is not the main canvas");return}const{canvas:t}=this;(t.width<e.width||t.height<e.height)&&(t.width=Math.max(e.width,e.width),t.height=Math.max(e.height,e.height))}initFromContext(e){this.gl=e,this.webGLVersion=e instanceof Dt.get().getWebGLRenderingContext()?1:2,this.getExtensions(),this.validateContext(e),this._renderer.runners.contextChange.emit(e);const t=this._renderer.view.canvas;t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}createContext(e,t){let r;const i=this.canvas;if(e===2&&(r=i.getContext("webgl2",t)),!r&&(r=i.getContext("webgl",t),!r))throw new Error("This browser does not support WebGL. Try using the canvas renderer");this.gl=r,this.initFromContext(this.gl)}getExtensions(){const{gl:e}=this,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc"),rgtc:e.getExtension("EXT_texture_compression_rgtc"),loseContext:e.getExtension("WEBGL_lose_context")};if(this.webGLVersion===1)this.extensions={...t,drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear"),vertexAttribDivisorANGLE:e.getExtension("ANGLE_instanced_arrays"),srgb:e.getExtension("EXT_sRGB")};else{this.extensions={...t,colorBufferFloat:e.getExtension("EXT_color_buffer_float")};const r=e.getExtension("WEBGL_provoking_vertex");r&&r.provokingVertexWEBGL(r.FIRST_VERTEX_CONVENTION_WEBGL)}}handleContextLost(e){e.preventDefault(),this._contextLossForced&&(this._contextLossForced=!1,setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext?.restoreContext()},0))}handleContextRestored(){this.getExtensions(),this._renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this._renderer.view.canvas;this._renderer=null,e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext?.loseContext()}forceContextLoss(){this.extensions.loseContext?.loseContext(),this._contextLossForced=!0}validateContext(e){const t=e.getContextAttributes();t&&!t.stencil&&ct("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=this.supports,i=this.webGLVersion===2,s=this.extensions;r.uint32Indices=i||!!s.uint32ElementIndex,r.uniformBufferObject=i,r.vertexArrayObject=i||!!s.vertexArrayObject,r.srgbTextures=i||!!s.srgb,r.nonPowOf2wrapping=i,r.nonPowOf2mipmaps=i,r.msaa=i,r.uint32Indices||ct("Provided WebGL context does not support 32 index buffer, large scenes may not render correctly")}};Nv.extension={type:[me.WebGLSystem],name:"context"};Nv.defaultOptions={context:null,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:void 0,preferWebGLVersion:2,multiView:!1};let mee=Nv;function pee(n,e){for(const t in n.attributes){const r=n.attributes[t],i=e[t];i?(r.format??(r.format=i.format),r.offset??(r.offset=i.offset),r.instance??(r.instance=i.instance)):ct(`Attribute ${t} is not present in the shader, but is present in the geometry. Unable to infer attribute details.`)}gee(n)}function gee(n){const{buffers:e,attributes:t}=n,r={},i={};for(const s in e){const o=e[s];r[o.uid]=0,i[o.uid]=0}for(const s in t){const o=t[s];r[o.buffer.uid]+=pd(o.format).stride}for(const s in t){const o=t[s];o.stride??(o.stride=r[o.buffer.uid]),o.start??(o.start=i[o.buffer.uid]),i[o.buffer.uid]+=pd(o.format).stride}}var J1=(n=>(n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n))(J1||{}),WR=(n=>(n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n))(WR||{}),kt=(n=>(n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT",n))(kt||{});const HE={uint8x2:kt.UNSIGNED_BYTE,uint8x4:kt.UNSIGNED_BYTE,sint8x2:kt.BYTE,sint8x4:kt.BYTE,unorm8x2:kt.UNSIGNED_BYTE,unorm8x4:kt.UNSIGNED_BYTE,snorm8x2:kt.BYTE,snorm8x4:kt.BYTE,uint16x2:kt.UNSIGNED_SHORT,uint16x4:kt.UNSIGNED_SHORT,sint16x2:kt.SHORT,sint16x4:kt.SHORT,unorm16x2:kt.UNSIGNED_SHORT,unorm16x4:kt.UNSIGNED_SHORT,snorm16x2:kt.SHORT,snorm16x4:kt.SHORT,float16x2:kt.HALF_FLOAT,float16x4:kt.HALF_FLOAT,float32:kt.FLOAT,float32x2:kt.FLOAT,float32x3:kt.FLOAT,float32x4:kt.FLOAT,uint32:kt.UNSIGNED_INT,uint32x2:kt.UNSIGNED_INT,uint32x3:kt.UNSIGNED_INT,uint32x4:kt.UNSIGNED_INT,sint32:kt.INT,sint32x2:kt.INT,sint32x3:kt.INT,sint32x4:kt.INT};function yee(n){return HE[n]??HE.float32}const bee={"point-list":0,"line-list":1,"line-strip":3,"triangle-list":4,"triangle-strip":5};class YR{constructor(e){this._geometryVaoHash=Object.create(null),this._renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this._renderer.renderableGC.addManagedHash(this,"_geometryVaoHash")}contextChange(){const e=this.gl=this._renderer.gl;if(!this._renderer.context.supports.vertexArrayObject)throw new Error("[PixiJS] Vertex Array Objects are not supported on this device");const t=this._renderer.context.extensions.vertexArrayObject;t&&(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=i=>t.bindVertexArrayOES(i),e.deleteVertexArray=i=>t.deleteVertexArrayOES(i));const r=this._renderer.context.extensions.vertexAttribDivisorANGLE;r&&(e.drawArraysInstanced=(i,s,o,c)=>{r.drawArraysInstancedANGLE(i,s,o,c)},e.drawElementsInstanced=(i,s,o,c,u)=>{r.drawElementsInstancedANGLE(i,s,o,c,u)},e.vertexAttribDivisor=(i,s)=>r.vertexAttribDivisorANGLE(i,s)),this._activeGeometry=null,this._activeVao=null,this._geometryVaoHash=Object.create(null)}bind(e,t){const r=this.gl;this._activeGeometry=e;const i=this.getVao(e,t);this._activeVao!==i&&(this._activeVao=i,r.bindVertexArray(i)),this.updateBuffers()}resetState(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this._renderer.buffer;for(let r=0;r<e.buffers.length;r++){const i=e.buffers[r];t.updateBuffer(i)}}checkCompatibility(e,t){const r=e.attributes,i=t._attributeData;for(const s in i)if(!r[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,t){const r=e.attributes,i=t._attributeData,s=["g",e.uid];for(const o in r)i[o]&&s.push(o,i[o].location);return s.join("-")}getVao(e,t){return this._geometryVaoHash[e.uid]?.[t._key]||this.initGeometryVao(e,t)}initGeometryVao(e,t,r=!0){const i=this._renderer.gl,s=this._renderer.buffer;this._renderer.shader._getProgramData(t),this.checkCompatibility(e,t);const o=this.getSignature(e,t);this._geometryVaoHash[e.uid]||(this._geometryVaoHash[e.uid]=Object.create(null),e.on("destroy",this.onGeometryDestroy,this));const c=this._geometryVaoHash[e.uid];let u=c[o];if(u)return c[t._key]=u,u;pee(e,t._attributeData);const d=e.buffers;u=i.createVertexArray(),i.bindVertexArray(u);for(let f=0;f<d.length;f++){const p=d[f];s.bind(p)}return this.activateVao(e,t),c[t._key]=u,c[o]=u,i.bindVertexArray(null),u}onGeometryDestroy(e,t){const r=this._geometryVaoHash[e.uid],i=this.gl;if(r){if(t)for(const s in r)this._activeVao!==r[s]&&this.unbind(),i.deleteVertexArray(r[s]);this._geometryVaoHash[e.uid]=null}}destroyAll(e=!1){const t=this.gl;for(const r in this._geometryVaoHash){if(e)for(const i in this._geometryVaoHash[r]){const s=this._geometryVaoHash[r];this._activeVao!==s&&this.unbind(),t.deleteVertexArray(s[i])}this._geometryVaoHash[r]=null}}activateVao(e,t){const r=this._renderer.gl,i=this._renderer.buffer,s=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);let o=null;for(const c in s){const u=s[c],d=u.buffer,f=i.getGlBuffer(d),p=t._attributeData[c];if(p){o!==f&&(i.bind(d),o=f);const y=p.location;r.enableVertexAttribArray(y);const b=pd(u.format),_=yee(u.format);if(p.format?.substring(1,4)==="int"?r.vertexAttribIPointer(y,b.size,_,u.stride,u.offset):r.vertexAttribPointer(y,b.size,_,b.normalised,u.stride,u.offset),u.instance)if(this.hasInstance){const w=u.divisor??1;r.vertexAttribDivisor(y,w)}else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,t,r,i){const{gl:s}=this._renderer,o=this._activeGeometry,c=bee[e||o.topology];if(i??(i=o.instanceCount),o.indexBuffer){const u=o.indexBuffer.data.BYTES_PER_ELEMENT,d=u===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;i!==1?s.drawElementsInstanced(c,t||o.indexBuffer.data.length,d,(r||0)*u,i):s.drawElements(c,t||o.indexBuffer.data.length,d,(r||0)*u)}else i!==1?s.drawArraysInstanced(c,r||0,t||o.getSize(),i):s.drawArrays(c,r||0,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this._renderer=null,this.gl=null,this._activeVao=null,this._activeGeometry=null,this._geometryVaoHash={}}}YR.extension={type:[me.WebGLSystem],name:"geometry"};const xee=new hR({attributes:{aPosition:[-1,-1,3,-1,-1,3]}}),Iv=class $R{constructor(e){this.useBackBuffer=!1,this._useBackBufferThisRender=!1,this._renderer=e}init(e={}){const{useBackBuffer:t,antialias:r}={...$R.defaultOptions,...e};this.useBackBuffer=t,this._antialias=r,this._renderer.context.supports.msaa||(ct("antialiasing, is not supported on when using the back buffer"),this._antialias=!1),this._state=Rd.for2d();const i=new zc({vertex:`
                attribute vec2 aPosition;
                out vec2 vUv;

                void main() {
                    gl_Position = vec4(aPosition, 0.0, 1.0);

                    vUv = (aPosition + 1.0) / 2.0;

                    // flip dem UVs
                    vUv.y = 1.0 - vUv.y;
                }`,fragment:`
                in vec2 vUv;
                out vec4 finalColor;

                uniform sampler2D uTexture;

                void main() {
                    finalColor = texture(uTexture, vUv);
                }`,name:"big-triangle"});this._bigTriangleShader=new nl({glProgram:i,resources:{uTexture:Ue.WHITE.source}})}renderStart(e){const t=this._renderer.renderTarget.getRenderTarget(e.target);if(this._useBackBufferThisRender=this.useBackBuffer&&!!t.isRoot,this._useBackBufferThisRender){const r=this._renderer.renderTarget.getRenderTarget(e.target);this._targetTexture=r.colorTexture,e.target=this._getBackBufferTexture(r.colorTexture)}}renderEnd(){this._presentBackBuffer()}_presentBackBuffer(){const e=this._renderer;e.renderTarget.finishRenderPass(),this._useBackBufferThisRender&&(e.renderTarget.bind(this._targetTexture,!1),this._bigTriangleShader.resources.uTexture=this._backBufferTexture.source,e.encoder.draw({geometry:xee,shader:this._bigTriangleShader,state:this._state}))}_getBackBufferTexture(e){return this._backBufferTexture=this._backBufferTexture||new Ue({source:new ur({width:e.width,height:e.height,resolution:e._resolution,antialias:this._antialias})}),this._backBufferTexture.source.resize(e.width,e.height,e._resolution),this._backBufferTexture}destroy(){this._backBufferTexture&&(this._backBufferTexture.destroy(),this._backBufferTexture=null)}};Iv.extension={type:[me.WebGLSystem],name:"backBuffer",priority:1};Iv.defaultOptions={useBackBuffer:!1};let vee=Iv;class qR{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.gl.colorMask(!!(e&8),!!(e&4),!!(e&2),!!(e&1)))}}qR.extension={type:[me.WebGLSystem],name:"colorMask"};class ZR{constructor(e){this.commandFinished=Promise.resolve(),this._renderer=e}setGeometry(e,t){this._renderer.geometry.bind(e,t.glProgram)}finishRenderPass(){}draw(e){const t=this._renderer,{geometry:r,shader:i,state:s,skipSync:o,topology:c,size:u,start:d,instanceCount:f}=e;t.shader.bind(i,o),t.geometry.bind(r,t.shader._activeProgram),s&&t.state.set(s),t.geometry.draw(c,u,d,f??r.instanceCount)}destroy(){this._renderer=null}}ZR.extension={type:[me.WebGLSystem],name:"encoder"};class XR{constructor(e){this._renderer=e}contextChange(){const e=this._renderer.gl;this.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.maxBatchableTextures=oR(this.maxTextures,e);const t=this._renderer.context.webGLVersion===2;this.maxUniformBindings=t?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0}destroy(){}}XR.extension={type:[me.WebGLSystem],name:"limits"};class _ee{constructor(){this.width=-1,this.height=-1,this.msaa=!1,this.msaaRenderBuffer=[]}}const rl=[];rl[or.NONE]=void 0;rl[or.DISABLED]={stencilWriteMask:0,stencilReadMask:0};rl[or.RENDERING_MASK_ADD]={stencilFront:{compare:"equal",passOp:"increment-clamp"},stencilBack:{compare:"equal",passOp:"increment-clamp"}};rl[or.RENDERING_MASK_REMOVE]={stencilFront:{compare:"equal",passOp:"decrement-clamp"},stencilBack:{compare:"equal",passOp:"decrement-clamp"}};rl[or.MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"equal",passOp:"keep"},stencilBack:{compare:"equal",passOp:"keep"}};rl[or.INVERSE_MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"not-equal",passOp:"keep"},stencilBack:{compare:"not-equal",passOp:"keep"}};class KR{constructor(e){this._stencilCache={enabled:!1,stencilReference:0,stencilMode:or.NONE},this._renderTargetStencilState=Object.create(null),e.renderTarget.onRenderTargetChange.add(this)}contextChange(e){this._gl=e,this._comparisonFuncMapping={always:e.ALWAYS,never:e.NEVER,equal:e.EQUAL,"not-equal":e.NOTEQUAL,less:e.LESS,"less-equal":e.LEQUAL,greater:e.GREATER,"greater-equal":e.GEQUAL},this._stencilOpsMapping={keep:e.KEEP,zero:e.ZERO,replace:e.REPLACE,invert:e.INVERT,"increment-clamp":e.INCR,"decrement-clamp":e.DECR,"increment-wrap":e.INCR_WRAP,"decrement-wrap":e.DECR_WRAP},this.resetState()}onRenderTargetChange(e){if(this._activeRenderTarget===e)return;this._activeRenderTarget=e;let t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:or.DISABLED,stencilReference:0}),this.setStencilMode(t.stencilMode,t.stencilReference)}resetState(){this._stencilCache.enabled=!1,this._stencilCache.stencilMode=or.NONE,this._stencilCache.stencilReference=0}setStencilMode(e,t){const r=this._renderTargetStencilState[this._activeRenderTarget.uid],i=this._gl,s=rl[e],o=this._stencilCache;if(r.stencilMode=e,r.stencilReference=t,e===or.DISABLED){this._stencilCache.enabled&&(this._stencilCache.enabled=!1,i.disable(i.STENCIL_TEST));return}this._stencilCache.enabled||(this._stencilCache.enabled=!0,i.enable(i.STENCIL_TEST)),(e!==o.stencilMode||o.stencilReference!==t)&&(o.stencilMode=e,o.stencilReference=t,i.stencilFunc(this._comparisonFuncMapping[s.stencilBack.compare],t,255),i.stencilOp(i.KEEP,i.KEEP,this._stencilOpsMapping[s.stencilBack.passOp]))}}KR.extension={type:[me.WebGLSystem],name:"stencil"};class wee{constructor(e){this._syncFunctionHash=Object.create(null),this._adaptor=e,this._systemCheck()}_systemCheck(){if(!ZI())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}ensureUniformGroup(e){const t=this.getUniformGroupData(e);e.buffer||(e.buffer=new qo({data:new Float32Array(t.layout.size/4),usage:Bn.UNIFORM|Bn.COPY_DST}))}getUniformGroupData(e){return this._syncFunctionHash[e._signature]||this._initUniformGroup(e)}_initUniformGroup(e){const t=e._signature;let r=this._syncFunctionHash[t];if(!r){const i=Object.keys(e.uniformStructures).map(c=>e.uniformStructures[c]),s=this._adaptor.createUboElements(i),o=this._generateUboSync(s.uboElements);r=this._syncFunctionHash[t]={layout:s,syncFunction:o}}return this._syncFunctionHash[t]}_generateUboSync(e){return this._adaptor.generateUboSync(e)}syncUniformGroup(e,t,r){const i=this.getUniformGroupData(e);e.buffer||(e.buffer=new qo({data:new Float32Array(i.layout.size/4),usage:Bn.UNIFORM|Bn.COPY_DST}));let s=null;return t||(t=e.buffer.data,s=e.buffer.dataInt32),r||(r=0),i.syncFunction(e.uniforms,t,s,r),!0}updateUniformGroup(e){if(e.isStatic&&!e._dirtyId)return!1;e._dirtyId=0;const t=this.syncUniformGroup(e);return e.buffer.update(),t}destroy(){this._syncFunctionHash=null}}const QR={f32:4,i32:4,"vec2<f32>":8,"vec3<f32>":12,"vec4<f32>":16,"vec2<i32>":8,"vec3<i32>":12,"vec4<i32>":16,"mat2x2<f32>":32,"mat3x3<f32>":48,"mat4x4<f32>":64};function See(n){const e=n.map(s=>({data:s,offset:0,size:0})),t=16;let r=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(r=QR[o.data.type],!r)throw new Error(`Unknown type ${o.data.type}`);o.data.size>1&&(r=Math.max(r,t)*o.data.size);const c=r===12?16:r;o.size=r;const u=i%t;u>0&&t-u<c?i+=(t-u)%16:i+=(r-u%r)%r,o.offset=i,i+=r}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}const Ro=[{type:"mat3x3<f32>",test:n=>n.value.a!==void 0,ubo:`
            var matrix = uv[name].toArray(true);
            data[offset] = matrix[0];
            data[offset + 1] = matrix[1];
            data[offset + 2] = matrix[2];
            data[offset + 4] = matrix[3];
            data[offset + 5] = matrix[4];
            data[offset + 6] = matrix[5];
            data[offset + 8] = matrix[6];
            data[offset + 9] = matrix[7];
            data[offset + 10] = matrix[8];
        `,uniform:`
            gl.uniformMatrix3fv(ud[name].location, false, uv[name].toArray(true));
        `},{type:"vec4<f32>",test:n=>n.type==="vec4<f32>"&&n.size===1&&n.value.width!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
            data[offset + 2] = v.width;
            data[offset + 3] = v.height;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height) {
                cv[0] = v.x;
                cv[1] = v.y;
                cv[2] = v.width;
                cv[3] = v.height;
                gl.uniform4f(ud[name].location, v.x, v.y, v.width, v.height);
            }
        `},{type:"vec2<f32>",test:n=>n.type==="vec2<f32>"&&n.size===1&&n.value.x!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y) {
                cv[0] = v.x;
                cv[1] = v.y;
                gl.uniform2f(ud[name].location, v.x, v.y);
            }
        `},{type:"vec4<f32>",test:n=>n.type==="vec4<f32>"&&n.size===1&&n.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
            data[offset + 3] = v.alpha;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                cv[3] = v.alpha;
                gl.uniform4f(ud[name].location, v.red, v.green, v.blue, v.alpha);
            }
        `},{type:"vec3<f32>",test:n=>n.type==="vec3<f32>"&&n.size===1&&n.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                gl.uniform3f(ud[name].location, v.red, v.green, v.blue);
            }
        `}];function Aee(n,e,t,r){const i=[`
        var v = null;
        var v2 = null;
        var t = 0;
        var index = 0;
        var name = null;
        var arrayOffset = null;
    `];let s=0;for(let c=0;c<n.length;c++){const u=n[c],d=u.data.name;let f=!1,p=0;for(let y=0;y<Ro.length;y++)if(Ro[y].test(u.data)){p=u.offset/4,i.push(`name = "${d}";`,`offset += ${p-s};`,Ro[y][e]||Ro[y].ubo),f=!0;break}if(!f)if(u.data.size>1)p=u.offset/4,i.push(t(u,p-s));else{const y=r[u.data.type];p=u.offset/4,i.push(`
                    v = uv.${d};
                    offset += ${p-s};
                    ${y};
                `)}s=p}const o=i.join(`
`);return new Function("uv","data","dataInt32","offset",o)}function ec(n,e){return`
        for (let i = 0; i < ${n*e}; i++) {
            data[offset + (((i / ${n})|0) * 4) + (i % ${n})] = v[i];
        }
    `}const JR={f32:`
        data[offset] = v;`,i32:`
        dataInt32[offset] = v;`,"vec2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];`,"vec3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];`,"vec4<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];`,"vec2<i32>":`
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];`,"vec3<i32>":`
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];
        dataInt32[offset + 2] = v[2];`,"vec4<i32>":`
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];
        dataInt32[offset + 2] = v[2];
        dataInt32[offset + 3] = v[3];`,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 4] = v[2];
        data[offset + 5] = v[3];`,"mat3x3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];
        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];`,"mat4x4<f32>":`
        for (let i = 0; i < 16; i++) {
            data[offset + i] = v[i];
        }`,"mat3x2<f32>":ec(3,2),"mat4x2<f32>":ec(4,2),"mat2x3<f32>":ec(2,3),"mat4x3<f32>":ec(4,3),"mat2x4<f32>":ec(2,4),"mat3x4<f32>":ec(3,4)};({...JR});function Cee(n,e){const t=Math.max(QR[n.data.type]/16,1),r=n.data.value.length/n.data.size,i=(4-r%4)%4,s=n.data.type.indexOf("i32")>=0?"dataInt32":"data";return`
        v = uv.${n.data.name};
        offset += ${e};

        arrayOffset = offset;

        t = 0;

        for(var i=0; i < ${n.data.size*t}; i++)
        {
            for(var j = 0; j < ${r}; j++)
            {
                ${s}[arrayOffset++] = v[t++];
            }
            ${i!==0?`arrayOffset += ${i};`:""}
        }
    `}function kee(n){return Aee(n,"uboStd40",Cee,JR)}class eP extends wee{constructor(){super({createUboElements:See,generateUboSync:kee})}}eP.extension={type:[me.WebGLSystem],name:"ubo"};class Tee{constructor(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Qt}init(e,t){this._renderer=e,this._renderTargetSystem=t,e.runners.contextChange.add(this)}contextChange(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Qt}copyToTexture(e,t,r,i,s){const o=this._renderTargetSystem,c=this._renderer,u=o.getGpuRenderTarget(e),d=c.gl;return this.finishRenderPass(e),d.bindFramebuffer(d.FRAMEBUFFER,u.resolveTargetFramebuffer),c.texture.bind(t,0),d.copyTexSubImage2D(d.TEXTURE_2D,0,s.x,s.y,r.x,r.y,i.width,i.height),t}startRenderPass(e,t=!0,r,i){const s=this._renderTargetSystem,o=e.colorTexture,c=s.getGpuRenderTarget(e);let u=i.y;e.isRoot&&(u=o.pixelHeight-i.height),e.colorTextures.forEach(p=>{this._renderer.texture.unbind(p)});const d=this._renderer.gl;d.bindFramebuffer(d.FRAMEBUFFER,c.framebuffer);const f=this._viewPortCache;(f.x!==i.x||f.y!==u||f.width!==i.width||f.height!==i.height)&&(f.x=i.x,f.y=u,f.width=i.width,f.height=i.height,d.viewport(i.x,u,i.width,i.height)),!c.depthStencilRenderBuffer&&(e.stencil||e.depth)&&this._initStencil(c),this.clear(e,t,r)}finishRenderPass(e){const r=this._renderTargetSystem.getGpuRenderTarget(e);if(!r.msaa)return;const i=this._renderer.gl;i.bindFramebuffer(i.FRAMEBUFFER,r.resolveTargetFramebuffer),i.bindFramebuffer(i.READ_FRAMEBUFFER,r.framebuffer),i.blitFramebuffer(0,0,r.width,r.height,0,0,r.width,r.height,i.COLOR_BUFFER_BIT,i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)}initGpuRenderTarget(e){const r=this._renderer.gl,i=new _ee;return e.colorTexture instanceof ja?(this._renderer.context.ensureCanvasSize(e.colorTexture.resource),i.framebuffer=null,i):(this._initColor(e,i),r.bindFramebuffer(r.FRAMEBUFFER,null),i)}destroyGpuRenderTarget(e){const t=this._renderer.gl;e.framebuffer&&(t.deleteFramebuffer(e.framebuffer),e.framebuffer=null),e.resolveTargetFramebuffer&&(t.deleteFramebuffer(e.resolveTargetFramebuffer),e.resolveTargetFramebuffer=null),e.depthStencilRenderBuffer&&(t.deleteRenderbuffer(e.depthStencilRenderBuffer),e.depthStencilRenderBuffer=null),e.msaaRenderBuffer.forEach(r=>{t.deleteRenderbuffer(r)}),e.msaaRenderBuffer=null}clear(e,t,r){if(!t)return;const i=this._renderTargetSystem;typeof t=="boolean"&&(t=t?Ba.ALL:Ba.NONE);const s=this._renderer.gl;if(t&Ba.COLOR){r??(r=i.defaultClearColor);const o=this._clearColorCache,c=r;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3])&&(o[0]=c[0],o[1]=c[1],o[2]=c[2],o[3]=c[3],s.clearColor(c[0],c[1],c[2],c[3]))}s.clear(t)}resizeGpuRenderTarget(e){if(e.isRoot)return;const r=this._renderTargetSystem.getGpuRenderTarget(e);this._resizeColor(e,r),(e.stencil||e.depth)&&this._resizeStencil(r)}_initColor(e,t){const r=this._renderer,i=r.gl,s=i.createFramebuffer();if(t.resolveTargetFramebuffer=s,i.bindFramebuffer(i.FRAMEBUFFER,s),t.width=e.colorTexture.source.pixelWidth,t.height=e.colorTexture.source.pixelHeight,e.colorTextures.forEach((o,c)=>{const u=o.source;u.antialias&&(r.context.supports.msaa?t.msaa=!0:ct("[RenderTexture] Antialiasing on textures is not supported in WebGL1")),r.texture.bindSource(u,0);const f=r.texture.getGlSource(u).texture;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+c,3553,f,0)}),t.msaa){const o=i.createFramebuffer();t.framebuffer=o,i.bindFramebuffer(i.FRAMEBUFFER,o),e.colorTextures.forEach((c,u)=>{const d=i.createRenderbuffer();t.msaaRenderBuffer[u]=d})}else t.framebuffer=s;this._resizeColor(e,t)}_resizeColor(e,t){const r=e.colorTexture.source;if(t.width=r.pixelWidth,t.height=r.pixelHeight,e.colorTextures.forEach((i,s)=>{s!==0&&i.source.resize(r.width,r.height,r._resolution)}),t.msaa){const i=this._renderer,s=i.gl,o=t.framebuffer;s.bindFramebuffer(s.FRAMEBUFFER,o),e.colorTextures.forEach((c,u)=>{const d=c.source;i.texture.bindSource(d,0);const p=i.texture.getGlSource(d).internalFormat,y=t.msaaRenderBuffer[u];s.bindRenderbuffer(s.RENDERBUFFER,y),s.renderbufferStorageMultisample(s.RENDERBUFFER,4,p,d.pixelWidth,d.pixelHeight),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+u,s.RENDERBUFFER,y)})}}_initStencil(e){if(e.framebuffer===null)return;const t=this._renderer.gl,r=t.createRenderbuffer();e.depthStencilRenderBuffer=r,t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r),this._resizeStencil(e)}_resizeStencil(e){const t=this._renderer.gl;t.bindRenderbuffer(t.RENDERBUFFER,e.depthStencilRenderBuffer),e.msaa?t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,this._renderer.context.webGLVersion===2?t.DEPTH24_STENCIL8:t.DEPTH_STENCIL,e.width,e.height)}prerender(e){const t=e.colorTexture.resource;this._renderer.context.multiView&&ja.test(t)&&this._renderer.context.ensureCanvasSize(t)}postrender(e){if(this._renderer.context.multiView&&ja.test(e.colorTexture.resource)){const t=this._renderer.context.canvas,r=e.colorTexture;r.context2D.drawImage(t,0,r.pixelHeight-t.height)}}}function Eee(n,e,t,r,i,s){const o=s?1:-1;return n.identity(),n.a=1/r*2,n.d=o*(1/i*2),n.tx=-1-e*n.a,n.ty=-o-t*n.d,n}const ac=new Map;Oc.register(ac);function tP(n,e){if(!ac.has(n)){const t=new Ue({source:new ja({resource:n,...e})}),r=()=>{ac.get(n)===t&&ac.delete(n)};t.once("destroy",r),t.source.once("destroy",r),ac.set(n,t)}return ac.get(n)}function Mee(n){const e=n.colorTexture.source.resource;return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement&&document.body.contains(e)}const nP=class rP{constructor(e={}){if(this.uid=an("renderTarget"),this.colorTextures=[],this.dirtyId=0,this.isRoot=!1,this._size=new Float32Array(2),this._managedColorTextures=!1,e={...rP.defaultOptions,...e},this.stencil=e.stencil,this.depth=e.depth,this.isRoot=e.isRoot,typeof e.colorTextures=="number"){this._managedColorTextures=!0;for(let t=0;t<e.colorTextures;t++)this.colorTextures.push(new ur({width:e.width,height:e.height,resolution:e.resolution,antialias:e.antialias}))}else{this.colorTextures=[...e.colorTextures.map(r=>r.source)];const t=this.colorTexture.source;this.resize(t.width,t.height,t._resolution)}this.colorTexture.source.on("resize",this.onSourceResize,this),(e.depthStencilTexture||this.stencil)&&(e.depthStencilTexture instanceof Ue||e.depthStencilTexture instanceof ur?this.depthStencilTexture=e.depthStencilTexture.source:this.ensureDepthStencilTexture())}get size(){const e=this._size;return e[0]=this.pixelWidth,e[1]=this.pixelHeight,e}get width(){return this.colorTexture.source.width}get height(){return this.colorTexture.source.height}get pixelWidth(){return this.colorTexture.source.pixelWidth}get pixelHeight(){return this.colorTexture.source.pixelHeight}get resolution(){return this.colorTexture.source._resolution}get colorTexture(){return this.colorTextures[0]}onSourceResize(e){this.resize(e.width,e.height,e._resolution,!0)}ensureDepthStencilTexture(){this.depthStencilTexture||(this.depthStencilTexture=new ur({width:this.width,height:this.height,resolution:this.resolution,format:"depth24plus-stencil8",autoGenerateMipmaps:!1,antialias:!1,mipLevelCount:1}))}resize(e,t,r=this.resolution,i=!1){this.dirtyId++,this.colorTextures.forEach((s,o)=>{i&&o===0||s.source.resize(e,t,r)}),this.depthStencilTexture&&this.depthStencilTexture.source.resize(e,t,r)}destroy(){this.colorTexture.source.off("resize",this.onSourceResize,this),this._managedColorTextures&&this.colorTextures.forEach(e=>{e.destroy()}),this.depthStencilTexture&&(this.depthStencilTexture.destroy(),delete this.depthStencilTexture)}};nP.defaultOptions={width:0,height:0,resolution:1,colorTextures:1,stencil:!1,depth:!1,antialias:!1,isRoot:!1};let e2=nP;class Nee{constructor(e){this.rootViewPort=new Qt,this.viewport=new Qt,this.onRenderTargetChange=new eR("onRenderTargetChange"),this.projectionMatrix=new We,this.defaultClearColor=[0,0,0,0],this._renderSurfaceToRenderTargetHash=new Map,this._gpuRenderTargetHash=Object.create(null),this._renderTargetStack=[],this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuRenderTargetHash")}finishRenderPass(){this.adaptor.finishRenderPass(this.renderTarget)}renderStart({target:e,clear:t,clearColor:r,frame:i}){this._renderTargetStack.length=0,this.push(e,t,r,i),this.rootViewPort.copyFrom(this.viewport),this.rootRenderTarget=this.renderTarget,this.renderingToScreen=Mee(this.rootRenderTarget),this.adaptor.prerender?.(this.rootRenderTarget)}postrender(){this.adaptor.postrender?.(this.rootRenderTarget)}bind(e,t=!0,r,i){const s=this.getRenderTarget(e),o=this.renderTarget!==s;this.renderTarget=s,this.renderSurface=e;const c=this.getGpuRenderTarget(s);(s.pixelWidth!==c.width||s.pixelHeight!==c.height)&&(this.adaptor.resizeGpuRenderTarget(s),c.width=s.pixelWidth,c.height=s.pixelHeight);const u=s.colorTexture,d=this.viewport,f=u.pixelWidth,p=u.pixelHeight;if(!i&&e instanceof Ue&&(i=e.frame),i){const y=u._resolution;d.x=i.x*y+.5|0,d.y=i.y*y+.5|0,d.width=i.width*y+.5|0,d.height=i.height*y+.5|0}else d.x=0,d.y=0,d.width=f,d.height=p;return Eee(this.projectionMatrix,0,0,d.width/u.resolution,d.height/u.resolution,!s.isRoot),this.adaptor.startRenderPass(s,t,r,d),o&&this.onRenderTargetChange.emit(s),s}clear(e,t=Ba.ALL,r){t&&(e&&(e=this.getRenderTarget(e)),this.adaptor.clear(e||this.renderTarget,t,r,this.viewport))}contextChange(){this._gpuRenderTargetHash=Object.create(null)}push(e,t=Ba.ALL,r,i){const s=this.bind(e,t,r,i);return this._renderTargetStack.push({renderTarget:s,frame:i}),s}pop(){this._renderTargetStack.pop();const e=this._renderTargetStack[this._renderTargetStack.length-1];this.bind(e.renderTarget,!1,null,e.frame)}getRenderTarget(e){return e.isTexture&&(e=e.source),this._renderSurfaceToRenderTargetHash.get(e)??this._initRenderTarget(e)}copyToTexture(e,t,r,i,s){r.x<0&&(i.width+=r.x,s.x-=r.x,r.x=0),r.y<0&&(i.height+=r.y,s.y-=r.y,r.y=0);const{pixelWidth:o,pixelHeight:c}=e;return i.width=Math.min(i.width,o-r.x),i.height=Math.min(i.height,c-r.y),this.adaptor.copyToTexture(e,t,r,i,s)}ensureDepthStencil(){this.renderTarget.stencil||(this.renderTarget.stencil=!0,this.adaptor.startRenderPass(this.renderTarget,!1,null,this.viewport))}destroy(){this._renderer=null,this._renderSurfaceToRenderTargetHash.forEach((e,t)=>{e!==t&&e.destroy()}),this._renderSurfaceToRenderTargetHash.clear(),this._gpuRenderTargetHash=Object.create(null)}_initRenderTarget(e){let t=null;return ja.test(e)&&(e=tP(e).source),e instanceof e2?t=e:e instanceof ur&&(t=new e2({colorTextures:[e]}),e.source instanceof ja&&(t.isRoot=!0),e.once("destroy",()=>{t.destroy(),this._renderSurfaceToRenderTargetHash.delete(e);const r=this._gpuRenderTargetHash[t.uid];r&&(this._gpuRenderTargetHash[t.uid]=null,this.adaptor.destroyGpuRenderTarget(r))})),this._renderSurfaceToRenderTargetHash.set(e,t),t}getGpuRenderTarget(e){return this._gpuRenderTargetHash[e.uid]||(this._gpuRenderTargetHash[e.uid]=this.adaptor.initGpuRenderTarget(e))}resetState(){this.renderTarget=null,this.renderSurface=null}}class iP extends Nee{constructor(e){super(e),this.adaptor=new Tee,this.adaptor.init(e,this)}}iP.extension={type:[me.WebGLSystem],name:"renderTarget"};class sP extends zi{constructor({buffer:e,offset:t,size:r}){super(),this.uid=an("buffer"),this._resourceType="bufferResource",this._touched=0,this._resourceId=an("resource"),this._bufferResource=!0,this.destroyed=!1,this.buffer=e,this.offset=t|0,this.size=r,this.buffer.on("change",this.onBufferChange,this)}onBufferChange(){this._resourceId=an("resource"),this.emit("change",this)}destroy(e=!1){this.destroyed=!0,e&&this.buffer.destroy(),this.emit("change",this),this.buffer=null,this.removeAllListeners()}}function Iee(n,e){const t=[],r=[`
        var g = s.groups;
        var sS = r.shader;
        var p = s.glProgram;
        var ugS = r.uniformGroup;
        var resources;
    `];let i=!1,s=0;const o=e._getProgramData(n.glProgram);for(const u in n.groups){const d=n.groups[u];t.push(`
            resources = g[${u}].resources;
        `);for(const f in d.resources){const p=d.resources[f];if(p instanceof tl)if(p.ubo){const y=n._uniformBindMap[u][Number(f)];t.push(`
                        sS.bindUniformBlock(
                            resources[${f}],
                            '${y}',
                            ${n.glProgram._uniformBlockData[y].index}
                        );
                    `)}else t.push(`
                        ugS.updateUniformGroup(resources[${f}], p, sD);
                    `);else if(p instanceof sP){const y=n._uniformBindMap[u][Number(f)];t.push(`
                    sS.bindUniformBlock(
                        resources[${f}],
                        '${y}',
                        ${n.glProgram._uniformBlockData[y].index}
                    );
                `)}else if(p instanceof ur){const y=n._uniformBindMap[u][f],b=o.uniformData[y];b&&(i||(i=!0,r.push(`
                        var tS = r.texture;
                        `)),e._gl.uniform1i(b.location,s),t.push(`
                        tS.bind(resources[${f}], ${s});
                    `),s++)}}}const c=[...r,...t].join(`
`);return new Function("r","s","sD",c)}class Ree{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBlockBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBlockBindings=null,this.program=null}}function VE(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}function mx(n){const e=new Array(n);for(let t=0;t<e.length;t++)e[t]=!1;return e}function aP(n,e){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return mx(2*e);case"bvec3":return mx(3*e);case"bvec4":return mx(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}let Wm=null;const WE={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"},Pee={float:"float32",vec2:"float32x2",vec3:"float32x3",vec4:"float32x4",int:"sint32",ivec2:"sint32x2",ivec3:"sint32x3",ivec4:"sint32x4",uint:"uint32",uvec2:"uint32x2",uvec3:"uint32x3",uvec4:"uint32x4",bool:"uint32",bvec2:"uint32x2",bvec3:"uint32x3",bvec4:"uint32x4"};function oP(n,e){if(!Wm){const t=Object.keys(WE);Wm={};for(let r=0;r<t.length;++r){const i=t[r];Wm[n[i]]=WE[i]}}return Wm[e]}function Dee(n,e){const t=oP(n,e);return Pee[t]||"float32"}function jee(n,e,t=!1){const r={},i=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES);for(let o=0;o<i;o++){const c=e.getActiveAttrib(n,o);if(c.name.startsWith("gl_"))continue;const u=Dee(e,c.type);r[c.name]={location:0,format:u,stride:pd(u).stride,offset:0,instance:!1,start:0}}const s=Object.keys(r);if(t){s.sort((o,c)=>o>c?1:-1);for(let o=0;o<s.length;o++)r[s[o]].location=o,e.bindAttribLocation(n,o,s[o]);e.linkProgram(n)}else for(let o=0;o<s.length;o++)r[s[o]].location=e.getAttribLocation(n,s[o]);return r}function Bee(n,e){if(!e.ACTIVE_UNIFORM_BLOCKS)return{};const t={},r=e.getProgramParameter(n,e.ACTIVE_UNIFORM_BLOCKS);for(let i=0;i<r;i++){const s=e.getActiveUniformBlockName(n,i),o=e.getUniformBlockIndex(n,s),c=e.getActiveUniformBlockParameter(n,i,e.UNIFORM_BLOCK_DATA_SIZE);t[s]={name:s,index:o,size:c}}return t}function Oee(n,e){const t={},r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const s=e.getActiveUniform(n,i),o=s.name.replace(/\[.*?\]$/,""),c=!!s.name.match(/\[.*?\]$/),u=oP(e,s.type);t[o]={name:o,index:i,type:u,size:s.size,isArray:c,value:aP(u,s.size)}}return t}function YE(n,e){const t=n.getShaderSource(e).split(`
`).map((d,f)=>`${f}: ${d}`),r=n.getShaderInfoLog(e),i=r.split(`
`),s={},o=i.map(d=>parseFloat(d.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(d=>d&&!s[d]?(s[d]=!0,!0):!1),c=[""];o.forEach(d=>{t[d-1]=`%c${t[d-1]}%c`,c.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const u=t.join(`
`);c[0]=u,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...c),console.groupEnd()}function Lee(n,e,t,r){n.getProgramParameter(e,n.LINK_STATUS)||(n.getShaderParameter(t,n.COMPILE_STATUS)||YE(n,t),n.getShaderParameter(r,n.COMPILE_STATUS)||YE(n,r),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(e)))}function zee(n,e){const t=VE(n,n.VERTEX_SHADER,e.vertex),r=VE(n,n.FRAGMENT_SHADER,e.fragment),i=n.createProgram();n.attachShader(i,t),n.attachShader(i,r);const s=e.transformFeedbackVaryings;s&&(typeof n.transformFeedbackVaryings!="function"?ct("TransformFeedback is not supported but TransformFeedbackVaryings are given."):n.transformFeedbackVaryings(i,s.names,s.bufferMode==="separate"?n.SEPARATE_ATTRIBS:n.INTERLEAVED_ATTRIBS)),n.linkProgram(i),n.getProgramParameter(i,n.LINK_STATUS)||Lee(n,i,t,r),e._attributeData=jee(i,n,!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertex)),e._uniformData=Oee(i,n),e._uniformBlockData=Bee(i,n),n.deleteShader(t),n.deleteShader(r);const o={};for(const u in e._uniformData){const d=e._uniformData[u];o[u]={location:n.getUniformLocation(i,u),value:aP(d.type,d.size)}}return new Ree(i,o)}const Ym={textureCount:0,blockIndex:0};class lP{constructor(e){this._activeProgram=null,this._programDataHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_programDataHash")}contextChange(e){this._gl=e,this._programDataHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._activeProgram=null}bind(e,t){if(this._setProgram(e.glProgram),t)return;Ym.textureCount=0,Ym.blockIndex=0;let r=this._shaderSyncFunctions[e.glProgram._key];r||(r=this._shaderSyncFunctions[e.glProgram._key]=this._generateShaderSync(e,this)),this._renderer.buffer.nextBindBase(!!e.glProgram.transformFeedbackVaryings),r(this._renderer,e,Ym)}updateUniformGroup(e){this._renderer.uniformGroup.updateUniformGroup(e,this._activeProgram,Ym)}bindUniformBlock(e,t,r=0){const i=this._renderer.buffer,s=this._getProgramData(this._activeProgram),o=e._bufferResource;o||this._renderer.ubo.updateUniformGroup(e);const c=e.buffer,u=i.updateBuffer(c),d=i.freeLocationForBufferBase(u);if(o){const{offset:p,size:y}=e;p===0&&y===c.data.byteLength?i.bindBufferBase(u,d):i.bindBufferRange(u,d,p)}else i.getLastBindBaseLocation(u)!==d&&i.bindBufferBase(u,d);const f=this._activeProgram._uniformBlockData[t].index;s.uniformBlockBindings[r]!==d&&(s.uniformBlockBindings[r]=d,this._renderer.gl.uniformBlockBinding(s.program,f,d))}_setProgram(e){if(this._activeProgram===e)return;this._activeProgram=e;const t=this._getProgramData(e);this._gl.useProgram(t.program)}_getProgramData(e){return this._programDataHash[e._key]||this._createProgramData(e)}_createProgramData(e){const t=e._key;return this._programDataHash[t]=zee(this._gl,e),this._programDataHash[t]}destroy(){for(const e of Object.keys(this._programDataHash))this._programDataHash[e].destroy(),this._programDataHash[e]=null;this._programDataHash=null,this._shaderSyncFunctions=null,this._activeProgram=null,this._renderer=null,this._gl=null}_generateShaderSync(e,t){return Iee(e,t)}resetState(){this._activeProgram=null}}lP.extension={type:[me.WebGLSystem],name:"shader"};const Uee={f32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1f(location, v);
        }`,"vec2<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2f(location, v[0], v[1]);
        }`,"vec3<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3f(location, v[0], v[1], v[2]);
        }`,"vec4<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4f(location, v[0], v[1], v[2], v[3]);
        }`,i32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,u32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1ui(location, v);
        }`,"vec2<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2ui(location, v[0], v[1]);
        }`,"vec3<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3ui(location, v[0], v[1], v[2]);
        }`,"vec4<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
        }`,bool:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,"mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);"},Fee={f32:"gl.uniform1fv(location, v);","vec2<f32>":"gl.uniform2fv(location, v);","vec3<f32>":"gl.uniform3fv(location, v);","vec4<f32>":"gl.uniform4fv(location, v);","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);",i32:"gl.uniform1iv(location, v);","vec2<i32>":"gl.uniform2iv(location, v);","vec3<i32>":"gl.uniform3iv(location, v);","vec4<i32>":"gl.uniform4iv(location, v);",u32:"gl.uniform1iv(location, v);","vec2<u32>":"gl.uniform2iv(location, v);","vec3<u32>":"gl.uniform3iv(location, v);","vec4<u32>":"gl.uniform4iv(location, v);",bool:"gl.uniform1iv(location, v);","vec2<bool>":"gl.uniform2iv(location, v);","vec3<bool>":"gl.uniform3iv(location, v);","vec4<bool>":"gl.uniform4iv(location, v);"};function Gee(n,e){const t=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
        var name = null;
    `];for(const r in n.uniforms){if(!e[r]){n.uniforms[r]instanceof tl?n.uniforms[r].ubo?t.push(`
                        renderer.shader.bindUniformBlock(uv.${r}, "${r}");
                    `):t.push(`
                        renderer.shader.updateUniformGroup(uv.${r});
                    `):n.uniforms[r]instanceof sP&&t.push(`
                        renderer.shader.bindBufferResource(uv.${r}, "${r}");
                    `);continue}const i=n.uniformStructures[r];let s=!1;for(let o=0;o<Ro.length;o++){const c=Ro[o];if(i.type===c.type&&c.test(i)){t.push(`name = "${r}";`,Ro[o].uniform),s=!0;break}}if(!s){const c=(i.size===1?Uee:Fee)[i.type].replace("location",`ud["${r}"].location`);t.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${c};`)}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}class cP{constructor(e){this._cache={},this._uniformGroupSyncHash={},this._renderer=e,this.gl=null,this._cache={}}contextChange(e){this.gl=e}updateUniformGroup(e,t,r){const i=this._renderer.shader._getProgramData(t);(!e.isStatic||e._dirtyId!==i.uniformDirtyGroups[e.uid])&&(i.uniformDirtyGroups[e.uid]=e._dirtyId,this._getUniformSyncFunction(e,t)(i.uniformData,e.uniforms,this._renderer,r))}_getUniformSyncFunction(e,t){return this._uniformGroupSyncHash[e._signature]?.[t._key]||this._createUniformSyncFunction(e,t)}_createUniformSyncFunction(e,t){const r=this._uniformGroupSyncHash[e._signature]||(this._uniformGroupSyncHash[e._signature]={}),i=this._getSignature(e,t._uniformData,"u");return this._cache[i]||(this._cache[i]=this._generateUniformsSync(e,t._uniformData)),r[t._key]=this._cache[i],r[t._key]}_generateUniformsSync(e,t){return Gee(e,t)}_getSignature(e,t,r){const i=e.uniforms,s=[`${r}-`];for(const o in i)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")}destroy(){this._renderer=null,this._cache=null}}cP.extension={type:[me.WebGLSystem],name:"uniformGroup"};function Hee(n){const e={};if(e.normal=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e.add=[n.ONE,n.ONE],e.multiply=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e.screen=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e.none=[0,0],e["normal-npm"]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e["add-npm"]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],e["screen-npm"]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e.erase=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],!(n instanceof Dt.get().getWebGLRenderingContext()))e.min=[n.ONE,n.ONE,n.ONE,n.ONE,n.MIN,n.MIN],e.max=[n.ONE,n.ONE,n.ONE,n.ONE,n.MAX,n.MAX];else{const r=n.getExtension("EXT_blend_minmax");r&&(e.min=[n.ONE,n.ONE,n.ONE,n.ONE,r.MIN_EXT,r.MIN_EXT],e.max=[n.ONE,n.ONE,n.ONE,n.ONE,r.MAX_EXT,r.MAX_EXT])}return e}const Vee=0,Wee=1,Yee=2,$ee=3,qee=4,Zee=5,uP=class t2{constructor(e){this._invertFrontFace=!1,this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode="none",this._blendEq=!1,this.map=[],this.map[Vee]=this.setBlend,this.map[Wee]=this.setOffset,this.map[Yee]=this.setCullFace,this.map[$ee]=this.setDepthTest,this.map[qee]=this.setFrontFace,this.map[Zee]=this.setDepthMask,this.checks=[],this.defaultState=Rd.for2d(),e.renderTarget.onRenderTargetChange.add(this)}onRenderTargetChange(e){this._invertFrontFace=!e.isRoot,this._cullFace?this.setFrontFace(this._frontFace):this._frontFaceDirty=!0}contextChange(e){this.gl=e,this.blendModesMap=Hee(e),this.resetState()}set(e){if(e||(e=this.defaultState),this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)t&1&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e||(e=this.defaultState);for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this._updateCheck(t2._checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this._updateCheck(t2._checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this._cullFace=e,this.gl[e?"enable":"disable"](this.gl.CULL_FACE),this._cullFace&&this._frontFaceDirty&&this.setFrontFace(this._frontFace)}setFrontFace(e){this._frontFace=e,this._frontFaceDirty=!1;const t=this._invertFrontFace?!e:e;this._glFrontFace!==t&&(this._glFrontFace=t,this.gl.frontFace(this.gl[t?"CW":"CCW"]))}setBlendMode(e){if(this.blendModesMap[e]||(e="normal"),e===this.blendMode)return;this.blendMode=e;const t=this.blendModesMap[e],r=this.gl;t.length===2?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}resetState(){this._glFrontFace=!1,this._frontFace=!1,this._cullFace=!1,this._frontFaceDirty=!1,this._invertFrontFace=!1,this.gl.frontFace(this.gl.CCW),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode="",this.setBlendMode("normal")}_updateCheck(e,t){const r=this.checks.indexOf(e);t&&r===-1?this.checks.push(e):!t&&r!==-1&&this.checks.splice(r,1)}static _checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static _checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null,this.checks.length=0}};uP.extension={type:[me.WebGLSystem],name:"state"};let Xee=uP;class Kee{constructor(e){this.target=WR.TEXTURE_2D,this.texture=e,this.width=-1,this.height=-1,this.type=kt.UNSIGNED_BYTE,this.internalFormat=J1.RGBA,this.format=J1.RGBA,this.samplerType=0}}const Qee={id:"buffer",upload(n,e,t){e.width===n.width||e.height===n.height?t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,e.format,e.type,n.resource):t.texImage2D(e.target,0,e.internalFormat,n.width,n.height,0,e.format,e.type,n.resource),e.width=n.width,e.height=n.height}},Jee={"bc1-rgba-unorm":!0,"bc1-rgba-unorm-srgb":!0,"bc2-rgba-unorm":!0,"bc2-rgba-unorm-srgb":!0,"bc3-rgba-unorm":!0,"bc3-rgba-unorm-srgb":!0,"bc4-r-unorm":!0,"bc4-r-snorm":!0,"bc5-rg-unorm":!0,"bc5-rg-snorm":!0,"bc6h-rgb-ufloat":!0,"bc6h-rgb-float":!0,"bc7-rgba-unorm":!0,"bc7-rgba-unorm-srgb":!0,"etc2-rgb8unorm":!0,"etc2-rgb8unorm-srgb":!0,"etc2-rgb8a1unorm":!0,"etc2-rgb8a1unorm-srgb":!0,"etc2-rgba8unorm":!0,"etc2-rgba8unorm-srgb":!0,"eac-r11unorm":!0,"eac-r11snorm":!0,"eac-rg11unorm":!0,"eac-rg11snorm":!0,"astc-4x4-unorm":!0,"astc-4x4-unorm-srgb":!0,"astc-5x4-unorm":!0,"astc-5x4-unorm-srgb":!0,"astc-5x5-unorm":!0,"astc-5x5-unorm-srgb":!0,"astc-6x5-unorm":!0,"astc-6x5-unorm-srgb":!0,"astc-6x6-unorm":!0,"astc-6x6-unorm-srgb":!0,"astc-8x5-unorm":!0,"astc-8x5-unorm-srgb":!0,"astc-8x6-unorm":!0,"astc-8x6-unorm-srgb":!0,"astc-8x8-unorm":!0,"astc-8x8-unorm-srgb":!0,"astc-10x5-unorm":!0,"astc-10x5-unorm-srgb":!0,"astc-10x6-unorm":!0,"astc-10x6-unorm-srgb":!0,"astc-10x8-unorm":!0,"astc-10x8-unorm-srgb":!0,"astc-10x10-unorm":!0,"astc-10x10-unorm-srgb":!0,"astc-12x10-unorm":!0,"astc-12x10-unorm-srgb":!0,"astc-12x12-unorm":!0,"astc-12x12-unorm-srgb":!0},ete={id:"compressed",upload(n,e,t){t.pixelStorei(t.UNPACK_ALIGNMENT,4);let r=n.pixelWidth,i=n.pixelHeight;const s=!!Jee[n.format];for(let o=0;o<n.resource.length;o++){const c=n.resource[o];s?t.compressedTexImage2D(t.TEXTURE_2D,o,e.internalFormat,r,i,0,c):t.texImage2D(t.TEXTURE_2D,o,e.internalFormat,r,i,0,e.format,e.type,c),r=Math.max(r>>1,1),i=Math.max(i>>1,1)}}},hP={id:"image",upload(n,e,t,r){const i=e.width,s=e.height,o=n.pixelWidth,c=n.pixelHeight,u=n.resourceWidth,d=n.resourceHeight;u<o||d<c?((i!==o||s!==c)&&t.texImage2D(e.target,0,e.internalFormat,o,c,0,e.format,e.type,null),r===2?t.texSubImage2D(t.TEXTURE_2D,0,0,0,u,d,e.format,e.type,n.resource):t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.format,e.type,n.resource)):i===o&&s===c?t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.format,e.type,n.resource):r===2?t.texImage2D(e.target,0,e.internalFormat,o,c,0,e.format,e.type,n.resource):t.texImage2D(e.target,0,e.internalFormat,e.format,e.type,n.resource),e.width=o,e.height=c}},tte={id:"video",upload(n,e,t,r){if(!n.isValid){t.texImage2D(e.target,0,e.internalFormat,1,1,0,e.format,e.type,null);return}hP.upload(n,e,t,r)}},$E={linear:9729,nearest:9728},nte={linear:{linear:9987,nearest:9985},nearest:{linear:9986,nearest:9984}},px={"clamp-to-edge":33071,repeat:10497,"mirror-repeat":33648},rte={never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519};function qE(n,e,t,r,i,s,o,c){const u=s;if(!c||n.addressModeU!=="repeat"||n.addressModeV!=="repeat"||n.addressModeW!=="repeat"){const d=px[o?"clamp-to-edge":n.addressModeU],f=px[o?"clamp-to-edge":n.addressModeV],p=px[o?"clamp-to-edge":n.addressModeW];e[i](u,e.TEXTURE_WRAP_S,d),e[i](u,e.TEXTURE_WRAP_T,f),e.TEXTURE_WRAP_R&&e[i](u,e.TEXTURE_WRAP_R,p)}if((!c||n.magFilter!=="linear")&&e[i](u,e.TEXTURE_MAG_FILTER,$E[n.magFilter]),t){if(!c||n.mipmapFilter!=="linear"){const d=nte[n.minFilter][n.mipmapFilter];e[i](u,e.TEXTURE_MIN_FILTER,d)}}else e[i](u,e.TEXTURE_MIN_FILTER,$E[n.minFilter]);if(r&&n.maxAnisotropy>1){const d=Math.min(n.maxAnisotropy,e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));e[i](u,r.TEXTURE_MAX_ANISOTROPY_EXT,d)}n.compare&&e[i](u,e.TEXTURE_COMPARE_FUNC,rte[n.compare])}function ite(n){return{r8unorm:n.RED,r8snorm:n.RED,r8uint:n.RED,r8sint:n.RED,r16uint:n.RED,r16sint:n.RED,r16float:n.RED,rg8unorm:n.RG,rg8snorm:n.RG,rg8uint:n.RG,rg8sint:n.RG,r32uint:n.RED,r32sint:n.RED,r32float:n.RED,rg16uint:n.RG,rg16sint:n.RG,rg16float:n.RG,rgba8unorm:n.RGBA,"rgba8unorm-srgb":n.RGBA,rgba8snorm:n.RGBA,rgba8uint:n.RGBA,rgba8sint:n.RGBA,bgra8unorm:n.RGBA,"bgra8unorm-srgb":n.RGBA,rgb9e5ufloat:n.RGB,rgb10a2unorm:n.RGBA,rg11b10ufloat:n.RGB,rg32uint:n.RG,rg32sint:n.RG,rg32float:n.RG,rgba16uint:n.RGBA,rgba16sint:n.RGBA,rgba16float:n.RGBA,rgba32uint:n.RGBA,rgba32sint:n.RGBA,rgba32float:n.RGBA,stencil8:n.STENCIL_INDEX8,depth16unorm:n.DEPTH_COMPONENT,depth24plus:n.DEPTH_COMPONENT,"depth24plus-stencil8":n.DEPTH_STENCIL,depth32float:n.DEPTH_COMPONENT,"depth32float-stencil8":n.DEPTH_STENCIL}}function ste(n,e){let t={},r=n.RGBA;return n instanceof Dt.get().getWebGLRenderingContext()?e.srgb&&(t={"rgba8unorm-srgb":e.srgb.SRGB8_ALPHA8_EXT,"bgra8unorm-srgb":e.srgb.SRGB8_ALPHA8_EXT}):(t={"rgba8unorm-srgb":n.SRGB8_ALPHA8,"bgra8unorm-srgb":n.SRGB8_ALPHA8},r=n.RGBA8),{r8unorm:n.R8,r8snorm:n.R8_SNORM,r8uint:n.R8UI,r8sint:n.R8I,r16uint:n.R16UI,r16sint:n.R16I,r16float:n.R16F,rg8unorm:n.RG8,rg8snorm:n.RG8_SNORM,rg8uint:n.RG8UI,rg8sint:n.RG8I,r32uint:n.R32UI,r32sint:n.R32I,r32float:n.R32F,rg16uint:n.RG16UI,rg16sint:n.RG16I,rg16float:n.RG16F,rgba8unorm:n.RGBA,...t,rgba8snorm:n.RGBA8_SNORM,rgba8uint:n.RGBA8UI,rgba8sint:n.RGBA8I,bgra8unorm:r,rgb9e5ufloat:n.RGB9_E5,rgb10a2unorm:n.RGB10_A2,rg11b10ufloat:n.R11F_G11F_B10F,rg32uint:n.RG32UI,rg32sint:n.RG32I,rg32float:n.RG32F,rgba16uint:n.RGBA16UI,rgba16sint:n.RGBA16I,rgba16float:n.RGBA16F,rgba32uint:n.RGBA32UI,rgba32sint:n.RGBA32I,rgba32float:n.RGBA32F,stencil8:n.STENCIL_INDEX8,depth16unorm:n.DEPTH_COMPONENT16,depth24plus:n.DEPTH_COMPONENT24,"depth24plus-stencil8":n.DEPTH24_STENCIL8,depth32float:n.DEPTH_COMPONENT32F,"depth32float-stencil8":n.DEPTH32F_STENCIL8,...e.s3tc?{"bc1-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,"bc2-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,"bc3-rgba-unorm":e.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT}:{},...e.s3tc_sRGB?{"bc1-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,"bc2-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,"bc3-rgba-unorm-srgb":e.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}:{},...e.rgtc?{"bc4-r-unorm":e.rgtc.COMPRESSED_RED_RGTC1_EXT,"bc4-r-snorm":e.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,"bc5-rg-unorm":e.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,"bc5-rg-snorm":e.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}:{},...e.bptc?{"bc6h-rgb-float":e.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,"bc6h-rgb-ufloat":e.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,"bc7-rgba-unorm":e.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,"bc7-rgba-unorm-srgb":e.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT}:{},...e.etc?{"etc2-rgb8unorm":e.etc.COMPRESSED_RGB8_ETC2,"etc2-rgb8unorm-srgb":e.etc.COMPRESSED_SRGB8_ETC2,"etc2-rgb8a1unorm":e.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgb8a1unorm-srgb":e.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgba8unorm":e.etc.COMPRESSED_RGBA8_ETC2_EAC,"etc2-rgba8unorm-srgb":e.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,"eac-r11unorm":e.etc.COMPRESSED_R11_EAC,"eac-rg11unorm":e.etc.COMPRESSED_SIGNED_RG11_EAC}:{},...e.astc?{"astc-4x4-unorm":e.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,"astc-4x4-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,"astc-5x4-unorm":e.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,"astc-5x4-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,"astc-5x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,"astc-5x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,"astc-6x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,"astc-6x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,"astc-6x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,"astc-6x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,"astc-8x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,"astc-8x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,"astc-8x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,"astc-8x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,"astc-8x8-unorm":e.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,"astc-8x8-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,"astc-10x5-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,"astc-10x5-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,"astc-10x6-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,"astc-10x6-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,"astc-10x8-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,"astc-10x8-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,"astc-10x10-unorm":e.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,"astc-10x10-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,"astc-12x10-unorm":e.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,"astc-12x10-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,"astc-12x12-unorm":e.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,"astc-12x12-unorm-srgb":e.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR}:{}}}function ate(n){return{r8unorm:n.UNSIGNED_BYTE,r8snorm:n.BYTE,r8uint:n.UNSIGNED_BYTE,r8sint:n.BYTE,r16uint:n.UNSIGNED_SHORT,r16sint:n.SHORT,r16float:n.HALF_FLOAT,rg8unorm:n.UNSIGNED_BYTE,rg8snorm:n.BYTE,rg8uint:n.UNSIGNED_BYTE,rg8sint:n.BYTE,r32uint:n.UNSIGNED_INT,r32sint:n.INT,r32float:n.FLOAT,rg16uint:n.UNSIGNED_SHORT,rg16sint:n.SHORT,rg16float:n.HALF_FLOAT,rgba8unorm:n.UNSIGNED_BYTE,"rgba8unorm-srgb":n.UNSIGNED_BYTE,rgba8snorm:n.BYTE,rgba8uint:n.UNSIGNED_BYTE,rgba8sint:n.BYTE,bgra8unorm:n.UNSIGNED_BYTE,"bgra8unorm-srgb":n.UNSIGNED_BYTE,rgb9e5ufloat:n.UNSIGNED_INT_5_9_9_9_REV,rgb10a2unorm:n.UNSIGNED_INT_2_10_10_10_REV,rg11b10ufloat:n.UNSIGNED_INT_10F_11F_11F_REV,rg32uint:n.UNSIGNED_INT,rg32sint:n.INT,rg32float:n.FLOAT,rgba16uint:n.UNSIGNED_SHORT,rgba16sint:n.SHORT,rgba16float:n.HALF_FLOAT,rgba32uint:n.UNSIGNED_INT,rgba32sint:n.INT,rgba32float:n.FLOAT,stencil8:n.UNSIGNED_BYTE,depth16unorm:n.UNSIGNED_SHORT,depth24plus:n.UNSIGNED_INT,"depth24plus-stencil8":n.UNSIGNED_INT_24_8,depth32float:n.FLOAT,"depth32float-stencil8":n.FLOAT_32_UNSIGNED_INT_24_8_REV}}const ote=4;class dP{constructor(e){this.managedTextures=[],this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundTextures=[],this._activeTextureLocation=-1,this._boundSamplers=Object.create(null),this._uploads={image:hP,buffer:Qee,video:tte,compressed:ete},this._premultiplyAlpha=!1,this._useSeparateSamplers=!1,this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_glTextures"),this._renderer.renderableGC.addManagedHash(this,"_glSamplers")}contextChange(e){this._gl=e,this._mapFormatToInternalFormat||(this._mapFormatToInternalFormat=ste(e,this._renderer.context.extensions),this._mapFormatToType=ate(e),this._mapFormatToFormat=ite(e)),this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundSamplers=Object.create(null),this._premultiplyAlpha=!1;for(let t=0;t<16;t++)this.bind(Ue.EMPTY,t)}initSource(e){this.bind(e)}bind(e,t=0){const r=e.source;e?(this.bindSource(r,t),this._useSeparateSamplers&&this._bindSampler(r.style,t)):(this.bindSource(null,t),this._useSeparateSamplers&&this._bindSampler(null,t))}bindSource(e,t=0){const r=this._gl;if(e._touched=this._renderer.textureGC.count,this._boundTextures[t]!==e){this._boundTextures[t]=e,this._activateLocation(t),e||(e=Ue.EMPTY.source);const i=this.getGlSource(e);r.bindTexture(i.target,i.texture)}}_bindSampler(e,t=0){const r=this._gl;if(!e){this._boundSamplers[t]=null,r.bindSampler(t,null);return}const i=this._getGlSampler(e);this._boundSamplers[t]!==i&&(this._boundSamplers[t]=i,r.bindSampler(t,i))}unbind(e){const t=e.source,r=this._boundTextures,i=this._gl;for(let s=0;s<r.length;s++)if(r[s]===t){this._activateLocation(s);const o=this.getGlSource(t);i.bindTexture(o.target,null),r[s]=null}}_activateLocation(e){this._activeTextureLocation!==e&&(this._activeTextureLocation=e,this._gl.activeTexture(this._gl.TEXTURE0+e))}_initSource(e){const t=this._gl,r=new Kee(t.createTexture());if(r.type=this._mapFormatToType[e.format],r.internalFormat=this._mapFormatToInternalFormat[e.format],r.format=this._mapFormatToFormat[e.format],e.autoGenerateMipmaps&&(this._renderer.context.supports.nonPowOf2mipmaps||e.isPowerOfTwo)){const i=Math.max(e.width,e.height);e.mipLevelCount=Math.floor(Math.log2(i))+1}return this._glTextures[e.uid]=r,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceUpdate,this),e.on("styleChange",this.onStyleChange,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),this.updateStyle(e,!1),r}onStyleChange(e){this.updateStyle(e,!1)}updateStyle(e,t){const r=this._gl,i=this.getGlSource(e);r.bindTexture(r.TEXTURE_2D,i.texture),this._boundTextures[this._activeTextureLocation]=e,qE(e.style,r,e.mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"texParameteri",r.TEXTURE_2D,!this._renderer.context.supports.nonPowOf2wrapping&&!e.isPowerOfTwo,t)}onSourceUnload(e){const t=this._glTextures[e.uid];t&&(this.unbind(e),this._glTextures[e.uid]=null,this._gl.deleteTexture(t.texture))}onSourceUpdate(e){const t=this._gl,r=this.getGlSource(e);t.bindTexture(t.TEXTURE_2D,r.texture),this._boundTextures[this._activeTextureLocation]=e;const i=e.alphaMode==="premultiply-alpha-on-upload";this._premultiplyAlpha!==i&&(this._premultiplyAlpha=i,t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i)),this._uploads[e.uploadMethodId]?this._uploads[e.uploadMethodId].upload(e,r,t,this._renderer.context.webGLVersion):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.pixelWidth,e.pixelHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e,!1)}onUpdateMipmaps(e,t=!0){t&&this.bindSource(e,0);const r=this.getGlSource(e);this._gl.generateMipmap(r.target)}onSourceDestroy(e){e.off("destroy",this.onSourceDestroy,this),e.off("update",this.onSourceUpdate,this),e.off("resize",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("styleChange",this.onStyleChange,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}_initSampler(e){const t=this._gl,r=this._gl.createSampler();return this._glSamplers[e._resourceId]=r,qE(e,t,this._boundTextures[this._activeTextureLocation].mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"samplerParameteri",r,!1,!0),this._glSamplers[e._resourceId]}_getGlSampler(e){return this._glSamplers[e._resourceId]||this._initSampler(e)}getGlSource(e){return this._glTextures[e.uid]||this._initSource(e)}generateCanvas(e){const{pixels:t,width:r,height:i}=this.getPixels(e),s=Dt.get().createCanvas();s.width=r,s.height=i;const o=s.getContext("2d");if(o){const c=o.createImageData(r,i);c.data.set(t),o.putImageData(c,0,0)}return s}getPixels(e){const t=e.source.resolution,r=e.frame,i=Math.max(Math.round(r.width*t),1),s=Math.max(Math.round(r.height*t),1),o=new Uint8Array(ote*i*s),c=this._renderer,u=c.renderTarget.getRenderTarget(e),d=c.renderTarget.getGpuRenderTarget(u),f=c.gl;return f.bindFramebuffer(f.FRAMEBUFFER,d.resolveTargetFramebuffer),f.readPixels(Math.round(r.x*t),Math.round(r.y*t),i,s,f.RGBA,f.UNSIGNED_BYTE,o),{pixels:new Uint8ClampedArray(o.buffer),width:i,height:s}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null,this._glTextures=null,this._glSamplers=null,this._boundTextures=null,this._boundSamplers=null,this._mapFormatToInternalFormat=null,this._mapFormatToType=null,this._mapFormatToFormat=null,this._uploads=null,this._renderer=null}resetState(){this._activeTextureLocation=-1,this._boundTextures.fill(Ue.EMPTY.source),this._boundSamplers=Object.create(null);const e=this._gl;this._premultiplyAlpha=!1,e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiplyAlpha)}}dP.extension={type:[me.WebGLSystem],name:"texture"};class fP{contextChange(e){const t=new tl({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new We,type:"mat3x3<f32>"},uRound:{value:0,type:"f32"}}),r=e.limits.maxBatchableTextures,i=_v({name:"graphics",bits:[mR,pR(r),zR,wv]});this.shader=new nl({glProgram:i,resources:{localUniforms:t,batchSamplers:gR(r)}})}execute(e,t){const r=t.context,i=r.customShader||this.shader,s=e.renderer,o=s.graphicsContext,{batcher:c,instructions:u}=o.getContextRenderData(r);i.groups[0]=s.globalUniforms.bindGroup,s.state.set(e.state),s.shader.bind(i),s.geometry.bind(c.geometry,i.glProgram);const d=u.instructions;for(let f=0;f<u.instructionSize;f++){const p=d[f];if(p.size){for(let y=0;y<p.textures.count;y++)s.texture.bind(p.textures.textures[y],y);s.geometry.draw(p.topology,p.size,p.start)}}}destroy(){this.shader.destroy(!0),this.shader=null}}fP.extension={type:[me.WebGLPipesAdaptor],name:"graphics"};class mP{init(){const e=_v({name:"mesh",bits:[zR,uee,wv]});this._shader=new nl({glProgram:e,resources:{uTexture:Ue.EMPTY.source,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new We}}}})}execute(e,t){const r=e.renderer;let i=t._shader;if(i){if(!i.glProgram){ct("Mesh shader has no glProgram",t.shader);return}}else{i=this._shader;const s=t.texture,o=s.source;i.resources.uTexture=o,i.resources.uSampler=o.style,i.resources.textureUniforms.uniforms.uTextureMatrix=s.textureMatrix.mapCoord}i.groups[100]=r.globalUniforms.bindGroup,i.groups[101]=e.localUniformsBindGroup,r.encoder.draw({geometry:t._geometry,shader:i,state:t.state})}destroy(){this._shader.destroy(!0),this._shader=null}}mP.extension={type:[me.WebGLPipesAdaptor],name:"mesh"};class pP{constructor(e){this._renderer=e}updateRenderable(){}destroyRenderable(){}validateRenderable(){return!1}addRenderable(e,t){this._renderer.renderPipes.batch.break(t),t.add(e)}execute(e){e.isRenderable&&e.render(this._renderer)}destroy(){this._renderer=null}}pP.extension={type:[me.WebGLPipes,me.WebGPUPipes,me.CanvasPipes],name:"customRender"};class gP{constructor(){this.batcherName="default",this.topology="triangle-list",this.attributeSize=4,this.indexSize=6,this.packAsQuad=!0,this.roundPixels=0,this._attributeStart=0,this._batcher=null,this._batch=null}get blendMode(){return this.renderable.groupBlendMode}get color(){return this.renderable.groupColorAlpha}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.bounds=null}destroy(){}}function n2(n,e){const t=n.instructionSet,r=t.instructions;for(let i=0;i<t.instructionSize;i++){const s=r[i];e[s.renderPipeId].execute(s)}}const lte=new We;class yP{constructor(e){this._renderer=e}addRenderGroup(e,t){e.isCachedAsTexture?this._addRenderableCacheAsTexture(e,t):this._addRenderableDirect(e,t)}execute(e){e.isRenderable&&(e.isCachedAsTexture?this._executeCacheAsTexture(e):this._executeDirect(e))}destroy(){this._renderer=null}_addRenderableDirect(e,t){this._renderer.renderPipes.batch.break(t),e._batchableRenderGroup&&(Ar.return(e._batchableRenderGroup),e._batchableRenderGroup=null),t.add(e)}_addRenderableCacheAsTexture(e,t){const r=e._batchableRenderGroup??(e._batchableRenderGroup=Ar.get(gP));r.renderable=e.root,r.transform=e.root.relativeGroupTransform,r.texture=e.texture,r.bounds=e._textureBounds,t.add(e),this._renderer.renderPipes.blendMode.pushBlendMode(e,e.root.groupBlendMode,t),this._renderer.renderPipes.batch.addToBatch(r,t),this._renderer.renderPipes.blendMode.popBlendMode(t)}_executeCacheAsTexture(e){if(e.textureNeedsUpdate){e.textureNeedsUpdate=!1;const t=lte.identity().translate(-e._textureBounds.x,-e._textureBounds.y);this._renderer.renderTarget.push(e.texture,!0,null,e.texture.frame),this._renderer.globalUniforms.push({worldTransformMatrix:t,worldColor:4294967295,offset:{x:0,y:0}}),n2(e,this._renderer.renderPipes),this._renderer.renderTarget.finishRenderPass(),this._renderer.renderTarget.pop(),this._renderer.globalUniforms.pop()}e._batchableRenderGroup._batcher.updateElement(e._batchableRenderGroup),e._batchableRenderGroup._batcher.geometry.buffers[0].update()}_executeDirect(e){this._renderer.globalUniforms.push({worldTransformMatrix:e.inverseParentTextureTransform,worldColor:e.worldColorAlpha}),n2(e,this._renderer.renderPipes),this._renderer.globalUniforms.pop()}}yP.extension={type:[me.WebGLPipes,me.WebGPUPipes,me.CanvasPipes],name:"renderGroup"};function r2(n,e){e||(e=0);for(let t=e;t<n.length&&n[t];t++)n[t]=null}const cte=new cr,ZE=Vh|Gp|mv;function bP(n,e=!1){ute(n);const t=n.childrenToUpdate,r=n.updateTick++;for(const i in t){const s=Number(i),o=t[i],c=o.list,u=o.index;for(let d=0;d<u;d++){const f=c[d];f.parentRenderGroup===n&&f.relativeRenderGroupDepth===s&&xP(f,r,0)}r2(c,u),o.index=0}if(e)for(let i=0;i<n.renderGroupChildren.length;i++)bP(n.renderGroupChildren[i],e)}function ute(n){const e=n.root;let t;if(n.renderGroupParent){const r=n.renderGroupParent;n.worldTransform.appendFrom(e.relativeGroupTransform,r.worldTransform),n.worldColor=Fp(e.groupColor,r.worldColor),t=e.groupAlpha*r.worldAlpha}else n.worldTransform.copyFrom(e.localTransform),n.worldColor=e.localColor,t=e.localAlpha;t=t<0?0:t>1?1:t,n.worldAlpha=t,n.worldColorAlpha=n.worldColor+((t*255|0)<<24)}function xP(n,e,t){if(e===n.updateTick)return;n.updateTick=e,n.didChange=!1;const r=n.localTransform;n.updateLocalTransform();const i=n.parent;if(i&&!i.renderGroup?(t|=n._updateFlags,n.relativeGroupTransform.appendFrom(r,i.relativeGroupTransform),t&ZE&&XE(n,i,t)):(t=n._updateFlags,n.relativeGroupTransform.copyFrom(r),t&ZE&&XE(n,cte,t)),!n.renderGroup){const s=n.children,o=s.length;for(let d=0;d<o;d++)xP(s[d],e,t);const c=n.parentRenderGroup,u=n;u.renderPipeId&&!c.structureDidChange&&c.updateRenderable(u)}}function XE(n,e,t){if(t&Gp){n.groupColor=Fp(n.localColor,e.groupColor);let r=n.localAlpha*e.groupAlpha;r=r<0?0:r>1?1:r,n.groupAlpha=r,n.groupColorAlpha=n.groupColor+((r*255|0)<<24)}t&mv&&(n.groupBlendMode=n.localBlendMode==="inherit"?e.groupBlendMode:n.localBlendMode),t&Vh&&(n.globalDisplayStatus=n.localDisplayStatus&e.globalDisplayStatus),n._updateFlags=0}function hte(n,e){const{list:t}=n.childrenRenderablesToUpdate;let r=!1;for(let i=0;i<n.childrenRenderablesToUpdate.index;i++){const s=t[i];if(r=e[s.renderPipeId].validateRenderable(s),r)break}return n.structureDidChange=r,r}const dte=new We;class vP{constructor(e){this._renderer=e}render({container:e,transform:t}){const r=e.parent,i=e.renderGroup.renderGroupParent;e.parent=null,e.renderGroup.renderGroupParent=null;const s=this._renderer,o=dte;t&&(o.copyFrom(e.renderGroup.localTransform),e.renderGroup.localTransform.copyFrom(t));const c=s.renderPipes;this._updateCachedRenderGroups(e.renderGroup,null),this._updateRenderGroups(e.renderGroup),s.globalUniforms.start({worldTransformMatrix:t?e.renderGroup.localTransform:e.renderGroup.worldTransform,worldColor:e.renderGroup.worldColorAlpha}),n2(e.renderGroup,c),c.uniformBatch&&c.uniformBatch.renderEnd(),t&&e.renderGroup.localTransform.copyFrom(o),e.parent=r,e.renderGroup.renderGroupParent=i}destroy(){this._renderer=null}_updateCachedRenderGroups(e,t){if(e._parentCacheAsTextureRenderGroup=t,e.isCachedAsTexture){if(!e.textureNeedsUpdate)return;t=e}for(let r=e.renderGroupChildren.length-1;r>=0;r--)this._updateCachedRenderGroups(e.renderGroupChildren[r],t);if(e.invalidateMatrices(),e.isCachedAsTexture){if(e.textureNeedsUpdate){const r=e.root.getLocalBounds();r.ceil();const i=e.texture;e.texture&&zo.returnTexture(e.texture,!0);const s=this._renderer,o=e.textureOptions.resolution||s.view.resolution,c=e.textureOptions.antialias??s.view.antialias,u=e.textureOptions.scaleMode??"linear",d=zo.getOptimalTexture(r.width,r.height,o,c);d._source.style=new md({scaleMode:u}),e.texture=d,e._textureBounds||(e._textureBounds=new qr),e._textureBounds.copyFrom(r),i!==e.texture&&e.renderGroupParent&&(e.renderGroupParent.structureDidChange=!0)}}else e.texture&&(zo.returnTexture(e.texture,!0),e.texture=null)}_updateRenderGroups(e){const t=this._renderer,r=t.renderPipes;if(e.runOnRender(t),e.instructionSet.renderPipes=r,e.structureDidChange?r2(e.childrenRenderablesToUpdate.list,0):hte(e,r),bP(e),e.structureDidChange?(e.structureDidChange=!1,this._buildInstructions(e,t)):this._updateRenderables(e),e.childrenRenderablesToUpdate.index=0,t.renderPipes.batch.upload(e.instructionSet),!(e.isCachedAsTexture&&!e.textureNeedsUpdate))for(let i=0;i<e.renderGroupChildren.length;i++)this._updateRenderGroups(e.renderGroupChildren[i])}_updateRenderables(e){const{list:t,index:r}=e.childrenRenderablesToUpdate;for(let i=0;i<r;i++){const s=t[i];s.didViewUpdate&&e.updateRenderable(s)}r2(t,r)}_buildInstructions(e,t){const r=e.root,i=e.instructionSet;i.reset();const s=t.renderPipes?t:t.batch.renderer,o=s.renderPipes;o.batch.buildStart(i),o.blendMode.buildStart(),o.colorMask.buildStart(),r.sortableChildren&&r.sortChildren(),r.collectRenderablesWithEffects(i,s,null),o.batch.buildEnd(i),o.blendMode.buildEnd(i)}}vP.extension={type:[me.WebGLSystem,me.WebGPUSystem,me.CanvasSystem],name:"renderGroup"};class _P{constructor(e){this._renderer=e}addRenderable(e,t){const r=this._getGpuSprite(e);e.didViewUpdate&&this._updateBatchableSprite(e,r),this._renderer.renderPipes.batch.addToBatch(r,t)}updateRenderable(e){const t=this._getGpuSprite(e);e.didViewUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}validateRenderable(e){const t=this._getGpuSprite(e);return!t._batcher.checkAndUpdateTexture(t,e._texture)}_updateBatchableSprite(e,t){t.bounds=e.visualBounds,t.texture=e._texture}_getGpuSprite(e){return e._gpuData[this._renderer.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const t=new gP;return t.renderable=e,t.transform=e.groupTransform,t.texture=e._texture,t.bounds=e.visualBounds,t.roundPixels=this._renderer._roundPixels|e._roundPixels,e._gpuData[this._renderer.uid]=t,t}destroy(){this._renderer=null}}_P.extension={type:[me.WebGLPipes,me.WebGPUPipes,me.CanvasPipes],name:"sprite"};const Rv=class wP{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new An(0),this.color=this._backgroundColor,this.alpha=1}init(e){e={...wP.defaultOptions,...e},this.clearBeforeRender=e.clearBeforeRender,this.color=e.background||e.backgroundColor||this._backgroundColor,this.alpha=e.backgroundAlpha,this._backgroundColor.setAlpha(e.backgroundAlpha)}get color(){return this._backgroundColor}set color(e){An.shared.setValue(e).alpha<1&&this._backgroundColor.alpha===1&&ct("Cannot set a transparent background on an opaque canvas. To enable transparency, set backgroundAlpha < 1 when initializing your Application."),this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get colorRgba(){return this._backgroundColor.toArray()}destroy(){}};Rv.extension={type:[me.WebGLSystem,me.WebGPUSystem,me.CanvasSystem],name:"background",priority:0};Rv.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};let fte=Rv;const Xh={};Pn.handle(me.BlendMode,n=>{if(!n.name)throw new Error("BlendMode extension must have a name property");Xh[n.name]=n.ref},n=>{delete Xh[n.name]});class SP{constructor(e){this._blendModeStack=[],this._isAdvanced=!1,this._filterHash=Object.create(null),this._renderer=e,this._renderer.runners.prerender.add(this)}prerender(){this._activeBlendMode="normal",this._isAdvanced=!1}pushBlendMode(e,t,r){this._blendModeStack.push(t),this.setBlendMode(e,t,r)}popBlendMode(e){this._blendModeStack.pop();const t=this._blendModeStack[this._activeBlendMode.length-1]??"normal";this.setBlendMode(null,t,e)}setBlendMode(e,t,r){const i=e instanceof D1;if(this._activeBlendMode===t){this._isAdvanced&&e&&!i&&this._renderableList?.push(e);return}this._isAdvanced&&this._endAdvancedBlendMode(r),this._activeBlendMode=t,e&&(this._isAdvanced=!!Xh[t],this._isAdvanced&&this._beginAdvancedBlendMode(e,r))}_beginAdvancedBlendMode(e,t){this._renderer.renderPipes.batch.break(t);const r=this._activeBlendMode;if(!Xh[r]){ct(`Unable to assign BlendMode: '${r}'. You may want to include: import 'pixi.js/advanced-blend-modes'`);return}const i=this._ensureFilterEffect(r),s=e instanceof D1,o={renderPipeId:"filter",action:"pushFilter",filterEffect:i,renderables:s?null:[e],container:s?e.root:null,canBundle:!1};this._renderableList=o.renderables,t.add(o)}_ensureFilterEffect(e){let t=this._filterHash[e];return t||(t=this._filterHash[e]=new Up,t.filters=[new Xh[e]]),t}_endAdvancedBlendMode(e){this._isAdvanced=!1,this._renderableList=null,this._renderer.renderPipes.batch.break(e),e.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}buildStart(){this._isAdvanced=!1}buildEnd(e){this._isAdvanced&&this._endAdvancedBlendMode(e)}destroy(){this._renderer=null,this._renderableList=null;for(const e in this._filterHash)this._filterHash[e].destroy();this._filterHash=null}}SP.extension={type:[me.WebGLPipes,me.WebGPUPipes,me.CanvasPipes],name:"blendMode"};const gx={png:"image/png",jpg:"image/jpeg",webp:"image/webp"},Pv=class AP{constructor(e){this._renderer=e}_normalizeOptions(e,t={}){return e instanceof cr||e instanceof Ue?{target:e,...t}:{...t,...e}}async image(e){const t=Dt.get().createImage();return t.src=await this.base64(e),t}async base64(e){e=this._normalizeOptions(e,AP.defaultImageOptions);const{format:t,quality:r}=e,i=this.canvas(e);if(i.toBlob!==void 0)return new Promise((s,o)=>{i.toBlob(c=>{if(!c){o(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>s(u.result),u.onerror=o,u.readAsDataURL(c)},gx[t],r)});if(i.toDataURL!==void 0)return i.toDataURL(gx[t],r);if(i.convertToBlob!==void 0){const s=await i.convertToBlob({type:gx[t],quality:r});return new Promise((o,c)=>{const u=new FileReader;u.onload=()=>o(u.result),u.onerror=c,u.readAsDataURL(s)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e){e=this._normalizeOptions(e);const t=e.target,r=this._renderer;if(t instanceof Ue)return r.texture.generateCanvas(t);const i=r.textureGenerator.generateTexture(e),s=r.texture.generateCanvas(i);return i.destroy(!0),s}pixels(e){e=this._normalizeOptions(e);const t=e.target,r=this._renderer,i=t instanceof Ue?t:r.textureGenerator.generateTexture(e),s=r.texture.getPixels(i);return t instanceof cr&&i.destroy(!0),s}texture(e){return e=this._normalizeOptions(e),e.target instanceof Ue?e.target:this._renderer.textureGenerator.generateTexture(e)}download(e){e=this._normalizeOptions(e);const t=this.canvas(e),r=document.createElement("a");r.download=e.filename??"image.png",r.href=t.toDataURL("image/png"),document.body.appendChild(r),r.click(),document.body.removeChild(r)}log(e){const t=e.width??200;e=this._normalizeOptions(e);const r=this.canvas(e),i=r.toDataURL();console.log(`[Pixi Texture] ${r.width}px ${r.height}px`);const s=["font-size: 1px;",`padding: ${t}px 300px;`,`background: url(${i}) no-repeat;`,"background-size: contain;"].join(" ");console.log("%c ",s)}destroy(){this._renderer=null}};Pv.extension={type:[me.WebGLSystem,me.WebGPUSystem],name:"extract"};Pv.defaultImageOptions={format:"png",quality:1};let mte=Pv;class Dv extends Ue{static create(e){return new Dv({source:new ur(e)})}resize(e,t,r){return this.source.resize(e,t,r),this}}const pte=new Qt,gte=new qr,yte=[0,0,0,0];class CP{constructor(e){this._renderer=e}generateTexture(e){e instanceof cr&&(e={target:e,frame:void 0,textureSourceOptions:{},resolution:void 0});const t=e.resolution||this._renderer.resolution,r=e.antialias||this._renderer.view.antialias,i=e.target;let s=e.clearColor;s?s=Array.isArray(s)&&s.length===4?s:An.shared.setValue(s).toArray():s=yte;const o=e.frame?.copyTo(pte)||fv(i,gte).rectangle;o.width=Math.max(o.width,1/t)|0,o.height=Math.max(o.height,1/t)|0;const c=Dv.create({...e.textureSourceOptions,width:o.width,height:o.height,resolution:t,antialias:r}),u=We.shared.translate(-o.x,-o.y);return this._renderer.render({container:i,transform:u,target:c,clearColor:s}),c.source.updateMipmaps(),c}destroy(){this._renderer=null}}CP.extension={type:[me.WebGLSystem,me.WebGPUSystem],name:"textureGenerator"};function bte(n,e,t){const r=(n>>24&255)/255;e[t++]=(n&255)/255*r,e[t++]=(n>>8&255)/255*r,e[t++]=(n>>16&255)/255*r,e[t++]=r}class kP{constructor(e){this._stackIndex=0,this._globalUniformDataStack=[],this._uniformsPool=[],this._activeUniforms=[],this._bindGroupPool=[],this._activeBindGroups=[],this._renderer=e}reset(){this._stackIndex=0;for(let e=0;e<this._activeUniforms.length;e++)this._uniformsPool.push(this._activeUniforms[e]);for(let e=0;e<this._activeBindGroups.length;e++)this._bindGroupPool.push(this._activeBindGroups[e]);this._activeUniforms.length=0,this._activeBindGroups.length=0}start(e){this.reset(),this.push(e)}bind({size:e,projectionMatrix:t,worldTransformMatrix:r,worldColor:i,offset:s}){const o=this._renderer.renderTarget.renderTarget,c=this._stackIndex?this._globalUniformDataStack[this._stackIndex-1]:{worldTransformMatrix:new We,worldColor:4294967295,offset:new br},u={projectionMatrix:t||this._renderer.renderTarget.projectionMatrix,resolution:e||o.size,worldTransformMatrix:r||c.worldTransformMatrix,worldColor:i||c.worldColor,offset:s||c.offset,bindGroup:null},d=this._uniformsPool.pop()||this._createUniforms();this._activeUniforms.push(d);const f=d.uniforms;f.uProjectionMatrix=u.projectionMatrix,f.uResolution=u.resolution,f.uWorldTransformMatrix.copyFrom(u.worldTransformMatrix),f.uWorldTransformMatrix.tx-=u.offset.x,f.uWorldTransformMatrix.ty-=u.offset.y,bte(u.worldColor,f.uWorldColorAlpha,0),d.update();let p;this._renderer.renderPipes.uniformBatch?p=this._renderer.renderPipes.uniformBatch.getUniformBindGroup(d,!1):(p=this._bindGroupPool.pop()||new Yh,this._activeBindGroups.push(p),p.setResource(d,0)),u.bindGroup=p,this._currentGlobalUniformData=u}push(e){this.bind(e),this._globalUniformDataStack[this._stackIndex++]=this._currentGlobalUniformData}pop(){this._currentGlobalUniformData=this._globalUniformDataStack[--this._stackIndex-1],this._renderer.type===Yo.WEBGL&&this._currentGlobalUniformData.bindGroup.resources[0].update()}get bindGroup(){return this._currentGlobalUniformData.bindGroup}get globalUniformData(){return this._currentGlobalUniformData}get uniformGroup(){return this._currentGlobalUniformData.bindGroup.resources[0]}_createUniforms(){return new tl({uProjectionMatrix:{value:new We,type:"mat3x3<f32>"},uWorldTransformMatrix:{value:new We,type:"mat3x3<f32>"},uWorldColorAlpha:{value:new Float32Array(4),type:"vec4<f32>"},uResolution:{value:[0,0],type:"vec2<f32>"}},{isStatic:!0})}destroy(){this._renderer=null,this._globalUniformDataStack.length=0,this._uniformsPool.length=0,this._activeUniforms.length=0,this._bindGroupPool.length=0,this._activeBindGroups.length=0,this._currentGlobalUniformData=null}}kP.extension={type:[me.WebGLSystem,me.WebGPUSystem,me.CanvasSystem],name:"globalUniforms"};let xte=1;class TP{constructor(){this._tasks=[],this._offset=0}init(){uc.system.add(this._update,this)}repeat(e,t,r=!0){const i=xte++;let s=0;return r&&(this._offset+=1e3,s=this._offset),this._tasks.push({func:e,duration:t,start:performance.now(),offset:s,last:performance.now(),repeat:!0,id:i}),i}cancel(e){for(let t=0;t<this._tasks.length;t++)if(this._tasks[t].id===e){this._tasks.splice(t,1);return}}_update(){const e=performance.now();for(let t=0;t<this._tasks.length;t++){const r=this._tasks[t];if(e-r.offset-r.last>=r.duration){const i=e-r.start;r.func(i),r.last=e}}}destroy(){uc.system.remove(this._update,this),this._tasks.length=0}}TP.extension={type:[me.WebGLSystem,me.WebGPUSystem,me.CanvasSystem],name:"scheduler",priority:0};let KE=!1;function vte(n){if(!KE){if(Dt.get().getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){const e=[`%c  %c  %c  %c  %c PixiJS %c v${V1} (${n}) http://www.pixijs.com/

`,"background: #E72264; padding:5px 0;","background: #6CA2EA; padding:5px 0;","background: #B5D33D; padding:5px 0;","background: #FED23F; padding:5px 0;","color: #FFFFFF; background: #E72264; padding:5px 0;","color: #E72264; background: #FFFFFF; padding:5px 0;"];globalThis.console.log(...e)}else globalThis.console&&globalThis.console.log(`PixiJS ${V1} - ${n} - http://www.pixijs.com/`);KE=!0}}class jv{constructor(e){this._renderer=e}init(e){if(e.hello){let t=this._renderer.name;this._renderer.type===Yo.WEBGL&&(t+=` ${this._renderer.context.webGLVersion}`),vte(t)}}}jv.extension={type:[me.WebGLSystem,me.WebGPUSystem,me.CanvasSystem],name:"hello",priority:-2};jv.defaultOptions={hello:!1};function _te(n){let e=!1;for(const r in n)if(n[r]==null){e=!0;break}if(!e)return n;const t=Object.create(null);for(const r in n){const i=n[r];i&&(t[r]=i)}return t}function wte(n){let e=0;for(let t=0;t<n.length;t++)n[t]==null?e++:n[t-e]=n[t];return n.length-=e,n}let Ste=0;const Bv=class EP{constructor(e){this._managedRenderables=[],this._managedHashes=[],this._managedArrays=[],this._renderer=e}init(e){e={...EP.defaultOptions,...e},this.maxUnusedTime=e.renderableGCMaxUnusedTime,this._frequency=e.renderableGCFrequency,this.enabled=e.renderableGCActive}get enabled(){return!!this._handler}set enabled(e){this.enabled!==e&&(e?(this._handler=this._renderer.scheduler.repeat(()=>this.run(),this._frequency,!1),this._hashHandler=this._renderer.scheduler.repeat(()=>{for(const t of this._managedHashes)t.context[t.hash]=_te(t.context[t.hash])},this._frequency),this._arrayHandler=this._renderer.scheduler.repeat(()=>{for(const t of this._managedArrays)wte(t.context[t.hash])},this._frequency)):(this._renderer.scheduler.cancel(this._handler),this._renderer.scheduler.cancel(this._hashHandler),this._renderer.scheduler.cancel(this._arrayHandler)))}addManagedHash(e,t){this._managedHashes.push({context:e,hash:t})}addManagedArray(e,t){this._managedArrays.push({context:e,hash:t})}prerender({container:e}){this._now=performance.now(),e.renderGroup.gcTick=Ste++,this._updateInstructionGCTick(e.renderGroup,e.renderGroup.gcTick)}addRenderable(e){this.enabled&&(e._lastUsed===-1&&(this._managedRenderables.push(e),e.once("destroyed",this._removeRenderable,this)),e._lastUsed=this._now)}run(){const e=this._now,t=this._managedRenderables,r=this._renderer.renderPipes;let i=0;for(let s=0;s<t.length;s++){const o=t[s];if(o===null){i++;continue}const c=o.renderGroup??o.parentRenderGroup,u=c?.instructionSet?.gcTick??-1;if((c?.gcTick??0)===u&&(o._lastUsed=e),e-o._lastUsed>this.maxUnusedTime){if(!o.destroyed){const d=r;c&&(c.structureDidChange=!0),d[o.renderPipeId].destroyRenderable(o)}o._lastUsed=-1,i++,o.off("destroyed",this._removeRenderable,this)}else t[s-i]=o}t.length-=i}destroy(){this.enabled=!1,this._renderer=null,this._managedRenderables.length=0,this._managedHashes.length=0,this._managedArrays.length=0}_removeRenderable(e){const t=this._managedRenderables.indexOf(e);t>=0&&(e.off("destroyed",this._removeRenderable,this),this._managedRenderables[t]=null)}_updateInstructionGCTick(e,t){e.instructionSet.gcTick=t;for(const r of e.renderGroupChildren)this._updateInstructionGCTick(r,t)}};Bv.extension={type:[me.WebGLSystem,me.WebGPUSystem],name:"renderableGC",priority:0};Bv.defaultOptions={renderableGCActive:!0,renderableGCMaxUnusedTime:6e4,renderableGCFrequency:3e4};let Ate=Bv;const Ov=class MP{constructor(e){this._renderer=e,this.count=0,this.checkCount=0}init(e){e={...MP.defaultOptions,...e},this.checkCountMax=e.textureGCCheckCountMax,this.maxIdle=e.textureGCAMaxIdle??e.textureGCMaxIdle,this.active=e.textureGCActive}postrender(){this._renderer.renderingToScreen&&(this.count++,this.active&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this._renderer.texture.managedTextures;for(let t=0;t<e.length;t++){const r=e[t];r.autoGarbageCollect&&r.resource&&r._touched>-1&&this.count-r._touched>this.maxIdle&&(r._touched=-1,r.unload())}}destroy(){this._renderer=null}};Ov.extension={type:[me.WebGLSystem,me.WebGPUSystem],name:"textureGC"};Ov.defaultOptions={textureGCActive:!0,textureGCAMaxIdle:null,textureGCMaxIdle:3600,textureGCCheckCountMax:600};let Cte=Ov;const Lv=class NP{get autoDensity(){return this.texture.source.autoDensity}set autoDensity(e){this.texture.source.autoDensity=e}get resolution(){return this.texture.source._resolution}set resolution(e){this.texture.source.resize(this.texture.source.width,this.texture.source.height,e)}init(e){e={...NP.defaultOptions,...e},e.view&&(it(Yt,"ViewSystem.view has been renamed to ViewSystem.canvas"),e.canvas=e.view),this.screen=new Qt(0,0,e.width,e.height),this.canvas=e.canvas||Dt.get().createCanvas(),this.antialias=!!e.antialias,this.texture=tP(this.canvas,e),this.renderTarget=new e2({colorTextures:[this.texture],depth:!!e.depth,isRoot:!0}),this.texture.source.transparent=e.backgroundAlpha<1,this.resolution=e.resolution}resize(e,t,r){this.texture.source.resize(e,t,r),this.screen.width=this.texture.frame.width,this.screen.height=this.texture.frame.height}destroy(e=!1){(typeof e=="boolean"?e:!!e?.removeView)&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.texture.destroy()}};Lv.extension={type:[me.WebGLSystem,me.WebGPUSystem,me.CanvasSystem],name:"view",priority:0};Lv.defaultOptions={width:800,height:600,autoDensity:!1,antialias:!1};let kte=Lv;const Tte=[fte,kP,jv,kte,vP,Cte,CP,mte,rR,Ate,TP],Ete=[SP,LR,_P,yP,UR,GR,FR,pP],Mte=[...Tte,eP,vee,mee,XR,HR,dP,iP,YR,cP,lP,ZR,Xee,KR,qR],Nte=[...Ete],Ite=[BR,mP,fP],IP=[],RP=[],PP=[];Pn.handleByNamedList(me.WebGLSystem,IP);Pn.handleByNamedList(me.WebGLPipes,RP);Pn.handleByNamedList(me.WebGLPipesAdaptor,PP);Pn.add(...Mte,...Nte,...Ite);class Rte extends pK{constructor(){const e={name:"webgl",type:Yo.WEBGL,systems:IP,renderPipes:RP,renderPipeAdaptors:PP};super(e)}}Pn.add(RZ,PZ);var Pte=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Dte=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}`,jte=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec2 uThickness;
uniform vec3 uColor;
uniform float uAlpha;
uniform float uKnockout;

uniform vec4 uInputClamp;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${ANGLE_STEP};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture(uTexture, clamp(displacedPos, uInputClamp.xy, uInputClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture(uTexture, vTextureCoord);
    vec4 contentColor = sourceColor * float(uKnockout < 0.5);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    finalColor = contentColor + outlineColor;
}
`,Bte=`struct OutlineUniforms {
  uThickness:vec2<f32>,
  uColor:vec3<f32>,
  uAlpha:f32,
  uAngleStep:f32,
  uKnockout:f32,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> outlineUniforms : OutlineUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
  let sourceColor: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let contentColor: vec4<f32> = sourceColor * (1. - outlineUniforms.uKnockout);
  
  let outlineAlpha: f32 = outlineUniforms.uAlpha * outlineMaxAlphaAtPos(uv) * (1. - sourceColor.a);
  let outlineColor: vec4<f32> = vec4<f32>(vec3<f32>(outlineUniforms.uColor) * outlineAlpha, outlineAlpha);
  
  return contentColor + outlineColor;
}

fn outlineMaxAlphaAtPos(uv: vec2<f32>) -> f32 {
  let thickness = outlineUniforms.uThickness;

  if (thickness.x == 0. || thickness.y == 0.) {
    return 0.;
  }
  
  let angleStep = outlineUniforms.uAngleStep;

  var displacedColor: vec4<f32>;
  var displacedPos: vec2<f32>;

  var maxAlpha: f32 = 0.;
  var displaced: vec2<f32>;
  var curColor: vec4<f32>;

  for (var angle = 0.; angle <= DOUBLE_PI; angle += angleStep)
  {
    displaced.x = uv.x + thickness.x * cos(angle);
    displaced.y = uv.y + thickness.y * sin(angle);
    curColor = textureSample(uTexture, uSampler, clamp(displaced, gfu.uInputClamp.xy, gfu.uInputClamp.zw));
    maxAlpha = max(maxAlpha, curColor.a);
  }

  return maxAlpha;
}

const DOUBLE_PI: f32 = 3.14159265358979323846264 * 2.;`,Ote=Object.defineProperty,Lte=(n,e,t)=>e in n?Ote(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Po=(n,e,t)=>(Lte(n,typeof e!="symbol"?e+"":e,t),t);const xg=class Ao extends qI{constructor(...e){let t=e[0]??{};typeof t=="number"&&(it("6.0.0","OutlineFilter constructor params are now options object. See params: { thickness, color, quality, alpha, knockout }"),t={thickness:t},e[1]!==void 0&&(t.color=e[1]),e[2]!==void 0&&(t.quality=e[2]),e[3]!==void 0&&(t.alpha=e[3]),e[4]!==void 0&&(t.knockout=e[4])),t={...Ao.DEFAULT_OPTIONS,...t};const r=t.quality??.1,i=el.from({vertex:{source:Dte,entryPoint:"mainVertex"},fragment:{source:Bte,entryPoint:"mainFragment"}}),s=zc.from({vertex:Pte,fragment:jte.replace(/\$\{ANGLE_STEP\}/,Ao.getAngleStep(r).toFixed(7)),name:"outline-filter"});super({gpuProgram:i,glProgram:s,resources:{outlineUniforms:{uThickness:{value:new Float32Array(2),type:"vec2<f32>"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uAlpha:{value:t.alpha,type:"f32"},uAngleStep:{value:0,type:"f32"},uKnockout:{value:t.knockout?1:0,type:"f32"}}}}),Po(this,"uniforms"),Po(this,"_thickness"),Po(this,"_quality"),Po(this,"_color"),this.uniforms=this.resources.outlineUniforms.uniforms,this.uniforms.uAngleStep=Ao.getAngleStep(r),this._color=new An,this.color=t.color??0,Object.assign(this,t)}apply(e,t,r,i){this.uniforms.uThickness[0]=this.thickness/t.source.width,this.uniforms.uThickness[1]=this.thickness/t.source.height,e.applyFilter(this,t,r,i)}static getAngleStep(e){return parseFloat((Math.PI*2/Math.max(e*Ao.MAX_SAMPLES,Ao.MIN_SAMPLES)).toFixed(7))}get thickness(){return this._thickness}set thickness(e){this._thickness=this.padding=e}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,r,i]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=r,this.uniforms.uColor[2]=i}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get quality(){return this._quality}set quality(e){this._quality=e,this.uniforms.uAngleStep=Ao.getAngleStep(e)}get knockout(){return this.uniforms.uKnockout===1}set knockout(e){this.uniforms.uKnockout=e?1:0}};Po(xg,"DEFAULT_OPTIONS",{thickness:1,color:0,alpha:1,quality:.1,knockout:!1});Po(xg,"MIN_SAMPLES",1);Po(xg,"MAX_SAMPLES",100);let ko=xg;const zte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFyWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OSwgMjAyMy8wNi8yNS0yMDowMTo1NSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNjoyMSswMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNjoyMSswMzowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDktMjhUMjI6MTY6MjErMDM6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OGUxNDg2ZTMtNTQ1ZS00MDQyLTkxNGEtZmRmMTk1ZGY5NzRmIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YTEwZWQyZGQtN2VlZi1kODRkLWEyYTUtODU2NGU5N2U4ZWQ4IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NTNhM2FmZTEtN2E4NC01NTQxLWE0N2MtYjhmYzliOGU1ZGU2IiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NTNhM2FmZTEtN2E4NC01NTQxLWE0N2MtYjhmYzliOGU1ZGU2IiBzdEV2dDp3aGVuPSIyMDI1LTA5LTI4VDIyOjE2OjIxKzAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjUuMiAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjhlMTQ4NmUzLTU0NWUtNDA0Mi05MTRhLWZkZjE5NWRmOTc0ZiIgc3RFdnQ6d2hlbj0iMjAyNS0wOS0yOFQyMjoxNjoyMSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp4e8y4AAAOESURBVFiFxZdPaBRXHMc/W0rbgyAWBFF6yCGRsZvsZHIREi91vJWsIIaFQi6hl/6BhUJrPGxxi4QqiEYMpXHBiWBWqIekpactGGrMxd2Z3WwdNOAabURw1sGTVMXpYfsmM7szyYwV8j395r2Z9/3z/vAm4TgOW4l3tpQdePdNP3y4+thpNp95mxKysjf2OIm4UyCIz/x8EQClV6aybHBy/Bv+ExRLSGQBQcReVJYNAFeIrOxNvFUB878uOAD9fS131377w9d/5NODNJvPuL50C4Dsl59FEhB7Dei1Oy4hIGLvEBQVsXbBiR+O+4TotTtcX7rluga4rE3FErDpFJiNFceyLffZXnvh67/34O+ObyrLBjM/nY40BaEJmI0V58/KkjNxNse0NsnN8gLT2iTdyd3s2POeLw2v6/+dgHA8rU0C8HEy5ev/q14FYDybx7Itykv3gJZrpVcm/ckAttV031cODG6YRIeA2d+vOgCypAAwX7rm6x9Wj2DZFjfLCwC8/+IjLmtT/KIVsK0m2tQVAJIpiXrVJJv7GttqhgoJFSAghIh1IIgFRoYOdxB7Ua+aAKFCAgWcyk/wbW7c1/5greF7LhaKZMYy9G7rAUCS9wFQmiv53lPTKrbVpLyoA/D5sa82FmA2VhzDrNCOdgHQWg+Z/Ud9bUKIWAeCWKBdQOAuOJWfCKyLhaJbj6hpsqNfsKtnJ7t6dq4bMG5jGrcpL+o+8kJxJogqfgIjahr7qYV2vrXdkv0p6nqV7Pc57KcWj+8+AWBt9VHHGPWqybnZC9ETkCXFrUfUNIeUQc6eyKOdnyLZnyLZn3JFiHZpv+Qm4nX9RgnIkoKot798DYDUJwNQmp/zfacOt5Ip31hsNTzf5roWOyN2Au01gFkzMGsG6nAadTjNwNAgA0ODlObn1skDXIclECjAuwW9dT7/Y4eQ8o1FH3FhZn2hjmVGA+tNBQjXhllxa6lPJpf7LnAQL8ZGM9T11nHtdS0OpEgChGtZUkIT8NZe12EJhCFQgDh+wb8GvAl4a6/rsdHMpqQbCpC6uhNSV3dCiAhKQOqTIyUgIFZ/+w6AiBcSgA94hVkzXAGiXru/2iLRq+65UNer8M+HAB3brh2bXslEIoJYICwBMRVhjtsR+7+g0TAdIDABgHOXZiNdxQRi34q7uiRB4AgRdb0am1ggdgJvG1v+c7rlAv4FTOAADH/2oHYAAAAASUVORK5CYII=",Ute="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFyWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OSwgMjAyMy8wNi8yNS0yMDowMTo1NSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNTo1MiswMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNTo1MiswMzowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDktMjhUMjI6MTU6NTIrMDM6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzI1ZTdlODItMjAxOC02MjQ5LWIxNjYtMTgxNmJhMTQ2YTYwIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YzQ5YzRjMDQtNWUzZC0xMzQ2LWFjNGYtNTczNWE3MTM1MjkwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NTU5YTAyODYtOTQ5Yi0yODRmLTkwNWEtNzQ1ODFiMmNhMGU2IiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NTU5YTAyODYtOTQ5Yi0yODRmLTkwNWEtNzQ1ODFiMmNhMGU2IiBzdEV2dDp3aGVuPSIyMDI1LTA5LTI4VDIyOjE1OjUyKzAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjUuMiAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjcyNWU3ZTgyLTIwMTgtNjI0OS1iMTY2LTE4MTZiYTE0NmE2MCIgc3RFdnQ6d2hlbj0iMjAyNS0wOS0yOFQyMjoxNTo1MiswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmfUrPcAAAJRSURBVFiF7ZcxbNNAGIWfK7ZKMCCmDE4lZ4iXVBk6RLB5QSp4glaUiBExsDIwJAoDEmVgAAFrKa0qprqt1CVTgjJ0SAlD4sgZnMFLMrPyM+BzfVfbsXNFWXhSFPts/+/zO98fRyEiLFJLC3X/DwDgmmyB+rYFw6yQ63gAoFTXV7MVICKpT8uekLpikLpi0Jfjc8p6vTRA7c0htewJtewJPdhoBAAte5IKSHoKfu+8hKvvAQCWv+8BqKE9nFL17iP/jLdUXV9V4q6XBgCA5Y9Puf2m1cHu6T4A4H39E5KeC+lVsPTkdbD96/YWAD8Vx4PreH4q8bqSBG69O4HreMDXo2BMTCVO/6QPRKUSp8wJ7J78uPTj4fcATlGpSAG0h1NyHQ/HfsFiuQQA0HQV+UIuEiKNZgKEjYvlEu49vs8dZ+OaruJ541kwnhYoFqA9nBLwdxmFjUf9MXceG2cgrq6SYVbkAZpWBwCCuwoX1HQ12GZAIgibmllS4l5I6tsWd8AwKxwIM2Yw4j4DYWq8MCO7YeIzoOlqUIglwkCYRGMmZj7o9vwRM9Ij1SpIAyICXRgnK1Mj0nQ1KNy0OmhaHeQLOeQLOYz6Y4z6Ywy6Pc48PA1RmrsVD7o9LhHxji9PwRwALE7xO5yEKGa88/kDAGBt7c58AMwgKUJNV7m+UCyXAuPrN24mGs8E+HZQUwDg4eYrEkHEZiRCpzVPBJAByaLYRhSnKBDg4u7PztpcAj/PD2Jfx4A5VkFSImHNMmbKnIAoBmIP+5mMrwxAVgv/a7ZwgD94pMedGjP1DQAAAABJRU5ErkJggg==",Fte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFyWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OSwgMjAyMy8wNi8yNS0yMDowMTo1NSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNzoyOCswMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNzoyOCswMzowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDktMjhUMjI6MTc6MjgrMDM6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzgyMzA2NmItZjZiZS0xZjRlLWJlNjQtYmVlNmE4Y2VkMDM1IiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6N2M5ZThjOGYtM2IxMS1iMzQ3LWIwNTMtYjM2NGNhOWMxOTY2IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MGE3YmUzZjItMzZhYi1iMTQyLTk2MzAtZTkzMDhkZDE1NmU2IiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MGE3YmUzZjItMzZhYi1iMTQyLTk2MzAtZTkzMDhkZDE1NmU2IiBzdEV2dDp3aGVuPSIyMDI1LTA5LTI4VDIyOjE3OjI4KzAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjUuMiAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc4MjMwNjZiLWY2YmUtMWY0ZS1iZTY0LWJlZTZhOGNlZDAzNSIgc3RFdnQ6d2hlbj0iMjAyNS0wOS0yOFQyMjoxNzoyOCswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PjZAe+YAAAHlSURBVFiF7ZU9TFpRGIafox11KncAY/wlAgMkYB2IDiQyWhdHjZNJSdrJqQum7WBi49I2sUmngkmb6qLGqQMDxsEfEjpIDbaFARguTrqfDnDw3mrJBZvQ4X7TOee753ufvPc75wgpJZ2Mro6q2wA2gA1gA/wPAA/a3Zg+12UhXwJg0N0HIKbGtJbriFbfAiW8t7mLNxgAIJfJMjP/uC0QywDpc10CvF3ZwBsMMOobMOUvzoptgVgGWFnbkQDTs2EAlP1/xt7mLgDPXsQsAbTUA6O+AQr5EhdnxQaICuWMNxggl8larmnJgeWlOdnjXuDj+3cAvHrzGrixXfWCyk9MTAGIL5/j9wdYjcdktaLT415orCmhxSdPyWWyHB2ljcIAdF+lAIQ/5OH5y432AFbjMRmJhin8LHF8cAJgAgFu2V0XBsDleggg1j9s/1Wj6UWkxH/9KPJochyHU+M6n+Q6n7z1bfdVyiQOUC5fAjS1uGkTbiV2cDg1ItFaww0O95H6ekgkGmYrUYPo720IAeAPeahW9MaaMXdXNP0Fy0tzaigdTo2hkZuzr2AAqhXdtM8gKgA+7ZudMYalY+hwagLg+OBE1ucmYeO8XL7EH/KIb6ffrZRu/Sr+19Hx19AGsAFsgI4D/AYAlMXy3kn9JQAAAABJRU5ErkJggg==",Gte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFyWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OSwgMjAyMy8wNi8yNS0yMDowMTo1NSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNToyNCswMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNToyNCswMzowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDktMjhUMjI6MTU6MjQrMDM6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDIzN2MzOWUtMGZkZi0xNTRiLWE3M2ItMTgyZmEwYWVhOGI0IiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6NWMxM2Y0NDYtNTIwOS1jMjQ5LTg2OWYtNjM4NDA3NzExN2VlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6N2U3MmM1YjUtYWY4Yy03ZTQwLWFjODAtOTljYWQ2MGJhN2I4IiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6N2U3MmM1YjUtYWY4Yy03ZTQwLWFjODAtOTljYWQ2MGJhN2I4IiBzdEV2dDp3aGVuPSIyMDI1LTA5LTI4VDIyOjE1OjI0KzAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjUuMiAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjAyMzdjMzllLTBmZGYtMTU0Yi1hNzNiLTE4MmZhMGFlYThiNCIgc3RFdnQ6d2hlbj0iMjAyNS0wOS0yOFQyMjoxNToyNCswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PttzcR0AAAJrSURBVFiF3ZfPa9NgGMe/kV4Kge7iZQ0EKTi2UNfsoLCTYNmYIIXCZi+iFXbwHyhiO6VzQ/GfCHraDg5KWaClPU0KA7FuOkYPZQSygnjZoOBl8HqYb0zS/HiTFAb7QnjJ+755v5+8z/s8aTlCCK5SN67U/doArElS6DhGBliTJCKLfGiIyACyyKOrDSGLfKjnubBZsPPwHulqQ+jnFxASMaOVRR55dZ9jXSfmNUi3166uNgQAi/mjOxOoH54B2hA3e7+Nt2rVOgCAainnCOUJAAB5dZ8rClNE0XtGWzfdA4Ci9zh6BvTzC8OURb4hoCZuottOw+EkRe+5h4QQ4nstP64St7Fnydvk89JdUpmZcZ3jdTFlwfTcrGP/mw818rz9BQf3X7Es4yhfgJXCOqmWctxKYX0kFNncfGhjJoDVbJpMz81a2siOrACr2TSZXNjAoFkBAAyaFUwubFggWrUOWrUOjr8djB8gk4ob5lSDZgWZVNzSF8Uc8EjDfDpJAODBfBLf+3+QScXR7pwCAHZ+nBppRdNUSMTw9uiIuQJSuRYiakJB2r+sxmbRahhGvpXQzdQsWeSBf+V57ABu2vr4fiR2tK/w9CVzKAJ/Dc3GjbICAP8/RAAWN4vGXBYQZgD7GzfKChY3i2iUFQiJy42USk+MfrO8QHxD4LTVdskij/rhGSSfNZxAfEvxSV/DSV8b6RcSMSME9PcBvbdL3d6Fur3rOMZ8CCnErZQI4HK7JZupfevdTM1iPgPvXr+wTKQgTrIbf1L3XM9A4CzwAgliHBrACeT468/AxpEBzCAUIIjx2ACi6nr8N4yivxF0cY+kPu0IAAAAAElFTkSuQmCC",Hte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFyWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OSwgMjAyMy8wNi8yNS0yMDowMTo1NSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNzo1NiswMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNzo1NiswMzowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDktMjhUMjI6MTc6NTYrMDM6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjI4MTAwZmMtNTRiMi0zMjRhLTg5ZTAtOWVkYzFiN2U2YmNlIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6MDIwODBiYWEtNzhiNS04NTQ5LWFjYzctNDMwNGM2YzVjYzljIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6Y2VkMzFkMGItZDUyZS03NDRkLTk0ZmQtMTBiNTM2ZGYyYjliIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6Y2VkMzFkMGItZDUyZS03NDRkLTk0ZmQtMTBiNTM2ZGYyYjliIiBzdEV2dDp3aGVuPSIyMDI1LTA5LTI4VDIyOjE3OjU2KzAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjUuMiAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjYyODEwMGZjLTU0YjItMzI0YS04OWUwLTllZGMxYjdlNmJjZSIgc3RFdnQ6d2hlbj0iMjAyNS0wOS0yOFQyMjoxNzo1NiswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PheBSM4AAAITSURBVFiF7ZZPSNtQHMe/kcHAgzsMjzvXKqWlO62wW7eTELzYeBLxItTiTcZAg7st10wcu0mhLe4g7+QlpwaiIGRkQpswD4JSRkMOyXnst4PNs3UuvMmmCPlB4L28X97v8/sXfhIR4T5l7F6tpwApQArw4AHO1mZpY2aGVI3B9Py7BThbm+W/0J+7b0lXd+4WwP525fFF+OO21+BR0uG88g4A4Hod/u7rl9aNELGYno/nzyYwPv5YCCAxAnutzZH9sPEXnxp8/frNMl+/zEwKGeZCRMJPrlBB2+1TrlCh3vkp9c5P6eS4TQ39PeUKFWq7fWq7feQKFeE7hWogrvDtlk4GsxCFAYLvvRGdKAxgMAsAKAoD4QAkAqgaI9PzCQCpGqOqUkNZLgEATo4Of4MoyyVUlRoWV1bJ9HwyPZ9UjSUOHIlFCCD2Cl3b4fv6wWX+Pw/OyvIS6q+WEEcn1r36Tr41gNS1HQIuOyEKA+w3m+jaDrLFPI+GwSx0bYd3y3DXAJCSDCQCbK3LmFccKVvMw/U6qB80yGAW9pvNIe/AjW63dABAValJrtfB3MLCiM6NHorMhIM64OnY/fgBE0+eYiozzY1HYYDFlVUA4JHR1R3peiv/FYCqMSrLpZE6GIRXAsABYggANJWZRraY5yAGs7C1Lv8xDUJFeN1wkkND+Rcat4VS8D/lYc8DKUAKkAL8C/kFB+1AZWAA+oQAAAAASUVORK5CYII=",Vte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAGs2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDEgNzkuMTQ2Mjg5OSwgMjAyMy8wNi8yNS0yMDowMTo1NSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNDo0NiswMzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNS0wOS0yOFQyMjoxNDo0NiswMzowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDktMjhUMjI6MTQ6NDYrMDM6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ZTM0MzMyYzUtN2RjNi02MzRlLTg0MGEtYWZlZjEwYmQxNTAyIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6NzA0ODkzNzUtNDFmYi1mMTRlLWI1NTktMjg2ZjU3MzU3Yzc1IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MjYwNzhiZmYtM2UxZi1mMTRjLWE0MWYtOGU5ODAwODVlYTA5IiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MjYwNzhiZmYtM2UxZi1mMTRjLWE0MWYtOGU5ODAwODVlYTA5IiBzdEV2dDp3aGVuPSIyMDI1LTA5LTI4VDIyOjE0OjQ2KzAzOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjUuMiAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmUzNDMzMmM1LTdkYzYtNjM0ZS04NDBhLWFmZWYxMGJkMTUwMiIgc3RFdnQ6d2hlbj0iMjAyNS0wOS0yOFQyMjoxNDo0NiswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjIgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6M2Q5YjMzMGItNjRlNy1hYTRmLWFlMzUtMzcxOWM1ODExMzc1PC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmMwMWM1YTRlLWJlMDMtODE0NS05NTAzLTQ3YzhhODUxYWZiNDwvcmRmOmxpPiA8L3JkZjpCYWc+IDwvcGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PupE5HcAAAKeSURBVFiF7Zc/b9pgEMZ/rjonqlLmNIoqE6T8HZASiSnsiA5gT12LUtZuDYJsGbqgiA9QqaYZijxlKFmCxMCARAawlypzKKrgC1yH5HVNA8HQ0AztSZas137ved67e+5sTUR4THvyqOj/CfwtArljWza2DeGoIt1n74eePZ0ncMooyNrOJhXL4vzqJd0PTUL7zwXQ1DvaPFSggOOJPYq5EgCO2+ZydZfu+XdCP47mQ2As8Ks0G18+AxDWI5yWDz0CD1IDKaMguWNbsvkMnWaLYq7E2s4mjtv2Qn+5ugs3odf8e/+oBtSJs/kMxVyJTrPF2s4mAPHEHp1mi31+hZ4Xd33MlIJRofYDA1TtOhXL8vaE9QiAdlo+HPI1VQQmnVgBd5otHLfNSbmoxfQQG9vGWJ+BCMwCDBDTQxN9T0xByihINp/hwMgS1iNjgQGy+Uxg4MAEam5XDowsAEnTHAncaNQAuPr2VRvtZbwFSsGg3wPwAH8HjkZj3v2DEyjmSiwsLmmA11YBbdDvCcDrN2+pWBYLi0szEZjYiE7Lh1pYj0jSND1wuDm1Ar2V2HwIKBKAljRNDeCkXBTHbRPWI0OKqLndqZvK1K34pFyUql1n0O/huG0AKpbFoN+jatenJyEiU13rW2m5cK5leSUuyytxWd9Ke/cXzrWsb6VlGn8zzYKqXefj2aeR60oxQW1iH8gd2zKq2/mbEnBn3b8n/y4xtj8EikDVrg+BJE0TuMl9WI94az6ZBrZA0zBlFLyXGo0aC4tLHgm/qWKMRmPemv/jY2YCfqu5XVGj1q//2yEEQEwPBW7JgYtQyUulQ8lQpUDJEIDEngQlMpGAKkJ/HcDoweNPlSLyYEWogO/Lqf/ZHTJjbC6f5dPYv/Frdp/9BH8U1l61YsfEAAAAAElFTkSuQmCC",Wte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAJ9JREFUOI21UrENwzAMo4N806Ffuf4oTZfOnZp7ckByQOaCHaIWgiDH9hACGiyTFC04kEQG9iJ4pC4jXgBMAC5SE4CPP4b06kVyU+eV5Oxx+1x+wbtwj3DWDqzAFR8ZPE0CSq/a4FrZO9wBVIriE+gsrWTMn0FqEFokvYNbg/DP1QYjgFghjsLdIV8ysR1Jf+W7mjBUxn/oBLaiMzF63C827sIYGoELmwAAAABJRU5ErkJggg==",Yte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAJdJREFUOI2tUUEOgzAMM9vewF922w2e3JzGe+APYxdXykxohsBSlbRxXKcFTqILzkrSM2YC65FLbwn5EqwAnowbd9VOoZvPjsjomqOxUUiY3U01f5Mzc/1A36BnNOaT1HrhbwSqzYH5S2p+lUjAXDQASzRvy4Hingk8ZD9ITKEO6hcZ80nqixszFGg9Ygg/gjV4Ws+4/+MLUp8l6z6oTp8AAAAASUVORK5CYII=",$te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAN1JREFUOI3NkLFqAkEYhL8TIYUpUlxnYWF71VVp8jKSwgPLVL5BHmWxPUPgEO4RYpoUvoFgJyRF4LPZGEP0uIMUGViYWXbmn3/hX0C9Uefx3IUQOgcs/Ma6i7fXsWy7gBACaZqiovYAqqpC7ed5TpZlx/tzK+zqukbtq4/quCxL1Ft1VhQF6kB9uRSgeq2WkY/VifqpPqgjdavaFLA54c8n/Endf4mmgFa49ImvwD3wEfUcWEW+BKbAcfq5gAGwAa6ifgeGkafAG5D8cPz1Cp2QxAb8qtXGnCS2eNaMA8qfQbVOLRtSAAAAAElFTkSuQmCC",qte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAMRJREFUOI3NkrEKwjAURU+0gotQQXd3B1ddHNz1a/qPfkHBTZxcdVIEvQ6mNk0fEnHxLgl5Nye5L4Ef5axFSdV0DhyBM3ByzrTbAEkb1ZoF0CRArqZuknLL20nhARnQs4rZh43D5Cu3jnxF2AcRdpJG3wDGaiutB77bd8PbtV6iAQgMfeARebPI0wQEhQJYANcIMPC1FqQCOEmFz7uK8p8lTf28kPT+knEP1n68GD2IPXWu6hJACSyBLTCJNh78WHrvn+gJNNGl7dCdR1EAAAAASUVORK5CYII=",Zte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAANZJREFUOI2tkr8OQTEUh3/3EoPNaJJILCLxLAYewVuYeAWTzWaSEItILMQDGG1mg9j5DHqpau8V8UuanrTnfOdPK/1LQGgVeakPHIBVEpfP4pr9LGksqSFpKCmXVkHByngDusAMRz7ACLia+x4wByZO3B4ohwAAbWAN7NyMRkeg6YuXyejTAKi4w00UW4ypw9xK6khaSGplDFsCIqvnGlCyqtiEKvC9QqK6ZVdDgMgG+Apz/Z6B0ePom490SnPIAiwlXX4F4NgfbYQA3mGE5hEHnNL05nMH+dw8lWm0hVAAAAAASUVORK5CYII=",Xte="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAKVJREFUOI3tkzEOwyAQBIdUlj9guXHhj/hT6fy6VP4JpftIDrhZI0IAkd4rnXRwd7sgFqhjUzRjBGbgCRyAVxzam9UTYKLcJ2QOWJS/gEdSN8k6qA1Anzldr5rPiAUC23BNGxOkx/obN8E3gQe6hpmu9IybClNleFJP1t4GeMuBq0xzYdCeU8+PC+PGPfL/qLj+xZ4QZ2Gk9pGiU77WlEtEVlEcPAFIsCnQmNthzgAAAABJRU5ErkJggg==",$m={RAD_BORDER:16.5,RAD_TERRITORY:13.5,SCALE:.5},tc={outerRadius:$m.RAD_BORDER*$m.SCALE,innerRadius:$m.RAD_TERRITORY*$m.SCALE};class vg{constructor(){this._assetCache=new Map,this._symbolCallbacks=[],this.blueprintRegistry={[$.Port]:{spriteSrc:Gte,...tc},[$.City]:{spriteSrc:zte,...tc},[$.Factory]:{spriteSrc:Ute,...tc},[$.MissileSilo]:{spriteSrc:Hte,...tc},[$.DefensePost]:{spriteSrc:Fte,...tc},[$.SAMLauncher]:{spriteSrc:Vte,...tc}},this.symbolRegistry=new Map([[$.City,{src:Yte,bitmap:null}],[$.Factory,{src:$te,bitmap:null}],[$.DefensePost,{src:Xte,bitmap:null}],[$.Port,{src:Wte,bitmap:null}],[$.MissileSilo,{src:qte,bitmap:null}],[$.SAMLauncher,{src:Zte,bitmap:null}]]),this.preloadAssets()}static getInstance(){return this._instance||(this._instance=new vg)}getBlueprint(e){return this.blueprintRegistry[e]}getSprite(e){return this._assetCache.get(String(e))}getSymbol(e){return this.symbolRegistry.get(e)?.bitmap??null}onSymbolLoaded(e){this._symbolCallbacks.push(e)}preloadAssets(){for(const[e,t]of Object.entries(this.blueprintRegistry))this.loadImage(e,t.spriteSrc,r=>this._assetCache.set(e,r));this.symbolRegistry.forEach((e,t)=>{this.loadImage(`symbol_${t}`,e.src,r=>{e.bitmap=r,this._symbolCallbacks.forEach(i=>i(t))})})}loadImage(e,t,r){const i=new Image;i.src=t,i.onload=()=>r(i),i.onerror=()=>console.warn(`[Assets] Failed to load: ${e}`)}}const $p={[$.City]:"circle",[$.Port]:"pentagon",[$.Factory]:"circle",[$.DefensePost]:"octagon",[$.SAMLauncher]:"square",[$.MissileSilo]:"triangle",[$.Warship]:"cross",[$.AtomBomb]:"cross",[$.HydrogenBomb]:"cross",[$.MIRV]:"cross"},DP=3,zv=3.5,qp=1.4,yx=.5,Do=4.3,i2={circle:28,octagon:28,pentagon:30,square:28,triangle:28,cross:20},jP=4;class Kte{constructor(e,t,r,i){this._theme=e,this._view=t,this._camera=r,this._texCache=new Map,this.useSprites=i,this._assets=vg.getInstance(),this._assets.onSymbolLoaded(s=>this.flushCache(s))}flushCache(e){for(const t of Array.from(this._texCache.keys()))(t.endsWith(`-${e}-sym`)||t===`build-${e}-sym`)&&this._texCache.delete(t)}assemblePhantom(e,t,r,i){const s=new cr,o=this.synthesizeTexture(i,e,!1,!0),c=new Ya(o);c.anchor.set(.5),c.alpha=.5,s.addChild(c),s.position.set(r.x,r.y);const u=Math.min(1,this._camera.zoomLevel/qp);return s.scale.set(u),t.addChild(s),s}constructEntityVisual(e,t){const r=new cr,i=e.tile(),s=new yr(this._view.x(i),this._view.y(i)),o=this._camera.toScreenSpace(s),c=e.type()===$.Construction,u=e.constructionType(),d=c?u:e.type(),{mode:f,parent:p}=t,y=this._camera.zoomLevel;if(f==="symbol"||f==="marker"){if(c&&u===void 0)return console.warn(`Undefined construction project: ${e.id()}`),r;const w=this.synthesizeTexture(d,e.owner(),c,f==="symbol"),S=new Ya(w);S.anchor.set(.5),r.addChild(S)}if((f==="symbol"||f==="rank")&&e.level()>1){const w=new cee({text:e.level().toString(),style:{fontFamily:"round_6x6_modified",fontSize:14}});w.anchor.set(.5);const S=$p[d];S!==void 0&&(w.position.y=Math.round(-i2[S]/2-2)),r.addChild(w)}const b=Math.round(o.x);let _=Math.round(o.y);if(f==="rank"&&y>=Do&&this.useSprites&&(_=Math.round(o.y-y*jP)),r.position.set(b,_),f==="symbol"){const w=y>=Do&&!this.useSprites?Math.max(1,y/zv):Math.min(1,y/qp);r.scale.set(w)}else f==="rank"&&r.scale.set(Math.max(1,y/DP));return p.addChild(r),r}fabricateRangeIndicator(e,t,r){if(!t)throw new Error("Unitialized stage");const i=new cr,s=new Yp;let o=0;switch(e){case $.SAMLauncher:o=this._view.config().defaultSamRange();break;case $.Factory:o=this._view.config().trainStationMaxRange();break;case $.DefensePost:o=this._view.config().defensePostRange();break;case $.AtomBomb:o=this._view.config().nukeMagnitudes($.AtomBomb).outer;break;case $.HydrogenBomb:o=this._view.config().nukeMagnitudes($.HydrogenBomb).outer;break;default:return null}return s.circle(0,0,o).stroke({width:1,color:16777215,alpha:.2}),i.addChild(s),i.position.set(r.x,r.y),i.scale.set(this._camera.zoomLevel),t.addChild(i),i}synthesizeTexture(e,t,r,i){const s=i?"-sym":"",o=this._theme.territoryColor(t).toRgbString(),c=r?`build-${e}${s}`:`${o}-${e}${s}`;if(this._texCache.has(c))return this._texCache.get(c);const u=$p[e],d=u?this.drawShape(t,e,r,u,i):Ue.EMPTY;return this._texCache.set(c,d),d}drawShape(e,t,r,i,s){const o=document.createElement("canvas");let c=i2[i];s||(c/=2.5),o.width=Math.ceil(c),o.height=Math.ceil(c);const u=o.getContext("2d"),d=e.territoryColor(),f=e.borderColor(),p=f.luminance()<d.luminance()?f:d,y=f.luminance()<d.luminance()?d:f;let b;if(r)u.fillStyle="rgb(198, 198, 198)",b="rgb(128, 127, 127)";else{u.fillStyle=y.lighten(.13).alpha(s?.65:1).toRgbString();const S=p.isLight()?.17:.15;b=p.darken(S).toRgbString()}u.strokeStyle=b,u.lineWidth=1;const _=c/2;switch(i){case"triangle":u.beginPath(),u.moveTo(_,1),u.lineTo(c-1,c-1),u.lineTo(0,c-1),u.closePath(),u.fill(),u.stroke();break;case"square":u.fillRect(1,1,c-2,c-2),u.strokeRect(1,1,c-3,c-3);break;case"octagon":{const S=_-1,A=Math.PI*2/8;u.beginPath();for(let M=0;M<8;M++){const k=A*M-Math.PI/8,E=_+S*Math.cos(k),U=_+S*Math.sin(k);M===0?u.moveTo(E,U):u.lineTo(E,U)}u.closePath(),u.fill(),u.stroke();break}case"pentagon":{const S=_-1,A=Math.PI*2/5;u.beginPath();for(let M=0;M<5;M++){const k=A*M-Math.PI/2,E=_+S*Math.cos(k),U=_+S*Math.sin(k);M===0?u.moveTo(E,U):u.lineTo(E,U)}u.closePath(),u.fill(),u.stroke();break}case"cross":{u.strokeStyle="rgba(0, 0, 0, 1)",u.fillStyle="rgba(0, 0, 0, 1)";const S=c*.18,A=c/2;u.save(),u.translate(_,_);const M=[[0,-1],[0,1],[-1,0],[1,0]];for(const k of M)u.beginPath(),u.moveTo(k[0]*S,k[1]*S),u.lineTo(k[0]*A,k[1]*A),u.stroke();u.restore();break}case"circle":u.beginPath(),u.arc(_,_,_-1,0,Math.PI*2),u.fill(),u.stroke();break;default:throw new Error(`Invalid profile: ${i}`)}const w=this._assets.getSymbol(t);if(!w)return Ue.from(o);if(s){const S={triangle:[6,11],square:[5,5],octagon:[6,6],pentagon:[7,7],circle:[6,6],cross:[0,0]},[A,M]=S[i]||[0,0];u.drawImage(this.tintBitmap(w,b),A,M)}return Ue.from(o)}tintBitmap(e,t){const r=document.createElement("canvas");r.width=e.width,r.height=e.height;const i=r.getContext("2d");return i.fillStyle=t,i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),r}}class Qte{constructor(e,t,r,i,s,o){
	window.executePlacement = this.executePlacement.bind(this);
	window.obj_placement = this;
	console.log("LOG1337: Obj expose injection successfull.");
this._view=e,this._bus=t,this._camera=r,this._factory=i,this._layerPhantom=s,this._visualsProvider=o,this._phantomEntity=null,this._cursorLoc={x:0,y:0},this._lastPhantomUpdate=0,this._lastUpgradeTick=0}update(e){this._phantomEntity?e===null?this.disposeBlueprint():e!==this._phantomEntity.specs.type&&this.resetBlueprint():e!==null&&this.initiateBlueprint(e),this.visualizeBlueprint()}onMouseMove(e){if(this._cursorLoc.x=e.x,this._cursorLoc.y=e.y,!this._phantomEntity)return;const t=this._camera.getBounds();if(!t)return;const r=e.x-t.left,i=e.y-t.top;this._phantomEntity.root.position.set(r,i),this._phantomEntity.radiusRing?.position.set(r,i)}onMouseUp(e){this.executePlacement(e)}visualizeBlueprint(){if(!this._phantomEntity)return;const e=performance.now();if(e-this._lastPhantomUpdate<50)return;const t=this._camera.getBounds();if(!t)return;const r=this._cursorLoc.x-t.left,i=this._cursorLoc.y-t.top;this._lastPhantomUpdate=e;let s;const o=this._camera.toWorldSpace(r,i);this._view.isValidCoord(o.x,o.y)&&(s=this._view.ref(o.x,o.y)),this._view?.myPlayer()?.actions(s).then(c=>{if(this._pendingUpgrade&&(this._pendingUpgrade.symbolNode.filters=[],this._pendingUpgrade.markerNode.filters=[]),this._phantomEntity?.root&&(this._phantomEntity.root.filters=[]),!this._phantomEntity)return;const u=c.buildableUnits.find(p=>p.type===this._phantomEntity.specs.type);if(!u){Object.assign(this._phantomEntity.specs,{canBuild:!1,canUpgrade:!1}),this._phantomEntity.root.filters=[new ko({thickness:2,color:"rgba(255, 0, 0, 1)"})];return}if(this._phantomEntity.specs=u,u.canUpgrade){if(this.checkCooldown()){this._phantomEntity.root.filters=[new ko({thickness:2,color:"rgba(255, 136, 0, 1)"})];return}const p=this._visualsProvider();this._pendingUpgrade=p.find(y=>y.entity.id()===u.canUpgrade&&y.entity.owner().id()===this._view.myPlayer()?.id()),this._pendingUpgrade&&(this._pendingUpgrade.symbolNode.filters=[new ko({thickness:2,color:"rgba(0, 255, 0, 1)"})],this._pendingUpgrade.markerNode.filters=[new ko({thickness:2,color:"rgba(0, 255, 0, 1)"})])}else u.canBuild===!1&&(this._phantomEntity.root.filters=[new ko({thickness:2,color:"rgba(255, 0, 0, 1)"})]);const d=this._camera.zoomLevel,f=d>=Do?Math.max(1,d/zv):Math.min(1,d/qp);this._phantomEntity.root.scale.set(f),this._phantomEntity.radiusRing?.scale.set(this._camera.zoomLevel)})}checkCooldown(){const t=this._view.config().upgradeCooldownTicks()*100;return Date.now()-this._lastUpgradeTick<t}executePlacement(e){if(!this._phantomEntity)return;if(this._phantomEntity.specs.canBuild===!1&&this._phantomEntity.specs.canUpgrade===!1){this.disposeBlueprint();return}const t=this._camera.getBounds();if(!t)return;const r=e.x-t.left,i=e.y-t.top,s=this._camera.toWorldSpace(r,i);this._phantomEntity.specs.canUpgrade!==!1?(this._lastUpgradeTick=Date.now(),this._bus.emit(new U2(this._phantomEntity.specs.canUpgrade,this._phantomEntity.specs.type))):this._phantomEntity.specs.canBuild&&this._bus.emit(new kc(this._phantomEntity.specs.type,this._view.ref(s.x,s.y))),this.disposeBlueprint()}initiateBlueprint(e){const t=this._view.myPlayer();if(!t)return;const r=this._camera.getBounds(),i=this._cursorLoc.x-r.left,s=this._cursorLoc.y-r.top;this._phantomEntity={root:this._factory.assemblePhantom(t,this._layerPhantom,{x:i,y:s},e),radiusRing:this._factory.fabricateRangeIndicator(e,this._layerPhantom,{x:i,y:s}),specs:{type:e,canBuild:!1,canUpgrade:!1,cost:0n}}}resetBlueprint(){this._phantomEntity&&(this._phantomEntity.root.destroy(),this._phantomEntity.radiusRing?.destroy(),this._phantomEntity=null),this._pendingUpgrade&&(this._pendingUpgrade.symbolNode.filters=[],this._pendingUpgrade.markerNode.filters=[],this._pendingUpgrade=void 0)}disposeBlueprint(){this.resetBlueprint()}}Ed([IZ]);class Jte{constructor(e,t,r,i,s,o=0,c=!0){this.entity=e,this.ownerId=t,this.symbolNode=r,this.rankNode=i,this.markerNode=s,this.rank=o,this.isBuilding=c,this.isVisible=!1}}class ene{constructor(e,t,r){this._gameInstance=e,this._bus=t,this._camera=r,this._sceneRoot=new cr,this.userControls=null,this._visuals=[],this._trackedEntities=new Set,this._showSprites=!0,this._visibilityMap=new Map([[$.City,{show:!0}],[$.Factory,{show:!0}],[$.DefensePost,{show:!0}],[$.Port,{show:!0}],[$.MissileSilo,{show:!0}],[$.SAMLauncher,{show:!0}]]),this._isReady=!1,this._view=e.gameView,this._theme=this._view.config().theme(),this._factory=new Kte(this._theme,this._view,r,this._showSprites)}async configureGraphicsContext(){try{await Eh.load("/fonts/round_6x6_modified.xml")}catch(e){console.error("Font load failure:",e)}this._glContext=new Rte,this._glCanvas=document.createElement("canvas"),this._glCanvas.width=window.innerWidth,this._glCanvas.height=window.innerHeight,this._layerSymbols=new cr,this._layerPhantom=new cr,this._layerRanks=new cr,this._layerMarkers=new cr,this._layerSymbols.position.set(0,0),this._layerPhantom.position.set(0,0),this._layerRanks.position.set(0,0),this._layerMarkers.position.set(0,0),this._sceneRoot.addChild(this._layerMarkers,this._layerSymbols,this._layerRanks,this._layerPhantom),this._sceneRoot.position.set(0,0),await this._glContext.init({canvas:this._glCanvas,resolution:1,width:this._glCanvas.width,height:this._glCanvas.height,antialias:!1,clearBeforeRender:!0,backgroundAlpha:0,backgroundColor:0}),this._planner=new Qte(this._view,this._bus,this._camera,this._factory,this._layerPhantom,()=>this._visuals),this._isReady=!0}isWorldSpace(){return!1}async init(){this._bus.on(m1,e=>this.updateVisibilityFilters(e.structureTypes)),this._bus.on(id,e=>this._planner?.onMouseMove(e)),this._bus.on(Td,e=>this._planner?.onMouseUp(e)),window.addEventListener("resize",()=>this.adaptResolution()),await this.configureGraphicsContext(),this.refreshSurface()}adaptResolution(){this._glContext&&this._isReady&&(this._glCanvas.width=window.innerWidth,this._glCanvas.height=window.innerHeight,this._glContext.resize(window.innerWidth,window.innerHeight,1))}tick(){this._view.updatesSinceLastTick()?.[Wt.Unit]?.map(t=>this._view.unit(t.id))?.forEach(t=>{t!==void 0&&(t.isActive()?this.processActiveEntity(t):this._trackedEntities.has(t)&&this.processInactiveEntity(t))});const e=this._view.config().userSettings()?.structureSprites()??!0;this._showSprites!==e&&(this._showSprites=e,this._factory.useSprites=e)}refreshSurface(){this.adaptResolution()}paint(e){if(!this._glContext||!this._isReady)return;if(this._planner.update(this._gameInstance.placementUnit),this._camera.isDirty())for(const r of this._visuals)this.recalculateCoords(r);const t=this._camera.zoomLevel;this._layerMarkers.visible=t<=yx,this._layerSymbols.visible=t>yx&&(t<=Do||!this._showSprites),this._layerRanks.visible=t>Do&&this._showSprites,this._glContext.render(this._sceneRoot),e.drawImage(this._glContext.canvas,0,0)}updateVisibilityFilters(e){for(const[t,r]of this._visibilityMap)r.show=e?.indexOf(t)!==-1||e===null;for(const t of this._visuals)this.applyVisibility(t)}getVisual(e){return this._visuals.find(t=>t.entity.id()===e.id())}processActiveEntity(e){if(this._trackedEntities.has(e)){const t=this.getVisual(e);t&&(this.verifyConstruction(t,e),this.verifyOwnership(t,e),this.verifyRank(t,e))}else(this._visibilityMap.has(e.type())||e.type()===$.Construction)&&this.registerAsset(e)}processInactiveEntity(e){const t=this.getVisual(e);t&&this.purgeAsset(t)}applyVisibility(e){const t=e.entity.type()===$.Construction?e.entity.constructionType():e.entity.type(),r=this._visibilityMap.get(t);let i=!1;for(const s of this._visibilityMap.values())if(s.show===!1){i=!0;break}r&&(e.symbolNode.alpha=r.show?1:.3,e.markerNode.alpha=r.show?1:.3,r.show&&i?(e.symbolNode.filters=[new ko({thickness:2,color:"rgb(255, 255, 255)"})],e.markerNode.filters=[new ko({thickness:2,color:"rgb(255, 255, 255)"})]):(e.symbolNode.filters=[],e.markerNode.filters=[]))}verifyConstruction(e,t){e.isBuilding&&e.entity.type()!==$.Construction&&(e.isBuilding=!1,e.symbolNode?.destroy(),e.markerNode?.destroy(),e.symbolNode=this.buildSymbol(t),e.markerNode=this.buildMarker(t),this.applyVisibility(e))}verifyOwnership(e,t){e.ownerId!==t.owner().id()&&(e.ownerId=t.owner().id(),e.symbolNode?.destroy(),e.markerNode?.destroy(),e.symbolNode=this.buildSymbol(t),e.markerNode=this.buildMarker(t),this.applyVisibility(e))}verifyRank(e,t){e.rank!==t.level()&&(e.rank=t.level(),e.symbolNode?.destroy(),e.rankNode?.destroy(),e.markerNode?.destroy(),e.symbolNode=this.buildSymbol(t),e.rankNode=this.buildRank(t),e.markerNode=this.buildMarker(t),this.applyVisibility(e))}recalculateCoords(e){const t=e.entity.tile(),r=new yr(this._view.x(t),this._view.y(t)),i=this._camera.toScreenSpace(r);i.x=Math.round(i.x);const s=this._camera.zoomLevel;i.y=Math.round(s>=Do&&this._view.config().userSettings()?.structureSprites()?i.y-s*jP:i.y);const o=e.entity.type()===$.Construction?e.entity.constructionType():e.entity.type(),c=o!==void 0&&$p[o]!==void 0?i2[$p[o]]:28,u=i.x+c>0&&i.x-c<this._glCanvas.width&&i.y+c>0&&i.y-c<this._glCanvas.height;if(u)if(s>Do){const d=this._view.config().userSettings()?.structureSprites()?e.rankNode:e.symbolNode;d.position.set(i.x,i.y),d.scale.set(Math.max(1,s/(d===e.rankNode?DP:zv)))}else s>yx?(e.symbolNode.position.set(i.x,i.y),e.symbolNode.scale.set(Math.min(1,s/qp))):e.markerNode.position.set(i.x,i.y);e.isVisible!==u&&(e.isVisible=u,e.symbolNode.visible=u,e.markerNode.visible=u,e.rankNode.visible=u)}registerAsset(e){this._trackedEntities.add(e);const t=new Jte(e,e.owner().id(),this.buildSymbol(e),this.buildRank(e),this.buildMarker(e),e.level(),e.type()===$.Construction);this._visuals.push(t),this.recalculateCoords(t),this.applyVisibility(t)}buildRank(e){return this._factory.constructEntityVisual(e,{mode:"rank",parent:this._layerRanks})}buildMarker(e){return this._factory.constructEntityVisual(e,{mode:"marker",parent:this._layerMarkers})}buildSymbol(e){return this._factory.constructEntityVisual(e,{mode:"symbol",parent:this._layerSymbols})}purgeAsset(e){e.symbolNode?.destroy(),e.rankNode?.destroy(),e.markerNode?.destroy(),this._visuals=this._visuals.filter(t=>t.entity!==e.entity),this._trackedEntities.delete(e.entity)}}const tne=j({r:150,g:150,b:150});class nne{constructor(e){this._view=e,this._scratchPad=document.createElement("canvas");const t=this._scratchPad.getContext("2d");if(!t)throw new Error("Scratchpad Context Failure");this._scratchCtx=t}rasterizeFootprint(e,t,r,i){const s=MT(t.tile(),i.outerRadius,!0);for(const u of this._view.bfs(t.tile(),s))this.drawPixel(e,new yr(this._view.x(u),this._view.y(u)),r,255);const o=MT(t.tile(),i.innerRadius,!0),c=t.type()===$.Construction?tne:t.owner().territoryColor();for(const u of this._view.bfs(t.tile(),o))this.drawPixel(e,new yr(this._view.x(u),this._view.y(u)),c,130)}eraseFootprint(e,t,r){const i=T1(t.tile(),r.outerRadius+1,!0);for(const s of this._view.bfs(t.tile(),i))this.erasePixel(e,new yr(this._view.x(s),this._view.y(s)))}blitSprite(e,t,r,i,s,o){this._scratchPad.width=s*2,this._scratchPad.height=o*2,this._scratchCtx.imageSmoothingEnabled=!0,this._scratchCtx.imageSmoothingQuality="high",this._scratchCtx.drawImage(t,0,0,s*2,o*2),this._scratchCtx.globalCompositeOperation="destination-in",this._scratchCtx.drawImage(t,0,0,s*2,o*2),e.drawImage(this._scratchPad,r*2,i*2)}drawPixel(e,t,r,i){this.erasePixel(e,t),e.fillStyle=r.alpha(i/255).toRgbString(),e.fillRect(t.x*2,t.y*2,2,2)}erasePixel(e,t){e.clearRect(t.x*2,t.y*2,2,2)}}const rne=j("#2F4F4F"),ine=4.3;class sne{constructor(e,t,r){this._view=e,this._bus=t,this._camera=r,this.isWorldSpace=()=>!0,this._assets=vg.getInstance(),this._rasterizer=new nne(e)}async init(){this.createRenderBuffer()}tick(){const t=this._view.updatesSinceLastTick()?.[Wt.Unit]??[];for(const r of t){const i=this._view.unit(r.id);i&&this.renderUnitToBuffer(i)}}paint(e){const{zoomLevel:t}=this._camera,r=this._view.config().userSettings();t<=ine||!r?.structureSprites()||e.drawImage(this._bufferCanvas,-this._view.width()/2,-this._view.height()/2,this._view.width(),this._view.height())}createRenderBuffer(){this._bufferCanvas=document.createElement("canvas"),this._bufferCanvas.width=this._view.width()*2,this._bufferCanvas.height=this._view.height()*2;const e=this._bufferCanvas.getContext("2d",{alpha:!0});if(!e)throw new Error("Canvas context failed");this._bufferCtx=e,this._bufferCtx.imageSmoothingEnabled=!0,this._bufferCtx.imageSmoothingQuality="high",this._view.units().forEach(t=>this.renderUnitToBuffer(t))}renderUnitToBuffer(e){const t=e.constructionType()??e.type(),r=this._assets.getBlueprint(t);if(!r)return;const i=this._assets.getSprite(t),s=e.type()===$.Construction?rne:e.owner().borderColor();if(!i||(this._rasterizer.eraseFootprint(this._bufferCtx,e,r),!e.isActive()))return;const[o,c]=[i.width>>1,i.height>>1],u=this._view.x(e.tile())-(o>>1),d=this._view.y(e.tile())-(c>>1);this._bufferCtx.clearRect(u*2,(d-4)*2,o*2,c*2),this._rasterizer.rasterizeFootprint(this._bufferCtx,e,s,r),this._rasterizer.blitSprite(this._bufferCtx,i,u,d-4,o,c)}}class ane{#e;#t;constructor(){this.#e=document.createElement("canvas");const e=this.#e.getContext("2d");if(!e)throw new Error("Failed to create buffer context");this.#t=e}resize(e,t){this.#e.width=e,this.#e.height=t}createImageData(e,t){return this.#t.createImageData(e,t)}putImageData(e){this.#t.putImageData(e,0,0)}get canvas(){return this.#e}}class one{static paint(e,t,r){const i=t.width();t.forEachTile(s=>{const o=r.terrainColor(t,s),c=t.x(s),d=(t.y(s)*i+c)*4;e.data[d]=o.rgba.r,e.data[d+1]=o.rgba.g,e.data[d+2]=o.rgba.b,e.data[d+3]=o.rgba.a*255|0})}}class lne{constructor(e,t){this._view=e,this._camera=t,this.#e=new ane}#e;#t=null;isWorldSpace(){return!0}tick(){this._view.config().theme()!==this.#t&&this.regenerateSurface()}async init(){this.regenerateSurface()}regenerateSurface(){const e=this._view.width(),t=this._view.height();this.#e.resize(e,t);const r=this.#e.createImageData(e,t);this.#t=this._view.config().theme(),one.paint(r,this._view,this.#t),this.#e.putImageData(r)}paint(e){this._camera.zoomLevel<1?(e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="low"):e.imageSmoothingEnabled=!1;const t=this._view.width(),r=this._view.height();e.drawImage(this.#e.canvas,-t/2,-r/2,t,r)}}class cne{#e;#t;#n;#r;#s;#i;constructor(){this.#e=document.createElement("canvas");const e=this.#e.getContext("2d");if(!e)throw new Error("Failed to create buffer context");this.#t=e,this.#s=document.createElement("canvas");const t=this.#s.getContext("2d",{alpha:!0});if(!t)throw new Error("Failed to create overlay context");this.#i=t,this.#n=new ImageData(1,1),this.#r=new ImageData(1,1)}resize(e,t){this.#e.width=e,this.#e.height=t,this.#s.width=e,this.#s.height=t,this.#n=this.#t.getImageData(0,0,e,t),this.#r=this.#t.getImageData(0,0,e,t)}clearBuffers(e){const t=e.width();e.forEachTile(r=>{const i=(e.y(r)*t+e.x(r))*4;this.#n.data[i+3]=0,this.#r.data[i+3]=0})}commitBuffers(e){this.#t.putImageData(e?this.#r:this.#n,0,0)}blitToContext(e,t,r,i){this.commitBuffers(i);const[s,o]=t.getViewableRange(),c=Math.max(0,s.x),u=Math.max(0,s.y),d=Math.min(r.width()-1,o.x),f=Math.min(r.height()-1,o.y),p=d-c+1,y=f-u+1;p>0&&y>0&&this.#t.putImageData(i?this.#r:this.#n,0,0,c,u,p,y)}get bufferCanvas(){return this.#e}get overlayCanvas(){return this.#s}get overlayCtx(){return this.#i}writePixel(e,t,r,i){const s=i?this.#r:this.#n,o=e*4;s.data[o]=t.rgba.r,s.data[o+1]=t.rgba.g,s.data[o+2]=t.rgba.b,s.data[o+3]=r}writePixelToBuffer(e,t,r,i){const s=t*4;e.data[s]=r.rgba.r,e.data[s+1]=r.rgba.g,e.data[s+2]=r.rgba.b,e.data[s+3]=i}erasePixel(e,t=!1){const r=e*4;t||(this.#n.data[r+3]=0),this.#r.data[r+3]=0}fillOverlayPixel(e,t,r,i){this.eraseOverlayPixel(e,t);const s=e.x(t),o=e.y(t);this.#i.fillStyle=r.alpha(i/255).toRgbString(),this.#i.fillRect(s,o,1,1)}eraseOverlayPixel(e,t){const r=e.x(t),i=e.y(t);this.#i.clearRect(r,i,1,1)}drawRing(e,t,r,i){const s=this.#i;s.beginPath(),s.arc(e,t,r,0,Math.PI*2),s.strokeStyle=i.toRgbString(),s.lineWidth=4,s.stroke()}clearOverlay(e,t){this.#i.clearRect(0,0,e,t)}}class une{#e;#t=!1;#n=null;#r=null;constructor(e){this.#e=e}get theme(){return this.#e}set theme(e){this.#e=e}get isTactical(){return this.#t}set isTactical(e){this.#t=e}get highlightedRegion(){return this.#n}set highlightedRegion(e){this.#n=e}get lastFocusTarget(){return this.#r}set lastFocusTarget(e){this.#r=e}}class hne{constructor(e,t){this._view=e,this._camera=t}#e=null;handleCursorMove(e){this.#e={x:e.x,y:e.y}}getHoveredRegion(){if(!this.#e)return null;const e=this._camera.toWorldSpace(this.#e.x,this.#e.y);if(!this._view.isValidCoord(e.x,e.y))return null;const t=this._view.ref(e.x,e.y);if(!t||!this._view.hasOwner(t))return null;const r=this._view.owner(t);return r instanceof Op?r:null}}var bx={},xx={},bh={},vx={};var QE;function Uv(){if(QE)return vx;QE=1;class n{constructor(t,r,i){if(typeof t!="function")throw new Error("Heap constructor expects a compare function");this._compare=t,this._nodes=Array.isArray(r)?r:[],this._leaf=i||null,this._nodes.length>0&&this.fix()}toArray(){return Array.from(this._nodes)}_hasLeftChild(t){return t*2+1<this.size()}_hasRightChild(t){return t*2+2<this.size()}_compareAt(t,r){return this._compare(this._nodes[t],this._nodes[r])}_swap(t,r){const i=this._nodes[t];this._nodes[t]=this._nodes[r],this._nodes[r]=i}_shouldSwap(t,r){return t<0||t>=this.size()||r<0||r>=this.size()?!1:this._compareAt(t,r)>0}_compareChildrenOf(t){if(!this._hasLeftChild(t)&&!this._hasRightChild(t))return-1;const r=t*2+1,i=t*2+2;return this._hasLeftChild(t)?this._hasRightChild(t)&&this._compareAt(r,i)>0?i:r:i}_compareChildrenBefore(t,r,i){return this._compareAt(i,r)<=0&&i<t?i:r}_heapifyUp(t){let r=t,i=Math.floor((r-1)/2);for(;this._shouldSwap(i,r);)this._swap(i,r),r=i,i=Math.floor((r-1)/2)}_heapifyDown(t){let r=t,i=this._compareChildrenOf(r);for(;this._shouldSwap(r,i);)this._swap(r,i),r=i,i=this._compareChildrenOf(r)}_heapifyDownUntil(t){let r=0,i=1,s=2,o;for(;i<t;)o=this._compareChildrenBefore(t,i,s),this._shouldSwap(r,o)&&this._swap(r,o),r=o,i=r*2+1,s=r*2+2}insert(t){return this._nodes.push(t),this._heapifyUp(this.size()-1),(this._leaf===null||this._compare(t,this._leaf)>0)&&(this._leaf=t),this}push(t){return this.insert(t)}extractRoot(){if(this.isEmpty())return null;const t=this.root();return this._nodes[0]=this._nodes[this.size()-1],this._nodes.pop(),this._heapifyDown(0),t===this._leaf&&(this._leaf=null),t}pop(){return this.extractRoot()}sort(){for(let t=this.size()-1;t>0;t-=1)this._swap(0,t),this._heapifyDownUntil(t);return this._nodes}fix(){for(let t=Math.floor(this.size()/2)-1;t>=0;t-=1)this._heapifyDown(t);for(let t=Math.floor(this.size()/2);t<this.size();t+=1){const r=this._nodes[t];(this._leaf===null||this._compare(r,this._leaf)>0)&&(this._leaf=r)}return this}isValid(){const t=r=>{let i=!0,s=!0;if(this._hasLeftChild(r)){const o=r*2+1;if(this._compareAt(r,o)>0)return!1;i=t(o)}if(this._hasRightChild(r)){const o=r*2+2;if(this._compareAt(r,o)>0)return!1;s=t(o)}return i&&s};return t(0)}clone(){return new n(this._compare,this._nodes.slice(),this._leaf)}root(){return this.isEmpty()?null:this._nodes[0]}top(){return this.root()}leaf(){return this._leaf}size(){return this._nodes.length}isEmpty(){return this.size()===0}clear(){this._nodes=[],this._leaf=null}[Symbol.iterator](){let t=this.size();return{next:()=>(t-=1,{value:this.pop(),done:t===-1})}}static heapify(t,r){if(!Array.isArray(t))throw new Error("Heap.heapify expects an array of values");if(typeof r!="function")throw new Error("Heap.heapify expects a compare function");return new n(r,t).fix()}static isHeapified(t,r){return new n(r,t).isValid()}}return vx.Heap=n,vx}var _x={};var JE;function dne(){if(JE)return _x;JE=1;const{Heap:n}=Uv(),e=r=>(i,s)=>{const o=typeof r=="function"?r(i):i,c=typeof r=="function"?r(s):s;return o<=c?-1:1};class t extends n{constructor(i,s){super(e(i),s),this._getCompareValue=i}insert(i){return super.insert(i),this}push(i){return this.insert(i)}fix(){return super.fix(),this}clone(){return new t(this._getCompareValue,this._nodes.slice())}static heapify(i,s){if(!Array.isArray(i))throw new Error("MinHeap.heapify expects an array");return new t(s,i)}static isHeapified(i,s){return new t(s,i).isValid()}}return _x.MinHeap=t,_x}var wx={};var eM;function fne(){if(eM)return wx;eM=1;const{Heap:n}=Uv(),e=r=>(i,s)=>{const o=typeof r=="function"?r(i):i,c=typeof r=="function"?r(s):s;return o<c?1:-1};class t extends n{constructor(i,s){super(e(i),s),this._getCompareValue=i}insert(i){return super.insert(i),this}push(i){return this.insert(i)}fix(){return super.fix(),this}clone(){return new t(this._getCompareValue,this._nodes.slice())}static heapify(i,s){if(!Array.isArray(i))throw new Error("MaxHeap.heapify expects an array");return new t(s,i)}static isHeapified(i,s){return new t(s,i).isValid()}}return wx.MaxHeap=t,wx}var tM;function mne(){if(tM)return bh;tM=1;const{Heap:n}=Uv(),{MinHeap:e}=dne(),{MaxHeap:t}=fne();return bh.Heap=n,bh.MinHeap=e,bh.MaxHeap=t,bh}var nM;function Fv(){if(nM)return xx;nM=1;const{Heap:n}=mne();class e{constructor(r,i){if(typeof r!="function")throw new Error("PriorityQueue constructor expects a compare function");this._heap=new n(r,i)}front(){return this._heap.root()}back(){return this._heap.leaf()}enqueue(r){return this._heap.insert(r),this}push(r){return this.enqueue(r)}dequeue(){return this._heap.extractRoot()}pop(){return this.dequeue()}remove(r){if(typeof r!="function")throw new Error("PriorityQueue remove expects a callback");const i=[],s=[];for(;!this.isEmpty();){const o=this.pop();r(o)?i.push(o):s.push(o)}return s.forEach(o=>this.push(o)),i}contains(r){if(typeof r!="function")throw new Error("PriorityQueue contains expects a callback");let i=!1;const s=[];for(;!this.isEmpty();){const o=this.pop();if(s.push(o),r(o)){i=!0;break}}return s.forEach(o=>this.push(o)),i}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}toArray(){return this._heap.clone().sort().reverse()}[Symbol.iterator](){let r=this.size();return{next:()=>(r-=1,{value:this.pop(),done:r===-1})}}}return e.fromArray=function(r,i){return new e(i,r)},xx.PriorityQueue=e,xx}var rM;function pne(){if(rM)return bx;rM=1;const{PriorityQueue:n}=Fv();class e extends n{constructor(r,i){if(r&&typeof r=="object"&&typeof r.compare=="function"){const s=(o,c)=>r.compare(o,c)<=0?-1:1;super(s,i)}else{const s=r;if(s&&typeof s!="function")throw new Error("MinPriorityQueue constructor requires a callback for object values");const o=(c,u)=>{const d=typeof s=="function"?s(c):c,f=typeof s=="function"?s(u):u;return d<=f?-1:1};super(o,i)}}enqueue(r){return super.enqueue(r),this}push(r){return this.enqueue(r)}}return e.fromArray=function(r,i){return new e(i,r)},bx.MinPriorityQueue=e,bx}var Sx={};var iM;function gne(){if(iM)return Sx;iM=1;const{PriorityQueue:n}=Fv();class e extends n{constructor(r,i){if(r&&typeof r=="object"&&typeof r.compare=="function"){const s=(o,c)=>r.compare(o,c)<=0?-1:1;super(s,i)}else{const s=r;if(s&&typeof s!="function")throw new Error("MaxPriorityQueue constructor requires a callback for object values");const o=(c,u)=>{const d=typeof s=="function"?s(c):c,f=typeof s=="function"?s(u):u;return d<f?1:-1};super(o,i)}}enqueue(r){return super.enqueue(r),this}push(r){return this.enqueue(r)}}return e.fromArray=function(r,i){return new e(i,r)},Sx.MaxPriorityQueue=e,Sx}var Ax,sM;function yne(){if(sM)return Ax;sM=1;const{MinPriorityQueue:n}=pne(),{MaxPriorityQueue:e}=gne(),{PriorityQueue:t}=Fv();return Ax={MinPriorityQueue:n,MaxPriorityQueue:e,PriorityQueue:t},Ax}var bne=yne();class xne{#e;constructor(){this.#e=new bne.PriorityQueue((e,t)=>e.timestamp-t.timestamp)}schedule(e,t){this.#e.push({ref:e,timestamp:t})}process(e,t){let r=e;for(;r>0;){r--;const i=this.#e.pop();if(!i)break;t(i.ref)}}get size(){return this.#e.size()}}class vne{constructor(e,t,r){this._view=e,this._bus=t,this._camera=r,this.#e=new une(e.config().theme()),this.#t=new xne,this.#n=new cne,this.#r=new hne(e,r)}#e;#t;#n;#r;#s=new ld(123);#i=0;#a=0;#l=200;#c=10;#o=0;isWorldSpace(){return!0}async init(){this._bus.on(Z4,e=>{this.#r.handleCursorMove(e),this.checkHoverState()}),this._bus.on(sd,e=>{this.#e.isTactical=e.alternateView}),this._bus.on(Ip,e=>{}),this.refreshSurfaces()}tick(){this._view.recentlyUpdatedTiles().forEach(i=>this.scheduleUpdate(i));const e=this._view.updatesSinceLastTick();(e!==null?e[Wt.Unit]:[]).forEach(i=>{if(i.unitType===$.DefensePost){const s=i.pos,o=T1(s,this._view.config().defensePostRange());this._view.bfs(s,o).forEach(c=>{this._view.isBorder(c)&&(this._view.ownerID(c)===i.ownerID||this._view.ownerID(c)===i.lastOwnerID)&&this.scheduleUpdate(c)})}}),this.processAllianceChanges(e);const r=this._view.focusedPlayer();r!==this.#e.lastFocusTarget&&(this.#e.lastFocusTarget&&this.drawBoundary(this.#e.lastFocusTarget),r&&this.drawBoundary(r),this.#e.lastFocusTarget=r),this._view.inSpawnPhase()&&this.renderSpawnZones()}paint(e){const t=Date.now(),r=t<=this.#a+this.#l,i=t>this.#o+this.#c;if(!r&&i){this.#o=t;let c=Math.floor(this.#t.size/10);(c===0||this._view.inSpawnPhase())&&(c=this.#t.size),this.#t.process(c,u=>{this.renderTile(u);for(const d of this._view.neighbors(u))this.renderTile(d,!0)}),this.#n.blitToContext(e,this._camera,this._view,this.#e.isTactical)}const s=this._view.width(),o=this._view.height();e.drawImage(this.#n.bufferCanvas,-s/2,-o/2,s,o),this._view.inSpawnPhase()&&e.drawImage(this.#n.overlayCanvas,-s/2,-o/2,s,o)}refreshSurfaces(){const e=this._view.width(),t=this._view.height();this.#n.resize(e,t),this.#n.clearBuffers(this._view),this._view.forEachTile(r=>{this.renderTile(r)}),this.#n.commitBuffers(this.#e.isTactical)}checkHoverState(){if(!this.#e.isTactical)return;const e=this.#e.highlightedRegion,t=this.#r.getHoveredRegion();if(this.#e.highlightedRegion=t,e?.id()!==this.#e.highlightedRegion?.id()){const r=[];e&&r.push(e),this.#e.highlightedRegion&&r.push(this.#e.highlightedRegion),this.refreshBorders(...r)}}async drawBoundary(e){(await e.borderTiles()).borderTiles.forEach(r=>{this.renderTile(r,!0)})}refreshBorders(...e){return Promise.all(e.map(async t=>{(await t.borderTiles()).borderTiles.forEach(i=>{this.renderTile(i,!0)})}))}scheduleUpdate(e){this.#t.schedule(e,this._view.ticks()+this.#s.nextFloat(0,.5))}renderTile(e,t=!1){if(t&&!this._view.hasOwner(e))return;if(!this._view.hasOwner(e)){if(this._view.hasFallout(e)){const s=this.#e.theme.falloutColor();this.#n.writePixel(e,s,150,!1),this.#n.writePixel(e,s,150,!0)}else this.#n.erasePixel(e);return}const r=this._view.owner(e),i=this._view.myPlayer();if(this._view.isBorder(e)){if(i){const o=this.getTacticalColor(r);this.#n.writePixel(e,o,255,!0)}const s=this._view.hasUnitNearby(e,this._view.config().defensePostRange(),$.DefensePost,r.id());this.#n.writePixel(e,r.borderColor(e,s),255,!1)}else this.#n.erasePixel(e,!0),this.#n.writePixel(e,r.territoryColor(e),150,!1)}getTacticalColor(e){const t=this._view.myPlayer();return t?e.smallID()===t.smallID()?this.#e.theme.selfColor():e.isFriendly(t)?this.#e.theme.allyColor():e.hasEmbargo(t)?this.#e.theme.enemyColor():this.#e.theme.neutralColor():this.#e.theme.neutralColor()}processAllianceChanges(e){const t=this._view.myPlayer();t&&(e?.[Wt.BrokeAlliance]?.forEach(r=>{const i=this._view.playerBySmallID(r.betrayedID);i&&i instanceof Op&&this.refreshBorders(i)}),e?.[Wt.AllianceRequestReply]?.forEach(r=>{if(r.accepted&&(r.request.requestorID===t.smallID()||r.request.recipientID===t.smallID())){const i=r.request.requestorID===t.smallID()?r.request.recipientID:r.request.requestorID,s=this._view.playerBySmallID(i);s&&s instanceof Op&&this.refreshBorders(s)}}),e?.[Wt.EmbargoEvent]?.forEach(r=>{const i=this._view.playerBySmallID(r.playerID),s=this._view.playerBySmallID(r.embargoedID);(i.id()===t.id()||s.id()===t.id())&&this.refreshBorders(i,s)}))}renderSpawnZones(){if(this._view.ticks()%5===0)return;const e=this._view.width(),t=this._view.height();this.#n.clearOverlay(e,t),this.animateFocusPulse();const r=this._view.playerViews().filter(o=>o.type()===Xt.Human),i=this._view.focusedPlayer(),s=this._view.myPlayer();for(const o of r){if(o===i)continue;const c=o.nameLocation();if(!c)continue;const u=this._view.ref(c.x,c.y);if(!u)continue;let d=this.#e.theme.spawnHighlightColor();s&&s!==o&&s.isFriendly(o)&&(d=this.#e.theme.selfColor());const f=T1(u,9,!0);for(const p of this._view.bfs(u,f))this._view.hasOwner(p)||this.#n.fillOverlayPixel(this._view,p,d,255)}}animateFocusPulse(){const e=this._view.focusedPlayer();if(!e)return;const t=e.nameLocation();if(!t)return;this.#i+=3;const r=6,s=r+(12-r)*(.5+.5*Math.sin(this.#i*.3));this.#n.drawRing(t.x,t.y,s,this.#e.theme.spawnHighlightColor())}}const yo=16,Aa=15,aM=.03;class _ne{constructor(e,t,r){this._viewRef=e,this._bus=t,this._canvas=r,this.zoomLevel=1.8,this._panX=-350,this._panY=-200,this._lastFrameTime=null,this._destZoom=null,this._animTimer=null,this._isDirty=!1,this._bounds=this._canvas.getBoundingClientRect(),this.bindInputEvents()}bindInputEvents(){this._bus.on(No,e=>this.handleZoom(e)),this._bus.on(Ip,e=>this.handleDrag(e)),this._bus.on(K4,()=>this.startCentering()),this._bus.on(Q4,()=>this.startFocusSequence()),this._bus.on(Y2,e=>this.trackPlayer(e)),this._bus.on(J4,e=>this.trackCoordinates(e)),this._bus.on(eN,e=>this.trackUnit(e))}recalculateBounds(){this._bounds=this._canvas.getBoundingClientRect()}getBounds(){return this._bounds}getWidth(){return this.getBounds().width}isDirty(){return this._isDirty}markClean(){this._isDirty=!1}applyToContext(e){e.imageSmoothingEnabled=!1;const t=this._viewRef.width(),r=this._viewRef.height(),i=t/2-this._panX*this.zoomLevel,s=r/2-this._panY*this.zoomLevel;e.setTransform(this.zoomLevel,0,0,this.zoomLevel,i,s)}toScreenSpace(e){const t=e.x,r=e.y,i=this._viewRef.width(),s=this._viewRef.height(),o=t-i/2,c=r-s/2,u=(o-this._panX)*this.zoomLevel+i/2,d=(c-this._panY)*this.zoomLevel+s/2,f=this.getBounds();return{x:u+f.left,y:d+f.top}}toWorldSpace(e,t){const r=this.getBounds(),i=e-r.left,s=t-r.top,o=this._viewRef.width(),c=this._viewRef.height(),u=(i-o/2)/this.zoomLevel+this._panX,d=(s-c/2)/this.zoomLevel+this._panY;return new yr(Math.floor(u+o/2),Math.floor(d+c/2))}getViewableRange(){const{width:e,height:t}=this.getBounds(),r=this._viewRef.width(),i=this._viewRef.height(),s=-r/2/this.zoomLevel+this._panX+r/2,o=-i/2/this.zoomLevel+this._panY+i/2,c=(e-r/2)/this.zoomLevel+this._panX+r/2,u=(t-i/2)/this.zoomLevel+this._panY+i/2;return[new yr(Math.floor(s),Math.floor(o)),new yr(Math.floor(c),Math.floor(u))]}isCellVisible(e){const[t,r]=this.getViewableRange();return e.x>t.x&&e.x<r.x&&e.y>t.y&&e.y<r.y}getViewportCenter(){const[e,t]=this.getViewableRange(),r=e.x+Math.floor((t.x-e.x)/2),i=e.y+Math.floor((t.y-e.y)/2);return{screenX:r,screenY:i}}trackPlayer(e){this._viewRef.setFocusedPlayer(e.player),this.stopAnimations();const t=e.player.nameLocation();t&&(this._destPoint=new yr(t.x,t.y),this._animTimer=setInterval(()=>this.processMovement(),yo))}trackCoordinates(e){this.stopAnimations(),this._destPoint=new yr(e.x,e.y),this._animTimer=setInterval(()=>this.processMovement(),yo)}trackUnit(e){this.stopAnimations();const t=e.unit.lastTile();this._destPoint=new yr(this._viewRef.x(t),this._viewRef.y(t)),this._animTimer=setInterval(()=>this.processMovement(),yo)}startCentering(){this.stopAnimations();const e=this._viewRef.myPlayer();if(!e||!e.nameLocation())return;const t=e.nameLocation();this._destPoint=new yr(t.x,t.y),this._animTimer=setInterval(()=>this.processMovement(),yo)}startFocusSequence(){this.stopAnimations();const e=this._viewRef.myPlayer();if(!e||!e.nameLocation())return;const t=e.nameLocation();this._destPoint=new yr(t.x,t.y),this._destZoom=5,this._animTimer=setInterval(()=>this.processZoomAndMove(),yo)}processMovement(){const e=this.getViewportCenter();if(!this._destPoint)throw new Error("Destination missing during animation");const t=Math.abs(this._destPoint.x-e.screenX),r=Math.abs(this._destPoint.y-e.screenY);if(t+r<2){this.stopAnimations();return}const i=window.performance.now(),s=this._lastFrameTime?i-this._lastFrameTime:yo;this._lastFrameTime=i;const o=1-Math.pow(aM,s/1e3),c=(this._destPoint.x-e.screenX)*o,u=(this._destPoint.y-e.screenY)*o;this._panX+=this.clamp(c,-Aa,Aa),this._panY+=this.clamp(u,-Aa,Aa),this._isDirty=!0}processZoomAndMove(){const e=this.getViewportCenter();if(!this._destPoint)throw new Error("Destination missing");const t=window.performance.now(),r=this._lastFrameTime?t-this._lastFrameTime:yo;this._lastFrameTime=t;const i=1-Math.pow(aM,r/1e3),o=Math.abs(this._destPoint.x-e.screenX)+Math.abs(this._destPoint.y-e.screenY)<2;if(!o){const c=(this._destPoint.x-e.screenX)*i,u=(this._destPoint.y-e.screenY)*i;this._panX+=this.clamp(c,-Aa,Aa),this._panY+=this.clamp(u,-Aa,Aa)}if(this._destZoom!==null){const c=this._destZoom-this.zoomLevel,u=Math.abs(c)<.01;if(!u){const d=this.zoomLevel;this.zoomLevel+=c*i,this.zoomLevel=this.clamp(this.zoomLevel,.2,20);const f=this.getBounds(),p=f.width/2,y=f.height/2,b=this._viewRef.width()/2,_=this._viewRef.height()/2,w=(p-b)/d+this._panX,S=(y-_)/d+this._panY;this._panX=w-(p-b)/this.zoomLevel,this._panY=S-(y-_)/this.zoomLevel}if(o&&u){this.stopAnimations();return}}else if(o){this.stopAnimations();return}this._isDirty=!0}handleZoom(e){this.stopAnimations();const t=this.zoomLevel,r=1+e.delta/600;this.zoomLevel/=r,this.zoomLevel=this.clamp(this.zoomLevel,.2,20);const i=this.getBounds(),s=e.x-i.left,o=e.y-i.top,c=this._viewRef.width()/2,u=this._viewRef.height()/2,d=(s-c)/t+this._panX,f=(o-u)/t+this._panY;this._panX=d-(s-c)/this.zoomLevel,this._panY=f-(o-u)/this.zoomLevel,this._isDirty=!0}handleDrag(e){this.stopAnimations(),this._panX-=e.deltaX/this.zoomLevel,this._panY-=e.deltaY/this.zoomLevel,this._isDirty=!0}stopAnimations(){this._animTimer&&(clearInterval(this._animTimer),this._animTimer=null),this._destPoint=null,this._destZoom=null,this._lastFrameTime=null}setView(e=0,t=0,r=1){this.stopAnimations(),this._panX=e,this._panY=t,this.zoomLevel=r,this._isDirty=!0}setZoom(e){this.zoomLevel=this.clamp(e,.2,20),this._isDirty=!0}fitWorld(e=1){const t=this.getBounds(),r=this._viewRef.width(),i=this._viewRef.height(),s=t.width/r*e,o=t.height/i*e,c=Math.min(s,o),u=(r-t.width)/2/c,d=(i-t.height)/2/c;this.setView(u,d,c)}clamp(e,t,r){return Math.max(t,Math.min(r,e))}}class wne{constructor(e,t){this.p1=e,this.p2=t,this.dx=Math.abs(t.x-e.x),this.dy=Math.abs(t.y-e.y),this.sx=e.x<t.x?1:-1,this.sy=e.y<t.y?1:-1,this.error=this.dx-this.dy}size(){return Math.max(this.dx,this.dy)+1}increment(){if(this.p1.x===this.p2.x&&this.p1.y===this.p2.y)return!0;const{x:e,y:t}=this.p1,r=2*this.error;return r>-this.dy&&(this.error-=this.dy,this.p1.x+=this.sx),r<this.dx&&(this.error+=this.dx,this.p1.y+=this.sy),{x:e,y:t}}}class Sne{constructor(e){this._view=e}#e=new Map;#t=new Map;getTrail(e){return this.#e.has(e)||this.#e.set(e,[]),this.#e.get(e)}addTrailPoint(e,t){this.getTrail(e).push(t)}clearTrail(e){this.#e.delete(e)}getAllTrails(){return this.#e.entries()}getCachedProjectileLoc(e){return this.#t.get(e)}setCachedProjectileLoc(e,t){this.#t.set(e,t)}calculateStrategicPath(e){let t=1;const r=this.getTrail(e);if(r.length>=1){const i={x:this._view.x(e.lastTile()),y:this._view.y(e.lastTile())},s={x:this._view.x(r[r.length-1]),y:this._view.y(r[r.length-1])},o=new wne(s,i);let c=o.increment();for(;c!==!0;)r.push(this._view.ref(c.x,c.y)),c=o.increment();t=o.size()}else r.push(e.lastTile());return r.slice(-t)}}class Ane{constructor(e,t,r){this._view=e,this._bus=t,this._camera=r}#e=null;#t=10;get activeSelection(){return this.#e}handleInputRelease(e){const t=this._camera.toWorldSpace(e.x,e.y),r=this.scanForNavalAssets(t);if(this.#e){const i=this._view.ref(t.x,t.y);this._view.isOcean(i)&&this._bus.emit(new Y4(this.#e.id(),i)),this._bus.emit(new Lh(this.#e,!1))}else if(r.length>0){const i=r[0];this._bus.emit(new Lh(i,!0))}}handleSelectionEvent(e){e.isSelected?this.#e=e.unit:this.#e===e.unit&&(this.#e=null)}processDeactivation(e){this.#e===e&&!e.isActive()&&this._bus.emit(new Lh(e,!1))}scanForNavalAssets(e){if(!this._view.isValidCoord(e.x,e.y))return[];const t=this._view.ref(e.x,e.y);return this._view.units($.Warship).filter(r=>r.isActive()&&r.owner()===this._view.myPlayer()&&this._view.manhattanDist(r.tile(),t)<=this.#t).sort((r,i)=>{const s=this._view.manhattanDist(r.tile(),t),o=this._view.manhattanDist(i.tile(),t);return s-o})}}class BP{static evaluateStance(e,t){const r=e.myPlayer();return r===null?Ra.Hostile:r===t.owner()?Ra.Own:r.isFriendly(t.owner())?Ra.Friendly:Ra.Hostile}}class Cne{constructor(e){this._view=e}evaluateStance(e){return BP.evaluateStance(this._view,e)}getTacticalColor(e,t,r){if(!r)return null;switch(this.evaluateStance(e)){case Ra.Own:return t.selfColor();case Ra.Friendly:return t.allyColor();case Ra.Hostile:return t.enemyColor()}}}class Gv extends Cne{render(e,t,r,i,s,o,c){let u=this.getTacticalColor(e,s,o);if(o&&u){const f=e.targetUnitId();if(e.type()===$.TradeShip&&f!==void 0){const p=this._view.unit(f)?.owner(),y=this._view.myPlayer();y!==null&&p!==void 0&&(y===p?u=s.selfColor():y.isFriendly(p)&&(u=s.allyColor()))}}const d=Lp(e,s,u??c,u??void 0);if(e.isActive()){const f=e.targetable();f||(t.save(),t.globalAlpha=.5),t.drawImage(d,Math.round(r-d.width/2),Math.round(i-d.height/2),d.width,d.width),f||t.restore()}}clearFootprint(e,t,r,i){if(!cv(e))return;const o=Lp(e,this._view.config().theme()).width+1;t.clearRect(r-o/2,i-o/2,o,o)}}class kne extends Gv{render(e,t,r,i,s,o,c){let u=c;e.type()===$.Warship&&e.targetUnitId()&&(u=j({r:200,b:0,g:0})),super.render(e,t,r,i,s,o,u)}}class Tne extends Gv{render(e,t,r,i,s,o,c){const u=this.getTacticalColor(e,s,o),d=Lp(e,s,u??c,u??void 0);if(e.isActive()){const f=e.targetable();t.save(),o||(t.globalAlpha=.15,t.drawImage(d,Math.round(r-d.width/2),Math.round(i-d.height/2),d.width,d.width)),t.globalAlpha=f?1:.5,t.drawImage(d,Math.round(r-d.width/2),Math.round(i-d.height/2),d.width,d.width),t.restore()}}clearFootprint(e,t,r,i){if(!cv(e))return;const o=Lp(e,this._view.config().theme()).width+8;t.clearRect(r-o/2,i-o/2,o,o)}}class Ene{constructor(e){this._renderers=new Map;const t=new Tne(e),r=new kne(e),i=new Gv(e);this._renderers.set($.Train,t),this._renderers.set($.Warship,r),this._renderers.set($.TransportShip,r),this._renderers.set($.TradeShip,r),this._defaultRenderer=i}getRenderer(e){return this._renderers.get(e)??this._defaultRenderer}registerRenderer(e,t){this._renderers.set(e,t)}}var Ra=(n=>(n[n.Own=0]="Own",n[n.Friendly=1]="Friendly",n[n.Hostile=2]="Hostile",n))(Ra||{});class Mne{constructor(e){this._view=e,this.#s=e.config().theme(),this.#a=new Ene(e),this.#e=document.createElement("canvas");const t=this.#e.getContext("2d");if(t===null)throw new Error("2d context not supported");this.#t=t,this.#n=document.createElement("canvas");const r=this.#n.getContext("2d");if(r===null)throw new Error("2d context not supported");this.#r=r}#e;#t;#n;#r;#s;#i=!1;#a;set tacticalView(e){this.#i=e}get entityCanvas(){return this.#e}get trailCanvas(){return this.#n}get trailCtx(){return this.#r}reconstructScene(e,t){this.#e.width=e,this.#e.height=t,this.#n.width=e,this.#n.height=t}refreshAssetSprites(e,t){const r=e?.map(i=>this._view.unit(i)).filter(i=>i!==void 0);r&&(this.clearAssetFootprints(r),t&&r.forEach(i=>t(i)))}renderSprite(e,t){const r=this._view.x(e.tile()),i=this._view.y(e.tile());this.#a.getRenderer(e.type()).render(e,this.#t,r,i,this.#s,this.#i,t)}rasterizePoint(e,t,r,i,s,o=this.#t){if(this.clearPoint(e,t,o),this.#i)switch(r){case 0:o.fillStyle=this.#s.selfColor().toRgbString();break;case 1:o.fillStyle=this.#s.allyColor().toRgbString();break;case 2:o.fillStyle=this.#s.enemyColor().toRgbString();break}else o.fillStyle=i.alpha(s/255).toRgbString();o.fillRect(e,t,1,1)}clearPoint(e,t,r=this.#t){r.clearRect(e,t,1,1)}evaluateStance(e){return BP.evaluateStance(this._view,e)}clearAssetFootprints(e){e.filter(t=>cv(t)).forEach(t=>{const r=this.#a.getRenderer(t.type()),i=this._view.x(t.lastTile()),s=this._view.y(t.lastTile());r.clearFootprint(t,this.#t,i,s)})}}class Nne{constructor(e,t,r){this._view=e,this._bus=t,this._camera=r,this.#e=new Ane(e,t,r),this.#t=new Sne(e),this.#n=new Mne(e)}#e;#t;#n;isWorldSpace(){return!0}tick(e=!1){const t=this._view.updatesSinceLastTick()?.[Wt.Unit]?.map(r=>r.id);if(t&&t.length>0){const r=[];for(const i of t){const s=this._view.unit(i);if(s){const o=s.type();(o===$.TransportShip||o===$.Warship||o===$.Train||o===$.AtomBomb||o===$.HydrogenBomb||o===$.MIRV||o===$.MIRVWarhead||o===$.Shell||o===$.SAMMissile||o===$.TradeShip)&&(this.#t.getTrail(s),s.isActive()&&r.push(s))}}r.length>0?this.#n.refreshAssetSprites(t,i=>{switch(i.type()){case $.TransportShip:this.processNavalTransport(i,e);break;case $.Warship:this.processNavalUnit(i,e);break;case $.Train:this.processRailUnit(i,e);break;case $.AtomBomb:case $.HydrogenBomb:case $.MIRV:this.processStrategicWeapon(i,e);break;case $.TradeShip:this.processMerchant(i,e);break;case $.Shell:this.processBallistic(i,e);break;case $.SAMMissile:this.processInterceptor(i,e);break;case $.MIRVWarhead:this.processMIRVPayload(i,e);break}}):e||this.#n.refreshAssetSprites(t)}else e||this.#n.refreshAssetSprites([])}async init(){this._bus.on(sd,e=>this.handleViewModeChange(e)),this._bus.on(Td,e=>this.#e.handleInputRelease(e)),this._bus.on(Lh,e=>this.#e.handleSelectionEvent(e)),this.reconstructScene(),await Wq()}paint(e){e.drawImage(this.#n.trailCanvas,-this._view.width()/2,-this._view.height()/2,this._view.width(),this._view.height()),e.drawImage(this.#n.entityCanvas,-this._view.width()/2,-this._view.height()/2,this._view.width(),this._view.height())}handleViewModeChange(e){this.#n.tacticalView=e.alternateView,this.reconstructScene()}reconstructScene(){this.#n.reconstructScene(this._view.width(),this._view.height());const e=this._view.units(),t=[];for(const r of e){const i=r.type();(i===$.TransportShip||i===$.Warship||i===$.Train||i===$.AtomBomb||i===$.HydrogenBomb||i===$.MIRV||i===$.MIRVWarhead||i===$.Shell||i===$.SAMMissile||i===$.TradeShip)&&(this.#t.getTrail(r),t.push(r.id()))}this.#n.refreshAssetSprites(t);for(const[r,i]of this.#t.getAllTrails()){for(const s of i)this.#n.rasterizePoint(this._view.x(s),this._view.y(s),this.#n.evaluateStance(r),r.owner().territoryColor(),150);switch(r.isActive()||this.#e.processDeactivation(r),r.type()){case $.TransportShip:this.processNavalTransport(r,!1);break;case $.Warship:this.processNavalUnit(r,!1);break;case $.Shell:this.processBallistic(r,!1);break;case $.SAMMissile:this.processInterceptor(r,!1);break;case $.TradeShip:this.processMerchant(r,!1);break;case $.Train:this.processRailUnit(r,!1);break;case $.MIRVWarhead:this.processMIRVPayload(r,!1);break;case $.AtomBomb:case $.HydrogenBomb:case $.MIRV:this.processStrategicWeapon(r,!1);break}}}processNavalUnit(e,t){t||this.#n.renderSprite(e)}processBallistic(e,t){const r=this.#n.evaluateStance(e);if(!t){this.#n.clearPoint(this._view.x(e.lastTile()),this._view.y(e.lastTile()));const i=this.#t.getCachedProjectileLoc(e);i!==void 0&&this.#n.clearPoint(this._view.x(i),this._view.y(i))}this.#t.setCachedProjectileLoc(e,e.lastTile()),e.isActive()&&(t||(this.#n.rasterizePoint(this._view.x(e.tile()),this._view.y(e.tile()),r,e.owner().borderColor(),255),this.#n.rasterizePoint(this._view.x(e.lastTile()),this._view.y(e.lastTile()),r,e.owner().borderColor(),255)))}processInterceptor(e,t){t||this.#n.renderSprite(e)}drawPath(e,t,r){for(const i of e)this.#n.rasterizePoint(this._view.x(i),this._view.y(i),r,t,150,this.#n.trailCtx)}erasePath(e){const t=this.#t.getTrail(e),r=this.#n.evaluateStance(e);for(const s of t)this.#n.clearPoint(this._view.x(s),this._view.y(s),this.#n.trailCtx);this.#t.clearTrail(e);const i=new Set(t);for(const[s,o]of this.#t.getAllTrails())for(const c of o)i.has(c)&&this.#n.rasterizePoint(this._view.x(c),this._view.y(c),r,s.owner().territoryColor(),150,this.#n.trailCtx)}processStrategicWeapon(e,t){const r=this.#n.evaluateStance(e),i=this.#t.calculateStrategicPath(e);t||(this.drawPath(i,e.owner().territoryColor(),r),this.#n.renderSprite(e)),e.isActive()||(t?this.#t.clearTrail(e):this.erasePath(e))}processMIRVPayload(e,t){const r=this.#n.evaluateStance(e);t||this.#n.clearPoint(this._view.x(e.lastTile()),this._view.y(e.lastTile())),e.isActive()&&!t&&this.#n.rasterizePoint(this._view.x(e.tile()),this._view.y(e.tile()),r,e.owner().borderColor(),255)}processMerchant(e,t){t||this.#n.renderSprite(e)}processRailUnit(e,t){t||this.#n.renderSprite(e)}processNavalTransport(e,t){const r=this.#n.evaluateStance(e);if(this.#t.addTrailPoint(e,e.lastTile()),t){e.isActive()||this.#t.clearTrail(e);return}const i=this.#t.getTrail(e);this.drawPath(i.slice(-1),e.owner().territoryColor(),r),this.#n.renderSprite(e),e.isActive()||this.erasePath(e)}}const Eo=class Eo{static drawGauge(e,t,r,i,s,o,c=[]){if(o=Math.max(0,Math.min(1,o)),e.fillStyle="rgba(0, 0, 0, 1)",e.fillRect(t-1,r-1,i,s),c.length===0)e.fillStyle="#808080";else{const u=Math.min(c.length-1,Math.floor(o*c.length));e.fillStyle=c[u]}e.fillRect(t,r,Math.max(1,Math.floor(o*(i-2))),s-2)}static clearGauge(e,t,r,i,s){e.clearRect(t-Eo.CLEAR_PADDING,r-Eo.CLEAR_PADDING,i+Eo.CLEAR_PADDING*2,s+Eo.CLEAR_PADDING*2)}};Eo.CLEAR_PADDING=2;let Ea=Eo;class Ine{constructor(){this._currentSelection=null,this._prevSelectionBounds=null,this.SELECTION_PADDING=6}handleSelectionEvent(e){e.isSelected?this._currentSelection=e.unit:this._currentSelection===e.unit&&(this._currentSelection=null)}getCurrentSelection(){return this._currentSelection}calculateSelectionDraw(e,t,r,i,s){if(!e||e.type()!==$.Warship||!e.isActive()){if(this._prevSelectionBounds){const w=this._prevSelectionBounds;return this._prevSelectionBounds=null,{pixels:[],clearBounds:w}}return null}const o=this.SELECTION_PADDING,d=200+Math.sin(i*.1)*55,f=s.lighten(.2),p=t,y=r;let b=null;this._prevSelectionBounds&&(this._prevSelectionBounds.x!==p||this._prevSelectionBounds.y!==y)&&(b=this._prevSelectionBounds);const _=[];for(let w=p-o;w<=p+o;w++)for(let S=y-o;S<=y+o;S++)(w===p-o||w===p+o||S===y-o||S===y+o)&&(w+S)%2===0&&_.push({x:w,y:S,color:f,alpha:d});return this._prevSelectionBounds={x:p,y,extent:o},{pixels:_,clearBounds:b}}getPrevSelectionBounds(){return this._prevSelectionBounds}clearPrevSelectionBounds(){this._prevSelectionBounds=null}}class Rne{constructor(){this._trackedHealthUnits=new Set,this._trackedProgressUnits=new Set}handleUnitState(e,t){switch(e.type()){case $.Construction:{e.constructionType()!==void 0&&this._trackedProgressUnits.add(e.id());break}case $.Warship:{const r=t.unitInfo(e.type()).maxHealth;if(r===void 0)break;const i=e.health();e.isActive()&&i<r&&i>0?this._trackedHealthUnits.add(e.id()):this._trackedHealthUnits.delete(e.id());break}case $.MissileSilo:case $.SAMLauncher:this._trackedProgressUnits.add(e.id());break;default:return}}calculateCompletion(e,t){if(!e.isActive())return 1;switch(e.type()){case $.Construction:{const r=e.constructionType();if(r===void 0)return 1;const i=t.unitInfo(r).constructionDuration;if(i===void 0)throw new Error("Missing construction data");return(t.ticks()-e.createdAt())/(i===0?1:i)}case $.MissileSilo:case $.SAMLauncher:return e.missileReadinesss();default:return 1}}refreshHealthGauges(e,t,r){const i=[],s=[];return this._trackedHealthUnits.forEach(o=>{const c=e.unit(o);if(!c||c.type()!==$.Warship){s.push(o);return}const u=e.unitInfo(c.type()).maxHealth;if(u===void 0){s.push(o);return}const d=c.health(),f=c.isActive();d>=u||d<=0||!f?s.push(o):i.push({unitId:o,x:t(c.tile())-4,y:r(c.tile())-6,progress:d/u})}),s.forEach(o=>this._trackedHealthUnits.delete(o)),i}refreshProgressGauges(e,t,r){const i=[],s=[];return this._trackedProgressUnits.forEach(o=>{const c=e.unit(o);if(!c||!c.isActive()){s.push(o);return}const u=this.calculateCompletion(c,e);u>=1?s.push(o):i.push({unitId:o,x:t(c.tile())-6,y:r(c.tile())+6,progress:u})}),s.forEach(o=>this._trackedProgressUnits.delete(o)),i}getTrackedHealthUnitIds(){return new Set(this._trackedHealthUnits)}getTrackedProgressUnitIds(){return new Set(this._trackedProgressUnits)}}const oM=["rgb(232, 25, 25)","rgb(240, 122, 25)","rgb(202, 231, 15)","rgb(44, 239, 18)"],Cx=11,kx=14,nc=3;class Pne{constructor(e,t,r){this._view=e,this._bus=t,this._camera=r,this._theme=null,this._animFrame=0,this._prevHealthGaugePositions=new Map,this._prevProgressGaugePositions=new Map,this._theme=e.config().theme(),this._selectionSystem=new Ine,this._statusMonitor=new Rne}isWorldSpace(){return!0}tick(){if(this._hudCtx===null)return;this._animFrame=(this._animFrame+1)%60,this._view.updatesSinceLastTick()?.[Wt.Unit]?.map(i=>this._view.unit(i.id))?.forEach(i=>{i!==void 0&&this._statusMonitor.handleUnitState(i,this._view)});const r=this._selectionSystem.getCurrentSelection();r&&r.type()===$.Warship&&this.renderSelectionReticule(r),this.renderHealthGauges(),this.renderProgressGauges()}async init(){this._bus.on(Lh,e=>{if(this._selectionSystem.handleSelectionEvent(e),!e.isSelected&&this._selectionSystem.getCurrentSelection()===null){const t=this._selectionSystem.getPrevSelectionBounds();t&&(this.eraseSelectionBox(t.x,t.y,t.extent),this._selectionSystem.clearPrevSelectionBounds())}}),this.rebuildSurface()}paint(e){e.drawImage(this._hudCanvas,-this._view.width()/2,-this._view.height()/2,this._view.width(),this._view.height())}rebuildSurface(){this._hudCanvas=document.createElement("canvas"),this._hudCtx=this._hudCanvas.getContext("2d"),this._hudCanvas.width=this._view.width(),this._hudCanvas.height=this._view.height()}renderHealthGauges(){if(this._hudCtx===null)return;const e=this._statusMonitor.refreshHealthGauges(this._view,r=>this._view.x(r),r=>this._view.y(r)),t=new Set(e.map(r=>r.unitId));this._prevHealthGaugePositions.forEach((r,i)=>{t.has(i)||(Ea.clearGauge(this._hudCtx,r.x,r.y,Cx,nc),this._prevHealthGaugePositions.delete(i))}),e.forEach(r=>{const i=this._prevHealthGaugePositions.get(r.unitId);i&&(i.x!==r.x||i.y!==r.y)&&Ea.clearGauge(this._hudCtx,i.x,i.y,Cx,nc),Ea.drawGauge(this._hudCtx,r.x,r.y,Cx,nc,r.progress,oM),this._prevHealthGaugePositions.set(r.unitId,{x:r.x,y:r.y})})}renderProgressGauges(){if(this._hudCtx===null)return;const e=this._statusMonitor.refreshProgressGauges(this._view,r=>this._view.x(r),r=>this._view.y(r)),t=new Set(e.map(r=>r.unitId));this._prevProgressGaugePositions.forEach((r,i)=>{t.has(i)||(Ea.clearGauge(this._hudCtx,r.x,r.y,kx,nc),this._prevProgressGaugePositions.delete(i))}),e.forEach(r=>{const i=this._prevProgressGaugePositions.get(r.unitId);i&&(i.x!==r.x||i.y!==r.y)&&Ea.clearGauge(this._hudCtx,i.x,i.y,kx,nc),Ea.drawGauge(this._hudCtx,r.x,r.y,kx,nc,r.progress,oM),this._prevProgressGaugePositions.set(r.unitId,{x:r.x,y:r.y})})}eraseSelectionBox(e,t,r){for(let i=e-r;i<=e+r;i++)for(let s=t-r;s<=t+r;s++)(i===e-r||i===e+r||s===t-r||s===t+r)&&this.clearPixel(i,s)}renderSelectionReticule(e){if(!e||!e.isActive()||this._hudCtx===null)return;if(this._theme===null)throw new Error("Theme missing");const t=e.tile(),r=this._view.x(t),i=this._view.y(t),s=e.owner().territoryColor(),o=this._selectionSystem.calculateSelectionDraw(e,r,i,this._animFrame,s);o&&(o.clearBounds&&this.eraseSelectionBox(o.clearBounds.x,o.clearBounds.y,o.clearBounds.extent),o.pixels.forEach(c=>{this.drawPixel(c.x,c.y,c.color,c.alpha)}))}drawPixel(e,t,r,i){if(this._hudCtx===null)throw new Error("Context lost");this.clearPixel(e,t),this._hudCtx.fillStyle=r.alpha(i/255).toRgbString(),this._hudCtx.fillRect(e,t,1,1)}clearPixel(e,t){if(this._hudCtx===null)throw new Error("Context lost");this._hudCtx.clearRect(e,t,1,1)}}class Dne{constructor(e,t){this._gameInstance=e,this.domCanvas=t,this._pipeline=[],this.syncDimensions=()=>{this.domCanvas.width=window.innerWidth,this.domCanvas.height=window.innerHeight,this.camera.recalculateBounds()},this.drawFrame=()=>{const i=performance.now(),s=this._view.config().theme().backgroundColor();this._ctx.fillStyle=s.toHex(),this._ctx.fillRect(0,0,this.domCanvas.width,this.domCanvas.height);let o=!1;const c=(d,f)=>d&&!f?(this._ctx.save(),this.camera.applyToContext(this._ctx),!0):!d&&f?(this._ctx.restore(),!1):f;for(const d of this._pipeline){const f=d.isWorldSpace?.()??!1;o=c(f,o),d.paint?.(this._ctx)}c(!1,o),this.camera.markClean(),requestAnimationFrame(this.drawFrame);const u=performance.now()-i;ae.emit(new c1(u)),u>50&&console.warn(`Slow tick detected: Frame ${this._view.ticks()} took ${u}ms`),this._gameInstance.worker.sendHeartbeat()},this._view=e.gameView,this.camera=new _ne(this._view,ae,t);const r=t.getContext("2d");if(!r)throw new Error("Canvas 2D Context unavailable");this._ctx=r,this._pipeline.push(new lne(this._view,this.camera),new vne(this._view,ae,this.camera),new NZ(this._view,this.camera),new sne(this._view,ae,this.camera),new Nne(this._view,ae,this.camera),new uZ(this._view),new Pne(this._view,ae,this.camera),new ene(this._gameInstance,ae,this.camera),new SZ(this._gameInstance,ae,this.camera),new hZ(this._gameInstance))}async initialize(e){const t=this._pipeline.length;let r=0;e&&e(0);for(const i of this._pipeline)i.init&&await i.init(),r++,e&&e(Math.round(r/t*100));window.addEventListener("resize",this.syncDimensions),this.syncDimensions(),this.camera.fitWorld(.9),this._frameId=requestAnimationFrame(this.drawFrame),this.domCanvas.addEventListener("contextlost",()=>{cancelAnimationFrame(this._frameId)}),this.domCanvas.addEventListener("contextrestored",()=>{this.triggerRestoration(),this._frameId=requestAnimationFrame(this.drawFrame)})}triggerRestoration(){this._pipeline.forEach(e=>e.onRestoration?.())}tick(e=!1){for(const t of this._pipeline)t.tick?.(e)}resize(e,t){const r=window.devicePixelRatio;this.domCanvas.width=Math.ceil(e/r),this.domCanvas.height=Math.ceil(t/r)}stop(){cancelAnimationFrame(this._frameId)}}var s2;try{s2=new TextDecoder}catch{}var Te,ms,te=0,rn={},bt,Pa,Ii=0,us=0,lr,$s,Zr=[],dt,lM={useRecords:!1,mapsAsObjects:!0};class OP{}const LP=new OP;LP.name="MessagePack 0xC1";var Oa=!1,zP=2,jne;try{new Function("")}catch{zP=1/0}class _d{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(Te)return WP(()=>(o2(),this?this.unpack(e,t):_d.prototype.unpack.call(lM,e,t)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Buffer<"u"?Buffer.from(e):new Uint8Array(e)),typeof t=="object"?(ms=t.end||e.length,te=t.start||0):(te=0,ms=t>-1?t:e.length),us=0,Pa=null,lr=null,Te=e;try{dt=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw Te=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof _d){if(rn=this,this.structures)return bt=this.structures,qm(t);(!bt||bt.length>0)&&(bt=[])}else rn=lM,(!bt||bt.length>0)&&(bt=[]);return qm(t)}unpackMultiple(e,t){let r,i=0;try{Oa=!0;let s=e.length,o=this?this.unpack(e,s):_g.unpack(e,s);if(t){if(t(o,i,te)===!1)return;for(;te<s;)if(i=te,t(qm(),i,te)===!1)return}else{for(r=[o];te<s;)i=te,r.push(qm());return r}}catch(s){throw s.lastPosition=i,s.values=r,s}finally{Oa=!1,o2()}}_mergeStructures(e,t){e=e||[],Object.isFrozen(e)&&(e=e.map(r=>r.slice(0)));for(let r=0,i=e.length;r<i;r++){let s=e[r];s&&(s.isShared=!0,r>=32&&(s.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],s=t[r];s&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=s)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function qm(n){try{if(!rn.trusted&&!Oa){let t=bt.sharedLength||0;t<bt.length&&(bt.length=t)}let e;if(rn.randomAccessStructure&&Te[te]<64&&Te[te]>=32&&jne||(e=On()),lr&&(te=lr.postBundlePosition,lr=null),Oa&&(bt.restoreStructures=null),te==ms)bt&&bt.restoreStructures&&cM(),bt=null,Te=null,$s&&($s=null);else{if(te>ms)throw new Error("Unexpected end of MessagePack data");if(!Oa){let t;try{t=JSON.stringify(e,(r,i)=>typeof i=="bigint"?`${i}n`:i).slice(0,100)}catch(r){t="(JSON view not available "+r+")"}throw new Error("Data read, but end of buffer not reached "+t)}}return e}catch(e){throw bt&&bt.restoreStructures&&cM(),o2(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||te>ms)&&(e.incomplete=!0),e}}function cM(){for(let n in bt.restoreStructures)bt[n]=bt.restoreStructures[n];bt.restoreStructures=null}function On(){let n=Te[te++];if(n<160)if(n<128){if(n<64)return n;{let e=bt[n&63]||rn.getStructures&&UP()[n&63];return e?(e.read||(e.read=Hv(e,n&63)),e.read()):n}}else if(n<144)if(n-=128,rn.mapsAsObjects){let e={};for(let t=0;t<n;t++){let r=GP();r==="__proto__"&&(r="__proto_"),e[r]=On()}return e}else{let e=new Map;for(let t=0;t<n;t++)e.set(On(),On());return e}else{n-=144;let e=new Array(n);for(let t=0;t<n;t++)e[t]=On();return rn.freezeData?Object.freeze(e):e}else if(n<192){let e=n-160;if(us>=te)return Pa.slice(te-Ii,(te+=e)-Ii);if(us==0&&ms<140){let t=e<16?Vv(e):FP(e);if(t!=null)return t}return a2(e)}else{let e;switch(n){case 192:return null;case 193:return lr?(e=On(),e>0?lr[1].slice(lr.position1,lr.position1+=e):lr[0].slice(lr.position0,lr.position0-=e)):LP;case 194:return!1;case 195:return!0;case 196:if(e=Te[te++],e===void 0)throw new Error("Unexpected end of buffer");return Tx(e);case 197:return e=dt.getUint16(te),te+=2,Tx(e);case 198:return e=dt.getUint32(te),te+=4,Tx(e);case 199:return bo(Te[te++]);case 200:return e=dt.getUint16(te),te+=2,bo(e);case 201:return e=dt.getUint32(te),te+=4,bo(e);case 202:if(e=dt.getFloat32(te),rn.useFloat32>2){let t=Wv[(Te[te]&127)<<1|Te[te+1]>>7];return te+=4,(t*e+(e>0?.5:-.5)>>0)/t}return te+=4,e;case 203:return e=dt.getFloat64(te),te+=8,e;case 204:return Te[te++];case 205:return e=dt.getUint16(te),te+=2,e;case 206:return e=dt.getUint32(te),te+=4,e;case 207:return rn.int64AsType==="number"?(e=dt.getUint32(te)*4294967296,e+=dt.getUint32(te+4)):rn.int64AsType==="string"?e=dt.getBigUint64(te).toString():rn.int64AsType==="auto"?(e=dt.getBigUint64(te),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=dt.getBigUint64(te),te+=8,e;case 208:return dt.getInt8(te++);case 209:return e=dt.getInt16(te),te+=2,e;case 210:return e=dt.getInt32(te),te+=4,e;case 211:return rn.int64AsType==="number"?(e=dt.getInt32(te)*4294967296,e+=dt.getUint32(te+4)):rn.int64AsType==="string"?e=dt.getBigInt64(te).toString():rn.int64AsType==="auto"?(e=dt.getBigInt64(te),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=dt.getBigInt64(te),te+=8,e;case 212:if(e=Te[te++],e==114)return pM(Te[te++]&63);{let t=Zr[e];if(t)return t.read?(te++,t.read(On())):t.noBuffer?(te++,t()):t(Te.subarray(te,++te));throw new Error("Unknown extension "+e)}case 213:return e=Te[te],e==114?(te++,pM(Te[te++]&63,Te[te++])):bo(2);case 214:return bo(4);case 215:return bo(8);case 216:return bo(16);case 217:return e=Te[te++],us>=te?Pa.slice(te-Ii,(te+=e)-Ii):One(e);case 218:return e=dt.getUint16(te),te+=2,us>=te?Pa.slice(te-Ii,(te+=e)-Ii):Lne(e);case 219:return e=dt.getUint32(te),te+=4,us>=te?Pa.slice(te-Ii,(te+=e)-Ii):zne(e);case 220:return e=dt.getUint16(te),te+=2,hM(e);case 221:return e=dt.getUint32(te),te+=4,hM(e);case 222:return e=dt.getUint16(te),te+=2,dM(e);case 223:return e=dt.getUint32(te),te+=4,dM(e);default:if(n>=224)return n-256;if(n===void 0){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+n)}}}const Bne=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Hv(n,e){function t(){if(t.count++>zP){let i=n.read=new Function("r","return function(){return "+(rn.freezeData?"Object.freeze":"")+"({"+n.map(s=>s==="__proto__"?"__proto_:r()":Bne.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(On);return n.highByte===0&&(n.read=uM(e,n.read)),i()}let r={};for(let i=0,s=n.length;i<s;i++){let o=n[i];o==="__proto__"&&(o="__proto_"),r[o]=On()}return rn.freezeData?Object.freeze(r):r}return t.count=0,n.highByte===0?uM(e,t):t}const uM=(n,e)=>function(){let t=Te[te++];if(t===0)return e();let r=n<32?-(n+(t<<5)):n+(t<<5),i=bt[r]||UP()[r];if(!i)throw new Error("Record id is not defined for "+r);return i.read||(i.read=Hv(i,n)),i.read()};function UP(){let n=WP(()=>(Te=null,rn.getStructures()));return bt=rn._mergeStructures(n,bt)}var a2=Pd,One=Pd,Lne=Pd,zne=Pd;function Pd(n){let e;if(n<16&&(e=Vv(n)))return e;if(n>64&&s2)return s2.decode(Te.subarray(te,te+=n));const t=te+n,r=[];for(e="";te<t;){const i=Te[te++];if((i&128)===0)r.push(i);else if((i&224)===192){const s=Te[te++]&63;r.push((i&31)<<6|s)}else if((i&240)===224){const s=Te[te++]&63,o=Te[te++]&63;r.push((i&31)<<12|s<<6|o)}else if((i&248)===240){const s=Te[te++]&63,o=Te[te++]&63,c=Te[te++]&63;let u=(i&7)<<18|s<<12|o<<6|c;u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|u&1023),r.push(u)}else r.push(i);r.length>=4096&&(e+=ir.apply(String,r),r.length=0)}return r.length>0&&(e+=ir.apply(String,r)),e}function hM(n){let e=new Array(n);for(let t=0;t<n;t++)e[t]=On();return rn.freezeData?Object.freeze(e):e}function dM(n){if(rn.mapsAsObjects){let e={};for(let t=0;t<n;t++){let r=GP();r==="__proto__"&&(r="__proto_"),e[r]=On()}return e}else{let e=new Map;for(let t=0;t<n;t++)e.set(On(),On());return e}}var ir=String.fromCharCode;function FP(n){let e=te,t=new Array(n);for(let r=0;r<n;r++){const i=Te[te++];if((i&128)>0){te=e;return}t[r]=i}return ir.apply(String,t)}function Vv(n){if(n<4)if(n<2){if(n===0)return"";{let e=Te[te++];if((e&128)>1){te-=1;return}return ir(e)}}else{let e=Te[te++],t=Te[te++];if((e&128)>0||(t&128)>0){te-=2;return}if(n<3)return ir(e,t);let r=Te[te++];if((r&128)>0){te-=3;return}return ir(e,t,r)}else{let e=Te[te++],t=Te[te++],r=Te[te++],i=Te[te++];if((e&128)>0||(t&128)>0||(r&128)>0||(i&128)>0){te-=4;return}if(n<6){if(n===4)return ir(e,t,r,i);{let s=Te[te++];if((s&128)>0){te-=5;return}return ir(e,t,r,i,s)}}else if(n<8){let s=Te[te++],o=Te[te++];if((s&128)>0||(o&128)>0){te-=6;return}if(n<7)return ir(e,t,r,i,s,o);let c=Te[te++];if((c&128)>0){te-=7;return}return ir(e,t,r,i,s,o,c)}else{let s=Te[te++],o=Te[te++],c=Te[te++],u=Te[te++];if((s&128)>0||(o&128)>0||(c&128)>0||(u&128)>0){te-=8;return}if(n<10){if(n===8)return ir(e,t,r,i,s,o,c,u);{let d=Te[te++];if((d&128)>0){te-=9;return}return ir(e,t,r,i,s,o,c,u,d)}}else if(n<12){let d=Te[te++],f=Te[te++];if((d&128)>0||(f&128)>0){te-=10;return}if(n<11)return ir(e,t,r,i,s,o,c,u,d,f);let p=Te[te++];if((p&128)>0){te-=11;return}return ir(e,t,r,i,s,o,c,u,d,f,p)}else{let d=Te[te++],f=Te[te++],p=Te[te++],y=Te[te++];if((d&128)>0||(f&128)>0||(p&128)>0||(y&128)>0){te-=12;return}if(n<14){if(n===12)return ir(e,t,r,i,s,o,c,u,d,f,p,y);{let b=Te[te++];if((b&128)>0){te-=13;return}return ir(e,t,r,i,s,o,c,u,d,f,p,y,b)}}else{let b=Te[te++],_=Te[te++];if((b&128)>0||(_&128)>0){te-=14;return}if(n<15)return ir(e,t,r,i,s,o,c,u,d,f,p,y,b,_);let w=Te[te++];if((w&128)>0){te-=15;return}return ir(e,t,r,i,s,o,c,u,d,f,p,y,b,_,w)}}}}}function fM(){let n=Te[te++],e;if(n<192)e=n-160;else switch(n){case 217:e=Te[te++];break;case 218:e=dt.getUint16(te),te+=2;break;case 219:e=dt.getUint32(te),te+=4;break;default:throw new Error("Expected string")}return Pd(e)}function Tx(n){return rn.copyBuffers?Uint8Array.prototype.slice.call(Te,te,te+=n):Te.subarray(te,te+=n)}function bo(n){let e=Te[te++];if(Zr[e]){let t;return Zr[e](Te.subarray(te,t=te+=n),r=>{te=r;try{return On()}finally{te=t}})}else throw new Error("Unknown extension type "+e)}var mM=new Array(4096);function GP(){let n=Te[te++];if(n>=160&&n<192){if(n=n-160,us>=te)return Pa.slice(te-Ii,(te+=n)-Ii);if(!(us==0&&ms<180))return a2(n)}else return te--,HP(On());let e=(n<<5^(n>1?dt.getUint16(te):n>0?Te[te]:0))&4095,t=mM[e],r=te,i=te+n-3,s,o=0;if(t&&t.bytes==n){for(;r<i;){if(s=dt.getUint32(r),s!=t[o++]){r=1879048192;break}r+=4}for(i+=3;r<i;)if(s=Te[r++],s!=t[o++]){r=1879048192;break}if(r===i)return te=r,t.string;i-=3,r=te}for(t=[],mM[e]=t,t.bytes=n;r<i;)s=dt.getUint32(r),t.push(s),r+=4;for(i+=3;r<i;)s=Te[r++],t.push(s);let c=n<16?Vv(n):FP(n);return c!=null?t.string=c:t.string=a2(n)}function HP(n){if(typeof n=="string")return n;if(typeof n=="number"||typeof n=="boolean"||typeof n=="bigint")return n.toString();if(n==null)return n+"";if(rn.allowArraysInMapKeys&&Array.isArray(n)&&n.flat().every(e=>["string","number","boolean","bigint"].includes(typeof e)))return n.flat().toString();throw new Error(`Invalid property type for record: ${typeof n}`)}const pM=(n,e)=>{let t=On().map(HP),r=n;e!==void 0&&(n=n<32?-((e<<5)+n):(e<<5)+n,t.highByte=e);let i=bt[n];return i&&(i.isShared||Oa)&&((bt.restoreStructures||(bt.restoreStructures=[]))[n]=i),bt[n]=t,t.read=Hv(t,r),t.read()};Zr[0]=()=>{};Zr[0].noBuffer=!0;Zr[66]=n=>{let e=n.byteLength%8||8,t=BigInt(n[0]&128?n[0]-256:n[0]);for(let r=1;r<e;r++)t<<=BigInt(8),t+=BigInt(n[r]);if(n.byteLength!==e){let r=new DataView(n.buffer,n.byteOffset,n.byteLength),i=(s,o)=>{let c=o-s;if(c<=40){let p=r.getBigUint64(s);for(let y=s+8;y<o;y+=8)p<<=64n,p|=r.getBigUint64(y);return p}let u=s+(c>>4<<3),d=i(s,u),f=i(u,o);return d<<BigInt((o-u)*8)|f};t=t<<BigInt((r.byteLength-e)*8)|i(e,r.byteLength)}return t};let gM={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,AggregateError:typeof AggregateError=="function"?AggregateError:null};Zr[101]=()=>{let n=On();if(!gM[n[0]]){let e=Error(n[1],{cause:n[2]});return e.name=n[0],e}return gM[n[0]](n[1],{cause:n[2]})};Zr[105]=n=>{if(rn.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=dt.getUint32(te-4);$s||($s=new Map);let t=Te[te],r;t>=144&&t<160||t==220||t==221?r=[]:t>=128&&t<144||t==222||t==223?r=new Map:(t>=199&&t<=201||t>=212&&t<=216)&&Te[te+1]===115?r=new Set:r={};let i={target:r};$s.set(e,i);let s=On();if(i.used)Object.assign(r,s);else return i.target=s;if(r instanceof Map)for(let[o,c]of s.entries())r.set(o,c);if(r instanceof Set)for(let o of Array.from(s))r.add(o);return r};Zr[112]=n=>{if(rn.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=dt.getUint32(te-4),t=$s.get(e);return t.used=!0,t.target};Zr[115]=()=>new Set(On());const VP=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(n=>n+"Array");let Une=typeof globalThis=="object"?globalThis:window;Zr[116]=n=>{let e=n[0],t=Uint8Array.prototype.slice.call(n,1).buffer,r=VP[e];if(!r){if(e===16)return t;if(e===17)return new DataView(t);throw new Error("Could not find typed array for code "+e)}return new Une[r](t)};Zr[120]=()=>{let n=On();return new RegExp(n[0],n[1])};const Fne=[];Zr[98]=n=>{let e=(n[0]<<24)+(n[1]<<16)+(n[2]<<8)+n[3],t=te;return te+=e-n.length,lr=Fne,lr=[fM(),fM()],lr.position0=0,lr.position1=0,lr.postBundlePosition=te,te=t,On()};Zr[255]=n=>n.length==4?new Date((n[0]*16777216+(n[1]<<16)+(n[2]<<8)+n[3])*1e3):n.length==8?new Date(((n[0]<<22)+(n[1]<<14)+(n[2]<<6)+(n[3]>>2))/1e6+((n[3]&3)*4294967296+n[4]*16777216+(n[5]<<16)+(n[6]<<8)+n[7])*1e3):n.length==12?new Date(((n[0]<<24)+(n[1]<<16)+(n[2]<<8)+n[3])/1e6+((n[4]&128?-281474976710656:0)+n[6]*1099511627776+n[7]*4294967296+n[8]*16777216+(n[9]<<16)+(n[10]<<8)+n[11])*1e3):new Date("invalid");function WP(n){let e=ms,t=te,r=Ii,i=us,s=Pa,o=$s,c=lr,u=new Uint8Array(Te.slice(0,ms)),d=bt,f=bt.slice(0,bt.length),p=rn,y=Oa,b=n();return ms=e,te=t,Ii=r,us=i,Pa=s,$s=o,lr=c,Te=u,Oa=y,bt=d,bt.splice(0,bt.length,...f),rn=p,dt=new DataView(Te.buffer,Te.byteOffset,Te.byteLength),b}function o2(){Te=null,$s=null,bt=null}const Wv=new Array(147);for(let n=0;n<256;n++)Wv[n]=+("1e"+Math.floor(45.15-n*.30103));var _g=new _d({useRecords:!1});const Gne=_g.unpack;_g.unpackMultiple;_g.unpack;let Hne=new Float32Array(1);new Uint8Array(Hne.buffer,0,4);let yp;try{yp=new TextEncoder}catch{}let l2,YP;const Pc=typeof Buffer<"u",Zm=Pc?function(n){return Buffer.allocUnsafeSlow(n)}:Uint8Array,$P=Pc?Buffer:Uint8Array,yM=Pc?4294967296:2144337920;let ue,xh,Zt,re=0,wr,wn=null,Vne;const Wne=21760,Yne=/[\u0080-\uFFFF]/,rc=Symbol("record-id");class $ne extends _d{constructor(e){super(e),this.offset=0;let t,r,i,s,o=$P.prototype.utf8Write?function(L,q){return ue.utf8Write(L,q,ue.byteLength-q)}:yp&&yp.encodeInto?function(L,q){return yp.encodeInto(L,ue.subarray(q)).written}:!1,c=this;e||(e={});let u=e&&e.sequential,d=e.structures||e.saveStructures,f=e.maxSharedStructures;if(f==null&&(f=d?32:0),f>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let p=e.maxOwnStructures;p==null&&(p=d?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let y=f>32||p+f>64,b=f+64,_=f+p+64;if(_>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let w=[],S=0,A=0;this.pack=this.encode=function(L,q){if(ue||(ue=new Zm(8192),Zt=ue.dataView||(ue.dataView=new DataView(ue.buffer,0,8192)),re=0),wr=ue.length-10,wr-re<2048?(ue=new Zm(ue.length),Zt=ue.dataView||(ue.dataView=new DataView(ue.buffer,0,ue.length)),wr=ue.length-10,re=0):re=re+7&2147483640,t=re,q&Jne&&(re+=q&255),s=c.structuredClone?new Map:null,c.bundleStrings&&typeof L!="string"?(wn=[],wn.size=1/0):wn=null,i=c.structures,i){i.uninitialized&&(i=c._mergeStructures(c.getStructures()));let N=i.sharedLength||0;if(N>f)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let V=0;V<N;V++){let J=i[V];if(!J)continue;let se,O=i.transitions;for(let F=0,X=J.length;F<X;F++){let D=J[F];se=O[D],se||(se=O[D]=Object.create(null)),O=se}O[rc]=V+64}this.lastNamedStructuresLength=N}u||(i.nextId=N+64)}r&&(r=!1);let W;try{c.randomAccessStructure&&L&&L.constructor&&L.constructor===Object?Y(L):E(L);let N=wn;if(wn&&xM(t,E,0),s&&s.idsToInsert){let V=s.idsToInsert.sort((F,X)=>F.offset>X.offset?1:-1),J=V.length,se=-1;for(;N&&J>0;){let F=V[--J].offset+t;F<N.stringsPosition+t&&se===-1&&(se=0),F>N.position+t?se>=0&&(se+=6):(se>=0&&(Zt.setUint32(N.position+t,Zt.getUint32(N.position+t)+se),se=-1),N=N.previous,J++)}se>=0&&N&&Zt.setUint32(N.position+t,Zt.getUint32(N.position+t)+se),re+=V.length*6,re>wr&&R(re),c.offset=re;let O=qne(ue.subarray(t,re),V);return s=null,O}return c.offset=re,q&Kne?(ue.start=t,ue.end=re,ue):ue.subarray(t,re)}catch(N){throw W=N,N}finally{if(i&&(M(),r&&c.saveStructures)){let N=i.sharedLength||0,V=ue.subarray(t,re),J=Zne(i,c);if(!W)return c.saveStructures(J,J.isCompatible)===!1?c.pack(L,q):(c.lastNamedStructuresLength=N,ue.length>1073741824&&(ue=null),V)}ue.length>1073741824&&(ue=null),q&Qne&&(re=t)}};const M=()=>{A<10&&A++;let L=i.sharedLength||0;if(i.length>L&&!u&&(i.length=L),S>1e4)i.transitions=null,A=0,S=0,w.length>0&&(w=[]);else if(w.length>0&&!u){for(let q=0,W=w.length;q<W;q++)w[q][rc]=0;w=[]}},k=L=>{var q=L.length;q<16?ue[re++]=144|q:q<65536?(ue[re++]=220,ue[re++]=q>>8,ue[re++]=q&255):(ue[re++]=221,Zt.setUint32(re,q),re+=4);for(let W=0;W<q;W++)E(L[W])},E=L=>{re>wr&&(ue=R(re));var q=typeof L,W;if(q==="string"){let N=L.length;if(wn&&N>=4&&N<4096){if((wn.size+=N)>Wne){let O,F=(wn[0]?wn[0].length*3+wn[1].length:0)+10;re+F>wr&&(ue=R(re+F));let X;wn.position?(X=wn,ue[re]=200,re+=3,ue[re++]=98,O=re-t,re+=4,xM(t,E,0),Zt.setUint16(O+t-3,re-t-O)):(ue[re++]=214,ue[re++]=98,O=re-t,re+=4),wn=["",""],wn.previous=X,wn.size=0,wn.position=O}let se=Yne.test(L);wn[se?0:1]+=L,ue[re++]=193,E(se?-N:N);return}let V;N<32?V=1:N<256?V=2:N<65536?V=3:V=5;let J=N*3;if(re+J>wr&&(ue=R(re+J)),N<64||!o){let se,O,F,X=re+V;for(se=0;se<N;se++)O=L.charCodeAt(se),O<128?ue[X++]=O:O<2048?(ue[X++]=O>>6|192,ue[X++]=O&63|128):(O&64512)===55296&&((F=L.charCodeAt(se+1))&64512)===56320?(O=65536+((O&1023)<<10)+(F&1023),se++,ue[X++]=O>>18|240,ue[X++]=O>>12&63|128,ue[X++]=O>>6&63|128,ue[X++]=O&63|128):(ue[X++]=O>>12|224,ue[X++]=O>>6&63|128,ue[X++]=O&63|128);W=X-re-V}else W=o(L,re+V);W<32?ue[re++]=160|W:W<256?(V<2&&ue.copyWithin(re+2,re+1,re+1+W),ue[re++]=217,ue[re++]=W):W<65536?(V<3&&ue.copyWithin(re+3,re+2,re+2+W),ue[re++]=218,ue[re++]=W>>8,ue[re++]=W&255):(V<5&&ue.copyWithin(re+5,re+3,re+3+W),ue[re++]=219,Zt.setUint32(re,W),re+=4),re+=W}else if(q==="number")if(L>>>0===L)L<32||L<128&&this.useRecords===!1||L<64&&!this.randomAccessStructure?ue[re++]=L:L<256?(ue[re++]=204,ue[re++]=L):L<65536?(ue[re++]=205,ue[re++]=L>>8,ue[re++]=L&255):(ue[re++]=206,Zt.setUint32(re,L),re+=4);else if(L>>0===L)L>=-32?ue[re++]=256+L:L>=-128?(ue[re++]=208,ue[re++]=L+256):L>=-32768?(ue[re++]=209,Zt.setInt16(re,L),re+=2):(ue[re++]=210,Zt.setInt32(re,L),re+=4);else{let N;if((N=this.useFloat32)>0&&L<4294967296&&L>=-2147483648){ue[re++]=202,Zt.setFloat32(re,L);let V;if(N<4||(V=L*Wv[(ue[re]&127)<<1|ue[re+1]>>7])>>0===V){re+=4;return}else re--}ue[re++]=203,Zt.setFloat64(re,L),re+=8}else if(q==="object"||q==="function")if(!L)ue[re++]=192;else{if(s){let V=s.get(L);if(V){if(!V.id){let J=s.idsToInsert||(s.idsToInsert=[]);V.id=J.push(V)}ue[re++]=214,ue[re++]=112,Zt.setUint32(re,V.id),re+=4;return}else s.set(L,{offset:re-t})}let N=L.constructor;if(N===Object)G(L);else if(N===Array)k(L);else if(N===Map)if(this.mapAsEmptyObject)ue[re++]=128;else{W=L.size,W<16?ue[re++]=128|W:W<65536?(ue[re++]=222,ue[re++]=W>>8,ue[re++]=W&255):(ue[re++]=223,Zt.setUint32(re,W),re+=4);for(let[V,J]of L)E(V),E(J)}else{for(let V=0,J=l2.length;V<J;V++){let se=YP[V];if(L instanceof se){let O=l2[V];if(O.write){O.type&&(ue[re++]=212,ue[re++]=O.type,ue[re++]=0);let pe=O.write.call(this,L);pe===L?Array.isArray(L)?k(L):G(L):E(pe);return}let F=ue,X=Zt,D=re;ue=null;let ee;try{ee=O.pack.call(this,L,pe=>(ue=F,F=null,re+=pe,re>wr&&R(re),{target:ue,targetView:Zt,position:re-pe}),E)}finally{F&&(ue=F,Zt=X,re=D,wr=ue.length-10)}ee&&(ee.length+re>wr&&R(ee.length+re),re=bM(ee,ue,re,O.type));return}}if(Array.isArray(L))k(L);else{if(L.toJSON){const V=L.toJSON();if(V!==L)return E(V)}if(q==="function")return E(this.writeFunction&&this.writeFunction(L));G(L)}}}else if(q==="boolean")ue[re++]=L?195:194;else if(q==="bigint"){if(L<9223372036854776e3&&L>=-9223372036854776e3)ue[re++]=211,Zt.setBigInt64(re,L);else if(L<18446744073709552e3&&L>0)ue[re++]=207,Zt.setBigUint64(re,L);else if(this.largeBigIntToFloat)ue[re++]=203,Zt.setFloat64(re,Number(L));else{if(this.largeBigIntToString)return E(L.toString());if(this.useBigIntExtension||this.moreTypes){let N=L<0?BigInt(-1):BigInt(0),V;if(L>>BigInt(65536)===N){let J=BigInt(18446744073709552e3)-BigInt(1),se=[];for(;se.push(L&J),L>>BigInt(63)!==N;)L>>=BigInt(64);V=new Uint8Array(new BigUint64Array(se).buffer),V.reverse()}else{let J=L<0,se=(J?~L:L).toString(16);if(se.length%2?se="0"+se:parseInt(se.charAt(0),16)>=8&&(se="00"+se),Pc)V=Buffer.from(se,"hex");else{V=new Uint8Array(se.length/2);for(let O=0;O<V.length;O++)V[O]=parseInt(se.slice(O*2,O*2+2),16)}if(J)for(let O=0;O<V.length;O++)V[O]=~V[O]}V.length+re>wr&&R(V.length+re),re=bM(V,ue,re,66);return}else throw new RangeError(L+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}re+=8}else if(q==="undefined")this.encodeUndefinedAsNil?ue[re++]=192:(ue[re++]=212,ue[re++]=0,ue[re++]=0);else throw new Error("Unknown type: "+q)},U=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?L=>{let q;if(this.skipValues){q=[];for(let V in L)(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(V))&&!this.skipValues.includes(L[V])&&q.push(V)}else q=Object.keys(L);let W=q.length;W<16?ue[re++]=128|W:W<65536?(ue[re++]=222,ue[re++]=W>>8,ue[re++]=W&255):(ue[re++]=223,Zt.setUint32(re,W),re+=4);let N;if(this.coercibleKeyAsNumber)for(let V=0;V<W;V++){N=q[V];let J=Number(N);E(isNaN(J)?N:J),E(L[N])}else for(let V=0;V<W;V++)E(N=q[V]),E(L[N])}:L=>{ue[re++]=222;let q=re-t;re+=2;let W=0;for(let N in L)(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(N))&&(E(N),E(L[N]),W++);if(W>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');ue[q+++t]=W>>8,ue[q+t]=W&255},I=this.useRecords===!1?U:e.progressiveRecords&&!y?L=>{let q,W=i.transitions||(i.transitions=Object.create(null)),N=re++-t,V;for(let J in L)if(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(J)){if(q=W[J],q)W=q;else{let se=Object.keys(L),O=W;W=i.transitions;let F=0;for(let X=0,D=se.length;X<D;X++){let ee=se[X];q=W[ee],q||(q=W[ee]=Object.create(null),F++),W=q}N+t+1==re?(re--,P(W,se,F)):H(W,se,N,F),V=!0,W=O[J]}E(L[J])}if(!V){let J=W[rc];J?ue[N+t]=J:H(W,Object.keys(L),N,0)}}:L=>{let q,W=i.transitions||(i.transitions=Object.create(null)),N=0;for(let J in L)(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(J))&&(q=W[J],q||(q=W[J]=Object.create(null),N++),W=q);let V=W[rc];V?V>=96&&y?(ue[re++]=((V-=96)&31)+96,ue[re++]=V>>5):ue[re++]=V:P(W,W.__keys__||Object.keys(L),N);for(let J in L)(typeof L.hasOwnProperty!="function"||L.hasOwnProperty(J))&&E(L[J])},B=typeof this.useRecords=="function"&&this.useRecords,G=B?L=>{B(L)?I(L):U(L)}:I,R=L=>{let q;if(L>16777216){if(L-t>yM)throw new Error("Packed buffer would be larger than maximum buffer size");q=Math.min(yM,Math.round(Math.max((L-t)*(L>67108864?1.25:2),4194304)/4096)*4096)}else q=(Math.max(L-t<<2,ue.length-1)>>12)+1<<12;let W=new Zm(q);return Zt=W.dataView||(W.dataView=new DataView(W.buffer,0,q)),L=Math.min(L,ue.length),ue.copy?ue.copy(W,0,t,L):W.set(ue.slice(t,L)),re-=t,t=0,wr=W.length-10,ue=W},P=(L,q,W)=>{let N=i.nextId;N||(N=64),N<b&&this.shouldShareStructure&&!this.shouldShareStructure(q)?(N=i.nextOwnId,N<_||(N=b),i.nextOwnId=N+1):(N>=_&&(N=b),i.nextId=N+1);let V=q.highByte=N>=96&&y?N-96>>5:-1;L[rc]=N,L.__keys__=q,i[N-64]=q,N<b?(q.isShared=!0,i.sharedLength=N-63,r=!0,V>=0?(ue[re++]=(N&31)+96,ue[re++]=V):ue[re++]=N):(V>=0?(ue[re++]=213,ue[re++]=114,ue[re++]=(N&31)+96,ue[re++]=V):(ue[re++]=212,ue[re++]=114,ue[re++]=N),W&&(S+=A*W),w.length>=p&&(w.shift()[rc]=0),w.push(L),E(q))},H=(L,q,W,N)=>{let V=ue,J=re,se=wr,O=t;ue=xh,re=0,t=0,ue||(xh=ue=new Zm(8192)),wr=ue.length-10,P(L,q,N),xh=ue;let F=re;if(ue=V,re=J,wr=se,t=O,F>1){let X=re+F-1;X>wr&&R(X);let D=W+t;ue.copyWithin(D+F,D+1,re),ue.set(xh.slice(0,F),D),re=X}else ue[W+t]=xh[0]},Y=L=>{let q=Vne(L,ue,t,re,i,R,(W,N,V)=>{if(V)return r=!0;re=N;let J=ue;return E(W),M(),J!==ue?{position:re,targetView:Zt,target:ue}:re},this);if(q===0)return G(L);re=q}}useBuffer(e){ue=e,ue.dataView||(ue.dataView=new DataView(ue.buffer,ue.byteOffset,ue.byteLength)),Zt=ue.dataView,re=0}set position(e){re=e}get position(){return re}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}YP=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,OP];l2=[{pack(n,e,t){let r=n.getTime()/1e3;if((this.useTimestamp32||n.getMilliseconds()===0)&&r>=0&&r<4294967296){let{target:i,targetView:s,position:o}=e(6);i[o++]=214,i[o++]=255,s.setUint32(o,r)}else if(r>0&&r<4294967296){let{target:i,targetView:s,position:o}=e(10);i[o++]=215,i[o++]=255,s.setUint32(o,n.getMilliseconds()*4e6+(r/1e3/4294967296>>0)),s.setUint32(o+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return e(0),t(this.onInvalidDate());let{target:i,targetView:s,position:o}=e(3);i[o++]=212,i[o++]=255,i[o++]=255}else{let{target:i,targetView:s,position:o}=e(15);i[o++]=199,i[o++]=12,i[o++]=255,s.setUint32(o,n.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(r)))}}},{pack(n,e,t){if(this.setAsEmptyObject)return e(0),t({});let r=Array.from(n),{target:i,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),t(r)}},{pack(n,e,t){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=101,r[i++]=0),t([n.name,n.message,n.cause])}},{pack(n,e,t){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=120,r[i++]=0),t([n.source,n.flags])}},{pack(n,e){this.moreTypes?Ex(n,16,e):Mx(Pc?Buffer.from(n):new Uint8Array(n),e)}},{pack(n,e){let t=n.constructor;t!==$P&&this.moreTypes?Ex(n,VP.indexOf(t.name),e):Mx(n,e)}},{pack(n,e){this.moreTypes?Ex(n,17,e):Mx(Pc?Buffer.from(n):new Uint8Array(n),e)}},{pack(n,e){let{target:t,position:r}=e(1);t[r]=193}}];function Ex(n,e,t,r){let i=n.byteLength;if(i+1<256){var{target:s,position:o}=t(4+i);s[o++]=199,s[o++]=i+1}else if(i+1<65536){var{target:s,position:o}=t(5+i);s[o++]=200,s[o++]=i+1>>8,s[o++]=i+1&255}else{var{target:s,position:o,targetView:c}=t(7+i);s[o++]=201,c.setUint32(o,i+1),o+=4}s[o++]=116,s[o++]=e,n.buffer||(n=new Uint8Array(n)),s.set(new Uint8Array(n.buffer,n.byteOffset,n.byteLength),o)}function Mx(n,e){let t=n.byteLength;var r,i;if(t<256){var{target:r,position:i}=e(t+2);r[i++]=196,r[i++]=t}else if(t<65536){var{target:r,position:i}=e(t+3);r[i++]=197,r[i++]=t>>8,r[i++]=t&255}else{var{target:r,position:i,targetView:s}=e(t+5);r[i++]=198,s.setUint32(i,t),i+=4}r.set(n,i)}function bM(n,e,t,r){let i=n.length;switch(i){case 1:e[t++]=212;break;case 2:e[t++]=213;break;case 4:e[t++]=214;break;case 8:e[t++]=215;break;case 16:e[t++]=216;break;default:i<256?(e[t++]=199,e[t++]=i):i<65536?(e[t++]=200,e[t++]=i>>8,e[t++]=i&255):(e[t++]=201,e[t++]=i>>24,e[t++]=i>>16&255,e[t++]=i>>8&255,e[t++]=i&255)}return e[t++]=r,e.set(n,t),t+=i,t}function qne(n,e){let t,r=e.length*6,i=n.length-r;for(;t=e.pop();){let s=t.offset,o=t.id;n.copyWithin(s+r,s,i),r-=6;let c=s+r;n[c++]=214,n[c++]=105,n[c++]=o>>24,n[c++]=o>>16&255,n[c++]=o>>8&255,n[c++]=o&255,i=s}return n}function xM(n,e,t){if(wn.length>0){Zt.setUint32(wn.position+n,re+t-wn.position-n),wn.stringsPosition=re-n;let r=wn;wn=null,e(r[0]),e(r[1])}}function Zne(n,e){return n.isCompatible=t=>{let r=!t||(e.lastNamedStructuresLength||0)===t.length;return r||e._mergeStructures(t),r},n}let qP=new $ne({useRecords:!1});const Xne=qP.pack;qP.pack;const Kne=512,Qne=1024,Jne=2048;var as=(n=>(n[n.Slow=2]="Slow",n[n.Normal=1]="Normal",n[n.Fast=.5]="Fast",n[n.Fastest=0]="Fastest",n))(as||{});class ere{constructor(e,t,r,i){this.config=e,this.onConnect=t,this.onMessage=r,this.eventBus=i,this.turns=[],this.replayTurns=[],this.pendingIntents=[],this.turnCheckInterval=null,this.turnStartTime=0,this.turnsExecuted=0,this.gameStartTime=0,this.isPaused=!1,this.speedMultiplier=1,this.winner=null,this.allPlayersStats={}}start(){this.setupEventListeners(),this.startTurnProcessor(),this.initializeGame()}pause(){this.isPaused=!0}resume(){this.isPaused=!1}handleMessage(e){switch(e.type){case"join":this.handleJoinMessage(e);break;case"intent":this.handleIntentMessage(e);break;case"hash":this.handleHashMessage(e);break;case"winner":this.handleWinnerMessage(e);break}}markTurnComplete(){this.turnsExecuted++}endGame(){this.cleanup(),!this.config.isReplay&&this.archiveGame().catch(e=>{console.error("[LocalServer] Failed to archive game:",e)})}setupEventListeners(){this.eventBus.on($4,e=>{this.speedMultiplier=e.multiplier}),this.eventBus.on(V2,e=>{e.paused?this.pause():this.resume()})}startTurnProcessor(){this.turnCheckInterval=setInterval(()=>{this.processTurnIfReady()},5)}processTurnIfReady(){if(this.isPaused||this.turnsExecuted!==this.turns.length)return;const e=this.config.serverConfig.turnIntervalMs()*this.speedMultiplier;Date.now()>this.turnStartTime+e&&(this.turnStartTime=Date.now(),this.executeTurn())}executeTurn(){this.isReplayMode()?this.executeReplayTurn():this.executeNormalTurn()}isReplayMode(){return this.replayTurns.length>0}executeReplayTurn(){if(this.turns.length>=this.replayTurns.length){this.endGame();return}const e=this.replayTurns[this.turns.length];this.pendingIntents=e.intents,this.createAndSendTurn()}executeNormalTurn(){this.createAndSendTurn()}createAndSendTurn(){const e={turnNumber:this.turns.length,intents:[...this.pendingIntents]};this.turns.push(e),this.pendingIntents=[],this.onMessage({type:"turn",turn:e})}initializeGame(){this.gameStartTime=Date.now(),this.turnStartTime=Date.now(),this.onConnect(),this.sendPrestartMessage(),this.scheduleStartMessage()}sendPrestartMessage(){this.onMessage({type:"prestart",gameMap:this.config.gameStartInfo.config.gameMap,gameMapSize:this.config.gameStartInfo.config.gameMapSize})}scheduleStartMessage(){setTimeout(()=>{this.onMessage({type:"start",gameStartInfo:this.config.gameStartInfo,turns:[]}),this.turnStartTime=Date.now()},1500)}handleJoinMessage(e){e.type==="join"&&(console.log("[LocalServer] Join message received - resending game state"),this.onMessage({type:"start",gameStartInfo:this.config.gameStartInfo,turns:this.turns}))}handleIntentMessage(e){e.type==="intent"&&(this.config.isReplay||this.isPaused||this.pendingIntents.push(e.intent))}handleHashMessage(e){e.type==="hash"&&(this.config.isReplay?this.verifyReplayHash(e):this.storeHashIfNeeded(e))}verifyReplayHash(e){if(e.type!=="hash")return;const t=this.replayTurns[e.turnNumber]?.hash;if(!t){console.warn(`[LocalServer] No archived hash found for turn ${e.turnNumber}`);return}t!==e.hash&&this.reportDesync(e.turnNumber,e.hash,t)}reportDesync(e,t,r){console.error(`[LocalServer] Desync detected on turn ${e}. Client: ${t}, Server: ${r}`),this.onMessage({type:"desync",turn:e,correctHash:r,clientsWithCorrectHash:0,totalActiveClients:1,yourHash:t})}storeHashIfNeeded(e){if(e.type==="hash"&&e.turnNumber%100===0){const t=this.turns[e.turnNumber];t&&(t.hash=e.hash)}}handleWinnerMessage(e){e.type==="winner"&&(this.winner=e,this.allPlayersStats=e.allPlayersStats)}cleanup(){this.turnCheckInterval&&(clearInterval(this.turnCheckInterval),this.turnCheckInterval=null)}async archiveGame(){const e=this.createGameRecord(),t=mq.safeParse(e);if(!t.success){const i=l4(t.error);console.error("[LocalServer] Invalid game record:",i);return}const r=await this.compressGameRecord(t.data);await this.sendArchiveRequest(r)}createGameRecord(){const t={persistentID:B3(),username:this.config.playerName,clientID:this.config.clientID,stats:this.allPlayersStats[this.config.clientID],cosmetics:this.config.gameStartInfo.players[0]?.cosmetics};return f7(this.config.gameStartInfo.gameID,this.config.gameStartInfo.config,[t],this.turns,this.gameStartTime,Date.now(),this.winner?.winner)}async compressGameRecord(e){const t=JSON.stringify(e,y7),r=new CompressionStream("gzip"),i=r.writable.getWriter(),s=r.readable.getReader();i.write(new TextEncoder().encode(t)),i.close();const o=[];let c=!1;for(;!c;){const{value:u,done:d}=await s.read();c=d,u&&o.push(u)}return this.combineChunks(o)}combineChunks(e){const t=e.reduce((s,o)=>s+o.length,0),r=new Uint8Array(t);let i=0;for(const s of e)r.set(s,i),i+=s.length;return r}async sendArchiveRequest(e){const t=this.config.serverConfig.workerPath(this.config.gameStartInfo.gameID),r=await fetch(`/${t}/api/archive_singleplayer_game`,{method:"POST",headers:{"Content-Type":"application/json","Content-Encoding":"gzip"},body:e,keepalive:!0});if(!r.ok)throw new Error(`Archive request failed: ${r.statusText}`)}}class tre{constructor(e){this.game=e,this.socket=null,this.localServer=null,this.pingInterval=null,this.isLocalConnection=!1,this.onConnectCallback=null,this.onMessageCallback=null}get isLocal(){return this.isLocalConnection||this.game.lobby?.gameConfig?.gameType===qs.Singleplayer||this.game.gameStartInfo?.config.gameType===qs.Singleplayer}get isConnected(){return this.isLocalConnection?this.localServer!==null:this.socket!==null&&this.socket.readyState===WebSocket.OPEN}async connect(e,t){if(this.onConnectCallback=e,this.onMessageCallback=t,this.isConnected){console.log("[Socket] Reusing existing connection"),this.onConnectCallback&&this.onConnectCallback();return}this.close(),this.isLocalConnection=this.isLocal,this.isLocalConnection?await this.establishLocalConnection():await this.establishRemoteConnection()}send(e){this.isLocal?this.sendToLocalServer(e):this.sendToRemoteServer(e)}notifyTurnComplete(){this.isLocal&&this.localServer&&this.localServer.markTurnComplete()}close(){this.stopPing(),this.isLocal?this.closeLocalConnection():this.closeRemoteConnection()}async establishLocalConnection(){if(!this.game.gameStartInfo){console.error("[Socket] Cannot establish local connection: gameStartInfo missing");return}const e=await this.createLocalServerConfig();this.localServer=new ere(e,()=>this.onConnectCallback?.(),t=>this.onMessageCallback?.(t),ae),this.setupLocalEventHandlers(),this.localServer.start()}async createLocalServerConfig(){const e=await this.game.loadServerConfig(),t=et.getUsername()||"Player";return{gameID:this.game.lobby.gameID,clientID:this.game.clientID,serverConfig:e,gameStartInfo:this.game.gameStartInfo,playerName:t,isReplay:!1}}setupLocalEventHandlers(){ae.on(V2,e=>{this.isLocal&&this.localServer&&(e.paused?this.localServer.pause():this.localServer.resume())})}async establishRemoteConnection(){this.startPing();const e=await this.game.loadServerConfig(),t=this.buildWebSocketURL(e);console.log("[Socket] Connecting to remote server:",t),this.socket=new WebSocket(t),this.socket.binaryType="arraybuffer",this.setupWebSocketHandlers()}buildWebSocketURL(e){const t=window.location.host,r=window.location.protocol==="https:"?"wss:":"ws:",i=e.workerPath(this.game.lobby.gameID);return`${r}//${t}/${i}`}setupWebSocketHandlers(){this.socket&&(this.socket.onopen=()=>{console.log("[Socket] Connected to remote server"),this.onConnectCallback?.()},this.socket.onmessage=e=>{this.handleWebSocketMessage(e,t=>this.onMessageCallback?.(t))},this.socket.onerror=e=>{console.error("[Socket] WebSocket error:",e),this.socket?.close()},this.socket.onclose=e=>{this.handleWebSocketClose(e)})}handleWebSocketMessage(e,t){const r=new Uint8Array(e.data),i=Gne(r);i&&typeof i=="object"&&("message"in i&&i.message instanceof Uint8Array&&(i.message=new TextDecoder().decode(i.message)),"error"in i&&i.error instanceof Uint8Array&&(i.error=new TextDecoder().decode(i.error)));const s=_q.safeParse(i);if(!s.success){console.error("[Socket] Failed to parse server message:",s.error);return}t(s.data)}handleWebSocketClose(e){if(console.log(`[Socket] WebSocket closed: code=${e.code}, reason=${e.reason}`),e.code===1002){console.error("[Socket] Connection refused by server");const t=e.reason||`Error code: ${e.code}`;ae.emit(new f1("Connection refused by server",t))}else e.code!==1e3&&this.attemptReconnection()}attemptReconnection(){this.isLocal||!this.onConnectCallback||!this.onMessageCallback||(console.log("[Socket] Attempting to reconnect..."),this.connect(this.onConnectCallback,this.onMessageCallback))}sendToLocalServer(e){if(!this.localServer){console.error("[Socket] Local server not initialized");return}this.localServer.handleMessage(e)}sendToRemoteServer(e){if(!this.socket){console.error("[Socket] WebSocket not connected");return}if(this.socket.readyState!==WebSocket.OPEN){console.error(`[Socket] WebSocket not open, readyState: ${this.socket.readyState}`);return}const t=Xne(e);this.socket.send(t)}closeLocalConnection(){this.localServer&&(this.localServer.endGame(),this.localServer=null)}closeRemoteConnection(){this.socket&&(this.socket.onmessage=null,this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.readyState===WebSocket.OPEN&&this.socket.close(),this.socket=null)}startPing(){this.stopPing(),this.pingInterval=setInterval(()=>{this.send({type:"ping"})},5e3)}stopPing(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=null)}}const Wr=class Wr{constructor(e,t,r){this.game=e,this.canvas=t,this.eventBus=r,this.keybinds={},this.lastPointerPosition={x:0,y:0},this.lastPointerDownPosition={x:0,y:0},this.lastMiddleMousePosition=null,this.lastPinchDistance=0,this.pointers=new Map,this.activeKeys=new Set,this.pointerDown=!1,this.alternateView=!1,this.middleMouseDown=!1,this.moveAnimationFrame=null,this.middleMouseHoldTimeout=null,this.middleMouseRepeatInterval=null,this.middleMouseMacroFrequencyMs=0}initialize(){this.keybinds=jo.getKeybinds(),mz&&(this.keybinds.modifierKey="MetaLeft"),this.setupEventListeners(),this.startMovementInterval()}setupEventListeners(){this.canvas.addEventListener("pointerdown",this.handlePointerDown.bind(this)),this.canvas.addEventListener("contextmenu",this.handleContextMenu.bind(this)),this.canvas.addEventListener("wheel",this.handleScroll.bind(this),{passive:!1}),window.addEventListener("pointerup",this.handlePointerUp.bind(this)),window.addEventListener("pointermove",this.handlePointerMove.bind(this)),window.addEventListener("mousemove",e=>{(e.movementX||e.movementY)&&(this.eventBus.emit(new id(e.clientX,e.clientY)),this.lastMousePosition={x:e.clientX,y:e.clientY}),this.middleMouseDown&&(this.lastMiddleMousePosition={x:e.clientX,y:e.clientY})}),window.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("keyup",this.handleKeyUp.bind(this)),this.pointers.clear()}startMovementInterval(){const e=()=>{this.processContinuousInput(),this.moveAnimationFrame=requestAnimationFrame(e)};this.moveAnimationFrame=requestAnimationFrame(e)}processContinuousInput(){if(this.isShiftKeyActive())return;const e=this.calculateMovementDelta();(e.x!==0||e.y!==0)&&this.eventBus.emit(new Ip(e.x,e.y)),this.processZoomInput()}isShiftKeyActive(){return this.activeKeys.has("ShiftLeft")||this.activeKeys.has("ShiftRight")}calculateMovementDelta(){let e=0,t=0;return(this.activeKeys.has(this.keybinds.moveUp)||this.activeKeys.has("ArrowUp"))&&(t+=Wr.PAN_SPEED),(this.activeKeys.has(this.keybinds.moveDown)||this.activeKeys.has("ArrowDown"))&&(t-=Wr.PAN_SPEED),(this.activeKeys.has(this.keybinds.moveLeft)||this.activeKeys.has("ArrowLeft"))&&(e+=Wr.PAN_SPEED),(this.activeKeys.has(this.keybinds.moveRight)||this.activeKeys.has("ArrowRight"))&&(e-=Wr.PAN_SPEED),{x:e,y:t}}processZoomInput(){const e=window.innerWidth/2,t=window.innerHeight/2;(this.activeKeys.has(this.keybinds.zoomOut)||this.activeKeys.has("Minus"))&&this.eventBus.emit(new No(e,t,Wr.ZOOM_SPEED)),(this.activeKeys.has(this.keybinds.zoomIn)||this.activeKeys.has("Equal"))&&this.eventBus.emit(new No(e,t,-Wr.ZOOM_SPEED))}
handleKeyDown(e) {
    // Toggle view
    if (e.code === this.keybinds.toggleView) {
        e.preventDefault();

        if (!this.alternateView) {
            this.alternateView = true;
            this.eventBus.emit(new sd(true));
        }
    }

    // Escape key
    if (e.code === "Escape") {
        e.preventDefault();
        if (window.keepghost) showToast("Spam Mode Deactivated.");
        window.keepghost = false;
        window.spam = false;
        this.eventBus.emit(new ZH());
        this.game.placementUnit = null;
    }

    if (e.code === "KeyQ"){ // spam
    	e.preventDefault();
    	window.spam = true;
    } else if (e.code === "KeyW"){ // single
    	e.preventDefault();
    } else if (e.code === "KeyE"){ // activate
    	e.preventDefault();
    	window.keepghost = true;
    	//console.log("1337: Spamming mode activated.");
    } else if (this.isMovementOrModifierKey(e.code)) {
        this.activeKeys.add(e.code);
    }
}
isMovementOrModifierKey(e){return[this.keybinds.moveUp,this.keybinds.moveDown,this.keybinds.moveLeft,this.keybinds.moveRight,this.keybinds.zoomOut,this.keybinds.zoomIn,"ArrowUp","ArrowLeft","ArrowDown","ArrowRight","Minus","Equal",this.keybinds.attackRatioDecrease,this.keybinds.attackRatioIncrease,this.keybinds.centerCamera,"ControlLeft","ControlRight","ShiftLeft","ShiftRight"].includes(e)}handleKeyUp(e){this.handleToggleViewKeyUp(e),this.handleActionKeyUp(e),this.handleBuildKeyUp(e),this.handlePerformanceOverlayToggle(e),this.activeKeys.delete(e.code)}handleToggleViewKeyUp(e){e.code===this.keybinds.toggleView&&(e.preventDefault(),this.alternateView=!1,this.eventBus.emit(new sd(!1)))}handleActionKeyUp(e){switch(e.code){case this.keybinds.boatAttack:e.preventDefault(),this.eventBus.emit(new W2);return;case this.keybinds.groundAttack:e.preventDefault(),this.eventBus.emit(new X4);return;case this.keybinds.attackRatioDecrease:e.preventDefault(),this.eventBus.emit(new Oh(-10));return;case this.keybinds.attackRatioIncrease:e.preventDefault(),this.eventBus.emit(new Oh(10));return;case this.keybinds.centerCamera:e.preventDefault(),this.eventBus.emit(new K4);break;
case "KeyQ":
	console.log("1337: spamming over!");
	window.spam = false;
	break
case "KeyW":
	window.executePlacement(window.obj_placement?._cursorLoc);
	console.log("1337: single shot sent!");
	break
}}handleBuildKeyUp(e){const r={[this.keybinds.buildCity]:$.City,[this.keybinds.buildFactory]:$.Factory,[this.keybinds.buildPort]:$.Port,[this.keybinds.buildDefensePost]:$.DefensePost,[this.keybinds.buildMissileSilo]:$.MissileSilo,[this.keybinds.buildSAMLauncher]:$.SAMLauncher,[this.keybinds.buildAtomBomb]:$.AtomBomb,[this.keybinds.buildHydrogenBomb]:$.HydrogenBomb,[this.keybinds.buildWarship]:$.Warship,[this.keybinds.buildMIRV]:$.MIRV}[e.code];r&&(e.preventDefault(),this.game.placementUnit=r)}handlePerformanceOverlayToggle(e){e.code==="KeyD"&&e.shiftKey&&(e.preventDefault(),this.eventBus.emit(new ad))}handlePointerDown(e){if(e.button===1){e.preventDefault(),this.startMiddleMouseMacro(e);return}e.button>0||(e.pointerType==="touch"&&e.preventDefault(),this.pointerDown=!0,this.pointers.set(e.pointerId,e),this.pointers.size===1?(this.lastPointerPosition={x:e.clientX,y:e.clientY},this.lastPointerDownPosition={x:e.clientX,y:e.clientY},this.eventBus.emit(new qH(e.clientX,e.clientY))):this.pointers.size===2&&(this.lastPinchDistance=this.calculatePinchDistance()))}handlePointerUp(e){if(e.button===1){e.preventDefault(),this.stopMiddleMouseMacro();return}if(!(e.button>0)){if(this.pointerDown=!1,this.pointers.clear(),this.isModifierKeyActive(e)){this.eventBus.emit(new p1(e.clientX,e.clientY));return}if(this.isAltKeyActive(e)){const t=this.game.getWorldCoordinateFromScreen(e.clientX,e.clientY);if(!t)return;const r=this.game.gameView.ref(t.x,t.y);if(!this.game.gameView.hasOwner(r))return;const i=this.game.gameView.owner(r);if(!i.isPlayer())return;this.eventBus.emit(new Rp(i.id()));return}e.target===this.canvas&&this.handlePointerClick(e)}}handlePointerClick(e){if(Math.abs(e.x-this.lastPointerDownPosition.x)+Math.abs(e.y-this.lastPointerDownPosition.y)<Wr.CLICK_THRESHOLD_PIXELS){if(e.pointerType==="touch"){e.preventDefault(),this.eventBus.emit(new Bo(e.clientX,e.clientY));const r=i=>{i.stopPropagation(),i.stopImmediatePropagation(),i.preventDefault()};window.addEventListener("click",r,{capture:!0,once:!0}),setTimeout(()=>{window.removeEventListener("click",r,{capture:!0})},50);return}!Re.leftClickOpensMenu()||e.shiftKey?this.eventBus.emit(new Td(e.x,e.y)):this.eventBus.emit(new Bo(e.clientX,e.clientY))}}handlePointerMove(e){if(e.button===1||this.middleMouseDown){this.middleMouseDown&&(this.lastMiddleMousePosition={x:e.clientX,y:e.clientY}),e.preventDefault();return}if(!(e.button>0)){if(this.pointers.set(e.pointerId,e),!this.pointerDown){this.eventBus.emit(new Z4(e.clientX,e.clientY));return}this.pointers.size===1?this.handleSinglePointerDrag(e):this.pointers.size===2&&this.handlePinchZoom()}}handleSinglePointerDrag(e){const t=e.clientX-this.lastPointerPosition.x,r=e.clientY-this.lastPointerPosition.y;this.eventBus.emit(new Ip(t,r)),this.lastPointerPosition={x:e.clientX,y:e.clientY}}handlePinchZoom(){const e=this.calculatePinchDistance(),t=e-this.lastPinchDistance;if(Math.abs(t)>1){const r=this.calculatePinchCenter();this.eventBus.emit(new No(r.x,r.y,-t*2)),this.lastPinchDistance=e}}handleScroll(e){this.handleWheelScroll(e),this.handleShiftWheelScroll(e),e.preventDefault()}handleWheelScroll(e){if(!e.shiftKey){const t=this.activeKeys.has("ControlLeft")||this.activeKeys.has("ControlRight"),r=e.ctrlKey&&!t?10:1;this.eventBus.emit(new No(e.x,e.y,e.deltaY*r))}}handleShiftWheelScroll(e){if(e.shiftKey){const r=(e.deltaY===0?e.deltaX:e.deltaY)>0?-10:10;this.eventBus.emit(new Oh(r))}}handleContextMenu(e){if(e.preventDefault(),this.game.placementUnit!==null){this.game.placementUnit=null;return}this.eventBus.emit(new Bo(e.clientX,e.clientY))}calculatePinchDistance(){const e=Array.from(this.pointers.values()),t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)}calculatePinchCenter(){const e=Array.from(this.pointers.values());return{x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}}setMacroCooldown(e){this.middleMouseMacroFrequencyMs=e}startMiddleMouseMacro(e){this.middleMouseDown=!0,this.lastMiddleMousePosition={x:e.clientX,y:e.clientY},this.eventBus.emit(new tp(e.clientX,e.clientY)),this.middleMouseHoldTimeout=setTimeout(()=>{this.middleMouseDown&&this.lastMiddleMousePosition&&(this.eventBus.emit(new tp(this.lastMiddleMousePosition.x,this.lastMiddleMousePosition.y)),this.middleMouseRepeatInterval=setInterval(()=>{this.middleMouseDown&&this.lastMiddleMousePosition?this.eventBus.emit(new tp(this.lastMiddleMousePosition.x,this.lastMiddleMousePosition.y)):this.stopMiddleMouseMacro()},this.middleMouseMacroFrequencyMs))},Wr.MIDDLE_MOUSE_MACRO_DELAY_MS)}stopMiddleMouseMacro(){this.middleMouseDown=!1,this.middleMouseHoldTimeout!==null&&(clearTimeout(this.middleMouseHoldTimeout),this.middleMouseHoldTimeout=null),this.middleMouseRepeatInterval!==null&&(clearInterval(this.middleMouseRepeatInterval),this.middleMouseRepeatInterval=null),this.lastMiddleMousePosition=null}destroy(){this.moveAnimationFrame!==null&&(cancelAnimationFrame(this.moveAnimationFrame),this.moveAnimationFrame=null),this.stopMiddleMouseMacro(),this.activeKeys.clear()}isModifierKeyActive(e){return this.keybinds.modifierKey==="AltLeft"&&e.altKey||this.keybinds.modifierKey==="ControlLeft"&&e.ctrlKey||this.keybinds.modifierKey==="ShiftLeft"&&e.shiftKey||this.keybinds.modifierKey==="MetaLeft"&&e.metaKey}isAltKeyActive(e){return this.keybinds.altKey==="AltLeft"&&e.altKey||this.keybinds.altKey==="ControlLeft"&&e.ctrlKey||this.keybinds.altKey==="ShiftLeft"&&e.shiftKey||this.keybinds.altKey==="MetaLeft"&&e.metaKey}};Wr.PAN_SPEED=5,Wr.ZOOM_SPEED=10,Wr.MIDDLE_MOUSE_MACRO_DELAY_MS=300,Wr.CLICK_THRESHOLD_PIXELS=10;let c2=Wr;class nre{constructor(){this.isInitialized=!1,this.loadPromise=null,this.enabled=!1}async init({shouldLoad:e}){this.enabled=e,e&&await this.ensureScript()}ensureScript(){return this.isInitialized?Promise.resolve():this.loadPromise?this.loadPromise:(this.loadPromise=new Promise((e,t)=>{const r=document.createElement("script");r.async=!0,r.dataset.cfasync="false",r.src="https://s.nitropay.com/ads-2216.js",r.addEventListener("load",()=>{this.isInitialized=!0,e()}),r.addEventListener("error",()=>{t(new Error("NitroPay SDK load error"))}),document.head.appendChild(r)}),this.loadPromise)}async renderBanner(e,t,...r){if(this.enabled)try{this.showBanner(e),await this.ensureScript(),await window.nitroAds.createAd(e,t,...r)}catch(i){console.warn("NitroPay renderBanner failed",e,i)}}showBanner(e){const t=document.getElementById(e);t&&(t.style.display="block")}hideBanner(e){const t=document.getElementById(e);t&&(t.style.display="none")}}const Xm=new nre;function rre(){try{const n=self.location.hostname;if(n.startsWith("mobile.")||/^mobile\./.test(n))return!0}catch{}return!1}class ire{constructor(){this.isCrazyGames=Rn.isCrazyGames,this.isMobile=rre(),this.initialized=!1,this.refreshTimerId=null,this.nitroCommonOptions={sizes:[["300","600"]],report:{enabled:!0,icon:!0,wording:"Report Ad",position:"top-right"}}}async init(){this.initialized||(Rn.init(),Xm.init({shouldLoad:!this.isMobile&&!this.isCrazyGames}),this.renderBanners(),this.refreshTimerId===null&&(this.refreshTimerId=window.setInterval(()=>{this.refreshBanners()},6e4)),this.initialized=!0)}async renderBanners(){if(console.log("renderBanners"),this.isCrazyGames){Rn.requestResponsiveBanner("cg-banner-left"),Rn.requestResponsiveBanner("cg-banner-right");return}Xm.renderBanner("frontwars-300x600",this.nitroCommonOptions),Xm.renderBanner("frontwars-300x600_2",this.nitroCommonOptions)}async renderIngameBanner(){const e=document.getElementById("game-banner");e&&(e.style.display="flex"),Rn.requestResponsiveBanner("cg-banner-ingame"),Xm.renderBanner("frontwars-728x90",{sizes:[["728","90"]],report:this.nitroCommonOptions.report})}hideIngameBanner(){const e=document.getElementById("game-banner");e&&(e.style.display="none")}async refreshBanners(){if(console.log("refresh banners"),this.isCrazyGames){Rn.requestResponsiveBanner("cg-banner-left"),Rn.requestResponsiveBanner("cg-banner-right"),Rn.requestResponsiveBanner("cg-banner-ingame");return}}updateBannerVisibility(e){const t=document.getElementById("ad-banner-left"),r=document.getElementById("ad-banner-right");if(!t||!r)return;const i=Math.max(document.documentElement.clientWidth,window.innerWidth||0);this.isMobile||i<=760?(t.style.display="none",r.style.display="none"):i<=1040?(t.style.display="none",r.style.display="block"):(t.style.display="block",r.style.display="block")}redirectTo(e){if(this.isCrazyGames){const t=new URL(e,window.location.origin);t.searchParams.set("crazygames","true"),window.location.href=t.toString()}else window.location.href=e}leaveGame(){this.isCrazyGames?(Rn.gameplayStop(),Rn.requestMidGameAd(()=>{this.redirectTo("/")})):this.redirectTo("/")}}const gs=new ire;class sre{constructor(){this.initialized=!1,this.gameStartInfo=null,this.clientID=null,this.map=null,this.mapLoader=new dd("/maps",up),this.mapLoadPromise=null,this.pendingStartTurns=[],this.serverConfig=null,this.ticksSeen=0,this.myPlayer=null,this.attackRatio=Re.attackRatio(),this.sendTroopsRatio=.1,this.sendGoldRatio=.1,this.placementUnit=null,this.pendingTurnsBuffer=[],this.socket=new tre(this),this.events=new GH(this),ae.on(Cc,e=>{this.joinLobby(e.lobby)}),ae.on(D4,e=>{this.leaveLobby(e.lobby)}),this.events.initialize()}joinLobby(e){if(console.log("[Game] Join lobby:",e),this.lobby=e,this.pendingTurnsBuffer=[],e.gameConfig?.gameType===qs.Singleplayer&&e.gameStartInfo)this.gameStartInfo=e.gameStartInfo,this.gameStartInfo&&this.gameStartInfo.players&&this.gameStartInfo.players.length>0?(this.clientID=this.gameStartInfo.players[0].clientID,console.log("[Game] Using clientID from gameStartInfo:",this.clientID)):this.clientID=Pi();else{const i=et.getSession();i&&i.gameID===e.gameID?(this.clientID=i.clientID,console.log("[Game] Restored clientID from session:",this.clientID)):(this.clientID=Pi(),et.setSession(e.gameID,this.clientID))}const t=()=>{this.joinGame()},r=i=>{if(i.type==="prestart"){const s=o=>{ae.emit(new Ta(Math.round(o*.6),"loading_map_data"))};this.mapLoadPromise=this.loadMap(i.gameMap,this.mapLoader,s),console.log("[Game] Pre-start game"),ae.emit(new o1)}i.type==="start"&&(console.log("[Game] Received start message:",i.gameStartInfo),this.gameStartInfo=i.gameStartInfo,i.turns&&(this.pendingStartTurns=i.turns),ae.emit(new nd(i.gameStartInfo))),i.type==="error"&&console.error("[Game] Error",i),i.type==="turn"&&(console.log(`[Game] Buffering turn ${i.turn.turnNumber} while in lobby`),this.pendingTurnsBuffer.push(i))};this.socket.connect(t,r)}joinGame(){const e=et.getFlag(),t=et.getPattern(),r=et.getColorPalette(),i=et.getColor(),s=et.getUsername();this.socket.send({type:"join",gameID:this.lobby.gameID,clientID:this.clientID,lastTurn:this.ticksSeen,token:B3(),username:s,cosmetics:{color:i??void 0,patternName:t??void 0,patternColorPaletteName:r??void 0,flag:e??void 0}})}leaveLobby(e){console.log("[Game] Leave lobby:",e),this.stop()}async loadServerConfig(){return this.serverConfig=await Na(),this.serverConfig}async initialize(e){if(console.log("[Game] Initialize"),!this.gameStartInfo){console.error("[Game] Cannot initialize: gameStartInfo is null");return}ae.emit(new Ta(0,"loading_map_data"));const t=await c$(this.gameStartInfo.config,Re,!1),r=o=>{ae.emit(new Ta(Math.round(o*.6),"loading_map_data"))},i=await this.loadMap(void 0,void 0,r);ae.emit(new Ta(60,"preparing_battlefield")),this.worker=new Iq(this.gameStartInfo,this.clientID),await this.worker.initialize(),this.gameView=new Nq(this.worker,t,i,this.clientID,this.gameStartInfo.gameID,this.gameStartInfo.players),this.initialized=!0,this.renderer=new Dne(this,e),this.inputHandler=new c2(this,e,ae),xc.setBackgroundMusicPlaylist([dp.FRONTWARS,dp.ES_EPIC,dp.ES_END]),xc.startBackgroundMusic(),this.start(e);const s=o=>{ae.emit(new Ta(60+Math.round(o*.3),"initializing_game_engine"))};await this.renderer.initialize(s),ae.emit(new Ta(100,"almost_ready")),ae.emit(new l1),gs.renderIngameBanner()}async loadMap(e,t,r){return this.mapLoadPromise?(this.map=await this.mapLoadPromise,r&&r(100)):this.map=await Pq(e??this.gameStartInfo?.config.gameMap,t??this.mapLoader,r),this.map}async start(e){ae.on(Td,this.handleMouseClick.bind(this)),ae.on(id,this.handleMouseHover.bind(this)),ae.on(tp,this.handleStructureUpgrade.bind(this)),ae.on(W2,this.handleBoatAttack.bind(this)),ae.on(X4,this.handleGroundAttack.bind(this)),ae.on(Np,()=>{ae.emit(new Q4)}),this.inputHandler.initialize(),this.worker.start(s=>{if("errMsg"in s){console.error(s.errMsg);return}this.socket.isLocal&&this.socket.notifyTurnComplete(),s.updates[Wt.Hash].forEach(c=>{ae.emit(new B4(c.tick,c.hash))}),this.gameView.update(s);const o=this.ticksSeen-s.tick>10;(!o||s.tick%10===0)&&ae.emit(new Ot(this)),this.renderer.tick(o),s.updates[Wt.Win].length>0});const t=()=>{this.joinGame()},r=s=>{if(s.type==="start"&&(this.gameStartInfo=s.gameStartInfo,s.turns&&s.turns.length>0)){console.log(`[Game] Fast-forwarding initial turns: ${s.turns.length}`);for(const o of s.turns)if(!(o.turnNumber<this.ticksSeen)){for(;o.turnNumber>this.ticksSeen;)this.worker.sendTurn({turnNumber:this.ticksSeen,intents:[]}),this.ticksSeen++;this.worker.sendTurn(o),this.ticksSeen++}}if(s.type==="desync"&&console.error("[Game] Desync",s),s.type==="error"&&console.error("[Game] Error",s),s.type==="turn"){if(this.ticksSeen!==s.turn.turnNumber)if(console.error(`[Game] Desync: Expected turn ${this.ticksSeen}, got ${s.turn.turnNumber}`),s.turn.turnNumber>this.ticksSeen)for(console.log(`[Game] Fast-forwarding from ${this.ticksSeen} to ${s.turn.turnNumber}`);this.ticksSeen<s.turn.turnNumber;)this.worker.sendTurn({turnNumber:this.ticksSeen,intents:[]}),this.ticksSeen++;else return;this.worker.sendTurn(s.turn),this.ticksSeen++}};if(this.pendingStartTurns.length>0){console.log(`[Game] Processing ${this.pendingStartTurns.length} pending turns from lobby`);for(const s of this.pendingStartTurns)if(!(s.turnNumber<this.ticksSeen)){for(;s.turnNumber>this.ticksSeen;)this.worker.sendTurn({turnNumber:this.ticksSeen,intents:[]}),this.ticksSeen++;this.worker.sendTurn(s),this.ticksSeen++}this.pendingStartTurns=[]}if(this.pendingTurnsBuffer.length>0){console.log(`[Game] Processing ${this.pendingTurnsBuffer.length} buffered turns`);for(const s of this.pendingTurnsBuffer)if(s.type==="turn"){if(s.turn.turnNumber<this.ticksSeen)continue;for(;s.turn.turnNumber>this.ticksSeen;)this.worker.sendTurn({turnNumber:this.ticksSeen,intents:[]}),this.ticksSeen++;this.worker.sendTurn(s.turn),this.ticksSeen++}this.pendingTurnsBuffer=[]}this.socket.connect(t,r),Rn.gameplayStart();const i=this.buildUrlWithSearchParams(`#game=${this.lobby.gameID}`);history.pushState(null,"",i)}buildUrlWithSearchParams(e){const t=new URLSearchParams(window.location.search);Rn.isCrazyGames&&t.set("crazygames","true");const r=t.toString();return window.location.pathname+(r?`?${r}`:"")+e}stop(){xc.stopBackgroundMusic(),this.inputHandler?.destroy(),this.renderer?.stop(),this.worker?.cleanup(),this.socket.close(),Rn.gameplayStop(),gs.hideIngameBanner()}handleMouseHover(){const e=this.getWorldCoordinateFromMouse();if(!e)return;const t=this.getPlayerFromTile(e);this.gameView.setFocusedPlayer(t)}handleMouseClick(e){if(!this.initialized||this.placementUnit!==null)return;const t=this.getWorldCoordinateFromScreen(e.x,e.y);if(!t)return;const r=this.gameView.ref(t.x,t.y);if(this.gameView.inSpawnPhase()){this.handleSpawnPhaseClick(r);return}this.handleCombatPhaseClick(r)}getWorldCoordinateFromMouse(){return!this.inputHandler.lastMousePosition||!this.renderer.camera?null:this.getWorldCoordinateFromScreen(this.inputHandler.lastMousePosition.x,this.inputHandler.lastMousePosition.y)}getWorldCoordinateFromScreen(e,t){const r=this.renderer.camera?.toWorldSpace(e,t);return!r||!this.gameView.isValidCoord(r.x,r.y)?null:r}getPlayerFromTile(e){const t=this.gameView.ref(e.x,e.y);if(this.gameView.isLand(t)){const s=this.gameView.owner(t);return s.isPlayer()?s:null}const r=[$.Warship,$.TradeShip,$.TransportShip],i=this.gameView.nearbyUnits(t,50,r).sort((s,o)=>s.distSquared-o.distSquared);return i.length>0?i[0].unit.owner():null}handleSpawnPhaseClick(e){this.gameView.isLand(e)&&!this.gameView.hasOwner(e)&&ae.emit(new O4(e))}async handleCombatPhaseClick(e){const t=this.getOrResolveMyPlayer();if(!t)return;const r=await t.actions(e);this.myPlayer&&(this.updateFocusedPlayerFromTile(e),this.executeAttackIfPossible(t,r,e))}getOrResolveMyPlayer(){if(this.myPlayer!==null)return this.myPlayer;const e=this.gameView.playerByClientID(this.clientID);return e===null?null:(this.myPlayer=e,this.myPlayer)}updateFocusedPlayerFromTile(e){const t=this.gameView.owner(e),r=t.isPlayer()?t:null;this.gameView.setFocusedPlayer(r)}executeAttackIfPossible(e,t,r){const s=this.gameView.owner(r).id(),o=Math.floor(e.troops()*this.attackRatio);if(t.canAttack){ae.emit(new u1(s,o));return}this.isBoatAttackAvailable(t,r,100)&&this.executeBoatAttack(e,r,s,o)}async executeBoatAttack(e,t,r,i){const s=await e.bestTransportShipSpawn(t);this.myPlayer&&ae.emit(new z4(r,t,i,s===!1?null:s))}isBoatAttackAvailable(e,t,r=0){if(!this.gameView.isLand(t))return!1;const i=e.buildableUnits.find(s=>s.type===$.TransportShip);return!i||i.canBuild===!1?!1:r&&r>0?this.isWithinBoatRange(t,i.canBuild,r):!0}isWithinBoatRange(e,t,r=0){return this.gameView.euclideanDistSquared(e,t)<=r*r}handleStructureUpgrade(e){if(!this.initialized||this.gameView.inSpawnPhase())return;const t=this.getWorldCoordinateFromScreen(e.x,e.y);if(!t)return;const r=this.gameView.ref(t.x,t.y);this.upgradeNearestStructure(r)}async upgradeNearestStructure(e){const t=this.getOrResolveMyPlayer();if(!t)return;const r=await t.actions(e);if(!this.myPlayer)return;let i=null;for(const s of r.buildableUnits){if(s.canUpgrade===!1)continue;const o=this.gameView.unit(s.canUpgrade);if(!o)continue;const c=this.gameView.manhattanDist(e,o.tile());(!i||c<i.distance)&&(i={unitId:s.canUpgrade,unitType:s.type,distance:c})}i&&ae.emit(new U2(i.unitId,i.unitType))}async handleBoatAttack(e){let t=null;if(e?.x!==void 0&&e?.y!==void 0){const i=this.getWorldCoordinateFromScreen(e.x,e.y);i&&(t=this.gameView.ref(i.x,i.y))}else t=this.getCursorTile();if(!t)return;const r=await this.getPlayerActionsForTile(t);if(!(!r||!this.myPlayer)&&this.isBoatAttackAvailable(r,t)){const i=this.getTargetPlayerID(t),s=this.calculateAttackTroops();await this.executeBoatAttack(this.myPlayer,t,i,s)}}async handleGroundAttack(){const e=this.getCursorTile();if(!e)return;const t=await this.getPlayerActionsForTile(e);if(!(!t||!this.myPlayer)&&t.canAttack){const r=this.getTargetPlayerID(e),i=this.calculateAttackTroops();ae.emit(new u1(r,i))}}getCursorTile(){if(!this.initialized||this.gameView.inSpawnPhase())return null;const e=this.getWorldCoordinateFromMouse();return e?this.gameView.ref(e.x,e.y):null}async getPlayerActionsForTile(e){const t=this.getOrResolveMyPlayer();return t?await t.actions(e):null}getTargetPlayerID(e){const t=this.gameView.owner(e);return t.isPlayer()?t.id():null}calculateAttackTroops(){return this.myPlayer?Math.floor(this.myPlayer.troops()*this.attackRatio):0}}const ye=new sre,Mh=40,vM=5,Km=4,are=1e3;function ore(){const{t:n}=xt(),[e,t]=T.useState(!1),[r,i]=T.useState(!1),[s,o]=T.useState([]),[c,u]=T.useState(null),[d,f]=T.useState("owned"),[p,y]=T.useState("desc"),[b,_]=T.useState(0),[w,S]=T.useState(600),A=T.useRef(null),M=T.useRef(0),k=T.useRef(null),E=T.useRef({players:[],myPlayer:null}),U=T.useMemo(()=>{if(!r)return{start:0,end:Km};const Y=Math.max(0,Math.floor(b/Mh)-vM),L=Math.ceil(w/Mh),q=Math.min(s.length,Y+L+vM*2);return{start:Y,end:q}},[b,w,s.length,r]),I=T.useCallback(Y=>{const L=Y.playerViews(),q=Y.myPlayer(),W=Y.numLandTiles()-Y.numTilesWithFallout();if(W===0)return{players:[],myPlayer:null};const N=L.filter(J=>J.isAlive()).map(J=>{const se=J.numTilesOwned()/W*100;return{rank:0,name:J.name(),playerID:J.id(),owned:se,gold:J.gold(),troops:J.troops()}});N.sort((J,se)=>{let O=0;return d==="owned"?O=se.owned-J.owned:d==="gold"?se.gold>J.gold?O=1:se.gold<J.gold?O=-1:O=0:d==="troops"&&(O=se.troops-J.troops),p==="asc"&&(O=-O),O===0&&d!=="owned"&&(O=se.owned-J.owned),O===0&&d!=="troops"&&(O=se.troops-J.troops),O}),N.forEach((J,se)=>{J.rank=se+1});let V=null;return q&&(V=N.find(J=>J.playerID===q.id())||null),{players:N,myPlayer:V}},[d,p]),B=T.useCallback(()=>{const Y=Date.now();if(Y-M.current<are){k.current=requestAnimationFrame(B);return}M.current=Y,(E.current.players.length>0||E.current.myPlayer)&&(o(E.current.players),u(E.current.myPlayer)),k.current=requestAnimationFrame(B)},[]),G=T.useCallback(Y=>{const L=Y.game.gameView;setTimeout(()=>{E.current=I(L)},0)},[I]);T.useEffect(()=>{if(!e){k.current&&(cancelAnimationFrame(k.current),k.current=null);return}return k.current=requestAnimationFrame(B),ae.on(Ot,G),()=>{k.current&&cancelAnimationFrame(k.current),ae.off(Ot,G)}},[e,G,B]),T.useEffect(()=>{if(!A.current||!r)return;const Y=A.current.getBoundingClientRect();S(Y.height||600);const L=new ResizeObserver(q=>{for(const W of q){const N=W.contentRect.height;N>0&&S(N)}});return L.observe(A.current),()=>L.disconnect()},[r]);const R=T.useCallback(Y=>{const L=Y.currentTarget;requestAnimationFrame(()=>{_(L.scrollTop)})},[]),P=T.useCallback(Y=>{if(!ye.gameView)return;const L=ye.gameView.player(Y);ae.emit(new Y2(L))},[]),H=T.useMemo(()=>{if(!r){const W=s.slice(0,Km),N=c&&W.some(J=>J.playerID===c.playerID);let V;return N?V=W:V=s.filter(J=>!c||J.playerID!==c.playerID).slice(0,Km),V.map(J=>g.jsx(bp,{player:J,onClick:P,isHighlighted:!!(c&&J.playerID===c.playerID)},J.playerID))}const Y=s.slice(U.start,U.end),L=U.start*Mh,q=(s.length-U.end)*Mh;return g.jsxs(g.Fragment,{children:[L>0&&g.jsx("tr",{style:{height:L},children:g.jsx("td",{colSpan:5,style:{padding:0,border:0},children:""})},"top-padding"),Y.map(W=>g.jsx(bp,{player:W,onClick:P},W.playerID)),q>0&&g.jsx("tr",{style:{height:q},children:g.jsx("td",{colSpan:5,style:{padding:0,border:0},children:""})},"bottom-padding")]})},[s,c,r,U,P]);return g.jsx("div",{className:"absolute top-4 left-0 z-1 select-none",children:g.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-r-lg shadow-xl transition-all overflow-hidden max-w-[400px]",children:[g.jsx("button",{onClick:()=>{t(!e),e&&i(!1)},className:"w-full flex items-center gap-2 px-2 py-2 hover:bg-gray-800/30 transition-colors cursor-pointer","aria-label":"Toggle Leaderboard",children:g.jsx("img",{src:e?"/images/LeaderboardIconSolidWhite.svg":"/images/LeaderboardIconRegularWhite.svg",alt:"Leaderboard",className:"w-5 h-5"})}),e&&g.jsxs(g.Fragment,{children:[g.jsx("div",{ref:A,className:`relative ${r?"h-[400px] max-h-[calc(100vh-360px)] overflow-y-auto":"overflow-hidden"}`,onScroll:r?R:void 0,children:g.jsxs("table",{className:"w-full table-fixed",children:[g.jsxs("colgroup",{children:[g.jsx("col",{style:{width:"28px"}}),g.jsx("col",{style:{width:"auto"}}),g.jsx("col",{style:{width:"70px"}}),g.jsx("col",{style:{width:"70px"}}),g.jsx("col",{style:{width:"80px"}})]}),g.jsx("thead",{className:"sticky top-0 bg-gray-900 z-10",children:g.jsxs("tr",{className:"border-b border-gray-700",children:[g.jsx("th",{className:"px-4 py-2 text-left text-gray-300 text-sm font-semibold",children:n("leaderboard.rank")}),g.jsx("th",{className:"pl-4 py-2 text-left text-gray-300 text-sm font-semibold",children:n("leaderboard.player")}),g.jsxs("th",{className:"pl-4 py-2 text-left text-gray-300 text-sm font-semibold cursor-pointer hover:text-white transition-colors select-none",onClick:()=>{d==="owned"?y(Y=>Y==="desc"?"asc":"desc"):(f("owned"),y("desc"))},title:"Click to sort",children:[n("leaderboard.owned"),d==="owned"?p==="desc"?"":"":""]}),g.jsxs("th",{className:"pl-4 py-2 text-left text-gray-300 text-sm font-semibold cursor-pointer hover:text-white transition-colors select-none",onClick:()=>{d==="gold"?y(Y=>Y==="desc"?"asc":"desc"):(f("gold"),y("desc"))},title:"Click to sort",children:[n("leaderboard.gold"),d==="gold"?p==="desc"?"":"":""]}),g.jsxs("th",{className:"pl-4 py-2 text-left text-gray-300 text-sm font-semibold cursor-pointer hover:text-white transition-colors select-none",onClick:()=>{d==="troops"?y(Y=>Y==="desc"?"asc":"desc"):(f("troops"),y("desc"))},title:"Click to sort",children:[n("leaderboard.troops"),d==="troops"?p==="desc"?"":"":""]})]})}),g.jsx("tbody",{children:s.length===0?g.jsx("tr",{children:g.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:n("game.leaderboard.no_players_available")})}):H})]})}),!r&&c&&!s.slice(0,Km).some(Y=>Y.playerID===c.playerID)&&g.jsx("div",{className:"overflow-hidden border-t-2 border-gray-700 bg-gray-800/40",children:g.jsxs("table",{className:"w-full table-fixed",children:[g.jsxs("colgroup",{children:[g.jsx("col",{style:{width:"28px"}}),g.jsx("col",{style:{width:"auto"}}),g.jsx("col",{style:{width:"70px"}}),g.jsx("col",{style:{width:"70px"}}),g.jsx("col",{style:{width:"80px"}})]}),g.jsx("tbody",{children:g.jsx(bp,{player:c,onClick:P,isHighlighted:!0})})]})}),g.jsx("button",{onClick:()=>i(!r),className:"w-full px-2 py-1 border-t border-gray-700 hover:bg-gray-800/30 transition-colors cursor-pointer flex items-center justify-center text-white text-xs","aria-label":n(r?"game.leaderboard.hide":"game.leaderboard.show_all"),children:g.jsx("span",{className:"text-base font-bold",children:r?"":"+"})})]})]})})}const bp=T.memo(({player:n,onClick:e,isHighlighted:t=!1})=>{const r=T.useCallback(()=>{e(n.playerID)},[e,n.playerID]),i=t?"font-semibold":"";return g.jsxs("tr",{className:"border-b border-gray-800/50 hover:bg-gray-800/30 transition-colors cursor-pointer",onClick:r,style:{height:Mh},children:[g.jsx("td",{className:`px-4 py-2 text-white text-sm ${i}`,children:n.rank}),g.jsx("td",{className:`pl-4 py-2 text-white text-sm truncate ${i}`,title:n.name,children:n.name}),g.jsxs("td",{className:`pl-4 py-2 text-white text-sm ${i}`,children:[n.owned.toFixed(1),"%"]}),g.jsx("td",{className:`pl-4 py-2 text-white text-sm ${i}`,children:pn(n.gold)}),g.jsx("td",{className:`pl-4 py-2 text-white text-sm ${i}`,children:Hs(n.troops)})]})},(n,e)=>n.player.rank===e.player.rank&&n.player.owned===e.player.owned&&n.player.gold===e.player.gold&&n.player.troops===e.player.troops&&n.isHighlighted===e.isHighlighted);bp.displayName="PlayerRow";function Ca({icon:n,title:e,description:t,checked:r,onChange:i}){const{t:s}=xt();return g.jsxs("button",{onClick:i,className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-800/50 rounded transition-colors text-left group cursor-pointer",children:[g.jsx("img",{src:n,alt:e,className:"w-6 h-6 shrink-0"}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"text-white font-semibold text-base",children:e}),g.jsx("div",{className:"text-gray-400 text-sm",children:t})]}),g.jsx("div",{className:`text-sm font-semibold shrink-0 ${r?"text-green-400":"text-gray-500"}`,children:s(r?"common.on":"common.off")})]})}function _M({icon:n,title:e,value:t,onChange:r}){return g.jsxs("div",{className:"px-4 py-3",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[g.jsx("img",{src:n,alt:e,className:"w-6 h-6 shrink-0"}),g.jsx("div",{className:"text-white font-semibold text-base flex-1",children:e}),g.jsxs("div",{className:"text-white font-semibold text-base shrink-0",children:[Math.round(t*100),"%"]})]}),g.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:t,onChange:i=>r(parseFloat(i.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-teal-400",style:{background:`linear-gradient(to right, rgb(45 212 191) 0%, rgb(45 212 191) ${t*100}%, rgb(55 65 81) ${t*100}%, rgb(55 65 81) 100%)`}})]})}function lre({open:n,onClose:e}){const{t}=xt(),[r,i]=T.useState(Re.backgroundMusicVolume()),[s,o]=T.useState(Re.soundEffectsVolume()),[c,u]=T.useState(Re.territoryPatterns()),[d,f]=T.useState(Re.emojis()),{theme:p,toggleTheme:y}=Dc(),[b,_]=T.useState(Re.fxLayer()),[w,S]=T.useState(Re.structureSprites()),[A,M]=T.useState(Re.anonymousNames()),[k,E]=T.useState(Re.leftClickOpensMenu()),[U,I]=T.useState(Re.performanceOverlay());T.useEffect(()=>{n&&(i(Re.backgroundMusicVolume()),o(Re.soundEffectsVolume()),u(Re.territoryPatterns()),f(Re.emojis()),_(Re.fxLayer()),S(Re.structureSprites()),M(Re.anonymousNames()),E(Re.leftClickOpensMenu()),I(Re.performanceOverlay()))},[n]);const B=ee=>{i(ee),Re.setBackgroundMusicVolume(ee),xc.setBackgroundMusicVolume(ee)},G=ee=>{o(ee),Re.setSoundEffectsVolume(ee),xc.setSoundEffectsVolume(ee)},R=()=>{u(!c),Re.toggleTerritoryPatterns()},P=()=>{f(!d),Re.toggleEmojis()},H=()=>{_(!b),Re.toggleFxLayer()},Y=()=>{S(!w),Re.toggleStructureSprites()},L=()=>{M(!A),Re.toggleRandomName()},q=()=>{E(!k),Re.toggleLeftClickOpenMenu()},W=()=>{I(!U),ae.emit(new ad)},N=()=>t(c?"game_settings.terrain_view_enabled":"game_settings.terrain_view_disabled"),V=()=>t(d?"game_settings.emojis_visible":"game_settings.emojis_hidden"),J=()=>p===yt.Dark?t("game_settings.dark_mode_enabled"):t("game_settings.dark_mode_disabled"),se=()=>t(b?"game_settings.special_effects_enabled":"game_settings.special_effects_disabled"),O=()=>t(w?"game_settings.structure_sprites_enabled":"game_settings.structure_sprites_disabled"),F=()=>t(A?"game_settings.random_names_shown":"game_settings.real_names_shown"),X=()=>t(k?"game_settings.left_click_opens_menu":"game_settings.right_click_opens_menu"),D=()=>t(U?"game_settings.performance_overlay_enabled":"game_settings.performance_overlay_disabled");return g.jsx(vr,{width:"450px",height:"600px",open:n,onClose:e,children:g.jsxs("div",{className:"w-full h-full flex flex-col select-none",children:[g.jsx("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-700 shrink-0",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("img",{src:"/images/SettingIconWhite.svg",alt:"Settings",className:"w-6 h-6"}),g.jsx("h2",{className:"text-xl font-bold text-white",children:t("game_settings.title")})]})}),g.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0 max-h-[calc(90vh-200px)] pr-2 space-y-1",children:[g.jsx(_M,{icon:"/images/music.svg",title:t("game_settings.background_music_volume"),value:r,onChange:B}),g.jsx(_M,{icon:"/images/music.svg",title:t("game_settings.sound_effects_volume"),value:s,onChange:G}),g.jsx(Ca,{icon:"/images/TreeIconWhite.svg",title:t("game_settings.toggle_terrain"),description:N(),checked:c,onChange:R}),g.jsx(Ca,{icon:"/images/EmojiIconWhite.svg",title:t("game_settings.emojis"),description:V(),checked:d,onChange:P}),g.jsx(Ca,{icon:"/images/DarkModeIconWhite.svg",title:t("game_settings.dark_mode"),description:J(),checked:p===yt.Dark,onChange:y}),g.jsx(Ca,{icon:"/images/ExplosionIconWhite.svg",title:t("game_settings.special_effects"),description:se(),checked:b,onChange:H}),g.jsx(Ca,{icon:"/images/CityIconWhite.svg",title:t("game_settings.structure_sprites"),description:O(),checked:w,onChange:Y}),g.jsx(Ca,{icon:"/images/NinjaIconWhite.svg",title:t("game_settings.hidden_names"),description:F(),checked:A,onChange:L}),g.jsx(Ca,{icon:"/images/MouseIconWhite.svg",title:t("game_settings.left_click_menu"),description:X(),checked:k,onChange:q}),g.jsx(Ca,{icon:"/images/SettingIconWhite.svg",title:t("game_settings.performance_overlay"),description:D(),checked:U,onChange:W})]}),g.jsx("div",{className:"border-t border-gray-700 my-4 shrink-0"}),g.jsxs("button",{onClick:()=>{e(),gs.leaveGame()},className:"w-full flex items-center gap-3 p-2 hover:bg-gray-800/50 rounded transition-colors text-left group cursor-pointer",children:[g.jsx("img",{src:"/images/ExitIconWhite.svg",alt:"Exit",className:"w-6 h-6 shrink-0"}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"text-red-400 font-semibold text-base",children:t("game_settings.exit_game")}),g.jsx("div",{className:"text-gray-400 text-sm",children:t("game_settings.return_to_main_menu")})]})]})]})})}function cre(){const{t:n}=xt(),[e,t]=T.useState(!0),[r,i]=T.useState(0),[s,o]=T.useState(!1),[c,u]=T.useState(!1),[d,f]=T.useState(!1),[p,y]=T.useState(as.Normal),[b,_]=T.useState(!1),w=T.useRef(null),S=T.useRef(null),A=T.useRef(-1),M=T.useRef(null),k=T.useCallback(R=>{if(R===0)return"-";const P=Math.floor(R/3600),H=Math.floor(R%3600/60);let L=`${Math.floor(R%60)}s`;return H>0&&(L=`${H}m `+L),P>0&&(L=`${P}h `+L),L},[]);T.useEffect(()=>{const R=P=>{if(!P.game.initialized||!P.game.gameView)return;const H=P.game.gameView;M.current=H;const Y=H.config(),L=Y.gameConfig().gameType===qs.Singleplayer,q=Y.isReplay();if(_(L||q),H.inSpawnPhase()){i(0),A.current=-1;return}if(s)return;const W=H.ticks();W%10===0&&W!==A.current&&(A.current=W,i(N=>N+1))};return ae.on(Ot,R),()=>{ae.off(Ot,R)}},[s]),T.useEffect(()=>{const R=()=>{o(!0)};return ae.on(rd,R),()=>{ae.off(rd,R)}},[]),T.useEffect(()=>{const R=P=>{const H=P.target;w.current&&!w.current.contains(H)&&S.current&&!S.current.contains(H)&&u(!1)};if(c)return document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[c]);const E=R=>{R.stopPropagation(),u(!c)},U=R=>{y(R),ae.emit(new $4(R)),console.log("Game speed changed to:",R,"multiplier:",R)},I=()=>{const R=!e;t(R),ae.emit(new V2(!R)),console.log(R?"Playing":"Paused")},B=()=>{f(!0)},G=()=>{const R=M.current;R&&R.myPlayer()?.isAlive()&&!confirm(n("help_modal.exit_confirmation"))||gs.leaveGame()};return g.jsxs("div",{className:"absolute top-4 right-0 z-1 flex gap-2 select-none",children:[b&&c&&g.jsxs("div",{ref:w,className:"bg-gray-900/50 backdrop-blur-sm rounded-md shadow-xl p-2 flex flex-col gap-2",children:[g.jsx("div",{className:"text-white text-center text-base font-semibold mb-1",children:n("game_control.game_speed")}),g.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[g.jsx("button",{onClick:()=>U(as.Slow),className:`px-3 py-1.5 rounded text-sm font-semibold text-white transition-colors cursor-pointer ${p===as.Slow?"bg-blue-500 hover:bg-blue-600":"bg-gray-800/40 hover:bg-gray-800/70"}`,children:"0.5"}),g.jsx("button",{onClick:()=>U(as.Normal),className:`px-3 py-1.5 rounded text-sm font-semibold text-white transition-colors cursor-pointer ${p===as.Normal?"bg-blue-500 hover:bg-blue-600":"bg-gray-800/50 hover:bg-gray-800/70"}`,children:"1"}),g.jsx("button",{onClick:()=>U(as.Fast),className:`px-3 py-1.5 rounded text-sm font-semibold text-white transition-colors cursor-pointer ${p===as.Fast?"bg-blue-500 hover:bg-blue-600":"bg-gray-800/50 hover:bg-gray-800/70"}`,children:"2"}),g.jsx("button",{onClick:()=>U(as.Fastest),className:`px-3 py-1.5 rounded text-sm font-semibold text-white transition-colors cursor-pointer ${p===as.Fastest?"bg-blue-500 hover:bg-blue-600":"bg-gray-800/50 hover:bg-gray-800/70"}`,children:"Max"})]})]}),g.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-l-md shadow-xl p-2 flex flex-col gap-2",children:[g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[b&&g.jsxs(g.Fragment,{children:[g.jsx("button",{ref:S,onClick:E,className:"w-6 h-6 flex items-center justify-center hover:bg-gray-800/50 rounded transition-colors cursor-pointer","aria-label":"Replay",children:g.jsx("img",{src:c?"/images/ReplaySolidIconWhite.svg":"/images/ReplayRegularIconWhite.svg",alt:"Replay",className:"w-5 h-5"})}),g.jsx("button",{onClick:I,className:"w-6 h-6 flex items-center justify-center hover:bg-gray-800/50 rounded transition-colors cursor-pointer","aria-label":e?"Pause":"Play",children:g.jsx("img",{src:e?"/images/PauseIconWhite.svg":"/images/PlayIconWhite.svg",alt:e?"Pause":"Play",className:"w-6 h-6"})})]}),g.jsx("button",{onClick:B,className:"w-6 h-6 flex items-center justify-center hover:bg-gray-800/50 rounded transition-colors cursor-pointer","aria-label":"Settings",children:g.jsx("img",{src:"/images/SettingIconWhite.svg",alt:"Settings",className:"w-6 h-6"})}),g.jsx("button",{onClick:G,className:"w-6 h-6 flex items-center justify-center hover:bg-gray-800/50 rounded transition-colors cursor-pointer","aria-label":"Exit",children:g.jsx("img",{src:"/images/ExitIconWhite.svg",alt:"Exit",className:"w-6 h-6"})})]}),g.jsx("div",{className:"border border-gray-600 rounded px-3 py-1.5 bg-gray-800/40",children:g.jsx("div",{className:"text-white text-center text-sm font-semibold",children:k(r)})})]}),g.jsx(lre,{open:d,onClose:()=>f(!1)})]})}const ure={"bright-rainbow":4e3,"copper-glow":3e3,"gold-glow":3e3,lava:6e3,neon:3e3,rainbow:4e3,"silver-glow":3e3,water:6200};function ZP(n,e,t=void 0){if(t===void 0){console.warn("No cosmetics provided for flag",n);return}if(!n.startsWith("!"))return;const i=n.slice(1).split("_").map(s=>{const[o,c]=s.split("-");return{layerKey:o,colorKey:c}});e.innerHTML="",e.style.overflow="hidden",e.style.position="relative",e.style.aspectRatio="3/4";for(const{layerKey:s,colorKey:o}of i){const u=`/flags/custom/${t?.flag?.layers[s]?.name??s}.svg`;if(!u)continue;const d=document.createElement("div");d.style.position="absolute",d.style.top="0",d.style.left="0",d.style.width="100%",d.style.height="100%";const f=t?.flag?.color[o]?.color??o;if(!f.startsWith("#")&&!/^([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/.test(f)){const y=ure[f]??5e3,_=performance.now()%y;y||console.warn(`No animation duration for: ${f}`),d.classList.add(`flag-color-${f}`),d.style.animationDelay=`-${_}ms`}else d.style.backgroundColor=f;d.style.maskImage=`url(${u})`,d.style.maskRepeat="no-repeat",d.style.maskPosition="center",d.style.maskSize="contain",d.style.webkitMaskImage=`url(${u})`,d.style.webkitMaskRepeat="no-repeat",d.style.webkitMaskPosition="center",d.style.webkitMaskSize="contain",e.appendChild(d)}}const hre=100,dre=50,fre=10;function mre(n){const e=T.useRef(0),t=T.useCallback(i=>{const s=Date.now();s-e.current<hre||(e.current=s,n(i.x,i.y))},[n]),r=T.useCallback(i=>{n(i.x,i.y)},[n]);T.useEffect(()=>(ae.on(id,t),ae.on(Bo,r),()=>{ae.off(id,t),ae.off(Bo,r)}),[t,r])}function pre(){const n=T.useRef(new Map);return T.useCallback((t,r)=>{const i=ye.gameView;if(!ye.initialized||!i||!ye.renderer?.camera)return null;const s=ye.renderer.camera.toWorldSpace(t,r);if(!i.isValidCoord(s.x,s.y))return null;const o=i.ref(s.x,s.y);if(!o)return null;const c=i.owner(o);if(c?.isPlayer()){const u=c,d=n.current.get(u.smallID());return d||u.profile().then(f=>{n.current.set(u.smallID(),f)}),{type:"player",data:u,profile:d??null}}if(!i.isLand(o)){const u=i.units($.Warship,$.TradeShip,$.TransportShip).filter(d=>Xx(s,d.tile(),i)<dre).sort(pz(s,i));if(u.length>0)return{type:"unit",data:u[0]}}return null},[])}function gre(){const[n,e]=T.useState({target:null,isExpanded:!0}),t=T.useRef(null),r=pre(),i=T.useCallback((s,o)=>{e(c=>({...c,target:r(s,o)}))},[r]);return mre(i),T.useEffect(()=>{if(n.target?.type!=="player")return;const s=()=>e(o=>({...o}));return ae.on(Ot,s),()=>ae.off(Ot,s)},[n.target]),T.useEffect(()=>{const o=(n.target?.type==="player"?n.target.data:null)?.cosmetics.flag,c=t.current;o?.startsWith("!")&&c&&requestAnimationFrame(()=>{t.current&&ZP(o,c,void 0)})},[n.target]),n.target?n.target.type==="player"?g.jsx(yre,{player:n.target.data,profile:n.target.profile,isExpanded:n.isExpanded,onToggleExpand:()=>e(s=>({...s,isExpanded:!s.isExpanded})),flagRef:t}):g.jsx(Sre,{unit:n.target.data}):null}function yre({player:n,profile:e,isExpanded:t,onToggleExpand:r,flagRef:i}){const s=ye.gameView;if(!ye?.initialized||!s)return null;const o=s.myPlayer(),c=T.useMemo(()=>{if(!o)return{isFriendly:!1,isAllied:!1,relation:null,alliance:null};const b=o.isFriendly(n),_=o.isAlliedWith(n),w=n.type()===Xt.FakeHuman&&!_&&e?e.relations[o.smallID()]??$i.Neutral:null,S=_?o.alliances().find(A=>A.other===n.id())??null:null;return{isFriendly:b,isAllied:_,relation:w,alliance:S}},[o,n,e]),u=s.ticks(),d=T.useMemo(()=>{if(!c.alliance)return null;const b=c.alliance.expiresAt-u;return b<=0?"0s":q4(Math.max(0,Math.floor(b/fre)))},[c.alliance,u]),f=T.useMemo(()=>n.outgoingAttacks().reduce((b,_)=>b+_.troops,0),[n,u]),p=n.cosmetics.flag,y=p&&!p.startsWith("!")?`/flags/${p}.svg`:null;return g.jsx("div",{className:"absolute right-0 top-[160px] z-1 select-none",children:g.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-l-lg shadow-xl p-4 min-w-[230px]",children:[g.jsx(bre,{player:n,flagAsset:y,flagRef:i,isFriendly:c.isFriendly,onToggleExpand:r}),t&&g.jsx(xre,{player:n,profile:e,diplomaticStatus:c,allianceTimer:d,attackingTroopsTotal:f})]})})}function bre({player:n,flagAsset:e,flagRef:t,isFriendly:r,onToggleExpand:i}){return g.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-gray-700",children:[(e||n.cosmetics.flag?.startsWith("!"))&&g.jsx("div",{className:"w-10 h-10 flex items-center justify-center rounded overflow-hidden",children:e?g.jsx("img",{src:e,alt:n.name(),className:"w-full h-full object-cover",onError:s=>{s.target.style.display="none"}}):n.cosmetics.flag?.startsWith("!")?g.jsx("div",{ref:t,className:"w-full h-full",style:{aspectRatio:"3/4"}}):null}),g.jsx("button",{onClick:i,className:`font-semibold text-lg text-left ${r?"text-green-500":"text-white"}`,children:n.name()})]})}function xre({player:n,profile:e,diplomaticStatus:t,allianceTimer:r,attackingTroopsTotal:i}){const{t:s}=xt();if(!ye.gameView)return null;const c=T.useMemo(()=>kre(n.type(),s),[n,s]),u=T.useMemo(()=>t.relation??$i.Neutral,[t.relation]),d=T.useMemo(()=>Are(u,s),[u,s]),f=T.useMemo(()=>Cre(u),[u]);return g.jsxs(g.Fragment,{children:[n.team()!==null&&g.jsxs("div",{className:"text-gray-300 text-sm mb-2",children:[s("player_info_overlay.team",{defaultValue:"Team"}),": ",n.team()]}),g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("span",{className:"text-gray-300 text-sm",children:c}),g.jsxs("div",{className:"flex items-center gap-2",children:[t.isAllied&&g.jsxs(g.Fragment,{children:[g.jsx("img",{src:"/images/AllianceIcon.svg",alt:"Alliance",className:"w-4 h-4"}),g.jsx("span",{className:"text-sm font-semibold text-white",children:r})]}),!t.isAllied&&g.jsx("span",{className:`text-sm font-semibold ${f}`,children:d})]})]}),n.troops()>=1&&g.jsx(wM,{label:s("player_info_overlay.troops"),value:Hs(n.troops())}),i>=1&&g.jsx(wM,{label:s("player_info_overlay.attacking_troops",{defaultValue:"Attacking Troops"}),value:Hs(i),valueClassName:"text-red-400"}),g.jsxs("div",{className:"border-2 border-yellow-500 rounded px-3 py-2 mb-4 bg-gray-800/40 flex items-center gap-2",children:[g.jsx("img",{src:"/images/GoldCoinIcon.svg",alt:"Gold",className:"w-5 h-5"}),g.jsx("span",{className:"text-yellow-500 font-semibold text-base",children:pn(n.gold())})]}),g.jsx(_re,{player:n})]})}function wM({label:n,value:e,valueClassName:t="text-white"}){return g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("span",{className:"text-gray-300 text-sm",children:n}),g.jsx("span",{className:`text-sm font-semibold ${t}`,children:e})]})}const vre=[{type:$.City,icon:"/images/CityIconWhite.svg",translationKey:"city"},{type:$.Factory,icon:"/images/FactoryIconWhite.svg",translationKey:"factory"},{type:$.Port,icon:"/images/PortIcon.svg",translationKey:"port"},{type:$.MissileSilo,icon:"/images/MissileSiloIconWhite.svg",translationKey:"missile_silo"},{type:$.SAMLauncher,icon:"/images/SamLauncherIconWhite.svg",translationKey:"sam_launcher"},{type:$.Warship,icon:"/images/BattleshipIconWhite.svg",translationKey:"warship"}];function _re({player:n}){const{t:e}=xt(),t=ye.gameView;return t?g.jsx("div",{className:"grid grid-cols-2 gap-2",children:vre.filter(r=>!t.config().isUnitDisabled(r.type)).map(r=>g.jsx(wre,{icon:r.icon,label:e(`infrastructure.${r.translationKey}`),count:n.totalUnitLevels(r.type)},r.type))}):null}function wre({icon:n,label:e,count:t}){return g.jsxs("div",{className:"bg-gray-800/50 rounded p-2 flex items-center gap-2",children:[g.jsx("img",{src:n,alt:e,className:"w-5 h-5"}),g.jsx("span",{className:"text-white text-sm font-semibold",children:t})]})}function Sre({unit:n}){const e=ye.gameView;if(!ye?.initialized||!e)return null;const t=e.myPlayer(),r=t?n.owner()===t||t.isFriendly(n.owner()):!1;return g.jsx("div",{className:"absolute right-0 top-1/3 -translate-y-1/2 z-1 select-none",children:g.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-l-lg shadow-xl p-4 min-w-[230px]",children:[g.jsx("div",{className:`font-semibold text-lg mb-2 ${r?"text-green-500":"text-white"}`,children:n.owner().name()}),g.jsx("div",{className:"text-gray-300 text-sm mb-1",children:n.type()}),n.hasHealth()&&g.jsxs("div",{className:"text-gray-300 text-sm",children:["Health: ",n.health()]})]})})}function Are(n,e){return{[$i.Hostile]:e("relation.hostile"),[$i.Distrustful]:e("relation.distrustful"),[$i.Neutral]:e("relation.neutral"),[$i.Friendly]:e("relation.friendly")}[n]??e("relation.neutral")}function Cre(n){return{[$i.Hostile]:"text-red-500",[$i.Distrustful]:"text-red-300",[$i.Neutral]:"text-white",[$i.Friendly]:"text-green-500"}[n]??"text-white"}function kre(n,e){return{[Xt.Bot]:e("player_type.bot"),[Xt.Human]:e("player_type.player"),[Xt.FakeHuman]:e("player_type.nation")}[n]??e("player_type.player")}class Tre{constructor(){this.events=[],this.alliancesCheckedAt=new Map,this.eventIdCounter=0,this.latestGoldAmount=null}processGameTick(e){const t=e.myPlayer();if(!t||!t.isAlive())return{events:[],incomingAttacks:[],outgoingAttacks:[],outgoingLandAttacks:[],outgoingBoats:[],latestGoldAmount:null};const r=e.updatesSinceLastTick();r&&this.processUpdates(r,e,t),this.checkAllianceExpirations(e,t),this.cleanupEvents(e);const i=t.incomingAttacks().filter(u=>{const d=e.playerBySmallID(u.attackerID);return d&&d.type()!==Xt.Bot}).map(u=>({id:u.id,attackerID:u.attackerID,targetID:u.targetID,troops:u.troops,retreating:u.retreating})),s=t.outgoingAttacks().filter(u=>u.targetID!==0).map(u=>({id:u.id,attackerID:u.attackerID,targetID:u.targetID,troops:u.troops,retreating:u.retreating})),o=t.outgoingAttacks().filter(u=>u.targetID===0).map(u=>({id:u.id,attackerID:u.attackerID,targetID:u.targetID,troops:u.troops,retreating:u.retreating})),c=t.units().filter(u=>u.type()===$.TransportShip).map(u=>({id:u.id(),troops:u.troops(),retreating:u.retreating()}));return{events:[...this.events],incomingAttacks:i,outgoingAttacks:s,outgoingLandAttacks:o,outgoingBoats:c,latestGoldAmount:this.latestGoldAmount}}clearGoldAmount(){this.latestGoldAmount=null}processUpdates(e,t,r){e[Wt.DisplayEvent]?.forEach(i=>{this.processDisplayMessageEvent(i,t,r)}),e[Wt.DisplayChatEvent]?.forEach(i=>{this.processDisplayChatEvent(i,t,r)}),e[Wt.AllianceRequest]?.forEach(i=>{this.processAllianceRequest(i,t,r)}),e[Wt.AllianceRequestReply]?.forEach(i=>{this.processAllianceRequestReply(i,t,r)}),e[Wt.BrokeAlliance]?.forEach(i=>{this.processBrokeAlliance(i,t,r)}),e[Wt.AllianceExpired]?.forEach(i=>{this.processAllianceExpired(i,t,r)}),e[Wt.TargetPlayer]?.forEach(i=>{this.processTargetPlayer(i,t,r)}),e[Wt.Emoji]?.forEach(i=>{this.processEmoji(i,t,r)}),e[Wt.UnitIncoming]?.forEach(i=>{this.processUnitIncoming(i,t,r)})}processDisplayMessageEvent(e,t,r){if(e.playerID!==null&&r.smallID()!==e.playerID)return;e.goldAmount!==void 0&&(this.latestGoldAmount=e.goldAmount);const i=e.message;this.addEvent({id:`display-${this.eventIdCounter++}`,message:i,category:$5(e.messageType),timestamp:t.ticks(),priority:1e5,duration:600})}processDisplayChatEvent(e,t,r){if(e.playerID===null||r.smallID()!==e.playerID)return;const i=`quick_chat.phrases.${e.category}.${e.key}`;let s=i;if(e.target)try{const d=t.player(e.target)?.displayName()??e.target;s=`${i}|${d}`}catch(u){console.warn(`Failed to resolve player for target ID '${e.target}'`,u);return}let o="";if(e.recipient!==null){const u=t.player(e.recipient);o=u?u.displayName():""}const c=e.isFrom?`chat.from|${o}|${s}`:`chat.to|${o}|${s}`;this.addEvent({id:`chat-${this.eventIdCounter++}`,message:c,category:tn.CHAT,timestamp:t.ticks(),priority:1e5,duration:600})}processAllianceRequest(e,t,r){if(e.recipientID!==r.smallID())return;const i=t.playerBySmallID(e.requestorID);i&&this.addEvent({id:`alliance-request-${e.requestorID}-${e.createdAt}`,message:`events_display.request_alliance|${i.name()}`,category:tn.ALLIANCE,timestamp:t.ticks(),isAllianceRequest:!0,allianceRequestorID:e.requestorID,allianceRecipientID:e.recipientID,focusID:e.requestorID,priority:1e5,duration:t.config().allianceRequestDuration()-20,shouldDelete:s=>{const o=t.playerBySmallID(e.requestorID),c=t.playerBySmallID(e.recipientID);return o&&c&&o.isAlliedWith(c)}})}processAllianceRequestReply(e,t,r){if(e.request.recipientID===r.smallID()){this.events=this.events.filter(o=>!(o.isAllianceRequest&&o.allianceRequestorID===e.request.requestorID));return}if(e.request.requestorID!==r.smallID())return;const i=t.playerBySmallID(e.request.recipientID);if(!i)return;const s=e.accepted?"events_display.alliance_accepted":"events_display.alliance_rejected";this.addEvent({id:`alliance-reply-${this.eventIdCounter++}`,message:`events_display.alliance_request_status|${i.name()}|${s}`,category:tn.ALLIANCE,timestamp:t.ticks(),focusID:e.request.recipientID,priority:1e5,duration:600})}processBrokeAlliance(e,t,r){const i=t.playerBySmallID(e.betrayedID),s=t.playerBySmallID(e.traitorID);if(!(!i||!s)&&!i.isDisconnected())if(!i.isTraitor()&&s===r){const o=Math.round((1-t.config().traitorDefenseDebuff())*100),c=Math.floor(t.config().traitorDuration()*.1),u=c===1?"events_display.duration_second":`events_display.duration_seconds_plural|${c}`;this.addEvent({id:`betrayal-${this.eventIdCounter++}`,message:`events_display.betrayal_description|${i.name()}|${o}|${u}`,category:tn.ALLIANCE,timestamp:t.ticks(),focusID:e.betrayedID,priority:1e5,duration:600})}else i===r&&this.addEvent({id:`betrayed-${this.eventIdCounter++}`,message:`events_display.betrayed_you|${s.name()}`,category:tn.ALLIANCE,timestamp:t.ticks(),focusID:e.traitorID,priority:1e5,duration:600,needsBetrayalButtons:!0})}processAllianceExpired(e,t,r){const i=e.player1ID===r.smallID()?e.player2ID:e.player2ID===r.smallID()?e.player1ID:null;if(i===null)return;const s=t.playerBySmallID(i);!s||!r.isAlive()||!s.isAlive()||this.addEvent({id:`alliance-expired-${this.eventIdCounter++}`,message:`events_display.alliance_expired|${s.name()}`,category:tn.ALLIANCE,timestamp:t.ticks(),focusID:i,priority:1e5,duration:600})}processTargetPlayer(e,t,r){const i=t.playerBySmallID(e.playerID);if(!r||!r.isFriendly(i))return;const s=t.playerBySmallID(e.targetID);s&&this.addEvent({id:`target-player-${this.eventIdCounter++}`,message:`events_display.attack_request|${i.name()}|${s.name()}`,category:tn.ATTACK,timestamp:t.ticks(),focusID:e.targetID,priority:1e5,duration:600})}processEmoji(e,t,r){const i=e.emoji.recipientID===fs?fs:t.playerBySmallID(e.emoji.recipientID),s=t.playerBySmallID(e.emoji.senderID);if(i===r)this.addEvent({id:`emoji-${this.eventIdCounter++}`,message:`${s.displayName()}: ${e.emoji.message}`,category:tn.CHAT,timestamp:t.ticks(),focusID:e.emoji.senderID,priority:1e5,duration:600});else if(s===r&&i!==fs){const o=i;this.addEvent({id:`emoji-sent-${this.eventIdCounter++}`,message:`events_display.sent_emoji|${o.displayName()}|${e.emoji.message}`,category:tn.CHAT,timestamp:t.ticks(),focusID:o.smallID(),priority:1e5,duration:600})}}processUnitIncoming(e,t,r){r.smallID()===e.playerID&&this.addEvent({id:`unit-incoming-${this.eventIdCounter++}`,message:e.message,category:$5(e.messageType),timestamp:t.ticks(),unitID:e.unitID,priority:1e5,duration:600})}checkAllianceExpirations(e,t){if(t?.isAlive())for(const r of t.alliances()){if(r.expiresAt>e.ticks()+e.config().allianceExtensionPromptOffset()||(this.alliancesCheckedAt.get(r.id)??0)>=e.ticks()-e.config().allianceExtensionPromptOffset())continue;this.alliancesCheckedAt.set(r.id,e.ticks());const i=e.player(r.other);i.isAlive()&&this.addEvent({id:`alliance-expiring-${r.id}`,message:`events_display.about_to_expire|${i.name()}`,category:tn.ALLIANCE,timestamp:e.ticks(),focusID:i.smallID(),priority:0,duration:e.config().allianceExtensionPromptOffset()-30,needsAllianceExpirationButtons:!0})}}cleanupEvents(e){const t=e.ticks();this.events=this.events.filter(r=>t-r.timestamp<(r.duration??600)&&!r.shouldDelete?.(e)),this.events.length>30&&(this.events=this.events.slice(-30))}addEvent(e){this.events.push(e)}removeEvent(e){this.events=this.events.filter(t=>t.id!==e)}clearEvents(){this.events=[]}}function Ere({onFilterChange:n}){const{t:e}=xt(),[t,r]=T.useState(new Set([tn.ATTACK,tn.NUKE,tn.ALLIANCE,tn.TRADE,tn.CHAT])),[i,s]=T.useState(!0),[o,c]=T.useState(!1),[u,d]=T.useState([]),[f,p]=T.useState([]),[y,b]=T.useState([]),[_,w]=T.useState([]),[S,A]=T.useState([]),[M,k]=T.useState(null),[E,U]=T.useState(!1),I=T.useRef(null),B=T.useRef(new Tre),G=T.useRef(null),R=T.useRef(null),P=T.useRef(null),H=T.useCallback(ie=>{if(!ie.game.initialized||!ie.game.gameView)return;const ve=ie.game.gameView,Ce=ve.myPlayer();if(ve.inSpawnPhase()){o&&c(!1);return}if(!Ce||!Ce.isAlive()){o&&c(!1);return}o||c(!0);const Le=B.current.processGameTick(ve);if(d(Le.events),p(Le.incomingAttacks),b(Le.outgoingAttacks),w(Le.outgoingLandAttacks),A(Le.outgoingBoats),Le.latestGoldAmount!==null){const st=R.current!==Le.latestGoldAmount,ft=P.current===Le.latestGoldAmount;st&&!ft&&(R.current=Le.latestGoldAmount,k(Le.latestGoldAmount),G.current&&(clearTimeout(G.current),G.current=null),G.current=setTimeout(()=>{P.current=R.current,k(null),R.current=null,G.current=null},5e3),U(!0),setTimeout(()=>{U(!1)},600))}else R.current!==null&&(P.current=R.current,R.current=null,k(null),G.current&&(clearTimeout(G.current),G.current=null)),P.current=null},[o]);T.useEffect(()=>(ae.on(Ot,H),()=>{ae.off(Ot,H),G.current&&clearTimeout(G.current)}),[H]);const Y=ie=>{switch(ie){case tn.ATTACK:return"text-orange-400";case tn.NUKE:return"text-red-500";case tn.TRADE:return"text-yellow-400";case tn.ALLIANCE:return"text-green-400";case tn.CHAT:return"text-gray-400";default:return"text-cyan-400"}},L=ie=>{const ve=new Set(t);ve.has(ie)?ve.delete(ie):ve.add(ie),r(ve),n?.(ve)},q=ie=>t.has(ie),W=T.useMemo(()=>u.filter(ve=>t.has(ve.category)).sort((ve,Ce)=>{const Le=ve.priority??1e5,st=Ce.priority??1e5;return Le===st?ve.timestamp-Ce.timestamp:Le-st}),[u,t]),N=T.useCallback(ie=>{if(!ie.allianceRequestorID||!ie.allianceRecipientID||!ye.initialized||!ye.gameView||!ye.clientID)return;const Ce=ye.gameView.playerBySmallID(ie.allianceRequestorID),Le=ye.gameView.playerBySmallID(ie.allianceRecipientID);!Ce||!Le||(ae.emit(new h1(Ce.id(),!0)),B.current.removeEvent(ie.id),d(st=>st.filter(ft=>ft.id!==ie.id)))},[]),V=T.useCallback(ie=>{if(!ie.allianceRequestorID||!ie.allianceRecipientID||!ye.initialized||!ye.gameView||!ye.clientID)return;const Ce=ye.gameView.playerBySmallID(ie.allianceRequestorID),Le=ye.gameView.playerBySmallID(ie.allianceRecipientID);!Ce||!Le||(ae.emit(new h1(Ce.id(),!1)),B.current.removeEvent(ie.id),d(st=>st.filter(ft=>ft.id!==ie.id)))},[]),J=T.useCallback(ie=>{if(!ie.focusID||!ye.initialized||!ye.gameView||!ye.clientID)return;const Ce=ye.gameView.playerBySmallID(ie.focusID);Ce&&ae.emit(new F4(Ce.id()))},[]),se=T.useCallback(ie=>{B.current.removeEvent(ie.id),d(ve=>ve.filter(Ce=>Ce.id!==ie.id))},[]),O=T.useCallback(ie=>{if(!ye.initialized||!ye.gameView)return;const ve=ye.gameView.playerBySmallID(ie);ve&&"name"in ve&&ae.emit(new Y2(ve))},[]),F=T.useCallback(ie=>{if(!ye.initialized||!ye.gameView)return;const ve=ye.gameView.unit(ie);ve&&ae.emit(new eN(ve))},[]),X=T.useCallback(async ie=>{if(!ye.initialized||!ye.gameView)return;const ve=ye.gameView.playerBySmallID(ie.attackerID);if(ve&&ve.isPlayer()){const Ce=await ve.attackAveragePosition(ie.attackerID,ie.id);Ce===null?O(ie.attackerID):ae.emit(new J4(Ce.x,Ce.y))}else O(ie.attackerID)},[O]),D=T.useCallback(ie=>{!ye.initialized||!ye.clientID||ae.emit(new L4(ie))},[]),ee=T.useCallback(ie=>{!ye.initialized||!ye.clientID||ae.emit(new U4(ie))},[]);T.useEffect(()=>{i&&I.current&&(I.current.scrollTop=I.current.scrollHeight)},[W,i,f,y,_,S]);const pe=[{category:tn.ATTACK,icon:"/images/SwordIconWhite.svg",label:e("game.events.attacks")},{category:tn.NUKE,icon:"/images/NukeIconWhite.svg",label:e("game.events.nukes")},{category:tn.TRADE,icon:"/images/DonateGoldIconWhite.svg",label:e("game.events.trade")},{category:tn.ALLIANCE,icon:"/images/AllianceIconWhite.svg",label:e("game.events.alliances")},{category:tn.CHAT,icon:"/images/ChatIconWhite.svg",label:e("game.events.chat")}];if(!o)return null;const Se=W.length>0||f.length>0||y.length>0||_.length>0||S.length>0;return g.jsxs("div",{className:"absolute bottom-4 right-4 z-1 select-none",children:[i?g.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-lg shadow-xl overflow-hidden w-[400px] max-h-[250px] flex flex-col",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-700 shrink-0",children:[g.jsx("div",{className:"flex items-center gap-2",children:pe.map(({category:ie,icon:ve,label:Ce})=>g.jsx("button",{onClick:()=>L(ie),className:`p-2 rounded transition-all cursor-pointer ${q(ie)?"bg-gray-700/50 hover:bg-gray-700/70 opacity-100":"bg-transparent hover:bg-gray-800/30 opacity-40"}`,title:Ce,"aria-label":Ce,children:g.jsx("img",{src:ve,alt:Ce,className:"w-5 h-5"})},ie))}),g.jsxs("div",{className:"flex items-center gap-3",children:[M!==null&&g.jsxs("span",{className:`text-green-400 font-semibold transition-all duration-300 ${E?"animate-pulse scale-110":"scale-100"}`,style:{animation:E?"goldBounce 0.6s ease-out":"none"},children:["+",pn(M)]}),g.jsx("button",{onClick:()=>s(!1),className:"text-white text-sm hover:text-gray-300 transition-colors px-2 py-1 cursor-pointer","aria-label":"Hide events",children:e("game.events.hide")})]})]}),g.jsx("div",{ref:I,className:"flex-1 overflow-y-auto min-h-0",children:Se?g.jsxs("div",{className:"px-4 py-2",children:[W.map(ie=>g.jsx("div",{className:`py-2 text-base border-b border-gray-800/50 last:border-b-0 ${Y(ie.category)}`,children:g.jsxs("div",{className:"flex items-start justify-between gap-2",children:[g.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>{ie.focusID?O(ie.focusID):ie.unitID&&F(ie.unitID)},children:[g.jsx("div",{children:j3(ie.message)}),ie.troops!==void 0&&g.jsx("div",{className:"flex items-center gap-1 mt-1 text-xs",children:g.jsxs("span",{children:[e("game.events.your_troops"),": ",ie.troops]})})]}),ie.isAllianceRequest&&g.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[g.jsx("button",{onClick:()=>N(ie),className:"px-2 py-1 bg-green-600 hover:bg-green-700 text-white text-sm rounded transition-colors cursor-pointer",children:e("game.events.accept")}),g.jsx("button",{onClick:()=>V(ie),className:"px-2 py-1 bg-gray-600 hover:bg-gray-700 text-white text-sm rounded transition-colors cursor-pointer",children:e("game.events.ignore")})]}),ie.needsAllianceExpirationButtons&&g.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-1",children:[g.jsx("button",{onClick:()=>J(ie),className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm rounded transition-colors cursor-pointer",children:(()=>{if(ie.focusID&&ye.gameView){const ve=ye.gameView.playerBySmallID(ie.focusID);if(ve&&"name"in ve)return e("game.events.renew_alliance")}return e("game.events.renew_alliance")})()}),g.jsx("button",{onClick:()=>se(ie),className:"px-3 py-1 bg-gray-500 hover:bg-gray-600 text-white text-sm rounded transition-colors cursor-pointer",children:e("game.events.ignore")})]}),ie.needsBetrayalButtons&&g.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:g.jsx("button",{onClick:()=>{ie.focusID&&O(ie.focusID)},className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded transition-colors cursor-pointer",children:e("game.events.focus")})}),ie.buttons&&ie.buttons.length>0&&g.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:ie.buttons.map((ve,Ce)=>g.jsx("button",{onClick:()=>{ve.action(),ve.preventClose||(B.current.removeEvent(ie.id),d(Le=>Le.filter(st=>st.id!==ie.id)))},className:`px-3 py-1 text-white text-sm rounded transition-colors cursor-pointer ${ve.className?.includes("btn-info")?"bg-blue-500 hover:bg-blue-600":ve.className?.includes("btn-gray")?"bg-gray-500 hover:bg-gray-600":"bg-green-600 hover:bg-green-700"}`,children:ve.text},Ce))})]})},ie.id)),f.length>0&&g.jsx("div",{className:"py-2 text-base border-b border-gray-800/50 text-red-400",children:g.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(ie=>{const ve=ye.gameView?.playerBySmallID(ie.attackerID),Ce=ve&&"name"in ve?ve.name():"";return g.jsxs("button",{onClick:()=>X(ie),className:"text-left cursor-pointer hover:underline",children:[Hs(ie.troops)," ",Ce,ie.retreating&&` (${e("game.events.retreating")}...)`]},ie.id)})})}),y.length>0&&g.jsx("div",{className:"py-2 text-base border-b border-gray-800/50 text-blue-400",children:g.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(ie=>{const ve=ye.gameView?.playerBySmallID(ie.targetID),Ce=ve&&"name"in ve?ve.name():"";return g.jsxs("div",{className:"inline-flex items-center gap-1",children:[g.jsxs("button",{onClick:()=>X(ie),className:"text-left cursor-pointer hover:underline",children:[Hs(ie.troops)," ",Ce]}),!ie.retreating&&g.jsx("button",{onClick:()=>D(ie.id),className:"text-red-500 hover:text-red-600 cursor-pointer",title:e("game.events.cancel"),children:""}),ie.retreating&&g.jsxs("span",{className:"text-blue-400 text-sm",children:["(",e("game.events.retreating"),"...)"]})]},ie.id)})})}),_.length>0&&g.jsx("div",{className:"py-2 text-base border-b border-gray-800/50 text-gray-400",children:g.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(ie=>g.jsxs("div",{className:"inline-flex items-center gap-1",children:[g.jsxs("span",{children:[Hs(ie.troops)," ",e("help_modal.ui_wilderness")]}),!ie.retreating&&g.jsx("button",{onClick:()=>D(ie.id),className:"text-red-500 hover:text-red-600 cursor-pointer",title:e("game.events.cancel"),children:""}),ie.retreating&&g.jsxs("span",{className:"text-blue-400 text-sm",children:["(",e("game.events.retreating"),"...)"]})]},ie.id))})}),S.length>0&&g.jsx("div",{className:"py-2 text-base border-b border-gray-800/50 text-blue-400",children:g.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(ie=>g.jsxs("div",{className:"inline-flex items-center gap-1",children:[g.jsxs("button",{onClick:()=>F(ie.id),className:"text-left cursor-pointer hover:underline",children:[e("game.events.boat"),": ",Hs(ie.troops)]}),!ie.retreating&&g.jsx("button",{onClick:()=>ee(ie.id),className:"text-red-500 hover:text-red-600 cursor-pointer",title:e("game.events.cancel"),children:""}),ie.retreating&&g.jsxs("span",{className:"text-blue-400 text-sm",children:["(",e("game.events.retreating"),"...)"]})]},ie.id))})})]}):g.jsx("div",{className:"px-4 py-8 text-center text-gray-400 text-base",children:e("game.events.no_events")})})]}):g.jsx("button",{onClick:()=>s(!0),className:"bg-gray-900/50 backdrop-blur-sm rounded-lg shadow-xl px-4 py-2 text-white text-sm hover:bg-gray-800/50 transition-colors cursor-pointer","aria-label":"Show events",children:e("game.events.title")}),g.jsx("style",{children:`
        @keyframes goldBounce {
          0% { transform: scale(1); }
          30% { transform: scale(1.3); }
          50% { transform: scale(1.1); }
          70% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
      `})]})}function Mre({isMobile:n=!1}){const{t:e}=xt(),[t,r]=T.useState(0),[i,s]=T.useState(0),[o,c]=T.useState(0),[u,d]=T.useState(0),[f,p]=T.useState(!1),[y,b]=T.useState(0),[_,w]=T.useState(Re.attackRatio()*100),[S,A]=T.useState(10),[M,k]=T.useState(10),[E,U]=T.useState(!1),I=T.useRef(_);T.useEffect(()=>{I.current=_},[_]);const B=W=>{W<0&&(W=0),W>100&&(W=100),w(W),ye.attackRatio=W/100},G=()=>{B(_-10)},R=()=>{B(_+10)},P=W=>{const N=parseInt(W.target.value);A(N),ye.sendTroopsRatio=N/100;const V=Math.floor(t*N/100);console.log("Send troops changed to:",N+"% ("+pn(V)+")")},H=W=>{const N=parseInt(W.target.value);k(N),ye.sendGoldRatio=N/100;const V=Math.floor(y*N/100);console.log("Send gold changed to:",N+"% ("+pn(V)+")")},Y=Math.floor(t*_/100),L=Math.floor(t*S/100),q=Math.floor(y*M/100);return T.useEffect(()=>{const W=J=>{const se=I.current+J.attackRatio;B(se)},N=J=>{const se=J.game,{gameView:O}=se,F=O.myPlayer();if(F===null||!F.isAlive()){U(!1);return}const X=O.config().troopIncreaseRate(F);O.ticks()%5===0&&(p(X>=u),d(X)),r(F.troops()/10),s(O.config().maxTroops(F)/10),b(Number(F.gold())),c(X)},V=J=>{U(!0)};return ae.on(Oh,W),ae.on(Ot,N),ae.on(Np,V),()=>{ae.off(Oh,W),ae.off(Ot,N),ae.off(Np,V)}},[]),E?n?g.jsxs("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-10 select-none",children:[g.jsxs("div",{className:"flex flex-col items-center gap-1",children:[g.jsx("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-md shadow-xl px-4 py-1 w-auto inline-flex",children:g.jsxs("span",{className:"text-white text-base font-semibold whitespace-nowrap",children:[e("game.control_panel.gold"),": ",pn(y)]})}),g.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-md shadow-xl p-2 flex items-center gap-3",children:[g.jsx("button",{onClick:G,disabled:_<=0,className:"w-8 h-8 bg-gray-700 active:bg-gray-800 rounded flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed text-white",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-6 h-6",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"})})}),g.jsx("div",{className:"relative flex-1 min-w-[200px]",children:g.jsxs("div",{className:"relative h-8 bg-gray-700 rounded-lg overflow-hidden",children:[g.jsx("div",{className:"absolute left-0 top-0 h-full bg-red-500",style:{width:`${_}%`}}),g.jsx("input",{type:"range",min:"0",max:"100",value:_,onChange:W=>B(parseInt(W.target.value)),className:"absolute inset-0 w-full h-full bg-transparent appearance-none cursor-pointer slider-thumb-hidden z-10"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-20",children:g.jsxs("span",{className:"text-white text-sm font-semibold",children:[pn(t)," / ",pn(i)," (",_.toFixed(0),"%)"]})})]})}),g.jsx("button",{onClick:R,disabled:_>=100,className:"w-8 h-8 bg-gray-700 active:bg-gray-800 rounded flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed text-white",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-6 h-6",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})})]})]}),g.jsx("style",{children:`
          .slider-thumb-hidden::-webkit-slider-thumb {
            appearance: none;
            width: 0;
            height: 0;
            background: transparent;
            border: none;
            cursor: pointer;
          }
          .slider-thumb-hidden::-moz-range-thumb {
            width: 0;
            height: 0;
            background: transparent;
            border: none;
            cursor: pointer;
          }
        `})]}):g.jsx("div",{className:"absolute bottom-4 left-4 z-1 select-none",children:g.jsxs("div",{className:"bg-gray-900/50 backdrop-blur-sm rounded-md shadow-xl p-3 min-w-[280px]",children:[g.jsxs("div",{className:"bg-gray-800/40 rounded px-3 py-2 mb-3",children:[g.jsx("div",{className:"mb-2",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("span",{className:"text-gray-300 text-base",children:[e("game.control_panel.troops"),":"]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsxs("span",{className:"text-white text-base font-semibold",children:[pn(t)," / ",pn(i)]}),g.jsxs("span",{className:`text-base font-semibold ${f?"text-green-500":"text-red-500"}`,children:["(",o>0?"+":"",o.toFixed(0),")"]})]})]})}),g.jsx("div",{children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("span",{className:"text-gray-300 text-base",children:[e("game.control_panel.gold"),":"]}),g.jsx("span",{className:"text-white text-base font-semibold",children:pn(y)})]})})]}),g.jsxs("div",{className:"mb-3",children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsxs("span",{className:"text-gray-300 text-base",children:[e("game.control_panel.attack_ratio"),":"]}),g.jsxs("span",{className:"text-white text-base font-semibold",children:[_.toFixed(0),"% (",pn(Y,1),")"]})]}),g.jsx("div",{className:"relative",children:g.jsxs("div",{className:"relative h-2 bg-gray-700 rounded-lg",children:[g.jsx("div",{className:"absolute left-0 top-0 h-full bg-red-500 rounded-l-lg",style:{width:`${_}%`}}),g.jsx("input",{type:"range",min:"0",max:"100",value:_,onChange:W=>B(parseInt(W.target.value)),className:"absolute inset-0 w-full h-2 bg-transparent appearance-none cursor-pointer slider-thumb-red"})]})})]}),g.jsxs("div",{className:"mb-3",children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsxs("span",{className:"text-gray-300 text-base",children:[e("game.control_panel.send_troops"),":"]}),g.jsxs("span",{className:"text-white text-base font-semibold",children:[S,"% (",pn(L),")"]})]}),g.jsx("div",{className:"relative",children:g.jsxs("div",{className:"relative h-2 bg-gray-700 rounded-lg",children:[g.jsx("div",{className:"absolute left-0 top-0 h-full bg-blue-500 rounded-l-lg",style:{width:`${S}%`}}),g.jsx("input",{type:"range",min:"0",max:"100",value:S,onChange:P,className:"absolute inset-0 w-full h-2 bg-transparent appearance-none cursor-pointer slider-thumb-blue"})]})})]}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsxs("span",{className:"text-gray-300 text-base",children:[e("game.control_panel.send_gold"),":"]}),g.jsxs("span",{className:"text-white text-base font-semibold",children:[M,"% (",pn(q),")"]})]}),g.jsx("div",{className:"relative",children:g.jsxs("div",{className:"relative h-2 bg-gray-700 rounded-lg",children:[g.jsx("div",{className:"absolute left-0 top-0 h-full bg-yellow-500 rounded-l-lg",style:{width:`${M}%`}}),g.jsx("input",{type:"range",min:"0",max:"100",value:M,onChange:H,className:"absolute inset-0 w-full h-2 bg-transparent appearance-none cursor-pointer slider-thumb-yellow"})]})})]}),g.jsx("style",{children:`
          .slider-thumb-red::-webkit-slider-thumb {
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: white;
            border: 2px solid #ef4444;
            cursor: pointer;
            position: relative;
            z-index: 10;
          }
          .slider-thumb-red::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: white;
            border: 2px solid #ef4444;
            cursor: pointer;
            position: relative;
            z-index: 10;
          }
          .slider-thumb-blue::-webkit-slider-thumb {
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: white;
            border: 2px solid #3b82f6;
            cursor: pointer;
            position: relative;
            z-index: 10;
          }
          .slider-thumb-blue::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: white;
            border: 2px solid #3b82f6;
            cursor: pointer;
            position: relative;
            z-index: 10;
          }
          .slider-thumb-yellow::-webkit-slider-thumb {
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: white;
            border: 2px solid #eab308;
            cursor: pointer;
            position: relative;
            z-index: 10;
          }
          .slider-thumb-yellow::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: white;
            border: 2px solid #eab308;
            cursor: pointer;
            position: relative;
            z-index: 10;
          }
        `})]})}):null}const Nre=[{unitType:$.City,iconPath:"/images/CityIconWhite.svg",keybindKey:"buildCity",name:"City"},{unitType:$.Factory,iconPath:"/images/FactoryIconWhite.svg",keybindKey:"buildFactory",name:"Factory"},{unitType:$.Port,iconPath:"/images/PortIcon.svg",keybindKey:"buildPort",name:"Port"},{unitType:$.DefensePost,iconPath:"/images/ShieldIconWhite.svg",keybindKey:"buildDefensePost",name:"Defense Post"},{unitType:$.MissileSilo,iconPath:"/images/MissileSiloIconWhite.svg",keybindKey:"buildMissileSilo",name:"Missile Silo"},{unitType:$.SAMLauncher,iconPath:"/images/SamLauncherIconWhite.svg",keybindKey:"buildSAMLauncher",name:"SAM Launcher"},{unitType:$.Warship,iconPath:"/images/BattleshipIconWhite.svg",keybindKey:"buildWarship",name:"Battleship"},{unitType:$.AtomBomb,iconPath:"/images/NukeIconWhite.svg",keybindKey:"buildAtomBomb",name:"Atom Bomb"},{unitType:$.HydrogenBomb,iconPath:"/images/MushroomCloudIconWhite.svg",keybindKey:"buildHydrogenBomb",name:"Hydrogen Bomb"},{unitType:$.MIRV,iconPath:"/images/MIRVIcon.svg",keybindKey:"buildMIRV",name:"MIRV"}];function SM({config:n,count:e,cost:t,currentGold:r,onBuild:i,canBuild:s,isSelected:o,width:c=48,height:u=48}){const{t:d}=xt(),[f,p]=T.useState(!1),y=T.useRef(null),b=T.useRef(null),_=jo.getKeybinds(),w=n.keybindKey?_[n.keybindKey]:null,S=w?LM(w):null,A=s?"opacity-100":"opacity-50",M=String(n.unitType).replace(/\s+/g,"_").toLowerCase(),k=d(`infrastructure.${M}_desc`),E=d(`infrastructure.${M}`),U=S!==null?`${E} [${S}]`:E,I=()=>{i&&i(n.unitType)},B=()=>{if(p(!0),ye.initialized&&ye.gameView){let R=null;switch(n.unitType){case $.AtomBomb:case $.HydrogenBomb:case $.MIRV:R=[$.MissileSilo,$.SAMLauncher];break;case $.Warship:R=[$.Port];break;default:R=[n.unitType]}ae.emit(new m1(R))}},G=()=>{p(!1),ye.initialized&&ye.gameView&&ae.emit(new m1(null))};return T.useEffect(()=>{if(f&&y.current&&b.current){const R=y.current,H=b.current.getBoundingClientRect(),Y=R.getBoundingClientRect(),L=H.left+H.width/2,q=Y.width,W=20;let N=W;const V=10;L-q/2+W<V?N=V-(L-q/2):L+q/2+W>window.innerWidth-V&&(N=window.innerWidth-V-(L+q/2)),R.style.transform=`translateX(calc(-50% + ${N}px))`}},[f]),g.jsxs("div",{className:"relative",ref:b,children:[g.jsxs("button",{onClick:I,onMouseEnter:B,onMouseLeave:G,className:`
          relative bg-gray-800/90 rounded p-1.5 
          flex items-center justify-center
          hover:bg-gray-700/90 transition-colors
          border border-gray-700/50
          cursor-pointer
          ${o?"bg-slate-400/20":""}
        `,style:{width:`${c}px`,height:`${u}px`},children:[S!==null&&g.jsx("div",{className:`absolute top-0.5 left-1.5 text-white text-xs font-semibold ${A}`,children:S}),g.jsxs("div",{className:`flex items-center justify-center gap-1.5 ${A}`,children:[g.jsx("img",{src:n.iconPath,alt:E,className:"w-7 h-6"}),g.jsx("div",{className:`text-white text-base font-semibold ${A}`,children:e})]})]}),f&&k&&g.jsxs("div",{ref:y,className:"absolute bottom-full left-1/2 mb-2 pointer-events-none z-10000",style:{background:"rgba(17, 24, 39, 0.95)",backdropFilter:"blur(8px)",color:"white",padding:"8px 12px",borderRadius:"8px",fontSize:"13px",width:"max-content",maxWidth:"250px",minWidth:"180px",border:"1px solid rgba(55, 65, 81, 0.5)",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2)"},children:[g.jsx("div",{style:{fontWeight:"600",fontSize:"14px",marginBottom:"4px",color:"#ffffff",textAlign:"center"},children:U}),g.jsx("div",{style:{marginBottom:"4px",color:"#d1d5db"},children:k}),g.jsxs("div",{style:{marginTop:"4px",color:"#fbbf24",fontWeight:"500",textAlign:"center"},children:[pn(t)," ",d("player_info_overlay.gold")]})]})]})}function Ire({customConfigs:n,buttonWidth:e=80,buttonHeight:t=38}){const r=n||Nre,[i,s]=T.useState({}),[o,c]=T.useState(0n),[u,d]=T.useState(null),[f,p]=T.useState(null);T.useEffect(()=>{const k=E=>{if(!E.game.initialized||!E.game.gameView)return;const U=E.game.gameView.myPlayer();if(!U||!U.isAlive()||E.game.gameView.inSpawnPhase())return;c(U.gold());const I={};for(const B of r)I[B.unitType]=U.totalUnitLevels(B.unitType);s(I),p(E.game.placementUnit),U.actions().then(B=>{d(B)})};return ae.on(Ot,k),()=>{ae.off(Ot,k)}},[r]);const y=k=>u?u.buildableUnits.find(U=>U.type===k)?.cost??0n:0n,b=k=>{if(!ye.initialized||!ye.gameView||ye.gameView.config().isUnitDisabled(k))return!1;const U=ye.gameView.myPlayer();if(!U)return!1;const I=y(k);switch(k){case $.AtomBomb:case $.HydrogenBomb:case $.MIRV:return I<=U.gold()&&U.units($.MissileSilo).length>0;case $.Warship:return I<=U.gold()&&U.units($.Port).length>0;default:return I<=U.gold()}},_=k=>{ye.initialized&&(ye.placementUnit===k?(ye.placementUnit=null,p(null)):b(k)&&(ye.placementUnit=k,p(k)))};if(!ye.initialized||!ye.gameView)return null;const w=ye.gameView.myPlayer();if(!w||!w.isAlive()||ye.gameView.inSpawnPhase()||r.every(k=>ye.gameView.config().isUnitDisabled(k.unitType)))return null;const A=r.slice(0,6),M=r.slice(6);return g.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-1 select-none overflow-visible",children:g.jsxs("div",{className:"p-3 overflow-visible",children:[g.jsx("div",{className:"flex flex-wrap justify-center gap-1.5 mb-2 max-w-full",children:A.map(k=>ye.gameView.config().isUnitDisabled(k.unitType)?null:g.jsx(SM,{config:k,count:i[k.unitType]??0,cost:y(k.unitType),currentGold:o,canBuild:b(k.unitType),isSelected:f===k.unitType,onBuild:_,width:e,height:t},k.unitType))}),M.length>0&&g.jsx("div",{className:"flex flex-wrap justify-center gap-1.5 max-w-full",children:M.map(k=>ye.gameView.config().isUnitDisabled(k.unitType)?null:g.jsx(SM,{config:k,count:i[k.unitType]??0,cost:y(k.unitType),currentGold:o,canBuild:b(k.unitType),isSelected:f===k.unitType,onBuild:_,width:e,height:t},k.unitType))})]})})}function Rre(){const[n,e]=T.useState([]),[t,r]=T.useState(null),[i,s]=T.useState("#3c3c3c"),[o,c]=T.useState(null);T.useEffect(()=>{const d=f=>{const p=f.game.gameView,y=f.game;if(r(p),s(p.config().theme().backgroundColor().toRgbString()),y.ticksSeen>p.ticks()+10){c({current:p.ticks(),total:y.ticksSeen});const A=p.ticks()/y.ticksSeen;e([{ratio:A,color:"#00d5be"}]);return}else c(null);if(p.inSpawnPhase()){const A=p.ticks()/p.config().numSpawnPhaseTurns();e([{ratio:A,color:"#00d5be"}]);return}if(e([]),p.config().gameConfig().gameMode!==qn.Team)return;const b=new Map;for(const A of p.players()){const M=A.team();if(M===null)throw new Error("Team is null");const k=b.get(M)??0;b.set(M,k+A.numTilesOwned())}const _=p.config().theme(),w=Pre(b.values());if(w===0)return;const S=[];for(const[A,M]of b){const k=M/w;S.push({ratio:k,color:_.teamColor(A).toRgbString()})}e(S)};return ae.on(Ot,d),()=>{ae.off(Ot,d)}},[]);const u=t&&(t.inSpawnPhase()||t.config().gameConfig().gameMode===qn.Team)||o!==null;return o?g.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"15px",backgroundColor:i,pointerEvents:"none",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",color:"white",fontFamily:t?.config().theme().font(),textShadow:"1px 1px 0px black"},children:[g.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:`${o.current/o.total*100}%`,transition:"width 0.3s ease-out, background-color 0.3s ease-out",backgroundColor:"#0a9ebd",zIndex:-1}}),"Replaying: ",o.current," / ",o.total]}):g.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"10px",backgroundColor:i,pointerEvents:"none",zIndex:100,display:"flex",overflow:"hidden"},children:u&&n.map((d,f)=>g.jsx("div",{style:{width:`${d.ratio*100}%`,backgroundColor:d.color,transition:"width 0.2s ease-out, background-color 0.2s ease-out",height:"100%"}},f))})}function Pre(n){let e=0;for(const t of n)e+=t;return e}const Pt={colors:{build:"rgba(234, 179, 8, 0.8)",building:"rgba(17, 24, 39, 0.95)",boat:"rgba(59, 130, 246, 0.8)",ally:"rgba(34, 197, 94, 0.8)",breakAlly:"rgba(239, 68, 68, 0.8)",delete:"rgba(239, 68, 68, 0.8)",info:"rgba(145, 153, 161, 0.95)",attack:"rgba(239, 68, 68, 0.8)",tooltipCost:"#fbbf24",unavailable:"#ef4444",disabled:"rgba(75, 85, 99, 0.6)"},dims:{baseSize:290,expandedSize:400,centerBtnRadius:55,iconSize:44,innerRadiusLvl0:68,widthLvl0:75,innerRadiusLvl1:90,widthLvl1:85}},Nn={sword:"/images/SwordIconWhite.svg",shield:"/images/ShieldIconWhite.svg",build:"/images/BuildIconWhite.svg",info:"/images/InfoIcon.svg",boat:"/images/BoatIconWhite.svg",alliance:"/images/AllianceIconWhite.svg",x:"/images/XIcon.svg",back:"/images/BackIconWhite.svg",atomBomb:"/images/NukeIconWhite.svg",hydrogenBomb:"/images/MushroomCloudIconWhite.svg",mirv:"/images/MIRVIcon.svg",warship:"/images/BattleshipIconWhite.svg",traitor:"/images/TraitorIconWhite.svg",donateTroop:"/images/DonateTroopIconWhite.svg",donateGold:"/images/DonateGoldIconWhite.svg",city:"/images/CityIconWhite.svg",factory:"/images/FactoryIconWhite.svg",port:"/images/PortIcon.svg",silo:"/images/MissileSiloIconWhite.svg",sam:"/images/SamLauncherIconWhite.svg"},AM=5;function Dre(n,e,t){const[r,i]=T.useState(null),[s,o]=T.useState(0n),[c,u]=T.useState(null);return T.useEffect(()=>{if(!ye.initialized||!ye.gameView||!ye.renderer?.camera){u(null);return}const d=ye.renderer.camera.toWorldSpace(n,e);if(!ye.gameView.isValidCoord(d.x,d.y)){u(null);return}const f=ye.gameView.ref(d.x,d.y),p=ye.gameView.owner(f),y=ye.gameView.myPlayer();if(!y){u(null);return}const b=p.isPlayer()?p:null;u({tile:f,playerID:b?b.id():null,isMyTile:b?.id()===y.id(),isTargetAlive:b?b.isAlive():!1,owner:b})},[n,e]),T.useEffect(()=>{if(!t||!c)return;const d=c.tile,f=()=>{if(!ye.gameView)return;const y=ye.gameView.myPlayer();if(!y||!y.isAlive()||ye.gameView.inSpawnPhase())return;o(y.gold());const b=ye.gameView.owner(d),_=b.isPlayer()?b:null,w=_?.id()===y.id(),S=_?_.isAlive():!1;(w!==c.isMyTile||S!==c.isTargetAlive||_?.id()!==c.playerID)&&u(A=>({...A,tile:d,playerID:_?_.id():null,isMyTile:w,isTargetAlive:S,owner:_})),y.actions(d).then(i).catch(A=>console.error("Actions fetch error:",A))};f();const p=y=>{y.game.initialized&&f()};return ae.on(Ot,p),()=>ae.off(Ot,p)},[t,c?.tile]),{tile:c?.tile??null,playerID:c?.playerID??null,isMyTile:c?.isMyTile??!1,isTargetAlive:c?.isTargetAlive??!1,owner:c?.owner??null,playerActions:r,playerGold:s,myPlayer:ye.gameView?.myPlayer()??null}}function jre(n,e,t){const{t:r}=xt(),{disabledItems:i}=n,{tile:s,myPlayer:o,playerActions:c,isMyTile:u,isTargetAlive:d,playerID:f,owner:p}=e,y=T.useCallback(E=>i?Array.isArray(i)?i.includes(E):i.has(E):!1,[i]),b=T.useCallback(E=>c?.buildableUnits?.find(U=>U.type===E)?.cost||0n,[c]),_=T.useCallback(E=>({...E,disabled:U=>{const I=y(E.id),B=E.disabled?E.disabled(U):!1;return I||B},subMenu:E.subMenu?()=>E.subMenu().map(U=>_(U)):void 0}),[y]),w=T.useCallback(()=>[{type:$.City,id:"build_city",name:"City",icon:Nn.city,title:"city",desc:"increases_max_population",color:Pt.colors.building},{type:$.Factory,id:"build_factory",name:"Factory",icon:Nn.factory,title:"factory",desc:"produces_units",color:Pt.colors.building},{type:$.Port,id:"build_port",name:"Port",icon:Nn.port,title:"port",desc:"allows_naval_units",color:Pt.colors.building},{type:$.DefensePost,id:"build_defense",name:"Defense Post",icon:Nn.shield,title:"defense_post",desc:"increases_defenses",color:Pt.colors.building},{type:$.MissileSilo,id:"build_missile_silo",name:"Missile Silo",icon:Nn.silo,title:"missile_silo",desc:"launches_missiles",color:Pt.colors.building},{type:$.SAMLauncher,id:"build_sam",name:"SAM Launcher",icon:Nn.sam,title:"sam_launcher",desc:"anti_aircraft_defense",color:Pt.colors.building}].map(U=>_({id:U.id,name:U.name,icon:U.icon,color:U.color,disabled:I=>{if(!I.game.gameView||I.game.gameView.config().isUnitDisabled(U.type))return!0;const B=I.playerActions?.buildableUnits?.find(R=>R.type===U.type);return B&&!B.canBuild||b(U.type)>=I.myPlayer.gold()?!0:[$.AtomBomb,$.HydrogenBomb,$.MIRV].includes(U.type)?!(I.myPlayer.units($.MissileSilo).length>0):U.type===$.Warship?!(I.myPlayer.units($.Port).length>0):!1},onClick:I=>{ae.emit(new kc(U.type,I.tile)),I.closeMenu()},tooltip:{title:r(`game.circular_menu.${U.title}`),description:r(`game.circular_menu.${U.desc}`),cost:`${pn(b(U.type))} Gold`}})),[r,b,_]),S=T.useCallback(()=>[{type:$.AtomBomb,id:"attack_atombomb",name:"Atom Bomb",icon:Nn.atomBomb,title:"atom_bomb",desc:"nuclear_weapon"},{type:$.HydrogenBomb,id:"attack_hydrogenbomb",name:"Hydrogen Bomb",icon:Nn.hydrogenBomb,title:"hydrogen_bomb",desc:"thermonuclear_weapon"},{type:$.MIRV,id:"attack_mirv",name:"MIRV",icon:Nn.mirv,title:"mirv",desc:"multiple_independently_targetable_reentry_vehicle"},{type:$.Warship,id:"attack_warship",name:"Warship",icon:Nn.warship,title:"warship",desc:"battleship_unit"}].map(U=>_({id:U.id,name:U.name,icon:U.icon,color:Pt.colors.attack,disabled:I=>!I.game.gameView||I.game.gameView.config().isUnitDisabled(U.type)||b(U.type)>=I.myPlayer.gold()?!0:[$.AtomBomb,$.HydrogenBomb,$.MIRV].includes(U.type)?!(I.myPlayer.units($.MissileSilo).length>0):U.type===$.Warship?!(I.myPlayer.units($.Port).length>0):!1,onClick:I=>{ae.emit(new kc(U.type,I.tile)),I.closeMenu()},tooltip:{title:r(`game.circular_menu.${U.title}`),description:r(`game.circular_menu.${U.desc}`),cost:`${pn(b(U.type))} Gold`}})),[r,b,_]),A=T.useMemo(()=>({id:"boat",name:"boat",icon:Nn.boat,color:Pt.colors.boat,onClick:E=>{ae.emit(new W2(n.x,n.y)),E.closeMenu()},tooltip:{title:r("game.circular_menu.transport_ship"),description:r("game.circular_menu.deploy_transport_ship")}}),[n.x,n.y,r]),M=T.useMemo(()=>({id:"attack",name:"attack",icon:Nn.sword,color:Pt.colors.attack,subMenu:S,tooltip:{title:r("game.circular_menu.attack"),description:r("game.circular_menu.attack_with_units")}}),[S,r]);return T.useMemo(()=>{const E=[];if(E.push(_({id:"info",name:"info",icon:Nn.info,color:Pt.colors.info,onClick:U=>{U.closeMenu();const I=U.game.gameView.owner(U.tile);ae.emit(new g1(I.isPlayer()?I:null,U.tile))},disabled:U=>!U.game.gameView.owner(U.tile).isPlayer(),tooltip:{title:r("game.circular_menu.player_info"),description:r("game.circular_menu.view_player_information")}})),u)E.push(_({id:"build",name:"build",icon:Nn.build,color:Pt.colors.build,disabled:U=>U.game.gameView.inSpawnPhase(),subMenu:w,tooltip:{title:r("game.circular_menu.build"),description:r("game.circular_menu.build_structures")}})),E.push(_({id:"delete",name:"delete",icon:Nn.x,color:Pt.colors.delete,disabled:U=>!U.game.gameView.isLand(U.tile)||!U.myPlayer.canDeleteUnit()?!0:!U.myPlayer.units().some(B=>U.game.gameView.manhattanDist(B.tile(),U.tile)<=AM),onClick:U=>{const I=U.myPlayer.units().filter(B=>U.game.gameView.manhattanDist(B.tile(),U.tile)<=AM);if(I.length>0){const B=I.sort((G,R)=>U.game.gameView.manhattanDist(G.tile(),U.tile)-U.game.gameView.manhattanDist(R.tile(),U.tile))[0];ae.emit(new G4(B.id()))}U.closeMenu()},tooltip:{title:r("game.circular_menu.delete_unit"),description:r("game.circular_menu.delete_selected_unit")}}));else{const U=p&&o?p.isAlliedWith(o):!1,I=p&&o?p.isOnSameTeam(o):!1,B=p?p.isDisconnected():!1,G=I?B:!0;G&&E.push(_({...A,disabled:R=>R.playerActions?!R.playerActions.buildableUnits.some(P=>P.type===$.TransportShip&&P.canBuild):!0})),(U||I)&&E.push(_({id:"donateTroops",name:"donateTroops",icon:Nn.donateTroop,color:Pt.colors.ally,disabled:R=>R.playerActions?.interaction?!R.playerActions.interaction.canDonateTroops:!0,onClick:R=>{f&&ae.emit(new cg(f,Math.floor(R.myPlayer.troops()*ye.sendTroopsRatio))),R.closeMenu()},tooltip:{title:r("game.circular_menu.donate_troops"),description:r("game.circular_menu.send_troops_to_ally")}})),p&&d&&(U?(U||!I)&&E.push(_({id:"breakAlly",name:"breakAlly",icon:Nn.traitor,color:Pt.colors.breakAlly,disabled:R=>R.playerActions?.interaction?!R.playerActions.interaction.canBreakAlliance:!0,onClick:R=>{f&&ae.emit(new G2(f)),R.closeMenu()},tooltip:{title:r("game.circular_menu.break_alliance"),description:r("game.circular_menu.break_alliance_desc")}})):I||E.push(_({id:"ally",name:"ally",icon:Nn.alliance,color:Pt.colors.ally,disabled:R=>R.playerActions?.interaction?!R.playerActions.interaction.canSendAllianceRequest:!0,onClick:R=>{f&&ae.emit(new F2(f)),R.closeMenu()},tooltip:{title:r("game.circular_menu.alliance"),description:r("game.circular_menu.request_alliance")}}))),(U||I)&&E.push(_({id:"donateGold",name:"donateGold",icon:Nn.donateGold,color:Pt.colors.build,disabled:R=>R.playerActions?.interaction?!R.playerActions.interaction.canDonateGold:!0,onClick:R=>{f&&ae.emit(new H2(f,Math.floor(Number(R.myPlayer.gold())*ye.sendGoldRatio))),R.closeMenu()},tooltip:{title:r("game.circular_menu.donate_gold"),description:r("game.circular_menu.send_gold_to_ally")}})),G&&E.push(_({...M,disabled:()=>I?!1:U?!B:!1}))}return E},[u,d,r,f,c,w,S,n.x,n.y,_,p,o,A,M])}const Nh=(n,e,t,r)=>({x:n+t*Math.cos(r),y:e+t*Math.sin(r)}),Bre=(n,e,t,r,i,s)=>{const o=Nh(n,e,r,s),c=Nh(n,e,r,i),u=Nh(n,e,t,s),d=Nh(n,e,t,i),f=s-i<=Math.PI?"0":"1";return["M",o.x,o.y,"A",r,r,0,f,0,c.x,c.y,"L",d.x,d.y,"A",t,t,0,f,1,u.x,u.y,"Z"].join(" ")},Ore=mj.memo(({item:n,index:e,totalItems:t,innerRadius:r,width:i,evaluateDisabled:s,onHover:o,onClick:c})=>{const u=2*Math.PI/t,d=-Math.PI/2-u/2,f=.05,p=e*u+d+f/2,y=(e+1)*u+d-f/2,b=r+i,_=s(n),w=T.useMemo(()=>Bre(0,0,r,b,p,y),[r,b,p,y]),S=p+(y-p)/2,A=Nh(0,0,r+i/2,S);return g.jsxs("g",{className:"menu-slice-group",onClick:M=>{M.stopPropagation(),c(n)},onMouseEnter:M=>o(n,M),onMouseMove:M=>o(n,M),onMouseLeave:M=>o(null,M),style:{cursor:_?"not-allowed":"pointer"},children:[g.jsx("path",{d:w,fill:_?Pt.colors.disabled:n.color,stroke:_?"rgba(107, 114, 128, 0.7)":"rgba(255, 255, 255, 0.5)",strokeWidth:1.5}),n.icon&&g.jsx("image",{href:n.icon,x:A.x-Pt.dims.iconSize/2,y:A.y-Pt.dims.iconSize/2,width:Pt.dims.iconSize,height:Pt.dims.iconSize,style:{opacity:_?.6:1,pointerEvents:"none"}}),n.text&&g.jsx("text",{x:A.x,y:A.y,textAnchor:"middle",dominantBaseline:"central",fill:"white",fontSize:"12px",style:{opacity:_?.6:1,pointerEvents:"none"},children:n.text})]})});function Lre(n){const{t:e}=xt(),{x:t,y:r,onClose:i}=n,[s,o]=T.useState(!0),[c,u]=T.useState([]),[d,f]=T.useState(null),[p,y]=T.useState({x:0,y:0}),b=Dre(t,r,s);T.useEffect(()=>{u([])},[b.isMyTile]);const _=jre(n,b),w=T.useCallback(()=>{o(!1),i?.()},[i]),S=T.useCallback(G=>{if(!b.tile||!b.myPlayer)return!0;const R={game:ye,tile:b.tile,myPlayer:b.myPlayer,playerActions:b.playerActions,closeMenu:w};return G.disabled?G.disabled(R):!1},[b,w]),A=T.useCallback(G=>{if(!S(G)){if(G.subMenu)u(R=>[...R,G.id]);else if(G.onClick){if(!b.tile||!b.myPlayer)return;const R={game:ye,tile:b.tile,myPlayer:b.myPlayer,playerActions:b.playerActions,closeMenu:w};G.onClick(R)}}},[S,b,w]),M=T.useMemo(()=>{const G=[_];let R=_;for(const P of c){const H=R.find(Y=>Y.id===P);if(H&&H.subMenu){const Y=H.subMenu();G.push(Y),R=Y}else break}return G},[_,c]),k=c.length,E=k>0?Pt.dims.expandedSize:Pt.dims.baseSize,U=c.length>0?Nn.back:b.isMyTile?Nn.shield:Nn.sword,I=G=>{G.stopPropagation(),c.length>0?u(R=>R.slice(0,-1)):(b.isMyTile&&b.tile?ae.emit(new kc($.DefensePost,b.tile)):ae.emit(new Td(t,r)),w())},B=T.useCallback((G,R)=>{f(G),G&&y({x:R.pageX,y:R.pageY})},[]);return s?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"fixed pointer-events-auto",style:xo.overlay,onClick:w,onContextMenu:G=>{G.preventDefault(),w()},children:g.jsx("svg",{width:E,height:E,style:{...xo.svg,top:r,left:t},viewBox:`0 0 ${E} ${E}`,onClick:G=>G.stopPropagation(),children:g.jsxs("g",{transform:`translate(${E/2},${E/2})`,children:[g.jsxs("g",{onClick:I,style:{cursor:"pointer"},children:[g.jsx("circle",{r:Pt.dims.centerBtnRadius,fill:"rgba(31, 41, 55, 0.95)",stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:"1.5"}),g.jsx("image",{href:U,width:64,height:64,x:-32,y:-32,style:{pointerEvents:"none"}})]}),M.map((G,R)=>{if(R!==k)return null;const P=R===0?Pt.dims.innerRadiusLvl0:Pt.dims.innerRadiusLvl1,H=R===0?Pt.dims.widthLvl0:Pt.dims.widthLvl1;return g.jsx("g",{children:G.map((Y,L)=>g.jsx(Ore,{item:Y,index:L,totalItems:G.length,innerRadius:P,width:H,evaluateDisabled:S,onHover:B,onClick:A},Y.id))},R)})]})})}),d?.tooltip&&g.jsxs("div",{style:{...xo.tooltip,left:p.x+15,top:p.y+15},children:[d.tooltip.title&&g.jsx("div",{style:xo.tooltipTitle,children:d.tooltip.title}),d.tooltip.description&&g.jsx("div",{style:xo.tooltipDesc,children:d.tooltip.description}),d.tooltip.cost&&g.jsx("div",{style:xo.tooltipCost,children:d.tooltip.cost}),S(d)&&g.jsx("div",{style:xo.tooltipError,children:e("game.circular_menu.unavailable")})]})]}):null}const xo={overlay:{top:0,left:0,width:"100vw",height:"100vh",touchAction:"none",zIndex:9999},svg:{position:"absolute",transform:"translate(-50%, -50%) scale(0.6)",pointerEvents:"all"},tooltip:{position:"fixed",pointerEvents:"none",zIndex:1e4,background:"rgba(17, 24, 39, 0.95)",color:"white",padding:"8px 12px",borderRadius:"8px",border:"1px solid rgba(55, 65, 81, 0.5)",maxWidth:"250px"},tooltipTitle:{fontWeight:600,fontSize:"14px",marginBottom:"4px",color:"#fff"},tooltipDesc:{color:"#d1d5db",fontSize:"13px",marginBottom:"2px"},tooltipCost:{marginTop:"4px",color:Pt.colors.tooltipCost,fontWeight:500,fontSize:"13px"},tooltipError:{marginTop:"4px",color:Pt.colors.unavailable,fontSize:"12px",fontStyle:"italic"}};function zre(){const[n,e]=T.useState(Re.performanceOverlay()),[t,r]=T.useState({x:20,y:20}),[i,s]=T.useState(!1),[o,c]=T.useState({x:0,y:0}),u=T.useRef(null),d=T.useRef(0),f=T.useRef(0),p=T.useRef([]),y=T.useRef([]),b=T.useRef(0),_=T.useRef(0),[w,S]=T.useState(0),[A,M]=T.useState(0),[k,E]=T.useState(0);T.useEffect(()=>{const I=()=>{Re.togglePerformanceOverlay(),e(Re.performanceOverlay())},B=G=>{const R=performance.now();if(d.current===0){d.current=R,f.current=R;return}const P=R-d.current;if(p.current.push(P),p.current.length>30&&p.current.shift(),p.current.length>0){const H=p.current.reduce((Y,L)=>Y+L,0)/p.current.length;S(Math.round(1e3/H)),E(Math.round(H))}if(b.current++,R-f.current>=1e3){if(y.current.push(b.current),y.current.length>30&&y.current.shift(),y.current.length>0){const H=Math.round(y.current.reduce((Y,L)=>Y+L,0)/y.current.length);M(H)}b.current=0,f.current=R}d.current=R,_.current++};return ae.on(ad,I),ae.on(c1,B),()=>{ae.off(ad,I),ae.off(c1,B)}},[]);const U=I=>{if(u.current){const B=u.current.getBoundingClientRect();c({x:I.clientX-B.left,y:I.clientY-B.top}),s(!0)}};return T.useEffect(()=>{const I=G=>{i&&r({x:G.clientX-o.x,y:G.clientY-o.y})},B=()=>{s(!1)};return i&&(document.addEventListener("mousemove",I),document.addEventListener("mouseup",B)),()=>{document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",B)}},[i,o]),n?g.jsx("div",{ref:u,className:"fixed z-10002 select-none",style:{left:`${t.x}px`,top:`${t.y}px`,cursor:i?"grabbing":"grab"},children:g.jsxs("div",{className:"bg-black/70 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-gray-700/50",children:[g.jsx("button",{onClick:I=>{I.stopPropagation(),Re.togglePerformanceOverlay(),e(!1)},className:"absolute top-1 right-1 w-5 h-5 flex items-center justify-center bg-black/50 hover:bg-black/70 rounded transition-colors cursor-pointer",style:{cursor:"pointer"},"aria-label":"Close performance overlay",children:g.jsx("span",{className:"text-white text-xs font-bold",children:""})}),g.jsxs("div",{onMouseDown:I=>{I.stopPropagation(),U(I)},className:"pr-6",style:{cursor:i?"grabbing":"grab"},children:[g.jsxs("div",{className:"text-white text-sm mb-1",children:["FPS: ",g.jsx("span",{className:"text-green-400",children:w})]}),g.jsxs("div",{className:"text-white text-sm mb-1",children:["Avg (30s): ",g.jsx("span",{className:"text-green-400",children:A})]}),g.jsxs("div",{className:"text-white text-sm",children:["Frame: ",g.jsx("span",{className:"text-green-400",children:k}),g.jsx("span",{className:"text-white",children:"ms"})]})]})]})}):null}const Nx=2500,Ure="https://store.steampowered.com/app/4002270/FrontWars/";function Fre(){const{t:n}=xt(),[e,t]=T.useState({isVisible:!1,headingText:"",outcomeType:"spectator",controlsEnabled:!1}),r=T.useRef(!1),i=T.useRef(!1),s=T.useRef(null),o=T.useRef(!1),c=T.useCallback(p=>{const y=p.game;if(!y.initialized||!y.gameView||o.current)return;const b=y.gameView,_=b.myPlayer();!r.current&&_&&!_.isAlive()&&!b.inSpawnPhase()&&_.hasSpawned()&&(r.current=!0,t({isVisible:!0,headingText:n("win_modal.died"),outcomeType:"defeat",controlsEnabled:!1}),s.current=setTimeout(()=>{t(A=>({...A,controlsEnabled:!0}))},Nx));const S=b.updatesSinceLastTick()?.[Wt.Win];S&&S.length>0&&S.forEach(A=>{if(i.current||o.current)return;const M=A.winner;if(M!==void 0)if(i.current=!0,M[0]==="team"){const k=M[1];ae.emit(new rd(M,A.allPlayersStats));const E=k===_?.team(),U=E?n("win_modal.your_team"):Kx(n("win_modal.other_team"),{team:k});t({isVisible:!0,headingText:U,outcomeType:E?"victory":"spectator",controlsEnabled:!1}),s.current=setTimeout(()=>{t(I=>({...I,controlsEnabled:!0}))},Nx)}else{const k=b.playerByClientID(M[1]);if(!k?.isPlayer())return;const E=k.clientID();E!==null&&ae.emit(new rd(["player",E],A.allPlayersStats));const U=E!==null&&E===_?.clientID(),I=U?n("win_modal.you_won"):Kx(n("win_modal.other_won"),{player:k.name()});t({isVisible:!0,headingText:I,outcomeType:U?"victory":"spectator",controlsEnabled:!1}),s.current=setTimeout(()=>{t(B=>({...B,controlsEnabled:!0}))},Nx)}})},[n]);T.useEffect(()=>(ae.on(Ot,c),()=>{ae.off(Ot,c),s.current&&clearTimeout(s.current)}),[c]);const u=T.useCallback(()=>{o.current=!0,t(p=>({...p,isVisible:!1})),s.current&&(clearTimeout(s.current),s.current=null)},[]),d=T.useCallback(()=>{o.current=!0,t(p=>({...p,isVisible:!1})),s.current&&(clearTimeout(s.current),s.current=null),gs.leaveGame()},[]),f=T.useCallback(()=>{o.current=!0,t(p=>({...p,isVisible:!1})),s.current&&(clearTimeout(s.current),s.current=null)},[]);return!e.isVisible||!e.headingText?null:g.jsx(vr,{open:e.isVisible,onClose:u,children:g.jsxs("div",{className:"w-full flex flex-col h-full max-w-2xl mx-auto",children:[g.jsx("div",{className:"flex items-center justify-center mb-6 pb-4 border-b border-gray-700 shrink-0",children:g.jsx("h2",{className:"text-2xl font-bold text-white",children:e.headingText})}),g.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center gap-6",children:[g.jsx("div",{className:"w-full max-w-md text-center",children:g.jsxs("a",{href:Ure,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-lg font-semibold text-cyan-400 hover:text-cyan-300 transition-colors",children:[g.jsx("span",{className:"underline decoration-2 underline-offset-4",children:n("win_modal.wishlist")}),g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})}),e.controlsEnabled&&g.jsxs("div",{className:"w-full max-w-md flex flex-row gap-4",children:[g.jsx("button",{onClick:d,className:"flex-1 px-6 py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-colors font-semibold text-lg cursor-pointer border border-gray-700",children:n("win_modal.exit")}),g.jsx("button",{onClick:f,className:"flex-1 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-semibold text-lg cursor-pointer",children:e.outcomeType==="victory"?n("win_modal.keep"):n("win_modal.spectate")})]})]})]})})}const Gre="/images/ChatIconWhite.svg",Hre="/images/EmojiIconWhite.svg",Vre="/images/DonateTroopIconWhite.svg",Wre="/images/DonateGoldIconWhite.svg",Yre="/images/GoldCoinIcon.svg",$re="/images/DisabledIcon.svg",CM="/images/TraitorIconWhite.svg",kM="/images/PortIcon.svg",qre="/images/ShieldIconWhite.svg",Zre="/images/TargetIconWhite.svg",Xre="/images/AllianceRequestWhiteIcon.svg",Kre=[{key:"help",labelKey:"quick_chat.categories.help"},{key:"attack",labelKey:"quick_chat.categories.attack"},{key:"defend",labelKey:"quick_chat.categories.defend"},{key:"greet",labelKey:"quick_chat.categories.greet"},{key:"misc",labelKey:"quick_chat.categories.misc"},{key:"warnings",labelKey:"quick_chat.categories.warnings"}],Qre=n=>({help:[{key:"troops",text:n("quick_chat.phrases.help.troops"),hasPlayer:!1},{key:"troops_frontlines",text:n("quick_chat.phrases.help.troops_frontlines"),hasPlayer:!1},{key:"gold",text:n("quick_chat.phrases.help.gold"),hasPlayer:!1},{key:"no_attack",text:n("quick_chat.phrases.help.no_attack"),hasPlayer:!1},{key:"sorry_attack",text:n("quick_chat.phrases.help.sorry_attack"),hasPlayer:!1},{key:"alliance",text:n("quick_chat.phrases.help.alliance"),hasPlayer:!1},{key:"help_defend",text:n("quick_chat.phrases.help.help_defend"),hasPlayer:!0},{key:"trade_partners",text:n("quick_chat.phrases.help.trade_partners"),hasPlayer:!1}],attack:[{key:"attack",text:n("quick_chat.phrases.attack.attack"),hasPlayer:!0},{key:"mirv",text:n("quick_chat.phrases.attack.mirv"),hasPlayer:!0},{key:"focus",text:n("quick_chat.phrases.attack.focus"),hasPlayer:!0},{key:"finish",text:n("quick_chat.phrases.attack.finish"),hasPlayer:!0},{key:"build_warships",text:n("quick_chat.phrases.attack.build_warships"),hasPlayer:!1}],defend:[{key:"defend",text:n("quick_chat.phrases.defend.defend"),hasPlayer:!0},{key:"defend_from",text:n("quick_chat.phrases.defend.defend_from"),hasPlayer:!0},{key:"dont_attack",text:n("quick_chat.phrases.defend.dont_attack"),hasPlayer:!0},{key:"ally",text:n("quick_chat.phrases.defend.ally"),hasPlayer:!0},{key:"build_posts",text:n("quick_chat.phrases.defend.build_posts"),hasPlayer:!1}],greet:[{key:"hello",text:n("quick_chat.phrases.greet.hello"),hasPlayer:!1},{key:"good_job",text:n("quick_chat.phrases.greet.good_job"),hasPlayer:!1},{key:"good_luck",text:n("quick_chat.phrases.greet.good_luck"),hasPlayer:!1},{key:"have_fun",text:n("quick_chat.phrases.greet.have_fun"),hasPlayer:!1},{key:"gg",text:n("quick_chat.phrases.greet.gg"),hasPlayer:!1},{key:"nice_to_meet",text:n("quick_chat.phrases.greet.nice_to_meet"),hasPlayer:!1},{key:"well_played",text:n("quick_chat.phrases.greet.well_played"),hasPlayer:!1},{key:"hi_again",text:n("quick_chat.phrases.greet.hi_again"),hasPlayer:!1},{key:"bye",text:n("quick_chat.phrases.greet.bye"),hasPlayer:!1},{key:"thanks",text:n("quick_chat.phrases.greet.thanks"),hasPlayer:!1},{key:"oops",text:n("quick_chat.phrases.greet.oops"),hasPlayer:!1},{key:"trust_me",text:n("quick_chat.phrases.greet.trust_me"),hasPlayer:!1},{key:"trust_broken",text:n("quick_chat.phrases.greet.trust_broken"),hasPlayer:!1},{key:"ruining_games",text:n("quick_chat.phrases.greet.ruining_games"),hasPlayer:!1},{key:"dont_do_that",text:n("quick_chat.phrases.greet.dont_do_that"),hasPlayer:!1},{key:"same_team",text:n("quick_chat.phrases.greet.same_team"),hasPlayer:!1}],misc:[{key:"go",text:n("quick_chat.phrases.misc.go"),hasPlayer:!1},{key:"strategy",text:n("quick_chat.phrases.misc.strategy"),hasPlayer:!1},{key:"fun",text:n("quick_chat.phrases.misc.fun"),hasPlayer:!1},{key:"team_up",text:n("quick_chat.phrases.misc.team_up"),hasPlayer:!0},{key:"pr",text:n("quick_chat.phrases.misc.pr"),hasPlayer:!1},{key:"build_closer",text:n("quick_chat.phrases.misc.build_closer"),hasPlayer:!1},{key:"coastline",text:n("quick_chat.phrases.misc.coastline"),hasPlayer:!1}],warnings:[{key:"strong",text:n("quick_chat.phrases.warnings.strong"),hasPlayer:!0},{key:"weak",text:n("quick_chat.phrases.warnings.weak"),hasPlayer:!0},{key:"mirv_soon",text:n("quick_chat.phrases.warnings.mirv_soon"),hasPlayer:!0},{key:"number1_warning",text:n("quick_chat.phrases.warnings.number1_warning"),hasPlayer:!1},{key:"stalemate",text:n("quick_chat.phrases.warnings.stalemate"),hasPlayer:!1},{key:"has_allies",text:n("quick_chat.phrases.warnings.has_allies"),hasPlayer:!0},{key:"no_allies",text:n("quick_chat.phrases.warnings.no_allies"),hasPlayer:!0},{key:"betrayed",text:n("quick_chat.phrases.warnings.betrayed"),hasPlayer:!0},{key:"betrayed_me",text:n("quick_chat.phrases.warnings.betrayed_me"),hasPlayer:!0},{key:"getting_big",text:n("quick_chat.phrases.warnings.getting_big"),hasPlayer:!0},{key:"danger_base",text:n("quick_chat.phrases.warnings.danger_base"),hasPlayer:!0},{key:"saving_for_mirv",text:n("quick_chat.phrases.warnings.saving_for_mirv"),hasPlayer:!0},{key:"mirv_ready",text:n("quick_chat.phrases.warnings.mirv_ready"),hasPlayer:!0},{key:"snowballing",text:n("quick_chat.phrases.warnings.snowballing"),hasPlayer:!0},{key:"cheating",text:n("quick_chat.phrases.warnings.cheating"),hasPlayer:!0},{key:"stop_trading",text:n("quick_chat.phrases.warnings.stop_trading"),hasPlayer:!0}]});function Jre({open:n,onClose:e,onSend:t,recipientId:r}){const{t:i}=xt(),[s,o]=T.useState("help"),[c,u]=T.useState(null),[d,f]=T.useState(null),[p,y]=T.useState(""),[b,_]=T.useState([]),w=T.useMemo(()=>Qre(i),[i]),S=T.useCallback(()=>{if(!ye.initialized||!ye.gameView){_([]);return}const H=ye.gameView.players().filter(Y=>Y.isAlive()).map(Y=>({id:Y.id(),name:Y.name()})).sort((Y,L)=>Y.name.localeCompare(L.name));_(H)},[]);T.useEffect(()=>{if(!n)return;S();const P=H=>{H.game.initialized&&S()};return ae.on(Ot,P),()=>{ae.off(Ot,P)}},[n,S]);const A=T.useMemo(()=>p.trim()?b.filter(P=>P.name.toLowerCase().includes(p.toLowerCase())):b,[p,b]),M=w[s],k=T.useMemo(()=>d&&b.find(P=>P.id===d)?.name||null,[d,b]),E=T.useMemo(()=>c?c.hasPlayer&&k?c.text.replace("[P1]",k):(c.hasPlayer&&!k,c.text):i("quick_chat.build_your_message"),[c,k,i]),U=P=>{o(P),u(null),f(null)},I=P=>{u(P),P.hasPlayer||f(null)},B=P=>{f(P)},G=()=>{if(!c)return;const P=`${s}.${c.key}`;t&&t(r,P,d||void 0),o("help"),u(null),f(null),y(""),e()},R=c&&(!c.hasPlayer||d);return g.jsx(vr,{open:n,onClose:e,width:"900px",children:g.jsxs("div",{className:"w-full h-full flex flex-col text-white",children:[g.jsx("div",{className:"text-xl font-bold mb-4 shrink-0",children:i("quick_chat.title")}),g.jsxs("div",{className:"flex-1 flex gap-4 min-h-0",children:[g.jsxs("div",{className:"flex flex-col w-48 shrink-0",children:[g.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-300",children:i("quick_chat.category")}),g.jsx("div",{className:"flex-1 overflow-y-auto space-y-1 pr-2",children:Kre.map(P=>g.jsx("button",{onClick:()=>U(P.key),className:`w-full px-3 py-2 text-left rounded transition-colors cursor-pointer ${s===P.key?"bg-purple-600 text-white":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:i(P.labelKey)},P.key))})]}),g.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[g.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-300",children:i("quick_chat.phrase")}),g.jsx("div",{className:"flex-1 overflow-y-auto space-y-1 pr-2",children:M.map(P=>g.jsx("button",{onClick:()=>I(P),className:`w-full px-3 py-2 text-left rounded transition-colors cursor-pointer ${c?.key===P.key?"bg-purple-600 text-white":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:P.text},P.key))})]}),c?.hasPlayer&&g.jsxs("div",{className:"flex flex-col w-48 shrink-0",children:[g.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-300",children:i("quick_chat.player")}),g.jsx("input",{type:"text",placeholder:i("quick_chat.search_player"),value:p,onChange:P=>y(P.target.value),className:"w-full px-3 py-2 mb-2 bg-gray-800 text-white rounded border border-gray-700 focus:outline-none focus:border-purple-500"}),g.jsx("div",{className:"flex-1 overflow-y-auto space-y-1 pr-2",children:A.length===0?g.jsx("div",{className:"px-3 py-2 text-gray-400 text-sm text-center",children:b.length===0?i("quick_chat.no_players_available")||"No players available":i("quick_chat.no_players_found")||"No players found"}):A.map(P=>g.jsx("button",{onClick:()=>B(P.id),className:`w-full px-3 py-2 text-left rounded transition-colors cursor-pointer ${d===P.id?"bg-purple-600 text-white":"bg-gray-800 hover:bg-gray-700 text-white"}`,children:P.name},P.id))})]})]}),g.jsxs("div",{className:"mt-4 flex gap-3 shrink-0",children:[g.jsx("div",{className:"flex-1 px-4 py-3 bg-gray-800 rounded text-white",children:E}),g.jsx("button",{onClick:G,disabled:!R,className:`px-6 py-3 rounded font-semibold transition-colors ${R?"bg-green-600 hover:bg-green-700 text-white cursor-pointer":"bg-gray-700 text-gray-400 cursor-not-allowed"}`,children:i("quick_chat.send")})]})]})})}function vh(n){return n>=1e6?`${(n/1e6).toFixed(2)}M`:n>=1e3?`${(n/1e3).toFixed(1)}K`:n.toString()}function eie({open:n,onClose:e,onSend:t,recipientName:r="Player",recipientId:i,availableTroops:s,cap:o}){const{t:c}=xt(),[u,d]=T.useState(0),[f,p]=T.useState(s??0),[y,b]=T.useState(o??0),w=T.useMemo(()=>{const I=Math.min(f,y);return Math.floor(u/100*I)},[u,f,y]),S=f-w,A=T.useCallback(I=>{d(I)},[]),M=T.useCallback(I=>{const B=parseFloat(I.target.value);d(B)},[]),k=T.useCallback(()=>{d(100)},[]),E=T.useCallback(()=>{w>0&&(i!==void 0&&ae.emit(new cg(i,w)),t&&t(w)),e()},[t,w,e,i]);T.useEffect(()=>{if(!n||!ye.initialized||!ye.gameView)return;const I=()=>{if(!ye.gameView)return;const G=ye.gameView.myPlayer();if(G)if(p(s===void 0?G.troops():s),i!==void 0&&o===void 0)try{const R=ye.gameView.player(i),P=ye.gameView.config().maxTroops(R),H=R.troops(),Y=Math.max(0,P-H);b(Y)}catch{}else o!==void 0&&b(o)};I();const B=G=>{G.game.initialized&&G.game.gameView&&I()};return ae.on(Ot,B),()=>{ae.off(Ot,B)}},[n,s,o,i]),T.useEffect(()=>{if(!n)return;const I=B=>{B.key==="Escape"&&e()};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[n,e]);const U=[{label:"10%",value:10},{label:"25%",value:25},{label:"50%",value:50},{label:"75%",value:75},{label:c("common.preset_max"),value:100}];return n?g.jsxs("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center",onClick:e,children:[g.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm","aria-hidden":"true"}),g.jsxs("div",{className:"relative z-10 bg-gray-900/95 rounded-lg shadow-xl overflow-hidden flex flex-col mx-4 w-full max-w-[500px]",onClick:I=>I.stopPropagation(),children:[g.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-20 p-2 rounded-full hover:bg-gray-700/50 transition-colors cursor-pointer","aria-label":"Close modal",children:g.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})}),g.jsx("div",{className:"p-6 flex flex-col flex-1 min-h-0",children:g.jsxs("div",{className:"w-full flex flex-col text-white",children:[g.jsx("div",{className:"text-xl font-bold mb-6 shrink-0",children:c("send_resources.send_troops.title",{recipientName:r})}),g.jsxs("div",{className:"flex gap-3 mb-4 shrink-0",children:[g.jsxs("div",{className:"flex-1 bg-gray-800/80 px-4 py-2 rounded-lg border border-gray-700/50",children:[g.jsx("span",{className:"text-sm text-gray-300",children:c("send_resources.send_troops.available")}),g.jsx("div",{className:"text-white font-semibold",children:vh(f)})]}),g.jsxs("div",{className:"flex-1 bg-gray-800/80 px-4 py-2 rounded-lg border border-gray-700/50",children:[g.jsx("span",{className:"text-sm text-gray-300",children:c("send_resources.send_troops.cap")}),g.jsx("div",{className:"text-white font-semibold",children:vh(y)})]})]}),g.jsx("div",{className:"flex gap-2 mb-4 shrink-0",children:U.map(I=>g.jsx("button",{onClick:()=>A(I.value),className:`flex-1 px-4 py-2 rounded-lg transition-colors border cursor-pointer ${u===I.value?"bg-purple-600 border-purple-500 text-white":"bg-gray-800/80 hover:bg-gray-700/80 border-gray-700/50 text-gray-300"}`,children:I.label},I.value))}),g.jsxs("div",{className:"mb-4 shrink-0",children:[g.jsx("div",{className:"flex items-center justify-between mb-2",children:g.jsxs("div",{className:"text-sm text-gray-300",children:[u.toFixed(0),"%  ",vh(w)]})}),g.jsx("input",{type:"range",min:"0",max:"100",step:"0.1",value:u,onChange:M,className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, #9333ea 0%, #9333ea ${u}%, #374151 ${u}%, #374151 100%)`}}),g.jsx("button",{onClick:k,className:"mt-2 px-3 py-1 text-xs bg-gray-800/80 hover:bg-gray-700/80 rounded border border-gray-700/50 transition-colors text-gray-300 cursor-pointer",children:c("send_resources.send_troops.cap")})]}),g.jsx("div",{className:"mb-6 shrink-0",children:g.jsxs("div",{className:"text-sm text-gray-300",children:[c("send_resources.send_troops.send")," ",g.jsx("span",{className:"text-blue-400 font-semibold",children:vh(w)}),"  ",c("send_resources.send_troops.keep")," ",g.jsx("span",{className:"text-green-400 font-semibold",children:vh(S)})]})}),g.jsxs("div",{className:"flex gap-3 shrink-0",children:[g.jsx("button",{onClick:e,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 px-6 py-3 rounded-lg transition-colors border border-gray-700/50 text-white font-semibold cursor-pointer",children:c("send_resources.send_troops.cancel")}),g.jsx("button",{onClick:E,disabled:w===0,className:`flex-1 px-6 py-3 rounded-lg transition-colors font-semibold ${w>0?"bg-purple-600 hover:bg-purple-700 text-white cursor-pointer":"bg-gray-700 text-gray-400 cursor-not-allowed"}`,children:c("send_resources.send_troops.send")})]})]})})]})]}):null}function Ix(n){return n>=1e6?`${(n/1e6).toFixed(2)}M`:n>=1e3?`${(n/1e3).toFixed(2)}K`:n.toString()}function tie({open:n,onClose:e,onSend:t,recipientName:r="Player",availableGold:i=20800}){const{t:s}=xt(),[o,c]=T.useState(0),d=T.useMemo(()=>Math.floor(o/100*i),[o,i]),f=i-d,p=T.useCallback(w=>{c(w)},[]),y=T.useCallback(w=>{const S=parseFloat(w.target.value);c(S)},[]),b=T.useCallback(()=>{t&&d>0&&t(d),e()},[t,d,e]);T.useEffect(()=>{if(!n)return;const w=S=>{S.key==="Escape"&&e()};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[n,e]);const _=[{label:"10%",value:10},{label:"25%",value:25},{label:"50%",value:50},{label:"75%",value:75},{label:s("common.preset_max"),value:100}];return n?g.jsxs("div",{className:"fixed inset-0 z-10001 flex items-center justify-center",onClick:e,children:[g.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm","aria-hidden":"true"}),g.jsxs("div",{className:"relative z-10 bg-gray-900/95 rounded-lg shadow-xl overflow-hidden flex flex-col mx-4 w-full max-w-[500px]",onClick:w=>w.stopPropagation(),children:[g.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-20 p-2 rounded-full hover:bg-gray-700/50 transition-colors cursor-pointer","aria-label":"Close modal",children:g.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})}),g.jsx("div",{className:"p-6 flex flex-col flex-1 min-h-0",children:g.jsxs("div",{className:"w-full flex flex-col text-white",children:[g.jsx("div",{className:"text-xl font-bold mb-6 shrink-0",children:s("send_resources.send_gold.title",{recipientName:r})}),g.jsx("div",{className:"mb-4 shrink-0",children:g.jsxs("div",{className:"text-sm text-gray-300",children:[s("send_resources.send_gold.available")," ",Ix(i)]})}),g.jsx("div",{className:"flex gap-2 mb-4 shrink-0",children:_.map(w=>g.jsx("button",{onClick:()=>p(w.value),className:`flex-1 px-4 py-2 rounded-lg transition-colors border cursor-pointer ${o===w.value?"bg-purple-600 border-purple-500 text-white":"bg-gray-800/80 hover:bg-gray-700/80 border-gray-700/50 text-gray-300"}`,children:w.label},w.value))}),g.jsxs("div",{className:"mb-4 shrink-0",children:[g.jsx("div",{className:"flex items-center justify-between mb-2",children:g.jsxs("div",{className:"text-sm text-gray-300",children:[o.toFixed(0),"%  ",Ix(d)]})}),g.jsx("input",{type:"range",min:"0",max:"100",step:"0.1",value:o,onChange:y,className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, #eab308 0%, #eab308 ${o}%, #374151 ${o}%, #374151 100%)`}})]}),g.jsx("div",{className:"mb-6 shrink-0",children:g.jsxs("div",{className:"text-sm text-gray-300",children:[s("send_resources.send_gold.send")," ",g.jsx("span",{className:"text-blue-400 font-semibold",children:Ix(d)}),"  ",s("send_resources.send_gold.keep")," ",g.jsx("span",{className:"text-green-400 font-semibold",children:pn(f)})]})}),g.jsxs("div",{className:"flex gap-3 shrink-0",children:[g.jsx("button",{onClick:e,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 px-6 py-3 rounded-lg transition-colors border border-gray-700/50 text-white font-semibold cursor-pointer",children:s("send_resources.send_gold.cancel")}),g.jsx("button",{onClick:b,disabled:d===0,className:`flex-1 px-6 py-3 rounded-lg transition-colors font-semibold ${d>0?"bg-purple-600 hover:bg-purple-700 text-white cursor-pointer":"bg-gray-700 text-gray-400 cursor-not-allowed"}`,children:s("send_resources.send_gold.send")})]})]})})]})]}):null}function nie(){const{t:n}=xt(),[e,t]=T.useState(!1),[r,i]=T.useState(null),[s,o]=T.useState(null),[c,u]=T.useState(!1),[d,f]=T.useState(!1),[p,y]=T.useState(!1),[b,_]=T.useState(null),w=T.useRef(null),S=()=>{t(!1)},[A,M]=T.useState(null);T.useEffect(()=>{const tt=mt=>{t(!0),i(mt.player),o(mt.tile)};return ae.on(g1,tt),()=>{ae.off(g1,tt)}},[]),T.useEffect(()=>{if(!e||!ye.gameView){M(null);return}const tt=async()=>{if(!(!ye.gameView||!r))try{const _t=ye.gameView.myPlayer();if(!_t)return;const Xn=_t.id()===r.id(),ke=(r?.allies()||[]).map(Dr=>Dr.name()),nt=r?.isTraitor()?r.getTraitorRemainingTicks():0,wt=r?Number(r.gold()):0,$e=r?.troops()||0;let kn;r&&(r.type()===Xt.Bot?kn="bot":r.type()===Xt.FakeHuman?kn="nation":kn="player");const de=r?r.cosmetics.flag:void 0,we=de&&!de.startsWith("!")?`/flags/${de}.svg`:void 0,Oe=_t?.troops()||0,qe=_t?Number(_t.gold()):0,pt=Math.floor($e*.1),Qn=await _t.actions(s||void 0);M({myPlayer:_t,isOwnTerritory:Xn,gold:wt,troops:$e,betrayals:nt,alliances:ke,playerName:r?.name()||"Unknown",flagPath:we,playerType:kn,availableTroops:Oe,availableGold:qe,donateTroopsCap:pt,playerActions:Qn})}catch(_t){console.error("Error updating player data:",_t)}};tt();const mt=()=>{tt()};return ae.on(Ot,mt),()=>{ae.off(Ot,mt)}},[e,r,s]),T.useEffect(()=>{(async()=>{try{const _t=await(await fetch("/cosmetics/cosmetics.json")).json();_(_t)}catch(mt){console.error("Failed to load cosmetics:",mt)}})()},[]),T.useEffect(()=>{if(!e||!r){w.current&&(w.current.innerHTML="");return}const tt=r.cosmetics?.flag,mt=w.current;mt&&(mt.innerHTML=""),tt?.startsWith("!")&&mt&&b&&requestAnimationFrame(()=>{w.current&&ZP(tt,w.current,b)})},[e,r?.id(),r?.cosmetics?.flag,b]);const k=r,E=A?.isOwnTerritory??!1,U=A?.gold,I=A?.troops,B=A?.betrayals??0,G=A?.alliances||[],R=A?.playerName||"Unknown",P=A?.flagPath,H=A?.playerType,Y=A?.availableTroops||0,L=A?.availableGold||0,q=A?.donateTroopsCap||0,W=A?.playerActions??null,N=W?.interaction,V=E?W?.canSendEmojiAllPlayers??!1:N?.canSendEmoji??!1,J=N?.canTarget??!1,se=N?.canDonateGold??!1,O=N?.canDonateTroops??!1,F=N?.canEmbargo??!1,X=N?.canSendAllianceRequest??!1,D=N?.canBreakAlliance??!1,ee=()=>{u(!0)},pe=()=>{k&&ae.emit(new Rp(k.id()))},Se=(tt,mt,_t)=>{k&&(ae.emit(new W4(tt,mt,_t)),S())},ie=()=>{f(!0)},ve=tt=>{k&&ae.emit(new cg(k.id(),tt))},Ce=()=>{y(!0)},Le=tt=>{k&&ae.emit(new H2(k.id(),tt))},st=()=>{k&&(ae.emit(new d1(k.id(),"stop")),S())},ft=()=>{k&&(ae.emit(new d1(k.id(),"start")),S())},Ge=()=>{k&&(ae.emit(new F2(k.id())),S())},It=()=>{k&&(ae.emit(new G2(k.id())),S())},zt=()=>{k&&(ae.emit(new V4(k.id())),S())};return g.jsxs(vr,{open:e,onClose:S,width:"350px",children:[g.jsxs("div",{className:"text-white backdrop-blur-sm",children:[g.jsx("div",{className:"flex items-center justify-between mb-4 pb-4 border-b border-gray-700/50 pr-10",children:g.jsxs("div",{className:"flex items-center gap-3",children:[P?g.jsx("img",{src:P,alt:R,className:"w-8 h-6 rounded-sm object-cover border border-gray-600",onError:tt=>{tt.target.style.display="none"}}):r&&r.cosmetics.flag?.startsWith("!")?g.jsx("div",{ref:w,className:"w-8 h-6 rounded-sm border border-gray-600 overflow-hidden",style:{aspectRatio:"3/4"}}):r&&r.cosmetics.flag&&!r.cosmetics.flag.startsWith("!")?g.jsx("img",{src:`/flags/${r.cosmetics.flag}.svg`,alt:R,className:"w-8 h-6 rounded-sm object-cover border border-gray-600",onError:tt=>{tt.target.style.display="none"}}):null,g.jsx("h2",{className:"text-2xl font-bold text-white",children:R})]})}),g.jsxs("div",{className:"flex items-center justify-center gap-6 mb-4 pb-4 border-b border-gray-700/50",children:[!E&&H&&g.jsxs("div",{className:"px-4 py-2 bg-purple-600/80 rounded-full text-sm flex items-center gap-2 shrink-0",children:[g.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),g.jsx("span",{className:"text-white capitalize",children:n(`player_type.${H}`)})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("img",{src:Yre,alt:"Gold",className:"w-6 h-6 object-contain"}),g.jsxs("span",{className:"text-gray-300 text-base",children:[pn(U)," ",n("player_info_overlay.gold")]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("img",{src:qre,alt:"Troops",className:"w-6 h-6 object-contain"}),g.jsxs("span",{className:"text-gray-300 text-base",children:[Hs(I)," ",n("player_info_overlay.troops")]})]})]}),g.jsxs("div",{className:"space-y-3 mb-4 pb-4 border-b border-gray-700/50",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("img",{src:CM,alt:"Betrayals",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-gray-300",children:n("player_info.betrayals")}),g.jsx("span",{className:"text-white font-semibold ml-auto",children:B})]}),!E&&N&&g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("img",{src:kM,alt:"Trading",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-gray-300",children:n("player_info.trading")}),F?g.jsx("span",{className:"text-green-400 font-semibold ml-auto",children:n("player_info.active")}):g.jsx("span",{className:"text-gray-400 font-semibold ml-auto",children:n("player_info.inactive")})]})]}),g.jsxs("div",{className:"mb-6 pb-4 border-b border-gray-700/50",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[g.jsx("h3",{className:"text-white font-semibold",children:n("player_info.alliances")}),g.jsx("span",{className:"bg-white text-gray-900 text-xs font-semibold w-5 h-5 rounded-full flex items-center justify-center",children:G.length})]}),g.jsx("div",{className:"space-y-2 bg-gray-800/50 rounded-lg p-3",children:G.map((tt,mt)=>g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),g.jsx("span",{className:"text-gray-300",children:tt})]},mt))})]}),g.jsxs("div",{className:"flex gap-2 mb-6",children:[g.jsxs("button",{onClick:ee,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 p-3 rounded-lg flex flex-col items-center gap-1.5 transition-colors border border-gray-700/50 cursor-pointer",children:[g.jsx("img",{src:Gre,alt:"Chat",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm text-gray-300",children:n("player_info.chat")})]}),V&&g.jsxs("button",{onClick:pe,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 p-3 rounded-lg flex flex-col items-center gap-1.5 transition-colors border border-gray-700/50 cursor-pointer",children:[g.jsx("img",{src:Hre,alt:"Emojis",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm text-gray-300",children:n("player_info.emojis")})]}),O&&g.jsxs("button",{onClick:ie,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 p-3 rounded-lg flex flex-col items-center gap-1.5 transition-colors border border-gray-700/50 cursor-pointer",children:[g.jsx("img",{src:Vre,alt:"Troops",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm text-gray-300",children:n("player_info_overlay.troops")})]}),se&&g.jsxs("button",{onClick:Ce,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 p-3 rounded-lg flex flex-col items-center gap-1.5 transition-colors border border-gray-700/50 cursor-pointer",children:[g.jsx("img",{src:Wre,alt:"Gold",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm text-gray-300",children:n("player_info_overlay.gold")})]}),J&&g.jsxs("button",{onClick:zt,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 p-3 rounded-lg flex flex-col items-center gap-1.5 transition-colors border border-gray-700/50 cursor-pointer",children:[g.jsx("img",{src:Zre,alt:"Target",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm text-gray-300",children:n("player_info.target")})]})]}),!E&&N&&g.jsxs("div",{className:"flex gap-3",children:[F?g.jsxs("button",{onClick:ft,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 px-4 py-3 rounded-lg flex flex-col items-center gap-1.5 text-orange-400 transition-colors border border-gray-700/50 font-medium cursor-pointer",children:[g.jsx("img",{src:$re,alt:"Stop Trading",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm",children:n("player_info.stop_trading")})]}):g.jsxs("button",{onClick:st,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 px-4 py-3 rounded-lg flex flex-col items-center gap-1.5 text-green-400 transition-colors border border-gray-700/50 font-medium cursor-pointer",children:[g.jsx("img",{src:kM,alt:"Start Trading",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm",children:n("player_info.start_trading")})]}),D?g.jsxs("button",{onClick:It,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 px-4 py-3 rounded-lg flex flex-col items-center gap-1.5 text-red-400 transition-colors border border-gray-700/50 font-medium cursor-pointer",children:[g.jsx("img",{src:CM,alt:"Break Alliance",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm",children:n("player_info.break_alliance")})]}):X?g.jsxs("button",{onClick:Ge,className:"flex-1 bg-gray-800/80 hover:bg-gray-700/80 px-4 py-3 rounded-lg flex flex-col items-center gap-1.5 text-purple-400 transition-colors border border-gray-700/50 font-medium cursor-pointer",children:[g.jsx("img",{src:Xre,alt:"Send Alliance",className:"w-5 h-5 object-contain"}),g.jsx("span",{className:"text-sm",children:n("player_info.send_alliance")})]}):null]})]}),g.jsx(Jre,{open:c,onClose:()=>u(!1),onSend:Se,recipientId:r?.id()}),g.jsx(eie,{open:d,onClose:()=>f(!1),onSend:ve,recipientName:R,recipientId:r?.id(),availableTroops:Y,cap:q}),g.jsx(tie,{open:p,onClose:()=>y(!1),onSend:Le,recipientName:R,availableGold:L})]})}const rie=[{type:$.City,icon:"/images/CityIconWhite.svg",titleKey:"city",descKey:"increases_max_population"},{type:$.Factory,icon:"/images/FactoryIconWhite.svg",titleKey:"factory",descKey:"produces_units"},{type:$.Port,icon:"/images/PortIcon.svg",titleKey:"port",descKey:"allows_naval_units"},{type:$.DefensePost,icon:"/images/ShieldIconWhite.svg",titleKey:"defense_post",descKey:"increases_defenses"},{type:$.MissileSilo,icon:"/images/MissileSiloIconWhite.svg",titleKey:"missile_silo",descKey:"launches_missiles"},{type:$.SAMLauncher,icon:"/images/SamLauncherIconWhite.svg",titleKey:"sam_launcher",descKey:"anti_aircraft_defense"},{type:$.AtomBomb,icon:"/images/NukeIconWhite.svg",titleKey:"atom_bomb",descKey:"nuclear_weapon"},{type:$.MIRV,icon:"/images/MIRVIcon.svg",titleKey:"mirv",descKey:"multiple_independently_targetable_reentry_vehicle"},{type:$.HydrogenBomb,icon:"/images/MushroomCloudIconWhite.svg",titleKey:"hydrogen_bomb",descKey:"thermonuclear_weapon"},{type:$.Warship,icon:"/images/BattleshipIconWhite.svg",titleKey:"warship",descKey:"battleship_unit"}];function iie(){const{t:n}=xt(),[e,t]=T.useState(!1),[r,i]=T.useState(null),[s,o]=T.useState(null),[c,u]=T.useState(0n),[d,f]=T.useState(null);T.useEffect(()=>{const S=A=>{if(!ye.initialized||!ye.gameView)return;const M=ye.gameView.myPlayer();if(!M||!M.isAlive()||ye.gameView.inSpawnPhase())return;const k=ye.getWorldCoordinateFromScreen(A.x,A.y);if(!k)return;const E=ye.gameView.ref(k.x,k.y);i(E),t(!0)};return ae.on(p1,S),()=>{ae.off(p1,S)}},[]),T.useEffect(()=>{if(!e||!r||!ye.gameView){o(null),f(null),u(0n);return}const S=async()=>{const M=ye.gameView.myPlayer();if(M){f(M),u(M.gold());try{const k=await M.actions(r);o(k)}catch(k){console.error("Actions fetch error:",k)}}};S();const A=M=>{M.game.initialized&&S()};return ae.on(Ot,A),()=>ae.off(Ot,A)},[e,r]);const p=()=>{t(!1),i(null)},y=S=>s?.buildableUnits?.find(A=>A.type===S)?.cost??null,b=S=>{if(!ye.gameView||!d||ye.gameView.config().isUnitDisabled(S))return!1;const M=s?.buildableUnits?.find(E=>E.type===S);if(M&&!M.canBuild)return!1;const k=y(S);return k===null||k>d.gold()?!1:[$.AtomBomb,$.HydrogenBomb,$.MIRV].includes(S)?d.units($.MissileSilo).length>0:S===$.Warship?d.units($.Port).length>0:!0},_=S=>d?d.units(S).length:0,w=S=>{!r||!b(S)||(ae.emit(new kc(S,r)),p())};return!e||!d?null:g.jsx(vr,{open:e,onClose:p,width:"800px",children:g.jsxs("div",{className:"flex flex-col h-full",children:[g.jsx("h2",{className:"text-xl font-bold text-white mb-3",children:n("game.circular_menu.build")}),g.jsx("div",{className:"flex-1 overflow-y-auto",children:g.jsx("div",{className:"grid grid-cols-4 gap-3",children:rie.map(S=>{const A=!b(S.type),M=y(S.type),k=_(S.type);return g.jsxs("button",{onClick:()=>w(S.type),disabled:A,className:`
                    relative bg-gray-800 rounded-lg p-2 flex flex-col items-center
                    transition-all duration-200
                    ${A?"opacity-50 cursor-not-allowed":"hover:bg-gray-700 active:bg-gray-600 cursor-pointer"}
                  `,children:[k>0&&g.jsx("div",{className:"absolute top-1 right-1 bg-gray-900 text-white text-xs font-bold px-1.5 py-0.5 rounded",children:k}),g.jsx("img",{src:S.icon,alt:S.type,className:"w-8 h-8 mb-1 filter brightness-0 invert"}),g.jsx("h3",{className:"text-white font-semibold text-sm mb-0.5 text-center",children:n(`game.circular_menu.${S.titleKey}`)}),g.jsx("p",{className:"text-gray-400 text-xs text-center mb-1 line-clamp-2",children:n(`game.circular_menu.${S.descKey}`)}),g.jsxs("div",{className:"flex items-center gap-1 bg-gray-900 rounded-full px-1.5 py-0.5 mt-auto",children:[g.jsx("span",{className:"text-yellow-400 text-xs",children:""}),g.jsx("span",{className:"text-white text-xs",children:M?pn(M):"-"})]})]},S.type)})})})]})})}const sie=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""];function aie(){const{t:n}=xt(),[e,t]=T.useState(!1),[r,i]=T.useState(null),[s,o]=T.useState(null);T.useEffect(()=>{const f=p=>{if(!ye.initialized||!ye.gameView)return;const y=ye.gameView.myPlayer();!y||!y.isAlive()||ye.gameView.inSpawnPhase()||(i(y?.id()===p.target?fs:p.target),t(!0))};return ae.on(Rp,f),()=>{ae.off(Rp,f)}},[]),T.useEffect(()=>{if(!e||!ye.gameView||!r){o(null);return}const f=async()=>{if(!(!ye.gameView||!r))try{const y=ye.gameView.myPlayer();if(!y)return;let b;if(r===fs)b=await y.actions(void 0);else{let _;ye.gameView.forEachTile(w=>{if(_!==void 0||!ye.gameView.isLand(w))return;const S=ye.gameView.owner(w);S.isPlayer()&&S.id()===r&&(_=w)}),b=await y.actions(_)}o(b)}catch(y){console.error("Error updating player actions:",y),o(null)}};f();const p=()=>{f()};return ae.on(Ot,p),()=>{ae.off(Ot,p)}},[e,r]);const c=()=>{t(!1),i(null),o(null)},u=r===fs?s?.canSendEmojiAllPlayers??!1:s?.interaction?.canSendEmoji??!1,d=f=>{if(!r||!u)return;const p=Q3.findIndex(y=>y===f);p!==-1&&ae.emit(new H4(r,p)),c()};return g.jsx(vr,{open:e,onClose:c,width:"500px",height:"500px",children:g.jsxs("div",{className:"w-full h-full flex flex-col text-white",children:[g.jsx("div",{className:"text-xl font-bold mb-4 shrink-0",children:n("emoji_modal.title")}),g.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden min-h-0",children:g.jsx("div",{className:"grid grid-cols-5 gap-3",children:sie.map((f,p)=>g.jsx("button",{onClick:()=>d(f),disabled:!u,className:`aspect-square flex items-center justify-center text-[60px] rounded-lg transition-colors border ${u?"bg-gray-800 hover:bg-gray-700 cursor-pointer border-gray-700/50 hover:border-gray-600":"bg-gray-900 cursor-not-allowed border-gray-800/50 opacity-50"}`,"aria-label":`Select emoji ${f}`,children:f},p))})})]})})}const TM=90;function oie({isMobile:n}){if(!n)return null;const e=()=>{const r=window.innerWidth/2,i=window.innerHeight/2;ae.emit(new No(r,i,-TM))},t=()=>{const r=window.innerWidth/2,i=window.innerHeight/2;ae.emit(new No(r,i,TM))};return g.jsxs("div",{className:"fixed right-4 top-1/2 -translate-y-1/2 z-50 flex flex-col gap-6",children:[g.jsx("button",{onClick:e,className:"w-13 h-13 rounded-full bg-gray-700/75 backdrop-blur-sm border-2 border-gray-600 hover:border-gray-400 active:bg-gray-800 flex items-center justify-center text-white text-3xl font-semibold shadow-lg transition-colors select-none","aria-label":"Zoom in",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-8 h-8 group-hover:scale-110 transition-transform",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})}),g.jsx("button",{onClick:t,className:"w-13 h-13 rounded-full bg-gray-700/75 backdrop-blur-sm border-2 border-gray-600 hover:border-gray-400 active:bg-gray-800 flex items-center justify-center text-white text-3xl font-semibold shadow-lg transition-colors select-none","aria-label":"Zoom out",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-8 h-8 group-hover:scale-110 transition-transform",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"})})})]})}function lie({isMobile:n}){const e=T.useRef(null),[t,r]=T.useState(!1),[i,s]=T.useState({x:0,y:0});return T.useEffect(()=>{ye.initialized||!e.current||!ye.gameStartInfo||ye?.initialize(e.current)},[ye,e,ye.gameStartInfo]),T.useEffect(()=>{const o=c=>{!ye.initialized&&e.current&&ye.gameStartInfo&&ye?.initialize(e.current)};return ae.on(nd,o),()=>{ae.off(nd,o)}},[]),T.useEffect(()=>{const o=async c=>{s({x:c.x,y:c.y}),r(!0)};return ae.on(Bo,o),()=>{ae.off(Bo,o)}},[]),g.jsxs("div",{className:"relative w-full h-screen bg-[#1b232f]",children:[g.jsx("canvas",{ref:e,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",pointerEvents:"auto",touchAction:"none",zIndex:0}}),t&&g.jsx(Lre,{x:i.x,y:i.y,onClose:()=>r(!1)}),g.jsx(Rre,{}),g.jsx(ore,{}),g.jsx(cre,{}),!n&&g.jsx(gre,{}),g.jsx(Ere,{}),g.jsx(Mre,{isMobile:n}),g.jsx(oie,{isMobile:n}),g.jsx(zre,{}),!n&&g.jsx(Ire,{}),g.jsx(nie,{}),g.jsx(Fre,{}),g.jsx(iie,{}),g.jsx(aie,{}),g.jsxs("div",{id:"game-banner",className:"flex fixed top-[10px] w-full justify-center",style:{display:"none"},children:[g.jsx("div",{id:"cg-banner-ingame",className:"ad",style:{width:"468px",height:"60px",display:"none"}}),g.jsx("div",{id:"frontwars-728x90",className:"ad",style:{width:"728px",display:"none"}})]})]})}const cie=16,uie=30,Rx={LARGE:50,MEDIUM:20,SMALL:10},hie=[{threshold:0,key:"initializing_game_engine"},{threshold:25,key:"loading_map_data"},{threshold:50,key:"preparing_battlefield"},{threshold:75,key:"almost_ready"}];function die({label:n,animate:e=!0,theme:t=yt.Dark}){return g.jsxs("div",{className:`flex items-center gap-3 ${e?"animate-fade-in":""}`,children:[g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-4 h-4 rounded-full bg-teal-500 animate-pulse shadow-lg shadow-teal-500/50"}),g.jsx("div",{className:"absolute inset-0 w-4 h-4 rounded-full bg-teal-500 animate-ping opacity-75"}),g.jsx("div",{className:"absolute inset-0 w-4 h-4 rounded-full bg-teal-400/50 animate-ping",style:{animationDelay:"0.5s"}})]}),g.jsx("span",{className:"font-bold",style:{color:t===yt.Light?"var(--text-loading-screen)":"#f3f4f6"},children:n})]})}function fie({progress:n=0}){const{t:e}=xt(),{theme:t}=Dc(),[r,i]=T.useState(0);T.useEffect(()=>{if(n>=100){i(100);return}const u=setInterval(()=>{i(d=>{if(d>=n)return d;const f=n-d;let p;return f>Rx.LARGE?p=f*.6:f>Rx.MEDIUM?p=f*.75:f>Rx.SMALL?p=Math.max(15,Math.ceil(f*.8)):p=Math.max(5,Math.ceil(f*.9)),Math.min(d+p,n)})},cie);return()=>clearInterval(u)},[n]);const s=T.useMemo(()=>Array.from({length:uie},(u,d)=>({id:d,left:Math.random()*100,top:Math.random()*100,size:Math.random()*6+3,delay:Math.random()*5,duration:Math.random()*15+10})),[]),o=T.useMemo(()=>({backgroundImage:`
      linear-gradient(rgba(20, 184, 166, 0.2) 1px, transparent 1px),
      linear-gradient(90deg, rgba(20, 184, 166, 0.2) 1px, transparent 1px)
    `,backgroundSize:"50px 50px"}),[]),c=T.useMemo(()=>Math.round(r),[r]);return g.jsxs("div",{className:"fixed inset-0 z-9999 select-none overflow-hidden transition-opacity duration-700 ease-out opacity-100","data-theme":t===yt.Light?yt.Light:void 0,style:{...t===yt.Light?{"--text-loading-screen":"#383b42"}:{}},children:[g.jsxs(FM,{blurAmount:2,className:"h-screen transition-transform duration-700 ease-out scale-100",children:[g.jsx("div",{className:"absolute inset-0 bg-linear-to-br from-teal-900/20 via-transparent to-cyan-900/20 animate-pulse"}),g.jsx("div",{className:"absolute inset-0 bg-linear-to-tr from-transparent via-teal-500/10 to-transparent"}),g.jsx("div",{className:"absolute inset-0 overflow-hidden",children:s.map(u=>g.jsx("div",{className:"absolute rounded-full bg-teal-500/20 animate-float",style:{left:`${u.left}%`,top:`${u.top}%`,width:`${u.size}px`,height:`${u.size}px`,animationDelay:`${u.delay}s`,animationDuration:`${u.duration}s`}},u.id))}),g.jsx("div",{className:"absolute inset-0 opacity-10",style:o}),g.jsx("div",{className:"absolute inset-0 bg-black/30 z-0"}),g.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-screen w-full transition-[opacity,transform] duration-800 ease-out opacity-100 translate-y-0",style:{transitionDelay:"150ms"},children:[g.jsxs("div",{className:"mb-16 text-center",children:[g.jsxs("div",{className:"relative inline-block",children:[g.jsx("div",{className:"absolute inset-0 blur-3xl bg-linear-to-r from-teal-500/60 via-cyan-500/60 to-teal-500/60 animate-pulse"}),g.jsx("h1",{className:"relative text-6xl md:text-8xl font-bold mb-4 bg-linear-to-r from-teal-400 via-cyan-400 to-teal-500 bg-clip-text text-transparent animate-gradient drop-shadow-2xl",style:{textShadow:t===yt.Light?"0 0 30px rgba(20, 184, 166, 1), 0 0 60px rgba(20, 184, 166, 0.8), 0 0 90px rgba(20, 184, 166, 0.5), 1px 1px 2px rgba(0, 0, 0, 0.15)":"0 0 30px rgba(20, 184, 166, 1), 0 0 60px rgba(20, 184, 166, 0.8), 0 0 90px rgba(20, 184, 166, 0.5)",filter:t===yt.Light?"brightness(1.2) contrast(1.1)":"none"},children:e("game.loading.title")})]}),g.jsxs("div",{className:"text-xl md:text-2xl font-bold mt-2",style:{color:t===yt.Light?"var(--text-loading-screen)":"#e5e7eb"},children:[e("game.loading.loading"),g.jsx("span",{className:"inline-block w-[1.5em] text-left animate-dots"})]})]}),g.jsx("div",{className:"w-full max-w-md px-8",children:g.jsxs("div",{className:"relative",children:[g.jsxs("div",{className:"h-3 bg-gray-900/80 rounded-full overflow-hidden backdrop-blur-sm border-2 border-teal-900/50 shadow-lg shadow-teal-900/50",children:[g.jsx("div",{className:"absolute inset-0 bg-linear-to-r from-transparent via-white/30 to-transparent animate-shimmer"}),g.jsxs("div",{className:"h-full bg-linear-to-r from-teal-600 via-cyan-500 to-teal-500 rounded-full transition-[width] duration-200 ease-linear relative overflow-hidden shadow-lg shadow-teal-500/50",style:{width:`${r}%`},children:[g.jsx("div",{className:"absolute inset-0 bg-teal-400/60 blur-md"}),g.jsx("div",{className:"absolute inset-0 bg-linear-to-r from-transparent via-white/60 to-transparent animate-shine"}),g.jsx("div",{className:"absolute inset-0 bg-teal-300/40 animate-pulse"})]})]}),g.jsx("div",{className:"mt-6 text-center",children:g.jsxs("span",{className:"text-4xl font-bold",style:{color:t===yt.Light?"var(--text-loading-screen)":"transparent",background:t===yt.Light?"none":"linear-gradient(to right, rgba(96, 165, 250, 1), rgba(34, 211, 238, 1), rgba(20, 184, 166, 1))",WebkitBackgroundClip:t===yt.Light?"unset":"text",backgroundClip:t===yt.Light?"unset":"text",textShadow:t===yt.Light?"none":"0 0 15px rgba(20, 184, 166, 0.9), 0 0 30px rgba(20, 184, 166, 0.6)",filter:t===yt.Light?"none":"drop-shadow(0 0 8px rgba(20, 184, 166, 0.8))",animation:t===yt.Dark?"gradient 3s ease infinite":"none",backgroundSize:t===yt.Dark?"200% 200%":"unset"},children:[c,"%"]})})]})}),g.jsx("div",{className:"mt-16 space-y-4 text-sm",children:hie.map((u,d)=>d===0||r>u.threshold?g.jsx(die,{label:e(`game.loading.${u.key}`),animate:d>0,theme:t},u.key):null)})]}),g.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-teal-500/20 rounded-full blur-3xl animate-pulse"}),g.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-cyan-500/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),g.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-teal-500/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"0.5s"}})]}),g.jsx("style",{children:`
        @keyframes float {
          0%, 100% {
            transform: translateY(0) translateX(0);
            opacity: 0;
          }
          10% {
            opacity: 1;
          }
          90% {
            opacity: 1;
          }
          100% {
            transform: translateY(-100vh) translateX(30px);
            opacity: 0;
          }
        }

        @keyframes shimmer {
          0% {
            transform: translateX(-100%);
          }
          100% {
            transform: translateX(100%);
          }
        }

        @keyframes shine {
          0% {
            transform: translateX(-100%);
          }
          100% {
            transform: translateX(100%);
          }
        }

        @keyframes gradient {
          0%, 100% {
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
        }

        @keyframes fade-in {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-float {
          animation: float linear infinite;
        }

        .animate-shimmer {
          animation: shimmer 2s infinite;
        }

        .animate-shine {
          animation: shine 1.5s infinite;
        }

        .animate-gradient {
          background-size: 200% 200%;
          animation: gradient 3s ease infinite;
        }

        .animate-fade-in {
          animation: fade-in 0.5s ease-out;
        }

        @keyframes dots {
          0% { content: ""; }
          25% { content: "."; }
          50% { content: ".."; }
          75% { content: "..."; }
          100% { content: ""; }
        }
        
        .animate-dots::after {
          content: "";
          animation: dots 1.5s infinite steps(1);
        }
      `})]})}class mie{constructor(){this.scale=1,this.ingameScale=1,this.isMobile=gs.isMobile}init(){window.addEventListener("resize",()=>this.onResize()),window.addEventListener("DOMContentLoaded",()=>this.applyScale()),this.onResize()}computeScale(){const e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=this.isMobile?540:760;return e>=t?1:Math.min(1,e/t)}computeIngameScale(e=1,t=e){const r=XP();let i=1;const{w:s,h:o}={w:16,h:9};return r*window.innerWidth/(r*window.innerHeight)>s/o?i=gie(27)/75*e:i=o*yie(27)/s/75*t,Math.min(1,i)}applyScale(){const e=document.querySelector(".scale-container");e&&(this.scale=this.computeScale(),this.ingameScale=this.computeIngameScale(),this.isMobile?e.style.transform="translate(-50%, -50%) scale("+this.scale+")":e.style.transform="scale("+this.scale+")",gs.updateBannerVisibility(this.scale))}onResize(){requestAnimationFrame(()=>this.applyScale())}}const pie=new mie;function gie(n){const e=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return n*e/100}function yie(n){const e=Math.max(document.documentElement.clientWidth,window.innerWidth||0);return n*e/100}function XP(n=window.innerWidth,e=window.innerHeight){return e===0?n:XP(e,n%e)}const EM=1080;function bie(){const[n,e]=T.useState(()=>typeof window>"u"?!1:gs.isMobile?!0:window.innerWidth<=EM);return T.useEffect(()=>{if(gs.isMobile){e(!0);return}const t=()=>{e(window.innerWidth<=EM)};t();let r;const i=()=>{clearTimeout(r),r=setTimeout(t,150)};return window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i),clearTimeout(r)}},[]),n}const xie=new u2;function MM(){const{t:n,i18n:e}=xt(),t=bie(),[r,i]=T.useState(!1),[s,o]=T.useState(!1),[c,u]=T.useState(!1),[d,f]=T.useState(!1),[p,y]=T.useState(!1),[b,_]=T.useState(null),[w,S]=T.useState(null),[A,M]=T.useState(!1),[k,E]=T.useState(!1),[U,I]=T.useState(0),[B,G]=T.useState("");T.useEffect(()=>{const P=xie.getLanguage();P&&e.language!==P&&iC(P),_(P||"en")},[e]),T.useEffect(()=>{if(b){const P=oI(b);S(P?{native:P.native,en:P.en,svg:P.svg}:{native:b,en:b,svg:b})}},[b]),T.useEffect(()=>{const P=H=>{console.log("[App] Game started"),M(!0),E(!0)};return ae.on(nd,P),()=>{ae.off(nd,P)}},[]),T.useEffect(()=>{const P=()=>{console.log("[App] Game ready"),I(100),E(!1)};return ae.on(l1,P),()=>{ae.off(l1,P)}},[]),T.useEffect(()=>{const P=()=>{E(!0),I(0)};return ae.on(o1,P),()=>{ae.off(o1,P)}},[]),T.useEffect(()=>{const P=H=>{I(H.progress)};return ae.on(Ta,P),()=>{ae.off(Ta,P)}},[]),T.useEffect(()=>{const P=()=>{const Y=window.location.hash;if(!Y)return;const W=decodeURIComponent(Y).split("?")[0];if(W.startsWith("#game=")){const N=W.substring(6);N&&$t.safeParse(N).success&&(G(N),o(!0));return}};P();const H=()=>{P()};return window.addEventListener("hashchange",H),window.addEventListener("popstate",H),()=>{window.removeEventListener("hashchange",H),window.removeEventListener("popstate",H)}},[n]),T.useEffect(()=>{const H=new URLSearchParams(window.location.search).get("roomId");H&&$t.safeParse(H).success&&(console.log(`Joining via invite link: ${H}`),setTimeout(()=>{G(H),o(!0)},100))},[]),T.useEffect(()=>{(async()=>{if(!Rn.isCrazyGames)return;await Rn.isInstantMultiplayer()&&(console.log("CrazyGames instant multiplayer detected, opening create lobby modal"),setTimeout(()=>{i(!0)},100))})(),gs.init(),pie.init()},[]);const R=async P=>{try{const Y=(()=>{const N="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";let V="";for(let J=0;J<8;J++)V+=N.charAt(Math.floor(Math.random()*N.length));return V})(),L={gameMap:P.gameMap,difficulty:P.difficulty,gameMode:P.gameMode,economyMode:P.economyMode,gameType:qs.Private,gameMapSize:P.gameMapSize||La.Normal,disableNPCs:P.disableNPCs??!1,bots:P.bots??400,infiniteGold:P.infiniteGold??!1,infiniteTroops:P.infiniteTroops??!1,instantBuild:P.instantBuild??!1,donateGold:P.donateGold??!1,donateTroops:P.donateTroops??!1,disabledUnits:P.disabledUnits||[]},q=await fetch(`/api/create_game/${Y}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!q.ok){const N=await q.json();throw new Error(N.error||n("errors.failed_to_create_lobby"))}const W=await q.json();console.log("Lobby created successfully:",W),i(!1)}catch(H){console.error("Failed to create lobby:",H),alert(`Failed to create lobby: ${H instanceof Error?H.message:"Unknown error"}`)}};return g.jsxs(n8,{children:[k&&g.jsx(fie,{progress:U}),A?g.jsx(lie,{isMobile:t}):g.jsxs(FM,{children:[g.jsxs("div",{id:"main-menu-container",className:"flex flex-col h-full w-full select-none",children:[g.jsxs("div",{className:"flex w-full justify-center items-center flex-1 scale-container",children:[g.jsxs("div",{id:"ad-banner-left",style:{width:"300px",height:"600px"},children:[g.jsx("div",{id:"cg-banner-left",style:{width:"300px",height:"600px",display:"none"}}),g.jsx("div",{id:"frontwars-300x600",style:{width:"300px",height:"600px",display:"none"}})]}),g.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8 w-full max-w-[540px]",children:[g.jsx(o8,{}),g.jsx(UH,{className:"mt-6"}),g.jsx(YH,{className:"mt-4"}),g.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[g.jsxs("div",{className:"flex gap-3",children:[g.jsx(ic,{variant:"flex",onClick:()=>i(!0),children:n("main.create_lobby")}),g.jsx(ic,{variant:"flex",onClick:()=>o(!0),children:n("main.join_lobby")})]}),g.jsx(ic,{onClick:()=>u(!0),children:n("main.single_player")}),g.jsx(ic,{onClick:()=>f(!0),children:n("main.instructions")}),g.jsx(ic,{className:"flex items-center justify-center gap-2",onClick:()=>y(!0),children:w?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-8 h-6 shrink-0 flex items-center justify-center rounded overflow-hidden border border-gray-600",children:g.jsx("img",{src:`/flags/${w.svg}.svg`,alt:w.en,className:"w-full h-full object-cover",onError:P=>{P.target.style.display="none"}})}),g.jsxs("span",{children:[w.native," (",w.en,")"]})]}):g.jsx(g.Fragment,{children:g.jsx("span",{children:n("main.loading")})})})]})]}),g.jsxs("div",{id:"ad-banner-right",style:{width:"300px",height:"600px"},children:[g.jsx("div",{id:"cg-banner-right",style:{width:"300px",height:"600px",display:"none"}}),g.jsx("div",{id:"frontwars-300x600_2",style:{width:"300px",height:"600px",display:"none"}})]})]}),g.jsx(QH,{}),g.jsx($H,{})]}),g.jsx(h$,{open:r,onClose:()=>{i(!1),G(""),Rn.hideInviteButton()},onCreateLobby:R}),g.jsx(wq,{open:s,onClose:()=>{o(!1),G("")},initialLobbyId:B}),g.jsx(Sq,{open:c,onClose:()=>u(!1)}),g.jsx(Aq,{open:d,onClose:()=>f(!1)}),g.jsx(Cq,{open:p,onClose:()=>y(!1),onSelectLanguage:P=>{_(P),iC(P)},currentLanguage:b===null?void 0:b}),g.jsx(kq,{})]})]})}fz.then(()=>{FA.createRoot(document.getElementById("root")).render(g.jsx(MM,{}))}).catch(n=>{console.error("Failed to initialize i18n:",n),FA.createRoot(document.getElementById("root")).render(g.jsx(MM,{}))});export{gR as $,cE as A,Yh as B,cr as C,Dt as D,me as E,qI as F,el as G,pd as H,nl as I,md as J,eQ as K,fx as L,We as M,aQ as N,_v as O,br as P,zR as Q,Yo as R,Rd as S,uc as T,j1 as U,oE as V,wv as W,tQ as X,iQ as Y,mR as Z,pR as _,zi as a,K1 as a0,aJ as a1,un as a2,Yp as a3,gP as a4,VZ as a5,vd as a6,SR as a7,zc as b,vie as c,tl as d,Pn as e,zo as f,Zo as g,Ue as h,hR as i,qr as j,it as k,qo as l,Bn as m,zp as n,Qt as o,mp as p,X1 as q,iX as r,W1 as s,An as t,DE as u,Yt as v,ct as w,bte as x,Ar as y,vR as z};
